(function(a){a.fn.slider=function(b){if(void 0!=b.value)try{this.setRange(b.value)}catch(c){}else if(void 0!=b.maxValue)try{this.duration=b.maxValue,this.setRange(this.range)}catch(d){}else{var e=this;this.duration=b.max;this.onChange=b.onChange;this.direction=b.direction;var f=a('<div class="slider-total"></div>'),g=a('<div class="slider-range"></div>'),h=a('<div class="slider-handle"></div>');this.append(f);this.append(g);this.append(h);this.setRange=function(a){if(void 0!=a){e.range=a;var a=f.offset().left-
e.offset().left,b=parseInt(g.css("bottom").replace("px","")),c=h.width();if("horizontal"==e.direction){var d=f.width()-c,b=Math.floor(e.range*d/e.duration),b=Math.min(b,d),c=b+c/2;h.css({left:b+a});g.css({width:c})}else d=f.height()-c,a=Math.floor(e.range*d/e.duration),a=Math.min(a,d),c=a+c/2,h.css({bottom:a+b}),g.css({height:c})}};this.setRange(b.range);b=function(b){var c;isTouchDevice()?(c=b.originalEvent.touches[0],void 0==c&&(c=b.touches[0])):c=b;if(void 0!=c){var b=a(c.target),d=0;"horizontal"==
e.direction?(d=c.offsetX,void 0==d&&(d=c.pageX-b.offset().left),d=d/f.width()*e.duration):(d=c.offsetY,void 0==d&&(d=c.pageY-b.offset().top),d=(b.height()-d)/f.height()*e.duration);e.setRange.apply(e,[d]);e.onChange(d);return!1}};f.bind(_event._click,b);g.bind(_event._click,b)}}})(jQuery);(function(a){a.fn.addVideoSkin=function(b){var c=this;this.theme=void 0;for(var d=0;d<videoThemes.length;d++)videoThemes[d].name==b&&(this.theme=videoThemes[d]);void 0==this.theme&&(this.theme=videoThemes[0]);var b=this.find("video:first"),e=b[0];if(!(void 0==e||null==e)){this.addClass("video-player").addClass(this.theme.name);var f=a('<div class="video-controls"></div>');this.append(f);d=a('<div class="control-border"></div>');f.append(d);var g=a('<div class="video-play"></div>');f.append(g);d=a('<div class="bevel"></div>');
f.append(d);d=function(a){e.paused==false?e.pause():e.play();stopEvent(a);return false};b.bind(_event._click,d);g.bind(_event._click,d);b.bind("play",function(){g.addClass("paused-button")});b.bind("pause",function(){g.removeClass("paused-button")});b.bind("ended",function(){g.removeClass("paused-button")});f.playButton=g;var h=a('<div class="video-timer">00:00</div>');f.append(h);b.bind("timeupdate",function(){var a=e.currentTime,b=e.duration;if(b==0||b==void 0)b=100;j.slider({maxValue:b});j.slider({value:a});
h.text(timeFormat(a))});f.videoTimer=h;var j=a('<div class="video-seek"></div>');f.append(j);(function(){var a=e.duration;if(a==0||a==void 0)a=100;j.slider({range:0,max:a,direction:"horizontal",onChange:function(a){try{e.currentTime=a}catch(b){}}});f.show();c.controlbarWidth=f.width()})();f.videoSeek=j;d=a('<div class="bevel"></div>');f.append(d);var k=a('<div class="volume-seek"></div>');f.append(k);this.volume_value=1;k.slider({range:1,max:1,direction:"vertical",onChange:function(a){try{c.volume_value=
a;if(a==0){e.muted=true;m.addClass("volume-mute")}else{e.muted=false;m.removeClass("volume-mute")}e.volume=a}catch(b){}}});f.volumeSeek=k;var m=a('<div class="volume-button"></div>');f.append(m);m.bind(_event._click,function(){if(e.muted==true){e.muted=false;k.slider({value:c.volume_value});m.removeClass("volume-mute")}else{e.muted=true;k.slider({value:0});m.addClass("volume-mute")}return false});m.bind("mouseenter",function(){k.css({visiblity:"visible",opacity:"1"})});m.bind("mouseleave",function(){k.css({visiblity:"hidden",
opacity:"0"})});k.bind("mouseenter",function(){k.css({visiblity:"visible",opacity:"1"})});k.bind("mouseleave",function(){k.css({visiblity:"hidden",opacity:"0"})});f.volumeButton=m;var l=a('<div class="player-fullscreen"></div>');f.append(l);l.bind(_event._click,function(){fullScreenApi.supportsFullScreen?fullScreenApi.isFullScreen()?fullScreenApi.cancelFullScreen():fullScreenApi.requestFullScreen(e):e.webkitSupportsFullscreen&&e.webkitEnterFullscreen();return false});b.bind(fullScreenApi.fullScreenEventName,
function(){fullScreenApi.isFullScreen()?l.addClass("player-exit-fullscreen"):l.removeClass("player-exit-fullscreen")});f.fullscreenButton=l;this.controlbar=f;this.resizeVideoSkin()}};a.fn.resizeVideoSkin=function(){var a=this.find("video:first")[0],c=this.controlbar;if(void 0!=c){var d=c.videoSeek,e=c.volumeSeek,f=c.volumeButton,g=c.fullscreenButton,h=this.width(),j=Math.max(0,h-this.theme.seekWidth);0>=j?d.css({display:"none"}):(d.css({width:j,display:"block"}),d.slider({value:a.currentTime}));c=
f.offset().left-c.offset().left+(f.width()-e.width())/2;h<this.theme.fullscreenWidth?(g.css({display:"none"}),h<this.theme.volumeWidth?(f.css({display:"none"}),e.css({left:"-45px"})):(f.css({display:"block"}),e.css({left:c+"px"}))):(f.css({display:"block"}),g.css({display:"block"}),e.css({left:c+"px"}));!0==a.muted?e.slider({value:0}):e.slider({value:this.volume_value})}};a.fn.addAudioSkin=function(b){var c=this;this.theme=void 0;for(var d=0;d<audioThemes.length;d++)audioThemes[d].name==b&&(this.theme=
audioThemes[d]);void 0==this.theme&&(this.theme=audioThemes[0]);var b=this.find("audio:first"),e=b[0];if(!(void 0==e||null==e)){this.audioList=[];this.audioIndex=0;if(0==b.children("source").length)d=b.attr("src"),""!=d&&void 0!=d&&this.audioList.push(b.attr("src"));else for(d=0;d<b.children("source").length;d++)this.audioList.push(b.children("source")[d].src);if(this.audioResources.length>this.audioList.length){this.audioList=[];for(d=0;d<this.audioResources.length;d++)this.audioList.push(this.audioResources[d])}this.addClass("audio-player").addClass(this.theme.name);
this.play_btn=a('<div class="audio-play"></div>');this.append(this.play_btn);this.play_btn.bind(_event._click,function(a){e.paused==false?e.pause():e.play();stopEvent(a);return false});b.bind("play",function(){c.play_btn.addClass("paused-button")});b.bind("pause",function(){c.play_btn.removeClass("paused-button")});b.bind("ended",function(){c.play_btn.removeClass("paused-button");c.audioIndex<c.audioList.length-1&&f()});this.back_btn=a('<div class="back_button"></div>');this.append(this.back_btn);
this.back_btn.bind(_event._click,function(a){if(c.audioList.length!=0){c.audioIndex--;if(c.audioIndex<0)c.audioIndex=c.audioIndex+c.audioList.length;var b=c.audioList[c.audioIndex];e.src=b;c.audio_name.text(h(b));e.play();stopEvent(a);return false}});this.forward_btn=a('<div class="forward_button"></div>');this.append(this.forward_btn);var f=function(a){if(c.audioList.length!=0){c.audioIndex++;c.audioIndex=c.audioIndex%c.audioList.length;var b=c.audioList[c.audioIndex];e.src=b;c.audio_name.text(h(b));
e.play();stopEvent(a);return false}};this.forward_btn.bind(_event._click,f);this.volume_seek=a('<div class="volume-seek"></div>');this.append(this.volume_seek);this.volume_value=1;this.volume_seek.slider({range:1,max:1,direction:this.theme.volumeDirection,onChange:function(a){try{c.volume_value=a;if(a==0){e.muted=true;c.volume_btn.addClass("volume-mute")}else{e.muted=false;c.volume_btn.removeClass("volume-mute")}e.volume=a}catch(b){}}});this.volume_btn=a('<div class="volume-button"></div>');this.append(this.volume_btn);
var g=function(a){c.volume_value=e.volume+a;c.volume_value=Math.max(0,c.volume_value);c.volume_value=Math.min(1,c.volume_value);e.volume=c.volume_value};this.volume_up_btn=a('<div class="volume-up-button"></div>');this.volume_down_btn=a('<div class="volume-down-button"></div>');this.volume_up_btn.bind(_event._click,function(){g(0.1)});this.volume_down_btn.bind(_event._click,function(){g(-0.1)});this.append(this.volume_up_btn);this.append(this.volume_down_btn);this.volume_btn.bind(_event._click,function(a){if(e.muted==
true){e.muted=false;c.volume_seek.slider({value:c.volume_value});c.volume_btn.removeClass("volume-mute")}else{e.muted=true;c.volume_seek.slider({value:0});c.volume_btn.addClass("volume-mute")}stopEvent(a);return false});this.audio_timer=a('<div class="audio-timer">00:00/00:00</div>');this.append(this.audio_timer);b.bind("timeupdate",function(){var a=e.currentTime,b=e.duration;c.audio_seek.slider({maxValue:b});c.audio_seek.slider({value:a});c.audio_timer.text(timeFormat(a)+"/"+timeFormat(b))});this.audio_seek=
a('<div class="audio-seek"></div>');this.append(this.audio_seek);(function(){var a=e.duration;if(a==0||a==void 0)a=100;c.audio_seek.slider({range:0,max:a,direction:"horizontal",onChange:function(a){try{e.currentTime=a}catch(b){}}});c.resizeAudioSkin()})();this.audio_name=a('<div class="audio-file"></div>');this.append(this.audio_name);d="";0<this.audioList.length&&(d=this.audioList[0]);var h=function(a){if(a=="")return"";var b=-1,b=a.indexOf("\\")==-1?a.lastIndexOf("/"):a.lastIndexOf("\\");iNameEnd=
a.lastIndexOf(".");return fileTitle=a.substr(b+1,iNameEnd-b-1)};this.audio_name.text(h(d));c.resizeAudioSkin()}};a.fn.resizeAudioSkin=function(){var a=this.find("audio:first")[0];if(!(null==this.theme||void 0==this.theme)){var c=Math.max(0,this.width()-this.theme.audioSeek);0>=c?this.audio_seek.css({display:"none"}):(this.audio_seek.css({width:c,display:"block"}),this.audio_seek.slider({value:a.currentTime}));c=this.theme.wolumnWidth;void 0!=c&&(this.width()<c?(this.volume_btn.css({display:"none"}),
this.volume_seek.css({display:"none"})):(this.volume_btn.css({display:"block"}),this.volume_seek.css({display:"block"})),!1==a.muted?this.volume_seek.slider({value:this.volume_value}):this.volume_seek.slider({value:0}))}};a.fn.refreshAudioSeek=function(){var a=this.find("audio:first")[0];null==this.theme||void 0==this.theme||null==a||(this.audio_seek.slider({value:a.currentTime}),!1==a.muted?this.volume_seek.slider({value:this.volume_value}):this.volume_seek.slider({value:0}))}})(jQuery);
var videoThemes=[{name:"default",seekWidth:150,volumeWidth:105,fullscreenWidth:130},{name:"round",seekWidth:225,volumeWidth:145,fullscreenWidth:150},{name:"classic",seekWidth:195,volumeWidth:135,fullscreenWidth:170},{name:"smallblack",seekWidth:135,volumeWidth:85,fullscreenWidth:110},{name:"circle",seekWidth:150,volumeWidth:105,fullscreenWidth:130}],audioThemes=[{name:"default",volumeDirection:"horizontal",audioSeek:20,wolumnWidth:170},{name:"advanced",volumeDirection:"horizontal"},{name:"wave",volumeDirection:"horizontal",
audioSeek:125},{name:"glass",volumeDirection:"horizontal"},{name:"simple",volumeDirection:"horizontal"},{name:"enjoy",volumeDirection:"horizontal"},{name:"decent",volumeDirection:"vertical"},{name:"tree",volumeDirection:"horizontal"},{name:"christmas",volumeDirection:"vertical"},{name:"turnonoff",volumeDirection:"horizontal"},{name:"fade",volumeDirection:"horizontal"}],audioThemeNames={GlassAudioPlayer:"",SimpleAudioPlayer:"",StandardAudioPlayer:"",StandardAudioPlayer02:"",StandardAudioPlayer03:"",
StandardAudioPlayer04:"",StandardAudioPlayer05:"",StandardAudioPlayer06:""},timeFormat=function(a){var b=10>Math.floor(a/60)?"0"+Math.floor(a/60):Math.floor(a/60);return b+":"+(10>Math.floor(a-60*b)?"0"+Math.floor(a-60*b):Math.floor(a-60*b))},stopEvent=function(a){a=a||window.event;a.preventDefault?(a.preventDefault(),a.stopPropagation()):(a.returnValue=!1,a.cancelBubble=!0)};(function(a,b,c){function d(a,b){var c=(a[0]||0)-(b[0]||0);return 0<c||!c&&0<a.length&&d(a.slice(1),b.slice(1))}function e(a){if(typeof a!=g)return a;var b=[],c="",d;for(d in a)c=typeof a[d]==g?e(a[d]):[d,h?encodeURI(a[d]):a[d]].join("="),b.push(c);return b.join("&")}function f(a){var b=[],c;for(c in a)b.push(['<param name="',c,'" value="',e(a[c]),'" />'].join(""));return b.join("")}var g="object",h=!0;try{var j=c.description||(new c("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version")}catch(k){j=
"Unavailable"}var m=j.match(/\d+/g)||[0];a[b]={available:0<m[0],activeX:c&&!c.name,version:{original:j,array:m,string:m.join("."),major:parseInt(m[0],10)||0,minor:parseInt(m[1],10)||0,release:parseInt(m[2],10)||0},hasVersion:function(a){a=/string|number/.test(typeof a)?a.toString().split("."):/object/.test(typeof a)?[a.major,a.minor]:a||[0,0];return d(m,a)},encodeParams:!0,expressInstall:"expressInstall.swf",expressInstallIsActive:!1,create:function(a){if(!a.swf||this.expressInstallIsActive||!this.available&&
!a.hasVersionFail)return!1;if(!this.hasVersion(a.hasVersion||1)){this.expressInstallIsActive=!0;if("function"==typeof a.hasVersionFail&&!a.hasVersionFail.apply(a))return!1;a={swf:a.expressInstall||this.expressInstall,height:137,width:214,flashvars:{MMredirectURL:location.href,MMplayerType:this.activeX?"ActiveX":"PlugIn",MMdoctitle:document.title.slice(0,47)+" - Flash Player Installation"}}}attrs={data:a.swf,type:"application/x-shockwave-flash",id:a.id||"flash_"+Math.floor(999999999*Math.random()),
width:a.width||320,height:a.height||180,style:a.style||""};h="undefined"!==typeof a.useEncode?a.useEncode:this.encodeParams;a.movie=a.swf;a.wmode=a.wmode||"opaque";delete a.fallback;delete a.hasVersion;delete a.hasVersionFail;delete a.height;delete a.id;delete a.swf;delete a.useEncode;delete a.width;var b=document.createElement("div"),c;c=attrs;var d=[],e;for(e in c)c[e]&&d.push([e,'="',c[e],'"'].join(""));c=d.join(" ");b.innerHTML=["<object ",c,">",f(a),"</object>"].join("");return b.firstChild}};
a.fn[b]=function(c){var d=this.find(g).andSelf().filter(g);/string|object/.test(typeof c)&&this.each(function(){var d=a(this),e;c=typeof c==g?c:{swf:c};c.fallback=this;if(e=a[b].create(c))d.children().remove(),d.html(e)});"function"==typeof c&&d.each(function(){var d=this;d.jsInteractionTimeoutMs=d.jsInteractionTimeoutMs||0;660>d.jsInteractionTimeoutMs&&(d.clientWidth||d.clientHeight?c.call(d):setTimeout(function(){a(d)[b](c)},d.jsInteractionTimeoutMs+66))});return d}})(jQuery,"flash",navigator.plugins["Shockwave Flash"]||
window.ActiveXObject);jQuery.easing.jswing=jQuery.easing.swing;
jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(a,b,c,d,e){return jQuery.easing[jQuery.easing.def](a,b,c,d,e)},easeInQuad:function(a,b,c,d,e){return d*(b/=e)*b+c},easeOutQuad:function(a,b,c,d,e){return-d*(b/=e)*(b-2)+c},easeInOutQuad:function(a,b,c,d,e){return 1>(b/=e/2)?d/2*b*b+c:-d/2*(--b*(b-2)-1)+c},easeInCubic:function(a,b,c,d,e){return d*(b/=e)*b*b+c},easeOutCubic:function(a,b,c,d,e){return d*((b=b/e-1)*b*b+1)+c},easeInOutCubic:function(a,b,c,d,e){return 1>(b/=e/2)?d/2*b*b*b+c:
d/2*((b-=2)*b*b+2)+c},easeInQuart:function(a,b,c,d,e){return d*(b/=e)*b*b*b+c},easeOutQuart:function(a,b,c,d,e){return-d*((b=b/e-1)*b*b*b-1)+c},easeInOutQuart:function(a,b,c,d,e){return 1>(b/=e/2)?d/2*b*b*b*b+c:-d/2*((b-=2)*b*b*b-2)+c},easeInQuint:function(a,b,c,d,e){return d*(b/=e)*b*b*b*b+c},easeOutQuint:function(a,b,c,d,e){return d*((b=b/e-1)*b*b*b*b+1)+c},easeInOutQuint:function(a,b,c,d,e){return 1>(b/=e/2)?d/2*b*b*b*b*b+c:d/2*((b-=2)*b*b*b*b+2)+c},easeInSine:function(a,b,c,d,e){return-d*Math.cos(b/
e*(Math.PI/2))+d+c},easeOutSine:function(a,b,c,d,e){return d*Math.sin(b/e*(Math.PI/2))+c},easeInOutSine:function(a,b,c,d,e){return-d/2*(Math.cos(Math.PI*b/e)-1)+c},easeInExpo:function(a,b,c,d,e){return 0==b?c:d*Math.pow(2,10*(b/e-1))+c},easeOutExpo:function(a,b,c,d,e){return b==e?c+d:d*(-Math.pow(2,-10*b/e)+1)+c},easeInOutExpo:function(a,b,c,d,e){return 0==b?c:b==e?c+d:1>(b/=e/2)?d/2*Math.pow(2,10*(b-1))+c:d/2*(-Math.pow(2,-10*--b)+2)+c},easeInCirc:function(a,b,c,d,e){return-d*(Math.sqrt(1-(b/=e)*
b)-1)+c},easeOutCirc:function(a,b,c,d,e){return d*Math.sqrt(1-(b=b/e-1)*b)+c},easeInOutCirc:function(a,b,c,d,e){return 1>(b/=e/2)?-d/2*(Math.sqrt(1-b*b)-1)+c:d/2*(Math.sqrt(1-(b-=2)*b)+1)+c},easeInElastic:function(a,b,c,d,e){var a=1.70158,f=0,g=d;if(0==b)return c;if(1==(b/=e))return c+d;f||(f=0.3*e);g<Math.abs(d)?(g=d,a=f/4):a=f/(2*Math.PI)*Math.asin(d/g);return-(g*Math.pow(2,10*(b-=1))*Math.sin((b*e-a)*2*Math.PI/f))+c},easeOutElastic:function(a,b,c,d,e){var a=1.70158,f=0,g=d;if(0==b)return c;if(1==
(b/=e))return c+d;f||(f=0.3*e);g<Math.abs(d)?(g=d,a=f/4):a=f/(2*Math.PI)*Math.asin(d/g);return g*Math.pow(2,-10*b)*Math.sin((b*e-a)*2*Math.PI/f)+d+c},easeInOutElastic:function(a,b,c,d,e){var a=1.70158,f=0,g=d;if(0==b)return c;if(2==(b/=e/2))return c+d;f||(f=e*0.3*1.5);g<Math.abs(d)?(g=d,a=f/4):a=f/(2*Math.PI)*Math.asin(d/g);return 1>b?-0.5*g*Math.pow(2,10*(b-=1))*Math.sin((b*e-a)*2*Math.PI/f)+c:0.5*g*Math.pow(2,-10*(b-=1))*Math.sin((b*e-a)*2*Math.PI/f)+d+c},easeInBack:function(a,b,c,d,e,f){void 0==
f&&(f=1.70158);return d*(b/=e)*b*((f+1)*b-f)+c},easeOutBack:function(a,b,c,d,e,f){void 0==f&&(f=1.70158);return d*((b=b/e-1)*b*((f+1)*b+f)+1)+c},easeInOutBack:function(a,b,c,d,e,f){void 0==f&&(f=1.70158);return 1>(b/=e/2)?d/2*b*b*(((f*=1.525)+1)*b-f)+c:d/2*((b-=2)*b*(((f*=1.525)+1)*b+f)+2)+c},easeInBounce:function(a,b,c,d,e){return d-jQuery.easing.easeOutBounce(a,e-b,0,d,e)+c},easeOutBounce:function(a,b,c,d,e){return(b/=e)<1/2.75?d*7.5625*b*b+c:b<2/2.75?d*(7.5625*(b-=1.5/2.75)*b+0.75)+c:b<2.5/2.75?
d*(7.5625*(b-=2.25/2.75)*b+0.9375)+c:d*(7.5625*(b-=2.625/2.75)*b+0.984375)+c},easeInOutBounce:function(a,b,c,d,e){return b<e/2?0.5*jQuery.easing.easeInBounce(a,2*b,0,d,e)+c:0.5*jQuery.easing.easeOutBounce(a,2*b-e,0,d,e)+0.5*d+c}});(function(a){var b=[],c=function(){},d=0,e=[],f=function(){d++;d>=b.length&&(c(e),c=function(){})},g=function(b){var c=new Image;a(c).load(function(){e.push({url:b,img:c});f()}).error(function(){e.push(c);f()}).attr("src",b)};a.fn.loader=function(d,e){d&&a.extend(b,d);"function"==typeof e&&(c=e);for(var f=0;f<b.length;f++)g(b[f])}})(jQuery);(function(a){var b=function(){return Hammer.HAS_TOUCHEVENTS&&navigator.userAgent.match(Hammer.MOBILE_REGEX)},c=function(a){var d=this;this.theButton=a;this.eventSource=a[0];b()?(a.bind("touchstart",function(){c.prototype.mouseDown.apply(d,arguments)}),a.bind("touchend",function(){c.prototype.mouseUp.apply(d,arguments)})):(a.bind("mousedown",function(){c.prototype.mouseDown.apply(d,arguments)}),a.bind("mouseleave",function(){c.prototype.mouseUp.apply(d,arguments)}),a.bind("mouseup",function(){c.prototype.mouseUp.apply(d,
arguments)}))};c.prototype.mouseDown=function(){this.setAlpha(70)};c.prototype.mouseUp=function(){var a=this;window.setTimeout(function(){c.prototype.setAlpha.apply(a,[100])},100)};c.prototype.setAlpha=function(a){0>a&&(a=0);100<=a&&(a=100);this.theButton.css("opacity",a/100)};a.fn.asButton=function(){new c(this);return this};var d=function(a){this.eventSource=a[0];this.origPicture=a[0].src;var c=this.origPicture.lastIndexOf("."),e=this.origPicture.substr(0,c),c=this.origPicture.substring(c);this.pictureDown=
e+"_down"+c;var f=this;b()?(a.bind("touchstart",function(){d.prototype.mouseDown.apply(f,arguments)}),a.bind("touchend",function(){d.prototype.mouseUp.apply(f,arguments)})):(a.bind("mouseenter",function(){d.prototype.mouseOver.apply(f,arguments)}),a.bind("mousedown",function(){d.prototype.mouseDown.apply(f,arguments)}),a.bind("mouseup",function(){d.prototype.mouseUp.apply(f,arguments)}),a.bind("mouseleave",function(){d.prototype.mouseUp.apply(f,arguments)}))};d.prototype.mouseOver=function(){this.eventSource.src=
this.pictureDown};d.prototype.mouseDown=function(){this.eventSource.src=this.pictureDown};d.prototype.mouseUp=function(){var a=this;window.setTimeout(function(){a.eventSource.src=a.origPicture},100)};a.fn.asImageButton=function(){new d(this);return this};var e=function(a){this.eventSource=a[0];this.origPicture=a[0].src;var c=this.origPicture.lastIndexOf("."),d=this.origPicture.substr(0,c),c=this.origPicture.substring(c);this.pictureDown=d+"_down"+c;var f=this;b()?(a.bind("touchstart",function(){e.prototype.mouseOver.apply(f,
arguments)}),a.bind("touchend",function(){e.prototype.mouseUp.apply(f,arguments)})):(a.bind("mouseenter",function(){e.prototype.mouseOver.apply(f,arguments)}),a.bind("mousedown",function(){e.prototype.mouseDown.apply(f,arguments)}),a.bind("mouseup",function(){e.prototype.mouseUp.apply(f,arguments)}),a.bind("mouseleave",function(){e.prototype.mouseUp.apply(f,arguments)}))};e.prototype.mouseOver=function(){this.eventSource.src=this.pictureDown};e.prototype.mouseDown=function(){this.eventSource.src=
this.pictureDown};e.prototype.mouseUp=function(){var a=this;window.setTimeout(function(){a.eventSource.src=a.origPicture},100)};a.fn.asImageChangeButton=function(){new e(this);return this};var f=function(a){var b=this;this.theButton=a;this.eventSource=a[0];var c=this.theButton.css("top");this.iOrigTop=parseInt(c.replace("px",""));this.iJumpTop=this.iOrigTop-5;a.bind("mouseenter",function(){f.prototype.MouseEnter.apply(b,arguments)});a.bind("mouseleave",function(){f.prototype.MouseLeave.apply(b,arguments)})};
f.prototype.MouseEnter=function(){this.theButton.animate({top:this.iJumpTop},50)};f.prototype.MouseLeave=function(){this.theButton.animate({top:this.iOrigTop},50)};a.fn.mouseEnterJump=function(){new f(this);return this};a.fn.mouseOverCursor=function(){new g(this);return this};var g=function(a){a.bind("mouseover",function(){a.css({cursor:"pointer"})})},h=function(a){var b=this;this.theButton=a;this.eventSource=a[0];var c=this.theButton.css("top");this.iOrigTop=parseInt(c.replace("px",""));c=this.theButton.css("left");
this.iOrigLeft=parseInt(c.replace("px",""));this.iZoomTop=this.iOrigTop-3;this.iZoomLeft=this.iOrigLeft-1;a.bind("mouseenter",function(){h.prototype.MouseEnter.apply(b,arguments)});a.bind("mouseleave",function(){h.prototype.MouseLeave.apply(b,arguments)})};h.prototype.MouseDown=function(){this.theButton.css({left:this.iZoomLeft+"px",top:this.iZoomTop+"px","-webkit-transform":"scale(1.1)","-moz-transform":"scale(1.1)",transform:"scale(1.1)","-ms-transform":"scale(1.1)","-o-transform":"scale(1.1)"})};
h.prototype.MouseEnter=function(){this.theButton.css({left:this.iZoomLeft+"px",top:this.iZoomTop+"px","-webkit-transform":"scale(1.2)","-moz-transform":"scale(1.2)",transform:"scale(1.2)","-ms-transform":"scale(1.2)","-o-transform":"scale(1.2)"})};h.prototype.MouseLeave=function(){this.theButton.css({left:this.iOrigLeft+"px",top:this.iOrigTop+"px","-webkit-transform":"scale(1)","-moz-transform":"scale(1)",transform:"scale(1)","-ms-transform":"scale(1)","-o-transform":"scale(1)"})};var j=function(a){var b=
this;this.theButton=a;this.eventSource=a[0];var c=this.theButton.css("top");this.iOrigTop=parseInt(c.replace("px",""));c=this.theButton.css("left");this.iOrigLeft=parseInt(c.replace("px",""));this.iZoomTop=this.iOrigTop-1;this.iZoomLeft=this.iOrigLeft-1;a.bind("mouseenter",function(){j.prototype.MouseEnter.apply(b,arguments)});a.bind("mouseleave",function(){j.prototype.MouseLeave.apply(b,arguments)})};j.prototype.MouseEnter=function(){this.theButton.css({left:this.iZoomLeft+"px",top:this.iZoomTop+
"px","-webkit-transform":"scale(1.1)","-moz-transform":"scale(1.1)",transform:"scale(1.1)","-ms-transform":"scale(1.1)","-o-transform":"scale(1.1)"})};j.prototype.MouseLeave=function(){this.theButton.css({left:this.iOrigLeft+"px",top:this.iOrigTop+"px","-webkit-transform":"scale(1)","-moz-transform":"scale(1)",transform:"scale(1)","-ms-transform":"scale(1)","-o-transform":"scale(1)"})};a.fn.mouseEnterZoom=function(){new j(this);return this};a.fn.mouseEnterUp=function(){new k(this);return this};var k=
function(a){var b=this;this.theButton=a;this.eventSource=a[0];var c=this.theButton.css("bottom");this.iOrigTop=parseInt(c.replace("px",""));c=this.theButton.css("left");this.iOrigLeft=parseInt(c.replace("px",""));this.iZoomTop=this.iOrigTop-1;this.iZoomLeft=this.iOrigLeft-1;a.bind("mouseenter",function(){k.prototype.MouseEnter.apply(b,arguments)});a.bind("mouseleave",function(){k.prototype.MouseLeave.apply(b,arguments)})};k.prototype.MouseEnter=function(){this.theButton.css({bottom:this.iZoomTop+
"px","-webkit-transform":"scale(1.1)","-moz-transform":"scale(1.1)",transform:"scale(1.1)","-ms-transform":"scale(1.1)","-o-transform":"scale(1.1)"})};k.prototype.MouseLeave=function(){this.theButton.css({bottom:this.iOrigTop+"px","-webkit-transform":"scale(1)","-moz-transform":"scale(1)",transform:"scale(1)","-ms-transform":"scale(1)","-o-transform":"scale(1)"})};a.fn.mouseZoomUp=function(){new h(this);return this};a.fn.mouseEnterLight=function(){var a=this;this.bind(_event._enter,function(){a.css({background:"#EEEEEE"})});
this.bind(_event._down,function(){a.css({background:"#EEEEEE"})});b()?this.bind(_event._end,function(){a.css({background:"transparent"})}):this.bind(_event._end,function(){a.css({background:"#EEEEEE"})});this.bind(_event._leave,function(){a.css({background:"transparent"})});return this};a.fn.mouseEnterShine=function(a,c,d){var e=this,f=colorDiv(a,10);this.bind(_event._enter,function(){e.css({background:f});e.css({border:""});e.css({"border-left":"1px solid "+d,"border-top":"1px solid "+d});e.css({"border-right":"1px solid "+
c,"border-bottom":"1px solid "+c})});this.bind(_event._down,function(){e.css({background:f});e.css({border:""});e.css({"border-left":"1px solid "+c,"border-top":"1px solid "+c});e.css({"border-right":"1px solid "+d,"border-bottom":"1px solid "+d})});b()?this.bind(_event._end,function(){e.css({background:"transparent"});e.css({border:""})}):this.bind(_event._end,function(){e.css({background:f});e.css({border:""});e.css({"border-left":"1px solid "+d,"border-top":"1px solid "+d});e.css({"border-right":"1px solid "+
c,"border-bottom":"1px solid "+c})});this.bind(_event._leave,function(){e.css({background:"transparent"});e.css({border:""})});return this};a.fn.mouseEnterGradient=function(a,c,d){var e=this,f=colorAdd(a,75),h="-webkit-gradient(linear,left top,left bottom,color-stop(0,"+f+"),color-stop(0.19,"+colorAdd(f,2)+"),color-stop(0.35,"+colorAdd(f,28)+"),color-stop(0.55, "+colorAdd(f,6)+"),color-stop(0.75,"+colorAdd(f,4)+"),color-stop(0.85,"+colorAdd(f,2)+"),color-stop(1, "+f+"))";this.bind(_event._enter,function(){e.css("background",
h);e.css({border:""});e.css({"border-left":"1px solid "+d,"border-top":"1px solid "+d});e.css({"border-right":"1px solid "+c,"border-bottom":"1px solid "+c})});this.bind(_event._down,function(){e.setGradient(f,!1);e.css({border:""});e.css({"border-left":"1px solid "+c,"border-top":"1px solid "+c});e.css({"border-right":"1px solid "+d,"border-bottom":"1px solid "+d})});b()?this.bind(_event._end,function(){e.css({background:"transparent"});e.css({border:""})}):this.bind(_event._end,function(){e.css("background",
h);e[0].style.removeAttribute&&e[0].style.removeAttribute("filter");e.css({border:""});e.css({"border-left":"1px solid "+d,"border-top":"1px solid "+d});e.css({"border-right":"1px solid "+c,"border-bottom":"1px solid "+c})});this.bind(_event._leave,function(){e[0].style.removeAttribute&&e[0].style.removeAttribute("filter");e.css({background:"transparent"});e.css({border:""})});return this};a.fn.dragToMove=function(b){var c=!1,d=0,e=0,f=0,h=0;a(this).bind(_event._down,function(g){var j=a(this)[0];
j.setCapture?j.setCapture():window.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP);g=isTouch?g.originalEvent.touches:[g];c=!0;d=g[0].pageX;e=g[0].pageY;f=a(b).offset().left;h=a(b).offset().top;return!1});a(this).bind(_event._end,function(){var b=a(this)[0];b.releaseCapture?b.releaseCapture():window.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP);return c=!1});a(this).bind(_event._move,function(g){g=isTouch?g.originalEvent.touches:[g];if(c){var j=g[0].pageX-d,g=g[0].pageY-e;a(b).css({left:f+j+"px",top:h+
g+"px"})}return!1});a(this).bind("mouseleave",function(){return c=!1})}})(jQuery);(function(a,b){function c(){if(!d.READY){d.event.determineEventTypes();for(var a in d.gestures)d.gestures.hasOwnProperty(a)&&d.detection.register(d.gestures[a]);d.event.onTouch(d.DOCUMENT,d.EVENT_MOVE,d.detection.detect);d.event.onTouch(d.DOCUMENT,d.EVENT_END,d.detection.detect);d.READY=!0}}var d=function(a,b){return new d.Instance(a,b||{})};d.defaults={stop_browser_behavior:{touchAction:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};d.HAS_POINTEREVENTS=
navigator.pointerEnabled||navigator.msPointerEnabled;d.HAS_TOUCHEVENTS="ontouchstart"in a;d.MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android/i;d.NO_MOUSEEVENTS=d.HAS_TOUCHEVENTS&&navigator.userAgent.match(d.MOBILE_REGEX);d.EVENT_TYPES={};d.DIRECTION_DOWN="down";d.DIRECTION_LEFT="left";d.DIRECTION_UP="up";d.DIRECTION_RIGHT="right";d.POINTER_MOUSE="mouse";d.POINTER_TOUCH="touch";d.POINTER_PEN="pen";d.EVENT_START="start";d.EVENT_MOVE="move";d.EVENT_END="end";d.DOCUMENT=document;d.plugins={};d.READY=
!1;d.Instance=function(a,b){var e=this;return c(),this.element=a,this.enabled=!0,this.options=d.utils.extend(d.utils.extend({},d.defaults),b||{}),this.options.stop_browser_behavior&&d.utils.stopDefaultBrowserBehavior(this.element,this.options.stop_browser_behavior),d.event.onTouch(a,d.EVENT_START,function(a){e.enabled&&d.detection.startDetect(e,a)}),this};d.Instance.prototype={on:function(a,b){for(var c=a.split(" "),d=0;c.length>d;d++)this.element.addEventListener(c[d],b,!1);return this},off:function(a,
b){for(var c=a.split(" "),d=0;c.length>d;d++)this.element.removeEventListener(c[d],b,!1);return this},trigger:function(a,b){var c=d.DOCUMENT.createEvent("Event");c.initEvent(a,!0,!0);c.gesture=b;var e=this.element;return d.utils.hasParent(b.target,e)&&(e=b.target),e.dispatchEvent(c),this},enable:function(a){return this.enabled=a,this}};var e=null,f=!1,g=!1;d.event={bindDom:function(a,b,c){for(var b=b.split(" "),d=0;b.length>d;d++)a.addEventListener(b[d],c,!1)},onTouch:function(a,b,c){var m=this;this.bindDom(a,
d.EVENT_TYPES[b],function(l){var n=l.type.toLowerCase();if(!n.match(/mouse/)||!g){(n.match(/touch/)||n.match(/pointerdown/)||n.match(/mouse/)&&1===l.which)&&(f=!0);n.match(/touch|pointer/)&&(g=!0);var o=0;f&&(d.HAS_POINTEREVENTS&&b!=d.EVENT_END?o=d.PointerEvent.updatePointer(b,l):n.match(/touch/)?o=l.touches.length:g||(o=n.match(/up/)?0:1),0<o&&b==d.EVENT_END?b=d.EVENT_MOVE:o||(b=d.EVENT_END),o||null===e?e=l:l=e,c.call(d.detection,m.collectEventData(a,b,l)),d.HAS_POINTEREVENTS&&b==d.EVENT_END&&(o=
d.PointerEvent.updatePointer(b,l)));o||(e=null,f=!1,g=!1,d.PointerEvent.reset())}})},determineEventTypes:function(){var a;a=d.HAS_POINTEREVENTS?d.PointerEvent.getEvents():d.NO_MOUSEEVENTS?["touchstart","touchmove","touchend touchcancel"]:["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"];d.EVENT_TYPES[d.EVENT_START]=a[0];d.EVENT_TYPES[d.EVENT_MOVE]=a[1];d.EVENT_TYPES[d.EVENT_END]=a[2]},getTouchList:function(a){return d.HAS_POINTEREVENTS?d.PointerEvent.getTouchList():a.touches?
a.touches:[{identifier:1,pageX:a.pageX,pageY:a.pageY,target:a.target}]},collectEventData:function(a,b,c){var a=this.getTouchList(c,b),e=d.POINTER_TOUCH;return(c.type.match(/mouse/)||d.PointerEvent.matchType(d.POINTER_MOUSE,c))&&(e=d.POINTER_MOUSE),{center:d.utils.getCenter(a),timeStamp:(new Date).getTime(),target:c.target,touches:a,eventType:b,pointerType:e,srcEvent:c,preventDefault:function(){this.srcEvent.preventManipulation&&this.srcEvent.preventManipulation();this.srcEvent.preventDefault&&this.srcEvent.preventDefault()},
stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return d.detection.stopDetect()}}}};d.PointerEvent={pointers:{},getTouchList:function(){var a=this,b=[];return Object.keys(a.pointers).sort().forEach(function(c){b.push(a.pointers[c])}),b},updatePointer:function(a,b){return a==d.EVENT_END?this.pointers={}:(b.identifier=b.pointerId,this.pointers[b.pointerId]=b),Object.keys(this.pointers).length},matchType:function(a,b){if(!b.pointerType)return!1;var c={};return c[d.POINTER_MOUSE]=
b.pointerType==b.MSPOINTER_TYPE_MOUSE||b.pointerType==d.POINTER_MOUSE,c[d.POINTER_TOUCH]=b.pointerType==b.MSPOINTER_TYPE_TOUCH||b.pointerType==d.POINTER_TOUCH,c[d.POINTER_PEN]=b.pointerType==b.MSPOINTER_TYPE_PEN||b.pointerType==d.POINTER_PEN,c[a]},getEvents:function(){return["pointerdown MSPointerDown","pointermove MSPointerMove","pointerup pointercancel MSPointerUp MSPointerCancel"]},reset:function(){this.pointers={}}};d.utils={extend:function(a,c,d){for(var e in c)a[e]!==b&&d||(a[e]=c[e]);return a},
hasParent:function(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1},getCenter:function(a){for(var b=[],c=[],d=0,e=a.length;e>d;d++)b.push(a[d].pageX),c.push(a[d].pageY);return{pageX:(Math.min.apply(Math,b)+Math.max.apply(Math,b))/2,pageY:(Math.min.apply(Math,c)+Math.max.apply(Math,c))/2}},getVelocity:function(a,b,c){return{x:Math.abs(b/a)||0,y:Math.abs(c/a)||0}},getAngle:function(a,b){return 180*Math.atan2(b.pageY-a.pageY,b.pageX-a.pageX)/Math.PI},getDirection:function(a,b){var c=Math.abs(a.pageX-
b.pageX),e=Math.abs(a.pageY-b.pageY);return c>=e?0<a.pageX-b.pageX?d.DIRECTION_LEFT:d.DIRECTION_RIGHT:0<a.pageY-b.pageY?d.DIRECTION_UP:d.DIRECTION_DOWN},getDistance:function(a,b){var c=b.pageX-a.pageX,d=b.pageY-a.pageY;return Math.sqrt(c*c+d*d)},getScale:function(a,b){return 2<=a.length&&2<=b.length?this.getDistance(b[0],b[1])/this.getDistance(a[0],a[1]):1},getRotation:function(a,b){return 2<=a.length&&2<=b.length?this.getAngle(b[1],b[0])-this.getAngle(a[1],a[0]):0},isVertical:function(a){return a==
d.DIRECTION_UP||a==d.DIRECTION_DOWN},stopDefaultBrowserBehavior:function(a,b){var c,d="webkit,khtml,moz,ms,o,".split(",");if(b&&a.style){for(var e=0;d.length>e;e++)for(var f in b)b.hasOwnProperty(f)&&(c=f,d[e]&&(c=d[e]+c.substring(0,1).toUpperCase()+c.substring(1)),a.style[c]=b[f]);"none"==b.userSelect&&(a.onselectstart=function(){return!1})}}};d.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(a,b){this.current||(this.stopped=!1,this.current={inst:a,startEvent:d.utils.extend({},
b),lastEvent:!1,name:""},this.detect(b))},detect:function(a){if(this.current&&!this.stopped){for(var a=this.extendEventData(a),b=this.current.inst.options,c=0,e=this.gestures.length;e>c;c++){var f=this.gestures[c];if(!this.stopped&&!1!==b[f.name]&&!1===f.handler.call(f,a,this.current.inst)){this.stopDetect();break}}return this.current&&(this.current.lastEvent=a),a.eventType==d.EVENT_END&&!a.touches.length-1&&this.stopDetect(),a}},stopDetect:function(){this.previous=d.utils.extend({},this.current);
this.current=null;this.stopped=!0},extendEventData:function(a){var b=this.current.startEvent;if(b&&(a.touches.length!=b.touches.length||a.touches===b.touches)){b.touches=[];for(var c=0,e=a.touches.length;e>c;c++)b.touches.push(d.utils.extend({},a.touches[c]))}var c=a.timeStamp-b.timeStamp,e=a.center.pageX-b.center.pageX,f=a.center.pageY-b.center.pageY,g=d.utils.getVelocity(c,e,f);return d.utils.extend(a,{deltaTime:c,deltaX:e,deltaY:f,velocityX:g.x,velocityY:g.y,distance:d.utils.getDistance(b.center,
a.center),angle:d.utils.getAngle(b.center,a.center),direction:d.utils.getDirection(b.center,a.center),scale:d.utils.getScale(b.touches,a.touches),rotation:d.utils.getRotation(b.touches,a.touches),startEvent:b}),a},register:function(a){var c=a.defaults||{};return c[a.name]===b&&(c[a.name]=!0),d.utils.extend(d.defaults,c,!0),a.index=a.index||1E3,this.gestures.push(a),this.gestures.sort(function(a,b){return a.index<b.index?-1:a.index>b.index?1:0}),this.gestures}};d.gestures=d.gestures||{};d.gestures.Hold=
{name:"hold",index:10,defaults:{hold_timeout:500,hold_threshold:1},timer:null,handler:function(a,b){switch(a.eventType){case d.EVENT_START:clearTimeout(this.timer);d.detection.current.name=this.name;this.timer=setTimeout(function(){"hold"==d.detection.current.name&&b.trigger("hold",a)},b.options.hold_timeout);break;case d.EVENT_MOVE:a.distance>b.options.hold_threshold&&clearTimeout(this.timer);break;case d.EVENT_END:clearTimeout(this.timer)}}};d.gestures.Tap={name:"tap",index:100,defaults:{tap_max_touchtime:250,
tap_max_distance:10,tap_always:!0,doubletap_distance:20,doubletap_interval:300},handler:function(a,b){if(a.eventType==d.EVENT_END){var c=d.detection.previous,e=!1;a.deltaTime>b.options.tap_max_touchtime||a.distance>b.options.tap_max_distance||(c&&"tap"==c.name&&a.timeStamp-c.lastEvent.timeStamp<b.options.doubletap_interval&&a.distance<b.options.doubletap_distance&&(b.trigger("doubletap",a),e=!0),(!e||b.options.tap_always)&&(d.detection.current.name="tap",b.trigger(d.detection.current.name,a)))}}};
d.gestures.Swipe={name:"swipe",index:40,defaults:{swipe_max_touches:1,swipe_velocity:0.7},handler:function(a,b){a.eventType==d.EVENT_END&&!(0<b.options.swipe_max_touches&&a.touches.length>b.options.swipe_max_touches)&&(a.velocityX>b.options.swipe_velocity||a.velocityY>b.options.swipe_velocity)&&(b.trigger(this.name,a),b.trigger(this.name+a.direction,a))}};d.gestures.Drag={name:"drag",index:50,defaults:{drag_min_distance:10,drag_max_touches:1,drag_block_horizontal:!1,drag_block_vertical:!1,drag_lock_to_axis:!1,
drag_lock_min_distance:25},triggered:!1,handler:function(a,c){if(d.detection.current.name!=this.name&&this.triggered)return c.trigger(this.name+"end",a),this.triggered=!1,b;if(!(0<c.options.drag_max_touches&&a.touches.length>c.options.drag_max_touches))switch(a.eventType){case d.EVENT_START:this.triggered=!1;break;case d.EVENT_MOVE:if(a.distance<c.options.drag_min_distance&&d.detection.current.name!=this.name)break;d.detection.current.name=this.name;(d.detection.current.lastEvent.drag_locked_to_axis||
c.options.drag_lock_to_axis&&c.options.drag_lock_min_distance<=a.distance)&&(a.drag_locked_to_axis=!0);var e=d.detection.current.lastEvent.direction;a.drag_locked_to_axis&&e!==a.direction&&(a.direction=d.utils.isVertical(e)?0>a.deltaY?d.DIRECTION_UP:d.DIRECTION_DOWN:0>a.deltaX?d.DIRECTION_LEFT:d.DIRECTION_RIGHT);this.triggered||(c.trigger(this.name+"start",a),this.triggered=!0);c.trigger(this.name,a);c.trigger(this.name+a.direction,a);(c.options.drag_block_vertical&&d.utils.isVertical(a.direction)||
c.options.drag_block_horizontal&&!d.utils.isVertical(a.direction))&&a.preventDefault();break;case d.EVENT_END:this.triggered&&c.trigger(this.name+"end",a),this.triggered=!1}}};d.gestures.Transform={name:"transform",index:45,defaults:{transform_min_scale:0.01,transform_min_rotation:1,transform_always_block:!1},triggered:!1,handler:function(a,c){if(d.detection.current.name!=this.name&&this.triggered)return c.trigger(this.name+"end",a),this.triggered=!1,b;if(!(2>a.touches.length))switch(c.options.transform_always_block&&
a.preventDefault(),a.eventType){case d.EVENT_START:this.triggered=!1;break;case d.EVENT_MOVE:var e=Math.abs(1-a.scale),f=Math.abs(a.rotation);if(c.options.transform_min_scale>e&&c.options.transform_min_rotation>f)break;d.detection.current.name=this.name;this.triggered||(c.trigger(this.name+"start",a),this.triggered=!0);c.trigger(this.name,a);f>c.options.transform_min_rotation&&c.trigger("rotate",a);e>c.options.transform_min_scale&&(c.trigger("pinch",a),c.trigger("pinch"+(1>a.scale?"in":"out"),a));
break;case d.EVENT_END:this.triggered&&c.trigger(this.name+"end",a),this.triggered=!1}}};d.gestures.Touch={name:"touch",index:-1/0,defaults:{prevent_default:!1,prevent_mouseevents:!1},handler:function(a,c){return c.options.prevent_mouseevents&&a.pointerType==d.POINTER_MOUSE?(a.stopDetect(),b):(c.options.prevent_default&&a.preventDefault(),a.eventType==d.EVENT_START&&c.trigger(this.name,a),b)}};d.gestures.Release={name:"release",index:1/0,handler:function(a,b){a.eventType==d.EVENT_END&&b.trigger(this.name,
a)}};"object"==typeof module&&"object"==typeof module.exports?module.exports=d:(a.Hammer=d,"function"==typeof a.define&&a.define.amd&&a.define("hammer",[],function(){return d}))})(this);
(function(a,b){a!==b&&(Hammer.event.bindDom=function(c,d,e){a(c).on(d,function(a){var c=a.originalEvent||a;c.pageX===b&&(c.pageX=a.pageX,c.pageY=a.pageY);c.target||(c.target=a.target);c.which===b&&(c.which=c.button);c.preventDefault||(c.preventDefault=a.preventDefault);c.stopPropagation||(c.stopPropagation=a.stopPropagation);e.call(this,c)})},Hammer.Instance.prototype.on=function(b,d){return a(this.element).on(b,d)},Hammer.Instance.prototype.off=function(b,d){return a(this.element).off(b,d)},Hammer.Instance.prototype.trigger=
function(b,d){var e=a(this.element);return e.has(d.target).length&&(e=a(d.target)),e.trigger({type:b,gesture:d})},a.fn.hammer=function(b){return this.each(function(){var d=a(this),e=d.data("hammer");e?e&&b&&Hammer.utils.extend(e.options,b):d.data("hammer",new Hammer(this,b||{}))})})})(window.jQuery||window.Zepto);(function(a){var b=function(b,d,e,f,g){if(!(void 0==b||null==b)){g=a.extend({background:"green",cornersTop:!0,scale:"noresize"},g);b.prev();var h=0,j=!1,k=g.background,m=g.cornersTop,l=g.gradientColors||["#ddd","#eee","#fff"],n=g.scale,o=[],p,q,s;try{p=b.clone(),q=p[0].getContext("2d"),s=b[0].getContext("2d"),loaded=0}catch(v){s=q=p=null}var f=f.each(function(b){if(!(o[b]||null==s)){var c=this;c.onload=function(){var g=1;if("noresize"!=n){var h=0==this.width?this.naturalWidth:this.width,k=0==this.height?
this.naturalHeight:this.height,r=d/h,l=e/k;"fit"==n&&(g=1>r||1>l?Math.min(r,l):1);"fill"==n&&(g=Math.min(r,l))}a(c).data("flip.scale",g);o[b]=s.createPattern(c,"no-repeat");o[b].width=h;o[b].height=k;loaded++;loaded==f.length&&!j&&(j=!0,E())};c.complete&&window.setTimeout(function(){c.onload()},10)}}).get(),t=d,r=e,u=a.browser.msie?b.offset():null,w,B,x,y;a.browser.msie&&function(){var f=a("<div>").width(d).height(e).css({position:"absolute",cursor:"default",zIndex:1}).appendTo(tmpContainer);7==parseInt(a.browser.version)&&
f.css({opacity:1.0E-6,background:"#FFF"});var g=function(){u=b.offset();return f.css({left:u.left+"px",top:u.top+"px"})};a(window).resize(g);return g()}();setInterval(function(){window.clearInterval(w);B=(new Date).getTime();x=t;y=r/50;w=window.setInterval(C,0);h+=1;0>h&&(h=f.length-1);h==f.length&&(h=0)},3E3);var C=function(){var a=(new Date).getTime()-B;700<=a?(window.clearInterval(w),f.push(f.shift()),o.push(o.shift()),t=d,r=e):(t=x-2*d*a/700,r=y+2*e*a/700/3);E()},D=function(b,c){if(null!=s){var f=
b*d+c,g=-c/b;a.browser.msie&&(f=Math.round(f),g=Math.round(g));s.beginPath();s.moveTo(d,Math.min(f,e));s.lineTo(d,0);s.lineTo(Math.max(g,0),0);0>g?(s.lineTo(0,Math.min(c,e)),c<e&&s.lineTo((e-c)/b,e),s.lineTo(d,e)):f<e?s.lineTo(d,f):(s.lineTo((e-c)/b,e),s.lineTo(d,e))}},E=function(){if(j&&null!=s&&null!=q){a.browser.msie&&s.clearRect(0,0,d,e);s.fillStyle=k;s.fillRect(0,0,d,e);var b=f[0],c=a(b).data("flip.scale");if(a.browser.msie)try{s.drawImage(b,0,0,b.width,b.height,0,0,d,e)}catch(g){s.fillStyle=
o[0],s.fillStyle.width2=s.fillStyle.width*c,s.fillStyle.height2=s.fillStyle.height*c,s.fillRect(0,0,d,e)}else s.drawImage(b,(d-b.width*c)/2,(e-b.height*c)/2,b.width*c,b.height*c);if(r&&t!=d&&(b=(r-2*(t+d))/2,m2=r/(d-t),q2=t*m2,2!=m2)){var h=1,u=0;s.save();m||(u=e,h=-1);s.translate(0,u);s.scale(1,h);var n=(q2-b)/(2-m2),w=2*n+b,x=(2*w+n+4*t-2*r)/5,B=-x/2+w+n/2,c=Math.sqrt(Math.pow(n-x,2)+Math.pow(w-B,2)),y=Math.min(0.5*c,30),v;a.browser.mozilla&&1.9>parseFloat(a.browser.version)?(v=q,v.clearRect(0,
0,d,e),v.save(),v.translate(1,0)):v=s;n=v.createLinearGradient(n,w,x,B);n.addColorStop(0,l[0]);n.addColorStop(y/c,l[1]);n.addColorStop(1,l[2]);v.fillStyle=n;v.beginPath();v.moveTo(-b/2,0);v.quadraticCurveTo((-b/2+t)/2+0.02*t,r/2,t,r);v.quadraticCurveTo((d+t)/2,(2*d+b+r)/2-0.02*(e-r),d,2*d+b);a.browser.mozilla&&1.9>parseFloat(a.browser.version)?(v.save(),v.clip(),v.fillRect(0,0,d,e),v.restore(),s.drawImage(p[0],0,0),v.restore()):v.fill();s.fillStyle=k;D(2,b);s.fill();D(2,b);!a.browser.safari&&!a.browser.opera&&
s.restore();b=f[1];c=a(b).data("flip.scale");if(a.browser.msie)s.fillStyle=o[1],s.fillStyle.width2=s.fillStyle.width*c,s.fillStyle.height2=s.fillStyle.height*c,s.fill();else{s.save();s.clip();if(a.browser.safari||a.browser.opera)s.scale(1,1/h),s.translate(-0.0,-u);s.drawImage(b,(d-b.width*c)/2,(e-b.height*c)/2,b.width*c,b.height*c);s.restore();(a.browser.safari||a.browser.opera)&&s.restore()}}}}}};a.fn.jFlip=function(c,d,e,f,g){return this.each(function(){a(this).wrap("<div class='bannerdiv' style='position: absolute;width:"+
c+"px;height:"+d+"px;top:"+g+"px;left:"+f+"px'>");var h=a(this).find("img"),j=a(document.createElement("canvas")).attr({width:c,height:d}).css({margin:0,width:c+"px",height:d+"px"});a(this).css({position:"absolute",left:"-9000px",top:"-9000px",display:"none"}).after(j);new b(a(this).next(),c||300,d||300,h,e)})}})(jQuery);(function(){if(void 0==$.browser){var a=navigator.userAgent.toLowerCase();$.browser={};$.browser.mozilla=/firefox/.test(a);$.browser.webkit=/webkit/.test(a);$.browser.opera=/opera/.test(a)||/opr/.test(a);$.browser.chrome=/chrome/.test(a);$.browser.safari=/safari/.test(a);$.browser.msie=/msie/.test(a)||/trident/.test(a);$.browser.version=0;var b=a.match(/msie\s?\d+\.0/);null==b?(b=a.match(/trident\/\d+\.0/),null!=b&&0<b.length&&(a=parseInt(b[0].replace("trident/","")),$.browser.version=a+4)):(a=parseInt(b[0].replace("msie",
"")),$.browser.version=a)}if(void 0==$.browser.prefix&&($.browser.prefix="",!0==$.browser.webkit&&($.browser.prefix="-webkit-"),!0==$.browser.mozilla&&($.browser.prefix="-moz-"),!0==$.browser.msie))$.browser.prefix="-ms-"})();function Class(a){var b=function(){void 0!=this.create&&this.create.apply(this,arguments)};b.prototype=a||{};a=a.statics;if(void 0!=a){for(var c in a)void 0==b[c]&&(b[c]=a[c]);delete b.prototype.statics}return b}
Function.prototype.extend=function(a){if(void 0==a||null==a)return this;if(a instanceof Function){for(var b in a)void 0==this[b]&&(this[b]=a[b]);for(b in a.prototype)if(void 0==this.prototype[b])this.prototype[b]=a.prototype[b];else{var c=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.prototype[b]instanceof Function&&a.prototype[b]instanceof Function&&c.test(this.prototype[b])&&(this.prototype[b]=function(b,c){return function(){var f=this._super;this._super=a.prototype[b];var g=c.apply(this,arguments);
this._super=f;return g}}(b,this.prototype[b]))}return this}return this.extend(Class(a))};Function.prototype.expand=function(a){"object"===typeof a&&this.extend(Class(a))};
Function.expand({bind:function(a){var b=this;return function(){b.apply(a,arguments)}},asEvent:function(a){return function(b){this.call(a,b)}.bind(this)},delay:function(a,b,c){if(void 0==c||null==c)c=[];return window.setTimeout(function(){this.apply(a,c)}.bind(this),b)},interval:function(a,b,c){if(void 0==c||null==c)c=[];return window.setInterval(function(){this.apply(a,c)}.bind(this),b)}});
String.expand({trim:function(){return this.replace(/(^\s*)|(\s*$)/g,"")},replaceAll:function(a,b){for(var c=this.indexOf(a),d=this;-1!=c;)d=d.replace(a,b),c=d.indexOf(a);return d},html2Text:function(){return this.replaceAll("<[.[^<]]*>","")},isUrl:function(){return""==this?!1:this.match(/(http\:\/\/)?([\w.]+)(\/[\w-   \.\/\?%&=]*)?/gi)?!0:!1},isEmail:function(){return""==this?!1:this.match(/^([A-Za-z0-9])(\w)+@(\w)+(\.)(com|com\.cn|net|cn|net\.cn|org|biz|info|gov|gov\.cn|edu|edu\.cn)/)?!0:!1},toArray:function(){return 0==
arguments.length?this.split(""):this.split(arguments[0])},equals:function(a){return this.trim()==a.trim()},equalsIgnoreCase:function(a){return this.toLowerCase().trim()==a.toLowerCase().trim()},statics:{format:function(){if(0==arguments.length)return"";if(1==arguments.length)return arguments[0];for(var a=arguments[0],b=1;b<arguments.length;b++){var c=arguments[b];"string"==typeof c&&(a=a.replace("%s",c));!isNaN(c)&&(a=a.replace("%d",c+""));var d=c,d=d+"";!isNaN(d)&&0<d.indexOf(".")&&(a=a.replace("%f",
c+""))}return a}}});Array.expand({remove:function(a){return isNaN(a)||a>this.length?!1:this.splice(a,1)[0]}});
Date.expand({format:function(a,b){var c={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(a)&&(a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var d in c)RegExp("("+d+")").test(a)&&(a=!0===b?a.replace(RegExp.$1,c[d]):a.replace(RegExp.$1,1==RegExp.$1.length?c[d]:("00"+c[d]).substr((""+c[d]).length)));return a}});
var Log=Class({statics:{isDebug:function(){return/debug=true/.test(window.location.href)},isPAD:function(){return 0<navigator.userAgent.toLowerCase().indexOf("pad")},logForPad:function(a,b){if(this.isPAD()){void 0==this.logDiv&&(this.logDiv=$("<div></div>"),this.logDiv.css({position:"absolute",width:"300px",height:"150px",overflow:"auto","z-index":"100000","background-color":"white"}),$("body")[0]&&$("body")[0].appendChild(this.logDiv[0]));var c=$("<p>"+a+"</p>");c.css("color",b);this.logDiv.append(c);
c=this.logDiv[0];c.scrollTop=c.scrollHeight}},info:function(){this.isDebug()&&($.browser&&$.browser.msie&&(arguments=[String.format.apply(this,arguments)]),console&&console.log&&console.log.apply(console,arguments),this.logForPad(String.format.apply(this,arguments),"black"))},debug:function(){this.isDebug()&&($.browser&&$.browser.msie&&(arguments=[String.format.apply(this,arguments)]),console&&console.debug&&console.debug.apply(console,arguments),this.logForPad(String.format.apply(this,arguments),
"blue"))},warn:function(){this.isDebug()&&($.browser&&$.browser.msie&&(arguments=[String.format.apply(this,arguments)]),console&&console.warn&&console.warn.apply(console,arguments),this.logForPad(String.format.apply(this,arguments),"#FFA042"))},error:function(){this.isDebug()&&($.browser&&$.browser.msie&&(arguments=[String.format.apply(this,arguments)]),console&&console.error&&console.error.apply(console,arguments),this.logForPad(String.format.apply(this,arguments),"red"))}}});
colorTo0x=function(a){var b=a;if(null==a||void 0==a)return b;"#"!=a.substr(0,1)&&"0x"!=a.substr(0,2)&&(b=parseInt(a).toString(16),b="#"+"000000".substr(0,6-b.length)+b);"0x"==a.substr(0,2)&&(b=a.replace("0x","#"));return b};var Point=function(a,b){return{x:a,y:b}};function debug(a){!1!=/debug=true/.test(window.location.href)&&console&&console.log&&console.log(a)}
function colorSplit(a){var b={r:0,g:0,b:0},c="FF",d="FF",e="FF";7==a.length?(c=a.substr(1,2),d=a.substr(3,2),e=a.substr(5,2)):4==a.length&&(c=a.substr(1,1),d=a.substr(2,1),e=a.substr(3,1),c+=c,d+=d,e+=e);b.r=parseInt(c,16);b.g=parseInt(d,16);b.b=parseInt(e,16);return b}
function colorAdd(a,b){var c=colorSplit(a);c.r=Math.min(c.r+b,255).toString(16);c.g=Math.min(c.g+b,255).toString(16);c.b=Math.min(c.b+b,255).toString(16);c.r=1>=c.r.length?"0"+c.r:c.r;c.g=1>=c.g.length?"0"+c.g:c.g;c.b=1>=c.b.length?"0"+c.b:c.b;return"#"+c.r+c.g+c.b}
function colorDiv(a,b){var c=colorSplit(a);c.r=Math.max(c.r-b,0).toString(16);c.g=Math.max(c.g-b,0).toString(16);c.b=Math.max(c.b-b,0).toString(16);c.r=1>=c.r.length?"0"+c.r:c.r;c.g=1>=c.g.length?"0"+c.g:c.g;c.b=1>=c.b.length?"0"+c.b:c.b;return"#"+c.r+c.g+c.b}
$.fn.setGradient=function(a,b){var c=colorAdd(a,15),d=colorDiv(a,15);void 0==b&&(b=!1);var e="",f="0";b&&(e="left,",f="1");this.css({background:"linear-gradient("+e+c+", "+d+")"});switch(browserType){case 1:this.css({background:"-webkit-linear-gradient("+e+c+", "+d+")"});break;case 2:this.css({background:"-moz-linear-gradient("+e+c+", "+d+")"});break;case 3:this.css({background:"-ms-linear-gradient("+e+c+", "+d+")"});this.css("filter","progid:DXImageTransform.Microsoft.Gradient(GradientType="+f+", EndColorStr="+
d+", StartColorStr="+c+")");break;case 4:this.css({background:"-o-linear-gradient("+e+c+", "+d+")"})}};
$.fn.setGradientByDir=function(a,b,c){void 0==c&&(c=!1);var d="",e="0";c&&(d="left,",e="1");this.css({background:"linear-gradient("+d+a+", "+b+")"});switch(browserType){case 1:this.css({background:"-webkit-linear-gradient("+d+a+", "+b+")"});break;case 2:this.css({background:"-moz-linear-gradient("+d+a+", "+b+")"});break;case 3:this.css({background:"-ms-linear-gradient("+d+a+", "+b+")"});this.css("filter","progid:DXImageTransform.Microsoft.Gradient(GradientType="+e+", EndColorStr="+b+", StartColorStr="+
a+")");break;case 4:this.css({background:"-o-linear-gradient("+d+a+", "+b+")"})}};$.fn.addBorderShadow=function(a,b,c){var d=b+"px",e=c+"px",b=2*(Math.abs(b)+Math.abs(c))+"px";this.css({"-moz-box-shadow":d+" "+e+" "+b+" "+a,"box-shadow":d+" "+e+" "+b+" "+a,"-webkit-box-shadow":d+" "+e+" "+b+" "+a,"-o-box-shadow":d+" "+e+" "+b+" "+a,"-ms-box-shadow":d+" "+e+" "+b+" "+a})};
var reflection=function(a){var b=new Image,c=document.createElement("canvas"),d=c.getContext("2d");a[0].appendChild(c);b.onload=function(){b.onload=b.onerror=null;var a=this.width,f=this.height,g=0.7*f;try{c.style.width=a+"px";c.style.height=g+"px";c.width=a;c.height=g;c.className="reflect";$(c).css({transform:"translateY(-1px)"});d.save();d.translate(0,f);d.scale(1,-1);d.drawImage(b,0,0,a,f);d.restore();d.globalCompositeOperation="destination-out";var h=d.createLinearGradient(0,0,0,g);h.addColorStop(1,
"rgba(255, 0, 0, 1.0)");h.addColorStop(0,"rgba(255, 0, 0, 0)");d.fillStyle=h;d.rect(0,0,a,2*g);d.fill()}catch(j){}};b.onerror=function(){b.onload=b.onerror=null};b.src=a.children("img")[0].src},getHost=function(a){var b="null";if("undefined"==typeof a||null==a)a=window.location.href;a=a.match(/.*\:\/\/([^\/]*).*/);"undefined"!=typeof a&&null!=a&&(b=a[1]);return b};
$.fn.changeButtonColor=function(a,b,c){var d=this;void 0==b&&(b=!1);if("none"!=this.css("display")){var e=this;0<this.children().length&&(e=this.find("img:first"));if(void 0!=e[0]){var f,g;try{f=$("<canvas></canvas>")[0],g=f.getContext("2d")}catch(h){return}var j=e.width(),k=e.height(),e=e[0],m=getHost(e.src),l=getHost();if(l!==m)f=e.src.replace(m,l),!1===b&&$(e).load(function(){try{d.changeButtonColor(a,!0,c)}catch(b){}}),e.src=f;else{f.width=j;f.height=k;try{g.drawImage(e,0,0,e.naturalWidth,e.naturalHeight,
0,0,j,k);var n=g.getImageData(0,0,j,k),o=g.getImageData(0,0,j,k);if(!0!=e.colorChanged&&(e.colorChanged=!0,n)){for(var p=colorSplit(a),j=0,q=n.data.length;j<q;j+=4)0<o.data[j+3]&&(n.data[j]!=p.r&&(o.data[j]=n.data[j]/255*p.r),n.data[j+1]!=p.g&&(o.data[j+1]=n.data[j+1]/255*p.g),n.data[j+2]!=p.b&&(o.data[j+2]=n.data[j+2]/255*p.b));g.putImageData(o,0,0);e.src=f.toDataURL("image/png");void 0!=c&&c(d)}}catch(s){!1===b&&$(e).load(function(){try{d.changeButtonColor(a,!0,c)}catch(b){}})}}}}};
$.fn.rotate=function(a){if(!(4<browserType&&1>browserType)){switch(browserType){case 1:this.css({"-webkit-transform":"rotate("+a+"deg)"});break;case 2:this.css({"-moz-transform":"rotate("+a+"deg)"});break;case 3:this.css({"-ms-transform":"rotate("+a+"deg)"});break;case 4:this.css({"-o-transform":"rotate("+a+"deg)"})}this.css({transform:"rotate("+a+"deg)"})}};
$.fn.scale=function(a){this.css({"-webkit-transform":"scale("+a+")","-moz-transform":"scale("+a+")","-ms-transform":"scale("+a+")","-o-transform":"scale("+a+")",transform:"scale("+a+")"})};$.fn.transition3D=function(){this.css({"-ms-transform":"translate3d(0,0,0)","-webkit-transform":"translate3d(0,0,0)","-moz-transform":"translate3d(0,0,0)","-o-transform":"translate3d(0,0,0)",transform:"translate3d(0,0,0)"});return this};
$.fn.speed=function(a){function b(a){a=void 0==a.originalEvent.touches?[a]:a.originalEvent.touches;if(1<a.length)return l=!0;e=g=a[0].pageX;f=h=a[0].pageY;j=Date.now();-1!=m&&window.clearInterval(m);m=window.setInterval(function(){e=g;f=h;j=Date.now()},300)}function c(a){if(-1==m||!0==l)return!0;a=void 0==a.originalEvent.touches?[a]:a.originalEvent.touches;g=a[0].pageX;h=a[0].pageY}function d(b){if(-1==m)return!0;b=!1==(void 0!=b.originalEvent.touches)?[b]:b.originalEvent.touches;if(!0==l)return l=
1<b.length,!0;k=Date.now();var b=(k-j)/20,c=g-e,d=h-f;0==b?iSpeedY=iSpeedX=0:(iSpeedX=c/b,iSpeedY=d/b);0<Math.abs(iSpeedX)&&0<Math.abs(iSpeedY)&&void 0!=a&&a(iSpeedX,iSpeedY);window.clearInterval(m);m=-1}var e,f,g,h,j,k,m=-1,l=!1;try{this.bind("mousedown",b),this.bind("mousemove",c),this.bind("mouseup",d)}catch(n){}try{this.bind("touchstart",b),this.bind("touchmove",c),this.bind("touchend",d)}catch(o){}};
Array.indexOf||(Array.prototype.indexOf=function(a){for(var b=0;b<this.length;b++)if(this[b]==a)return b;return-1});
(function(){var a={supportsFullScreen:false,isFullScreen:function(){return false},requestFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"-",prefix:""},b=["webkit","moz","o","ms"];if(typeof document.exitFullscreen!="undefined")a.supportsFullScreen=true;else if(typeof document.cancelFullScreen!="undefined")a.supportsFullScreen=true;else for(var c=0,d=b.length;c<d;c++){a.prefix=b[c];if(typeof document[a.prefix+"CancelFullScreen"]!="undefined"){a.supportsFullScreen=true;break}}if(a.supportsFullScreen){a.fullScreenEventName=
a.prefix+"fullscreenchange";a.isFullScreen=function(){switch(this.prefix){case "":return document.fullScreen;case "webkit":return document.webkitIsFullScreen;default:return document[this.prefix+"FullScreen"]}};a.requestFullScreen=function(a){return this.prefix===""?a.requestFullScreen():a[this.prefix+"RequestFullScreen"]()};a.cancelFullScreen=function(){return this.prefix===""?document.cancelFullScreen():document[this.prefix+"CancelFullScreen"]()}}window.fullScreenApi=a})();
function EnString(a,b){if(a=="")return"";a=escape(a);if(!b||b=="")b="fb5";b=escape(b);if(b==null||b.length<=0){alert("Please enter a password with which to encrypt the message.");return null}for(var c="",d=0;d<b.length;d++)c=c+b.charCodeAt(d).toString();var d=Math.floor(c.length/5),e=parseInt(c.charAt(d)+c.charAt(d*2)+c.charAt(d*3)+c.charAt(d*4)+c.charAt(d*5)),f=Math.ceil(b.length/2),g=Math.pow(2,31)-1;if(e<2){alert("Algorithm cannot find a suitable hash. Please choose a different password. \nPossible considerations are to choose a more complex or longer password.");
return null}for(var h=Math.round(Math.random()*1E9)%1E8,c=c+h;c.length>10;)c=(parseInt(c.substring(0,10))+parseInt(c.substring(10,c.length))).toString();for(var c=(e*c+f)%g,j="",k="",d=0;d<a.length;d++){j=parseInt(a.charCodeAt(d)^Math.floor(c/g*255));k=j<16?k+("0"+j.toString(16)):k+j.toString(16);c=(e*c+f)%g}for(h=h.toString(16);h.length<8;)h="0"+h;return k+h}
function DeString(a,b){if(a=="")return"";if(!b||b=="")b="fb5";b=escape(b);if(a==null||a.length<8)alert("A salt value could not be extracted from the encrypted message because it's length is too short. The message cannot be decrypted.");else if(b==null||b.length<=0)alert("Please enter a password with which to decrypt the message.");else{for(var c="",d=0;d<b.length;d++)c=c+b.charCodeAt(d).toString();for(var e=Math.floor(c.length/5),e=parseInt(c.charAt(e)+c.charAt(e*2)+c.charAt(e*3)+c.charAt(e*4)+c.charAt(e*
5)),f=Math.round(b.length/2),g=Math.pow(2,31)-1,d=parseInt(a.substring(a.length-8,a.length),16),a=a.substring(0,a.length-8),c=c+d;c.length>10;)c=(parseInt(c.substring(0,10))+parseInt(c.substring(10,c.length))).toString();for(var c=(e*c+f)%g,h="",j="",d=0;d<a.length;d=d+2){h=parseInt(parseInt(a.substring(d,d+2),16)^Math.floor(c/g*255));j=j+String.fromCharCode(h);c=(e*c+f)%g}return unescape(j)}}
var divHint=Class({create:function(a,b,c,d){this.instance=$("<div class='hint'></div>");this.setText(a);d==void 0&&(d=bookContainer);d.append(this.instance);this.instance.css({display:"none",opacity:0});this.moveto(b,c);this.animation=false},setAnimate:function(a){this.animation=a;a==true&&this.instance.css({"-moz-transition":"all 0.2s ease-in-out","-webkit-transition":"all 0.2s ease-in-out","-o-transition":"all 0.2s ease-in-out","-ms-transition":"all 0.2s ease-in-out",transition:"all 0.2s ease-in-out"})},
setText:function(a){this.instance[0].innerText=a},moveto:function(a,b){this.instance.css({left:a,top:b})},show:function(){this.instance.css({display:"block",opacity:1})},hide:function(){this.animation==true?this.instance.css({display:"none",opacity:0}):this.instance.css({display:"none",opacity:1})},destroy:function(){this.hide();this.instance.empty();this.instance.remove()},width:function(){return this.instance.width()+this.padding()*3},height:function(){return this.instance.height()+this.padding()*
3},padding:function(){var a=this.instance.css("padding");if(a==void 0||a==null||a=="")return 0;return iPadding=parseInt(a.replace("px",""))}});function loadJavascript(a,b,c){var d=this,e=document.createElement("script");e.type="text/javascript";e.async=true;e.onload=e.onreadystatechange=function(){if(!d.readyState||d.readyState=="loaded"||d.readyState=="complete"){e.onload=e.onreadystatechange=null;b!=void 0&&b()}};e.onerror=function(){c!=void 0&&c()};$("body")[0].appendChild(e);e.src=a}
function addProgressBar(a,b,c){if(a!=void 0&&a!=null&&(a.progressBar==void 0||a.progressBar==null)){var d=$("<div></div>"),e=$("<div></div>"),b=b==void 0||b==null?$(a).outerWidth():b,c=c==void 0||c==null?$(a).outerHeight():c,f=$("<img src='"+uiBaseURL+"progress.gif' style='position:absolute;' />");e.css({background:"#000000",opacity:"0.3",width:b+"px",height:c+"px","z-index":"0"});d.css({width:b+"px",height:c+"px","z-index":"100"});f.css({left:(b-31)/2+"px",top:(c-31)/2+"px","z-index":"1"});d.append($(e));
d.append($(f));a.append($(d));a.progressBar=d}}function clearProgressBar(a){a.progressBar!=void 0&&a.progressBar!=null&&a.progressBar.remove()};var VERSION_NAME="2.1.8",BUILD_DATE="20140410",BookType={normal_book:0,single_book:1,zoom_book:2,slide_book:3,phone_book:4,singlePhone_book:5,singleSlide_book:6,catalog_book:7,singleCatalog_book:8},normalBookStatu={book_statu_ready:0,book_statu_auto_flip:1,book_statu_mouse_flip:2,book_statu_mag_flip:3},singleBookStatu={book_statu_ready:0,book_statu_auto_flip:1,book_statu_mouse_flip:2,book_statu_mag_flip:3},bookCorner={top_left:0,top_right:1,bottom_left:2,bottom_right:3},BrowserType={WEBKIT:1,OPERA:1,
MOZ:2,MS:3},PageEditor={AnnoType:{ANNO_LINK:"com.mobiano.flipbook.pageeditor.TAnnoLink",ANNO_YOUTUBE:"com.mobiano.flipbook.pageeditor.TAnnoYouTube",ANNO_YOUTUBE1:"com.mobiano.flipbook.pageeditor::TAnnoYoutubePlayer",ANNO_YOUTUBE2:"com.mobiano.flipbook.pageeditor.player::TAnnoYoutubePlayer02",ANNO_YOUTUBE3:"com.mobiano.flipbook.pageeditor.player::TAnnoYoutubePlayer03",ANNO_YOUTUBE4:"com.mobiano.flipbook.pageeditor.player::TAnnoYoutubePlayer04",ANNO_VIDEO1:"com.mobiano.flipbook.pageeditor::TAnnoVideoPlayer",
ANNO_VIDEO2:"com.mobiano.flipbook.pageeditor.player::TAnnoSimpleVideoPlayer",ANNO_AUDIO1:"com.mobiano.flipbook.pageeditor::TAnnoAdvancedSound",ANNO_AUDIO2:"com.mobiano.flipbook.pageeditor::TAnnoWavemusicPlayer",ANNO_AUDIO3:"com.mobiano.flipbook.pageeditor::TAnnoPlugIn",ANNO_AUDIO4:"",ANNO_AUDIO5:"",ANNO_AUDIO6:"",ANNO_AUDIO7:"",ANNO_AUDIO8:"",ANNO_AUDIO9:"",ANNO_VIMEO:"com.mobiano.flipbook.pageeditor.vimeoPlayer::TAnnoVimeoPlayer",ANNO_VIMEO2:"com.mobiano.flipbook.pageeditor.vimeoPlayer::TAnnoVimeoPopUpPlayer",
ANNO_VIDEO:"com.mobiano.flipbook.pageeditor.TAnnoMovie",ANNO_AUDIO:"com.mobiano.flipbook.pageeditor.TAnnoSound",ANNO_IMAGE:"com.mobiano.flipbook.pageeditor.TAnnoImage",ANNO_BUTTON:"com.mobiano.flipbook.pageeditor.TAnnoButton",ANNO_LINE:"com.mobiano.flipbook.pageeditor.shapes::TAnnoLine",ANNO_ARROW:"com.mobiano.flipbook.pageeditor.shapes::TAnnoArrow",ANNO_ROUND:"com.mobiano.flipbook.pageeditor.shapes::TAnnoEllipse",ANNO_RECTANGLE:"com.mobiano.flipbook.pageeditor.shapes::TAnnoRectangle",ANNO_TEXT:"com.mobiano.flipbook.pageeditor::TAnnoText",
ANNO_AREA:"com.mobiano.flipbook.pageeditor::TAnnoHighLightArea",ANNO_FLASHSHOW:"com.mobiano.flipbook.pageeditor.TAnnoSWF1",ANNO_ATEXT:"com.mobiano.flipbook.pageeditor::TAnnoDynamicText",ANNO_PRINT:"com.mobiano.flipbook.pageeditor::TAnnoPrint",ANNO_STARTEXT:"com.mobiano.flipbook.pageeditor::TAnnoStarwarsText",ANNO_TEXTANIM:"com.mobiano.flipbook.pageeditor.textAnim::TAnnoTextAnim",ANNO_ATIMAGE:"com.mobiano.flipbook.pageeditor.TAnnoClipart",ANNO_EFFECTTEXT:"com.mobiano.flipbook.pageeditor.TAnnoEffectText",
ANNO_CALLOUT:"com.mobiano.flipbook.pageeditor.shapes::TAnnoCallout",ANNO_ADVANCEDSOUND:"com.mobiano.flipbook.pageeditor::TAnnoAdvancedSound1",ANNO_ALPHATRANSITIONBANNER:"com.mobiano.flipbook.pageeditor.TAnnoAlphaTransitionBanner",ANNO_EMBEDDEDSLIDESHOW:"com.mobiano.flipbook.pageeditor.TAnnoEmbeddedSlideshow",ANNO_BANNER:"com.mobiano.flipbook.pageeditor::TAnnoBanner",ANNO_CAROUSEL:"com.mobiano.flipbook.pageeditor.TAnnoCarouselViewer",ANNO_DYNSHOW:"com.mobiano.flipbook.pageeditor::TAnnoDynamicShowPhoto",
ANNO_FLIPJUMP:"com.mobiano.flipbook.pageeditor.TAnnoDynamicTurnPhoto",ANNO_PLUGIN:"com.mobiano.flipbook.pageeditor::TAnnoPlugIn",ANNO_SWF:"com.mobiano.flipbook.pageeditor.TAnnoSWF"},PlayEvt:{EVT_PLAY:"EVT_PageViewed",EVT_STOP:"EVT_PageOffView"},TriggerEventType:{MouseDown:"mouseDown",MouseOver:"mouseOver",MouseOut:"mouseOut"},MouseOverType:{Zoom:"1",AddBorder:"2"},ActionType:{GOTO_PAGE:"com.mobiano.flipbook.pageeditor.TAnnoActionGotoPage",OPEN_URL:"com.mobiano.flipbook.pageeditor.TAnnoActionOpenURL",
OPEN_WINDOW:"com.mobiano.flipbook.pageeditor.TAnnoActionOpenWindow",SLIDE_SHOW:"com.mobiano.flipbook.pageeditor.TAnnoActionPhotoSlide",ACTION_JS:"com.mobiano.flipbook.pageeditor.TAnnoActionJavascript",PLAY_AUDIO:"com.mobiano.flipbook.pageeditor.TAnnoActionPlayAudio"}},bookEvent={onCurrentPageIndexChanged:"BE_PIC",onCurrentPageIndexWillChange:"BE_PIWC",onNoNextPage:"BE_NNP",onNoPreviousPage:"BE_NPP"},PLUGIN_ROTATE3D="AbPIRotationPhotoFor3D",PLUGIN_VIDEO1="VideoPlayerExemple01",PLUGIN_VIDEO2="VideoPlayerExemple02",
PLUGIN_CLASSAUDIO="",KEY_CODE_ENTER=13,KEY_CODE_LEFT=37,KEY_CODE_UP=38,KEY_CODE_RIGHT=39,KEY_CODE_DOWN=40,KEY_CODE_HOME=36,KEY_CODE_END=35,KEY_CODE_PAGEUP=33,KEY_CODE_PAGEDOWN=34,KEY_CODE_DELETE=46,KEY_CODE_F11=122,LOADING_WIDTH=30,LOADING_HEIGHT=30,COIL_PAGE_WIDTH=500,ICON_BACKGROUND=0,ICON_LAST=1,ICON_NEXT=2,ICON_PREV=3,ICON_FIRST=4,ICON_ZOOMIN=5,ICON_ZOOMOUT=6,ICON_AUTOPLAY=7,ICON_STOPAUTOPLAY=8,ICON_THUMB=9,ICON_SHARE=10,ICON_SEARCH=11,ICON_DOWNLOAD=12,ICON_HOME=13,ICON_BOOKMARK=14,ICON_SOUNDON=
15,ICON_SOUNDOFF=16,ICON_PREV_NORMAL=17,ICON_PREV_NORMAL_DOWN=18,ICON_NEXT_NORMAL=19,ICON_NEXT_NORMAL_DOWN=20,ICON_PRINT=21,ICON_HELP=22,ICON_ABOUT=23,ICON_MOREBAR=24,ICON_LANGUAGE=25,ICON_THUMB_DOWN=26,ICON_FULLSCREEN=27,ICON_EXIT_FULLSCREEN=28,ICON_MOVE_POSITION=29,ICON_MOVE_DRAG=30,ICON_ANNOTATION=31,ICON_TOC=32,isTouchDevice=function(){return Hammer.HAS_TOUCHEVENTS&&navigator.userAgent.match(Hammer.MOBILE_REGEX)},_event;
_event=isTouchDevice()?{_down:"touchstart",_move:"touchmove",_end:"touchend",_click:"touchend",_leave:"touchleave",_enter:"touchmove",_mousewheel:"mousewheel",_over:"touchover"}:{_down:"mousedown",_move:"mousemove",_end:"mouseup",_click:"click",_leave:"mouseleave",_enter:"mouseenter",_mousewheel:"mousewheel",_over:"mouseover"};function loadingBook(a,b){this.width=700;this.height=460;this.bg=$("<div></div>");this.loadingBox=$("<div></div>");this.bg.css({"background-color":"#1F2232",width:window.innerWidth+"px",height:window.innerHeight+"px"});isTouch&&(this.width=window.innerWidth,this.height=window.innerHeight);b||(b="#1F2232");this.loadingBox.css({width:this.width+"px",height:this.height+"px",position:"absolute",left:(window.innerWidth-this.width)/2+"px",top:(window.innerHeight-this.height)/2+"px","background-color":"#1F2232"});
var c=this;this.titleLabel=new label("",this.loadingBox);this.descriptionLabel=$("<div></div>");this.flipModel=$("<div></div>");this.padModel=$("<div></div>");this.loadingBox.append(this.titleLabel);this.loadingBox.append(this.descriptionLabel);this.loadingBox.append(this.flipModel);this.loadingBox.append(this.padModel);this.flipModel.append($("<img src='"+uiBaseURL+"pc.png'/>").asImageButton());this.padModel.append($("<img src='"+uiBaseURL+"pad.png'/>").asImageButton());this.flipModel.css({position:"absolute",
left:(this.width-500)/2+"px",top:(this.height-262)/2+70+"px"});this.padModel.css({position:"absolute",left:(this.width-500)/2+260+"px",top:(this.height-262)/2+70+"px"});this.titleLabel.setCSS({position:"absolute",height:"50px",width:c.width+"px",left:0,top:(this.height-262)/2-50+"px","line-height":"50px","text-align":"center","vertical-align":"middle",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis","font-size":"30px",color:"#ffffff"});this.descriptionLabel.css({position:"absolute",
height:"50px",width:this.width+"px",left:0,top:(this.height-262)/2+"px","line-height":"50px","text-align":"center","vertical-align":"middle","font-size":"20px",color:"#ffffff"});this.titleLabel.setCaption(window.document.title);$(this.loadingBox).css({"text-shadow":"0 0 10px #8c97cb, 0 0 20px #8c97cb,0 0 30px #8c97cb"});this.flipModel.bind(_event._enter,function(){c.flipModel.css({cursor:"pointer",border:"2px solid #ff8040"})});this.padModel.bind(_event._enter,function(){c.padModel.css({cursor:"pointer",
border:"2px solid #ff8040"})});this.flipModel.bind(_event._leave,function(){c.flipModel.css({cursor:"pointer",border:""})});this.padModel.bind(_event._leave,function(){c.padModel.css({cursor:"pointer",border:""})});a.append(this.bg);this.bg.append(this.loadingBox);this.showHide(!1)}
loadingBook.prototype.chooseFlipSlide=function(){var a=this;if(isPhoneBook()){this.showHide(!1);isFlipModel=!1;a.hide();bookType=windowWidth>windowHeight?4:5;toolBar=new loadToolBar(tmpContainer,iconArray);init();bgSound=new initBGSound;bookContainer.animate({opacity:1},1E3);toolBar.hide();QRbutton.css({display:"none"});var b=$("<img src='"+uiBaseURL+"toolbarshow.png'/>");tmpContainer.append($(b).asImageButton());$(b).css({width:"50px",height:"50px",bottom:"10px",right:"10px",position:"absolute",
"z-index":"300"});$(b).bind(_event._end,function(){toolBar.show();$(b).css({display:"none"});QRbutton.css({display:"block"})});bookContainer.bind(_event._down,function(){});$(singlePhoneBook.bookContainer).bind(_event._down,function(a){if(!(bookType!=BookType.singlePhone_book&&bookType!=BookType.phone_book)&&(a=isTouch?a.originalEvent.touches:[a],(bookType==BookType.slide_book||bookType==BookType.singleSlide_book||bookType==BookType.singlePhone_book||bookType==BookType.phone_book||bookType==BookType.singleCatalog_book||
bookType==BookType.catalog_book)&&!0==toolBar.visible&&30<a[0].pageX&&a[0].pageX<windowWidth-30&&30<a[0].pageY&&a[0].pageY<windowHeight-30&&1==a.length))$(b).css({display:"block"}),QRbutton.css({display:"none"}),toolBar.hide(),onStageResize()});$(phoneBook.bookContainer).bind(_event._down,function(a){if(!(bookType!=BookType.singlePhone_book&&bookType!=BookType.phone_book)&&(a=isTouch?a.originalEvent.touches:[a],(bookType==BookType.slide_book||bookType==BookType.singleSlide_book||bookType==BookType.singlePhone_book||
bookType==BookType.phone_book||bookType==BookType.singleCatalog_book||bookType==BookType.catalog_book)&&!0==toolBar.visible&&30<a[0].pageX&&a[0].pageX<windowWidth-30&&30<a[0].pageY&&a[0].pageY<windowHeight-30&&1==a.length))$(b).css({display:"block"}),QRbutton.css({display:"none"}),toolBar.hide(),onStageResize()});windowWidth>windowHeight?(bookType=4,changeShowBook(4)):(bookType=5,changeShowBook(5))}else if("flip"==bookConfig.FlipStyle.toLowerCase()&&!isBelowIE9())this.showHide(!1),isFlipModel=!0,
a.hide(),bookType=0,miniStyle=new isMiniStyle(tmpContainer),toolBar=new loadToolBar(tmpContainer,iconArray),toolBar.show(),init(),bgSound=new initBGSound,window.setTimeout(function(){bookContainer.animate({opacity:1},1E3);showFlipButton&&leftRightButton.show()},200);else if(("slide"==bookConfig.FlipStyle.toLowerCase()||isBelowIE9())&&"catalog"!=bookConfig.FlipStyle.toLowerCase())this.showHide(!1),isFlipModel=!1,a.hide(),bookType=!0==userConfig.showDoublePage?3:6,miniStyle=new isMiniStyle(tmpContainer),
toolBar=new loadToolBar(tmpContainer,iconArray),toolBar.hide(),init(),bgSound=new initBGSound,window.setTimeout(function(){bookContainer.animate({opacity:1},1E3);var a=$("<img src='"+uiBaseURL+"toolbarshow.png'/>");tmpContainer.append($(a).asImageButton());$(a).css({width:"50px",height:"50px",bottom:"10px",right:"10px",position:"absolute","z-index":"300"});$(a).bind(_event._end,function(){!1==toolBar.visible&&(toolBar.show(),onStageResize(),$(a).css({display:"none"}))});bookContainer.bind(_event._down,
function(){});bookContainer.bind(_event._end,function(){if((bookType==BookType.slide_book||bookType==BookType.singleSlide_book||bookType==BookType.singlePhone_book||bookType==BookType.phone_book)&&!0==toolBar.visible)toolBar.hide(),onStageResize(),$(a).css({display:"block"})});!0==userConfig.showDoublePage?(bookType=3,changeShowBook(3)):(bookType=6,changeShowBook(6))},200);else if("catalog"==bookConfig.FlipStyle.toLowerCase())this.showHide(!1),isFlipModel=!1,a.hide(),bookType=!0==userConfig.showDoublePage?
BookType.catalog_book:BookType.singleCatalog_book,miniStyle=new isMiniStyle(tmpContainer),toolBar=new loadToolBar(tmpContainer,iconArray),init(),bgSound=new initBGSound,window.setTimeout(function(){bookContainer.animate({opacity:1},1E3);!0==userConfig.showDoublePage?changeShowBook(BookType.catalog_book):changeShowBook(BookType.singleCatalog_book)},200);else{this.showHide(!0);this.flipModel.bind(_event._end,function(){isFlipModel=!0;a.hide();bookType=0;miniStyle=new isMiniStyle(tmpContainer);toolBar=
new loadToolBar(tmpContainer,iconArray);toolBar.show();init();bgSound=new initBGSound;window.setTimeout(function(){bookContainer.animate({opacity:1},1E3);showFlipButton&&leftRightButton.show()},200)});this.padModel.bind(_event._end,function(){isFlipModel=!1;a.hide();bookType=!0==userConfig.showDoublePage?3:6;miniStyle=new isMiniStyle(tmpContainer);toolBar=new loadToolBar(tmpContainer,iconArray);toolBar.hide();init();bgSound=new initBGSound;window.setTimeout(function(){bookContainer.animate({opacity:1},
1E3);var a=$("<img src='"+uiBaseURL+"toolbarshow.png'/>");tmpContainer.append($(a).asImageButton());$(a).css({width:"50px",height:"50px",bottom:"10px",right:"10px",position:"absolute","z-index":"300"});$(a).bind(_event._end,function(){!1==toolBar.visible&&(toolBar.show(),onStageResize(),$(a).css({display:"none"}))});bookContainer.bind(_event._down,function(){});bookContainer.bind(_event._end,function(){if((bookType==BookType.slide_book||bookType==BookType.singleSlide_book||bookType==BookType.singlePhone_book||
bookType==BookType.phone_book||bookType==BookType.singleCatalog_book||bookType==BookType.catalog_book)&&!0==toolBar.visible)toolBar.hide(),onStageResize(),$(a).css({display:"block"})});!0==userConfig.showDoublePage?changeShowBook(3):changeShowBook(6)},200)});var c=100,d=window.setInterval(function(){a.descriptionLabel.html("Select View Mode Please.("+c+")");c--;0>=c&&(window.clearInterval(d),window.setTimeout(function(){a.flipModel.trigger(_event._end)},20))},1E3)}};
loadingBook.prototype.onResize=function(){void 0!=this.loadingBox&&(this.bg.css({width:window.innerWidth+"px",height:window.innerHeight+"px"}),this.loadingBox.css({width:this.width+"px",height:this.height+"px",left:(window.innerWidth-this.width)/2+"px",top:(window.innerHeight-this.height)/2+"px"}))};loadingBook.prototype.showHide=function(a){a?this.loadingBox.css("display","block"):this.loadingBox.css("display","none")};loadingBook.prototype.hide=function(){this.bg.remove()};function loadXMLString(a){var b=null;if(!window.DOMParser&&window.ActiveXObject)for(var c=["MSXML.2.DOMDocument.6.0","MSXML.2.DOMDocument.3.0","Microsoft.XMLDOM"],d=0;d<c.length;d++)try{b=new ActiveXObject(c[d]);b.async=!1;b.loadXMLString(a);break}catch(e){}else if(window.DOMParser&&document.implementation&&document.implementation.createDocument)try{domParser=new DOMParser,b=domParser.parseFromString(a,"text/xml")}catch(f){}else return null;return b}
function loadXMLFile(a){var b=null;if(!window.DOMParser&&window.ActiveXObject)for(var c=["MSXML.2.DOMDocument.6.0","MSXML.2.DOMDocument.3.0","Microsoft.XMLDOM"],d=0;d<c.length;d++)try{b=new ActiveXObject(c[d]);break}catch(e){}else if(document.implementation&&document.implementation.createDocument)try{b=document.implementation.createDocument("","",null)}catch(f){}else return null;null!=b&&(b.async=!1,b.load(a));return b};function audioPlayer(a){this.audio=document.createElement("audio");tmpContainer.append(this.audio);this.audio.src=a;var b=this;this.audio.addEventListener("ended",function(){b.audio.currentTime=0},!1)}audioPlayer.prototype.play=function(){null!=this.audio&&this.audio.play()};audioPlayer.prototype.rePlay=function(){null!=this.audio&&(0!=this.audio.currentTime&&(this.audio.currentTime=this.audio.startTime),this.audio.play())};audioPlayer.prototype.preload=function(){this.audio.preload};
audioPlayer.prototype.loop=function(){this.audio.loop};audioPlayer.prototype.autoPlay=function(){this.audio.autoplay};audioPlayer.prototype.src=function(a){this.audio.src=a};audioPlayer.prototype.control=function(){this.audio.controls};function printBar(a){this.background=$("<div class='printBar'></div>");this.contentBack=$("<div class='printBack'></div>");this.contentBox=$("<div class='printBG'></div>");this.toolBox=$("<div class='printBox'></div>");this.checkBox=$("<div class='printBox'></div>");this.titleBox=$("<div class='printBox'></div>");this.printArea=$("<div></div>");this.printAll=$('<p><input type="radio" value="printAll" id="printAll" name="gender" checked=\'true\' onClick=\'setPrintValue("printAll")\'/><label for="printAll">'+
getLanguage("frmPrintall","Print All Pages")+"</label></p>");this.printCurrent=$('<p><input type="radio" value="printCurrent" id="printCurrent" name="gender" onClick=\'setPrintValue("printCurrent")\'/><label for="printCurrent">'+getLanguage("frmPrintcurrent","Print Current Page")+"</label></p>");var b='<p><input type="radio" value="printRange" id="printRange" name="gender" onClick=\'setPrintValue("printRange")\'/><label for="printRange">'+getLanguage("frmPrintRange","Print Range ")+"</label><input id='rangeNum' width='30px' style='width:100px;left:50px' type='text'/><label for=\"example\">"+
getLanguage("frmPrintexample","Example: 2,3,5-10")+"</label></p>";this.printRange=$(b);this.printSubmit=$('<p><button type="button" style="width:49px;height:28px;">'+getLanguage("frmPrintbtn","Print")+"</button></p>");this.printSubmit.css({position:"absolute",right:30,"margin-top":"5px"});setPrintValue("printAll");this.showing=!1;this.width=windowWidth;this.height=windowHeight;this.contentWidth=330;this.contentHeight=213;this.mainColor="#888888";this.background.css({height:this.height+"px",bottom:"0px"});
this.contentBox.css({height:this.contentHeight+"px",width:this.contentWidth+"px",left:(this.width-this.contentWidth)/2+"px"});this.contentBack.css({height:this.contentHeight+10+"px",width:this.contentWidth+10+"px",left:(this.width-this.contentWidth)/2-5+"px"});this.contentBack.css({opacity:0.5});this.toolBox.css({width:"330px",height:"31px",top:"0px",left:"0px",background:"#333333"});this.checkBox.css({width:"330px",height:"300px",top:"31px",left:"0px"});this.contentBox.css({top:(this.height-this.contentHeight)/
2+"px"});this.contentBack.css({top:(this.height-this.contentHeight)/2-5+"px"});$(this.background).css({"-webkit-box-shadow":"0 0 5px rgba(40, 40, 40, 0.5)","-moz-box-shadow":"0 0 5px rgba(40, 40, 40, 0.5)","-o-box-shadow":"0 0 5px rgba(40, 40, 40, 0.5)","-ms-box-shadow":"0 0 5px rgba(40, 40, 40, 0.5)","box-shadow":"0 0 5px rgba(40, 40, 40, 0.5)"});$(a).append(this.background);$(a).append(this.contentBack);$(a).append(this.contentBox);$(this.contentBox).append(this.toolBox);$(this.contentBox).append(this.checkBox);
$(this.checkBox).append(this.printAll);$(this.checkBox).append(this.printCurrent);$(this.checkBox).append(this.printRange);$(this.checkBox).append(this.printSubmit);this.contentBox.css({"text-shadow":"1px 1px #ffffff",background:"#dddddd"});this.closeButton=$("<div></div>");$(this.closeButton).css({top:"0px",right:"0px",position:"absolute"});$(this.closeButton).append($("<img src='"+uiBaseURL+"close.png'/>").asImageButton());this.titleBox.css({width:"300px",height:"20px",left:"15px",position:"absolute"});
this.titleBox.css({color:"#ffffff",top:"7px"});this.titleBox.css({"text-shadow":"1px 1px #000000","font-family":"verdana"});$(this.titleBox).html(getLanguage("frmPrintCaption","Print"));$(this.toolBox).append(this.closeButton);$(this.toolBox).append(this.titleBox);this.initEvent();this.background.css({display:"none"});this.contentBox.css({display:"none"});this.contentBack.css({display:"none"})}function setPrintValue(a){printValue=a}
printBar.prototype.onResize=function(){this.contentHeight=213;this.contentWidth=330;this.background.css({height:windowHeight+"px",bottom:"0px"});this.contentBox.css({height:this.contentHeight+"px",width:this.contentWidth+"px",left:(windowWidth-this.contentWidth)/2+"px"});this.contentBack.css({height:this.contentHeight+10+"px",width:this.contentWidth+10+"px",left:(windowWidth-this.contentWidth)/2-5+"px"});this.toolBox.css({width:"330px",height:"31px",top:"0px",left:"0px"});this.checkBox.css({width:"330px",
height:"300px",top:"31px",left:"0px"});this.contentBox.css({top:(windowHeight-this.contentHeight)/2+"px"});this.contentBack.css({top:(windowHeight-this.contentHeight)/2-5+"px"});this.closeButton.css({top:"0px",right:"0px"});this.printAll.css({"margin-left":"10px"});this.printCurrent.css({"margin-left":"10px"});this.printRange.css({"margin-left":"10px"});$("#rangeNum").css({width:"50px","margin-left":"10px","margin-right":"10px"});$("#rangeNum").css({"border-right":"1px solid "+colorAdd("#ffffff",
40)});$("#rangeNum").css({"border-bottom":"1px solid "+colorAdd("#ffffff",40)});$("#rangeNum").css({"border-left":"1px solid "+colorDiv("#aaaaaa",40)});$("#rangeNum").css({"border-top":"1px solid "+colorDiv("#aaaaaa",40)});this.printArea.css({top:-windowHeight+"px",left:"0px"})};printBar.prototype.setPosition=function(a,b,c){void 0==c&&(c=["left","top"]);$(this.background).css(c[0],a+"px");$(this.background).css(c[1],b+"px")};printBar.prototype.getShowStatu=function(){return this.showing};
printBar.prototype.setShowStatu=function(a){this.showing=a};printBar.prototype.showshow=function(){$(this.background).fadeIn(500);$(this.contentBox).fadeIn(500);$(this.contentBack).fadeIn(500);this.showing=!0};printBar.prototype.hideBox=function(){$(this.background).fadeOut(500);$(this.contentBox).fadeOut(500);$(this.contentBack).fadeOut(500);this.showing=!1};
printBar.prototype.initEvent=function(){var a=this;this.background.bind(_event._down,function(){a.hideBox();a.showing=!1});this.closeButton.bind("mouseover",function(){a.closeButton.css({cursor:"pointer"})});this.printSubmit.bind(_event._down,function(){addProgressBar(a.contentBox,a.contentWidth,a.contentHeight);switch(printValue){case "printAll":var b,c,d=0,e=0;a.printArea.empty();for(var f=1;f<=bookConfig.totalPageCount;f++){b=$("<div></div>");f!=bookConfig.totalPageCount&&b.css({"page-break-after":"always"});
b.css({position:"relative"});b.css({width:500,height:500});c=$("<img src = '"+bookConfig.largePath+f+".jpg'/>");c.css({"z-index":"200",left:0,top:0,position:"absolute"});b.append(c);if("Show"==bookConfig.PrintButtonVisible&&""!=bookConfig.printWatermarkFile){var g=$("<img src = '"+bookConfig.printWatermarkFile+"'/>");g.css({"z-index":"201",left:0,top:0,position:"absolute"});e++;g.load(function(){d++;d==bookConfig.totalPageCount+e&&(a.printArea.printArea(),clearProgressBar(a.contentBox))});b.append(g)}c.load(function(){d++;
d==bookConfig.totalPageCount+e&&(a.printArea.printArea(),clearProgressBar(a.contentBox))});a.printArea.append(b)}break;case "printCurrent":if(2==bookType)d=0,a.printArea.empty(),b=$("<div></div>"),b.css({position:"relative"}),b.css({width:500,height:500}),c=$("<img src = '"+bookConfig.largePath+zoomBook.currentIndex+".jpg'/>"),b.append(c),"Show"==bookConfig.PrintButtonVisible&&""!=bookConfig.printWatermarkFile&&(g=$("<img src = '"+bookConfig.printWatermarkFile+"'/>"),g.css({"z-index":"201",left:0,
top:0,position:"absolute"}),g.load(function(){d++;2==d&&(clearProgressBar(a.contentBox),a.printArea.printArea())}),b.append(g)),c.load(function(){d++;if(d==2){clearProgressBar(a.contentBox);a.printArea.printArea()}}),a.printArea.append(b);else if(3==bookType)d=0,a.printArea.empty(),b=$("<div></div>"),b.css({position:"relative"}),b.css({width:500,height:500}),c=$("<img src = '"+bookConfig.largePath+slideBook.currentIndex+".jpg'/>"),b.append(c),"Show"==bookConfig.PrintButtonVisible&&""!=bookConfig.printWatermarkFile&&
(g=$("<img src = '"+bookConfig.printWatermarkFile+"'/>"),g.css({"z-index":"201",left:0,top:0,position:"absolute"}),g.load(function(){d++;2==d&&(clearProgressBar(a.contentBox),a.printArea.printArea())}),b.append(g)),c.load(function(){d++;if(d==2){clearProgressBar(a.contentBox);a.printArea.printArea()}}),a.printArea.append(b);else if(1==bookType)d=0,a.printArea.empty(),b=$("<div></div>"),b.css({position:"relative"}),b.css({width:500,height:500}),c=$("<img src = '"+bookConfig.largePath+$(singlePageBook).data().currentPageIndex+
".jpg'/>"),b.append(c),"Show"==bookConfig.PrintButtonVisible&&""!=bookConfig.printWatermarkFile&&(g=$("<img src = '"+bookConfig.printWatermarkFile+"'/>"),g.css({"z-index":"201",left:0,top:0,position:"absolute"}),g.load(function(){d++;2==d&&(clearProgressBar(a.contentBox),a.printArea.printArea())}),b.append(g)),c.load(function(){d++;if(d==2){clearProgressBar(a.contentBox);a.printArea.printArea()}}),a.printArea.append(b);else if(0==bookType){var h=d=0,e=0;a.printArea.empty();h=1==flipBook.currentPageIndex||
flipBook.currentPageIndex==bookConfig.totalPageCount?0:1;for(f=0;f<=h;f++)b=$("<div></div>"),f!=h&&b.css({"page-break-after":"always"}),b.css({position:"relative"}),b.css({width:500,height:500}),g=2*parseInt(flipBook.currentPageIndex/2)+f,1==flipBook.currentPageIndex&&(g=1),c=$("<img src = '"+bookConfig.largePath+g+".jpg'/>"),c.css({"z-index":"200",left:0,top:0,position:"absolute"}),b.append(c),"Show"==bookConfig.PrintButtonVisible&&""!=bookConfig.printWatermarkFile&&(g=$("<img src = '"+bookConfig.printWatermarkFile+
"'/>"),g.css({"z-index":"201",left:0,top:0,position:"absolute"}),e++,g.load(function(){d++;d==h+e+1&&(clearProgressBar(a.contentBox),a.printArea.printArea())}),b.append(g)),c.load(function(){d++;if(d==h+e+1){clearProgressBar(a.contentBox);a.printArea.printArea()}}),a.printArea.append(b)}break;case "printRange":b=$("#rangeNum").val().split(",");c=[];e=h=f=0;c=[];a.printArea.empty();for(f=0;f<b.length;f++)if(isNaN(b[f])){g=b[f].split("-");for(d=parseInt(g[0]);d<=parseInt(g[1]);d++)c.push("<img src = '"+
bookConfig.largePath+d+".jpg'/>")}else c.push("<img src = '"+bookConfig.largePath+b[f]+".jpg'/>");for(f=0;f<c.length;f++)b=$("<div></div>"),f!=c.length-1&&b.css({"page-break-after":"always"}),b.css({position:"relative"}),b.css({width:500,height:500}),$(c[f]).css({"z-index":"200",left:0,top:0,position:"absolute"}),b.append($(c[f])),"Show"==bookConfig.PrintButtonVisible&&""!=bookConfig.printWatermarkFile&&(g=$("<img src = '"+bookConfig.printWatermarkFile+"'/>"),g.css({"z-index":"201",left:0,top:0,position:"absolute"}),
e++,g.load(function(){h++;h==c.length+e&&(clearProgressBar(a.contentBox),a.printArea.printArea())}),b.append(g)),$(c[f]).load(function(){h++;if(h==c.length+e){clearProgressBar(a.contentBox);a.printArea.printArea()}}),a.printArea.append(b)}});this.closeButton.bind(_event._end,function(){a.hideBox();a.showing=!1})};function helpBar(a){this.background=$("<div class='printBar'></div>");this.contentBack=$("<div class='printBack'></div>");this.contentBox=$("<div class='printBG'></div>");this.toolBox=$("<div class='printBox'></div>");this.checkBox=$("<div class='printBox'></div>");this.titleBox=$("<div class='printBox'></div>");this.showing=!1;this.width=windowWidth;this.height=windowHeight;this.contentWidth=bookConfig.helpWidth;this.contentHeight=bookConfig.helpHeight;""==userConfig.helpContentFileURL&&(this.contentWidth=
300,this.contentHeight=200);this.mainColor="#888888";this.background.css({height:this.height+"px",bottom:"0px"});this.contentBox.css({height:this.contentHeight+"px",width:this.contentWidth+"px",left:(this.width-this.contentWidth)/2+"px"});this.contentBack.css({height:this.contentHeight+10+"px",width:this.contentWidth+10+"px",left:(this.width-this.contentWidth)/2-5+"px"});this.contentBack.css({opacity:0.5});this.toolBox.css({width:this.contentWidth+"px",height:"31px",top:"0px",left:"0px",background:"#333333"});
this.checkBox.css({width:this.contentWidth+"px",height:this.contentHeight-31+"px",top:"31px",left:"0px"});this.contentBox.css({top:(this.height-this.contentHeight)/2+"px"});this.contentBack.css({top:(this.height-this.contentHeight)/2-5+"px"});$(a).append(this.background);$(a).append(this.contentBack);$(a).append(this.contentBox);$(this.contentBox).append(this.toolBox);$(this.contentBox).append(this.checkBox);this.contentBox.css({"text-shadow":"1px 1px #ffffff",background:"#dddddd"});this.closeButton=
$("<div></div>");this.closeButton.css({top:"0px",right:"0px",position:"absolute"});this.titleBox.css({width:"20px",height:"20px",left:"15px",position:"absolute"});this.titleBox.css({color:"#ffffff",top:"7px"});this.titleBox.css({"text-shadow":"1px 1px #000000","font-family":"verdana"});this.closeButton.append($("<img src='"+uiBaseURL+"close.png'/>").asImageButton());$(this.toolBox).append(this.closeButton);$(this.toolBox).append(this.titleBox);$(this.titleBox).html("Help");this.fillImage();this.initEvent();
if(!userConfig.showHelpContentAtFirst||!userConfig.helpButtonVisible)this.background.css({display:"none"}),this.contentBox.css({display:"none"}),this.contentBack.css({display:"none"})}
helpBar.prototype.onResize=function(){this.contentWidth=bookConfig.helpWidth;this.contentHeight=bookConfig.helpHeight;""==userConfig.helpContentFileURL&&(this.contentWidth=300,this.contentHeight=200);this.background.css({height:windowHeight+"px",bottom:"0px"});this.contentBox.css({height:this.contentHeight+"px",width:this.contentWidth+"px",left:(windowWidth-this.contentWidth)/2+"px"});this.contentBack.css({height:this.contentHeight+10+"px",width:this.contentWidth+10+"px",left:(windowWidth-this.contentWidth)/
2-5+"px"});this.toolBox.css({width:this.contentWidth+"px",height:"31px",top:"0px",left:"0px",background:"#333333"});this.checkBox.css({width:this.contentWidth+"px",height:this.contentHeight-31+"px",top:"31px",left:"0px"});this.contentBox.css({top:(windowHeight-this.contentHeight)/2+"px"});this.contentBack.css({top:(windowHeight-this.contentHeight)/2-5+"px"});this.closeButton.css({top:"0px",right:"0px"})};
helpBar.prototype.setPosition=function(a,b,c){void 0==c&&(c=["left","top"]);$(this.background).css(c[0],a+"px");$(this.background).css(c[1],b+"px")};helpBar.prototype.getShowStatu=function(){return this.showing};helpBar.prototype.setShowStatu=function(a){this.showing=a};helpBar.prototype.showshow=function(){$(this.background).fadeIn(500);$(this.contentBox).fadeIn(500);$(this.contentBack).fadeIn(500);this.showing=!0};
helpBar.prototype.hideBox=function(){$(this.background).fadeOut(500);$(this.contentBox).fadeOut(500);$(this.contentBack).fadeOut(500);this.showing=!1};helpBar.prototype.initEvent=function(){var a=this;this.background.bind(_event._down,function(){a.hideBox();a.showing=!1});this.closeButton.bind(_event._end,function(){a.hideBox();a.showing=!1});this.closeButton.bind("mouseover",function(){a.closeButton.css({cursor:"pointer"})})};
helpBar.prototype.fillImage=function(){var a;""!=userConfig.helpContentFileURL?a=$("<img src='"+userConfig.helpContentFileURL+"'/>"):(a=$("<div></div>"),a.append($("<p><div><li>Drag the page corner to view</li></div></p>")),a.append($("<p><div><li>Double click to zoom in, out</li></div></p>")),a.css({"margin-left":"15px","text-shadow":"0px 1px #ffffff","font-weight":"bold","font-size":"13px","font-family":"verdana",left:"20px"}));this.checkBox.append(a)};function sharePanel(a){this.background=$("<div class='printBar' id='background'></div>");this.contentBack=$("<div class='printBack' id='contentBack'></div>");this.contentBox=$("<div class='printBG' id='contentBox'></div>");this.toolBox=$("<div class='printBox' id='toolBox'></div>");this.checkBox=$("<div class='printBox' id='checkBox'></div>");this.titleBox=$("<div class='printBox'></div>");this.shareUrl=$("<div class='printBox' id='shareUrl'></div>");this.shareCheck=$("<div class='printBox' id='shareCheck'></div>");
this.shareCopy=$("<div class='printBox' id='shareCopy'></div>");this.shareUrlInput=$("<div class='printBox'><input type='text' id='utlField' size='13' style='text-align: left'/></div>");this.shareUrlSubmit=$('<button type="button">Copy</button>');this.shareCheckPanel=$("<div class='printBox'></div>");this.shareCheckTitle=$("<div class='printBox'></div>");this.shareCheckBar=$("<div class='printBox'></div>");var b;b=getLanguage("frmShareInfo","You can easily share this publication to social networks.Just cilck the appropriate button below.");
this.textCheckField=new label(b,this.shareCheckPanel);this.shareCopyPanel=$("<div class='printBox'></div>");this.shareCopyTitle=$("<div class='printBox'></div>");this.shareCopyInput=$("<div class='printBox'><textarea id='copyField' size='13' style='text-align: left'/></div>");this.shareCopySubmit=$('<button type="button">Copy</button>');b=getLanguage("frminsertInfo","Use the code below to embed this publication to your website.");this.textCopyField=new label(b,this.shareCopyPanel);this.mainColor=
colorAdd("#333333",160);this.showing=!1;this.width=windowWidth;this.height=windowHeight;this.contentWidth=565;this.contentHeight=390;this.background.css({height:this.height+"px",bottom:"0px"});this.contentBox.css({height:this.contentHeight+"px",width:this.contentWidth+"px",left:(this.width-this.contentWidth)/2+"px"});this.contentBack.css({height:this.contentHeight+10+"px",width:this.contentWidth+10+"px",left:(this.width-this.contentWidth)/2-5+"px"});this.contentBack.css({opacity:0.5});this.toolBox.css({width:this.contentWidth+
"px",height:"35px",top:"0px",left:"0px",background:"#333333"});this.checkBox.css({width:this.contentWidth+"px",height:this.contentHeight-35+"px",top:"35px",left:"0px"});this.contentBox.css({top:(this.height-this.contentHeight)/2+"px"});this.contentBack.css({top:(this.height-this.contentHeight)/2-5+"px"});this.shareUrl.css({width:this.contentWidth+"px",height:"50px",top:"0px",left:"0px"});this.shareCheck.css({width:this.contentWidth+"px",height:"100px",top:"50px",left:"0px"});this.shareCopy.css({width:this.contentWidth+
"px",height:this.contentHeight-35-50-100+"px",top:"150px",left:"0px"});this.shareUrlInput.css({width:"470px",height:"40px","margin-left":"13px",bottom:"1px"});this.shareUrlInput.children("input").css({color:"black","border-radius":"5px"});this.shareUrlInput.children("input").css({width:"470px",height:"30px"});this.shareUrlInput.children("input").css({"padding-left":"5px"});this.shareUrlInput.children("input").css({"border-width":"1px"});this.shareUrlSubmit.css({width:"50px",height:"33px","margin-top":"10px",
"margin-left":"500px","border-radius":"5px"});this.shareCheckPanel.css({width:"538px",height:"80px",top:"10px",left:"13px","border-radius":"5px"});this.shareCheckTitle.css({width:"auto","font-size":"8px","font-family":"arial",height:"auto",top:"3px",left:"23px",background:this.mainColor});this.shareCheckBar.css({width:"538px",height:"50px",bottom:"0px",left:"0px"});this.shareCheckPanel.css({"border-left":"1px solid "+colorDiv(this.mainColor,120)});this.shareCheckPanel.css({"border-top":"1px solid "+
colorDiv(this.mainColor,120)});this.shareCheckPanel.css({"border-right":"1px solid "+colorAdd(this.mainColor,120)});this.shareCheckPanel.css({"border-bottom":"1px solid "+colorAdd(this.mainColor,120)});this.shareCheckTitle.html("<b>"+getLanguage("frmShareLabel","Share")+"</b>");this.shareCopyPanel.css({width:"538px",height:"180px",top:"10px",left:"13px","border-radius":"5px"});this.shareCopyTitle.css({width:"auto","font-size":"10px","font-family":"arial",height:"auto",top:"3px",left:"23px",background:this.mainColor});
this.shareCopyPanel.css({"border-left":"1px solid "+colorDiv(this.mainColor,120)});this.shareCopyPanel.css({"border-top":"1px solid "+colorDiv(this.mainColor,120)});this.shareCopyPanel.css({"border-right":"1px solid "+colorAdd(this.mainColor,120)});this.shareCopyPanel.css({"border-bottom":"1px solid "+colorAdd(this.mainColor,120)});this.shareCopyTitle.html("<b>"+getLanguage("frminsertLabel","Insert to Site")+"</b>");this.shareCopyInput.css({width:"516px",height:"85px","margin-left":"11px",top:"40px"});
this.shareCopyInput.children("textarea").css({color:"black","border-radius":"0px"});this.shareCopyInput.children("textarea").css({"padding-left":"5px"});this.shareCopyInput.children("textarea").css({width:"516px",height:"85px","border-radius":"5px"});this.shareCopySubmit.css({width:"50px",height:"33px","margin-top":"140px","margin-left":"480px","border-radius":"5px"});this.shareCopyInput.children("textarea").css({"border-left":"1px solid "+colorDiv(this.mainColor,120)});this.shareCopyInput.children("textarea").css({"border-top":"1px solid "+
colorDiv(this.mainColor,120)});this.shareCopyInput.children("textarea").css({"border-right":"1px solid "+colorAdd(this.mainColor,120)});this.shareCopyInput.children("textarea").css({"border-bottom":"1px solid "+colorAdd(this.mainColor,120)});this.titleBox.css({width:"50px",height:"20px",left:"15px",position:"absolute"});this.titleBox.css({color:"#ffffff",top:"7px"});this.titleBox.css({"text-shadow":"1px 1px #000000","font-family":"verdana"});$(this.titleBox).html(getLanguage("frmShareCaption","Share"));
$(a).append(this.background);$(a).append(this.contentBack);$(a).append(this.contentBox);$(this.contentBox).append(this.toolBox);$(this.contentBox).append(this.checkBox);$(this.checkBox).append(this.shareUrl);$(this.checkBox).append(this.shareCheck);$(this.checkBox).append(this.shareCopy);$(this.shareUrl).append(this.shareUrlInput);$(this.shareUrl).append(this.shareUrlSubmit);$(this.shareCheck).append(this.shareCheckPanel);$(this.shareCheck).append(this.shareCheckTitle);$(this.shareCheckPanel).append(this.shareCheckBar);
$(this.shareCheckPanel).append(this.textCheckField);$(this.shareCopy).append(this.shareCopyPanel);$(this.shareCopy).append(this.shareCopyTitle);$(this.shareCopyPanel).append(this.shareCopyInput);$(this.shareCopyPanel).append(this.textCopyField);$(this.shareCopyPanel).append(this.shareCopySubmit);this.textCheckField.setLabelPosition(15,8);this.textCopyField.setLabelPosition(15,8);this.textCheckField.onResize(516,30);this.textCopyField.onResize(516,30);this.shareUrlSubmit.bind(_event._end,function(){copyToClipboard($("#utlField").val())});
this.shareCopySubmit.bind(_event._end,function(){copyToClipboard($("#copyField").val())});this.contentBox.css({"text-shadow":"1px 1px #ffffff",background:this.mainColor});this.closeButton=$("<div></div>");this.closeButton.css({top:"0px",right:"0px",position:"absolute"});this.closeButton.append($("<img src='"+uiBaseURL+"close.png'/>").asImageButton());$(this.toolBox).append(this.closeButton);$(this.toolBox).append(this.titleBox);this.initShareBar(this.shareCheckBar);this.initEvent();this.background.css({display:"none"});
this.contentBox.css({display:"none"});this.contentBack.css({display:"none"})}
function copyToClipboard(a){if(window.clipboardData)window.clipboardData.clearData(),window.clipboardData.setData("Text",a);else if(-1!=navigator.userAgent.indexOf("Opera"))window.location=a;else if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(b){return alert("Your browser does not support clipboard.Please do it yourself."),!1}var c=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(c){var d=
Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(d){d.addDataFlavor("text/unicode");var e={},e=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);e.data=a;d.setTransferData("text/unicode",e,2*a.length);if(!c)return!1;c.setData(d,null,Components.interfaces.nsIClipboard.kGlobalClipboard)}}}else alert("Your browser does not support clipboard.Please do it yourself.")}
sharePanel.prototype.onResize=function(){this.contentWidth=565;this.contentHeight=390;this.width=windowWidth;this.height=windowHeight;this.background.css({height:this.height+"px",bottom:"0px"});this.contentBox.css({height:this.contentHeight+"px",width:this.contentWidth+"px",left:(this.width-this.contentWidth)/2+"px"});this.contentBack.css({height:this.contentHeight+10+"px",width:this.contentWidth+10+"px",left:(this.width-this.contentWidth)/2-5+"px"});this.toolBox.css({width:this.contentWidth+"px",
height:"35px",top:"0px",left:"0px"});this.checkBox.css({width:this.contentWidth+"px",height:this.contentHeight-35+"px",top:"35px",left:"0px"});this.contentBox.css({top:(this.height-this.contentHeight)/2+"px"});this.contentBack.css({top:(this.height-this.contentHeight)/2-5+"px"});this.shareUrl.css({width:this.contentWidth+"px",height:"50px",top:"0px",left:"0px"});this.shareCheck.css({width:this.contentWidth+"px",height:"100px",top:"50px",left:"0px"});this.shareCopy.css({width:this.contentWidth+"px",
height:this.contentHeight-35-50-100+"px",top:"150px",left:"0px"});this.shareUrlInput.css({width:"470px",height:"40px","margin-left":"13px"});this.shareUrlInput.children("input").css({width:"470px",height:"30px"});this.shareUrlSubmit.css({width:"50px",height:"33px","margin-top":"10px","margin-left":"500px"});this.shareCheckPanel.css({width:"538px",height:"80px",top:"10px",left:"13px"});this.shareCheckTitle.css({width:"auto",height:"auto",top:"3px",left:"23px"});this.shareCopyPanel.css({width:"538px",
height:"180px",top:"10px",left:"13px"});this.shareCopyTitle.css({width:"auto",height:"auto",top:"3px",left:"23px"});this.closeButton.css({top:"0px",right:"0px"})};sharePanel.prototype.setPosition=function(a,b,c){void 0==c&&(c=["left","top"]);$(this.background).css(c[0],a+"px");$(this.background).css(c[1],b+"px")};sharePanel.prototype.getShowStatu=function(){return this.showing};sharePanel.prototype.setShowStatu=function(a){this.showing=a};
sharePanel.prototype.showshow=function(){$(this.background).fadeIn(500);$(this.contentBox).fadeIn(500);$(this.contentBack).fadeIn(500);var a=window.location.href;0<=a.toLowerCase().indexOf("file:")&&(a="index.html");var b="<iframe frameborder='0'  width='240' height='210'  title='"+window.document.title+"' src='"+a+"' type='text/html' allowfullscreen='true' scrolling='no' marginwidth='0' marginheight='0'></iframe>";this.shareUrlInput.children("input").val(a);this.shareCopyInput.children("textarea").val(b);
this.showing=!0};sharePanel.prototype.hideBox=function(){$(this.background).fadeOut(500);$(this.contentBox).fadeOut(500);$(this.contentBack).fadeOut(500);this.showing=!1};sharePanel.prototype.initEvent=function(){var a=this;this.background.bind(_event._down,function(){a.hideBox();a.showing=!1});this.closeButton.bind(_event._end,function(){a.hideBox();a.showing=!1});this.closeButton.bind("mouseover",function(){a.closeButton.css({cursor:"pointer"})})};
sharePanel.prototype.fillContent=function(){var a=$("<div/>");a.html(bookConfig.aboutContactInfoTxt);this.checkBox.append(a)};
sharePanel.prototype.initShareBar=function(a){var b=window.location.href,c=window.document.title;0<=b.toLowerCase().indexOf("file:")&&(b="index.html");var d="",d=d.substring(0,d.lastIndexOf("/"))+"/"+bookConfig.thumbPath+"1.jpg",e="?&url="+b+"&title="+c+"&description="+bookDescription+"&screenshot="+d,b=this.initShareButton("email",e),c=this.initShareButton("facebook",e),d=this.initShareButton("google",e),f=this.initShareButton("mySpace",e),g=this.initShareButton("twitter",e),h=this.initShareButton("digg",
e),e=this.initShareButton("more",e);a.append(b);shareButtonLeft=function(a){return 10+35*a};b.css({top:"10px",left:shareButtonLeft(0)+"px"});a.append(c);c.css({top:"10px",left:shareButtonLeft(1)+"px"});a.append(d);d.css({top:"10px",left:shareButtonLeft(2)+"px"});a.append(f);f.css({top:"10px",left:shareButtonLeft(3)+"px"});a.append(g);g.css({top:"10px",left:shareButtonLeft(4)+"px"});a.append(h);h.css({top:"10px",left:shareButtonLeft(5)+"px"});a.append(e);e.css({top:"10px",left:shareButtonLeft(6)+"px"});
a=window.location.href;0<=a.toLowerCase().indexOf("file:")&&(a="index.html");b="<iframe frameborder='0'  width='240' height='210'  title='"+window.document.title+"' src='"+a+"' type='text/html' allowfullscreen='true' scrolling='no' marginwidth='0' marginheight='0'></iframe>";this.shareUrlInput.children("input").val(a);this.shareCopyInput.children("textarea").val(b)};
sharePanel.prototype.initShareButton=function(a,b){var c=$("<div style = 'position: absolute;width:30px;height:30px;'></div>"),d,e;switch(a){case "email":e="http://api.addthis.com/oexchange/0.8/forward/email/offer"+b;d=$("<div class='shareButton' ><img src='"+uiBaseURL+"email.png' class='shareBarImg' /></div>");break;case "facebook":e="http://api.addthis.com/oexchange/0.8/forward/facebook/offer"+b;d=$("<div class='shareButton'><img src='"+uiBaseURL+"facebook.png' class='shareBarImg' /></div>");break;
case "google":e="http://api.addthis.com/oexchange/0.8/forward/igoogle/offer"+b;d=$("<div class='shareButton'><img src='"+uiBaseURL+"google.png' class='shareBarImg' /></div>");break;case "mySpace":e="http://api.addthis.com/oexchange/0.8/forward/myspace/offer"+b;d=$("<div class='shareButton'><img src='"+uiBaseURL+"myspace.png' class='shareBarImg' /></div>");break;case "netvibes":e="http://api.addthis.com/oexchange/0.8/forward/netvibes/offer"+b;d=$("<div class='shareButton'><img src='"+uiBaseURL+"netvibes.png' class='shareBarImg' /></div>");
break;case "twitter":e="http://api.addthis.com/oexchange/0.8/forward/twitter/offer"+b;d=$("<div class='shareButton'><img src='"+uiBaseURL+"twitter.png' class='shareBarImg' /></div>");break;case "digg":e="http://api.addthis.com/oexchange/0.8/forward/digg/offer"+b;d=$("<div class='shareButton'><img src='"+uiBaseURL+"digg.png' class='shareBarImg' /></div>");break;case "more":e="http://api.addthis.com/oexchange/0.8/offer"+b,d=$("<div class='shareButton'><img src='"+uiBaseURL+"more.png' class='shareBarImg' /></div>")}d.css({cursor:"pointer"});
d.attr({title:"Share to "+a});d.bind(_event._end,function(){sendvisitinfo(2,getShownPageString());window.open(e,"_blank")});c.append(d);c.mouseenter(function(){$(c).css({"-webkit-box-shadow":"0 0 10px rgba(0, 0, 0, 0.5)","-moz-box-shadow":"0 0 10px rgba(0, 0, 0, 0.5)","-o-box-shadow":"0 0 10px rgba(0, 0, 0, 0.5)","-ms-box-shadow":"0 0 10px rgba(0, 0, 0, 0.5)","box-shadow":"0 0 10px rgba(0, 0, 0, 0.5)"})});c.mousedown(function(){});c.mouseup(function(){c.css("background-color","");c.css({"-moz-box-shadow":"",
"-ms-box-shadow":"","box-shadow":"","-webkit-box-shadow":"","-o-box-shadow":""})});c.mouseleave(function(){c.css("background-color","");c.css({"-moz-box-shadow":"","-ms-box-shadow":"","box-shadow":"","-webkit-box-shadow":"","-o-box-shadow":""})});return c};function aboutBar(a){this.background=$("<div class='printBar'></div>");this.contentBack=$("<div class='printBack'></div>");this.contentBox=$("<div class='printBG'></div>");this.toolBox=$("<div class='printBox'></div>");this.checkBox=$("<div class='printBox'></div>");this.checkLeftBox=$("<div class='printBox dd'></div>");this.checkRightBox=$("<div class='printBox dda'></div>");this.showing=!1;this.width=windowWidth;this.height=windowHeight;this.contentWidth=532;this.contentHeight=350;this.mainColor=
"#888888";this.background.css({height:this.height+"px",bottom:"0px"});this.contentBox.css({height:this.contentHeight+"px",width:this.contentWidth+"px",left:(this.width-this.contentWidth)/2+"px"});this.contentBack.css({height:this.contentHeight+10+"px",width:this.contentWidth+10+"px",left:(this.width-this.contentWidth)/2-5+"px"});this.contentBack.css({opacity:0.5});this.contentBack.setGradient("#222222",!1);this.toolBox.css({width:this.contentWidth+"px",height:"31px",top:"0px",left:"0px"});this.checkBox.css({width:this.contentWidth+
"px",height:this.contentHeight-31+"px",top:"31px",left:"0px",backgroundColor:"#CACACA"});this.checkLeftBox.css({width:this.contentWidth/2-10+"px",height:this.contentHeight-31+"px",top:"0px",left:"10px"});this.checkRightBox.css({width:this.contentWidth/2-10+"px",height:this.contentHeight-31+"px",top:"0px",left:this.contentWidth/2+"px"});this.contentBox.css({top:(this.height-this.contentHeight)/2+"px"});this.contentBack.css({top:(this.height-this.contentHeight)/2-5+"px"});$(a).append(this.background);
$(a).append(this.contentBack);$(a).append(this.contentBox);$(this.contentBox).append(this.toolBox);$(this.contentBox).append(this.checkBox);$(this.checkBox).append(this.checkLeftBox);$(this.checkBox).append(this.checkRightBox);$(this.contentBack).css({"border-radius":"10px"});$(this.contentBox).css({"border-radius":"10px"});$(this.toolBox).css({background:"#393838"});$(this.toolBox).css({"font-family":"verdana"});$(this.toolBox).css({"vertical-align":"middle","text-indent":"18px",lineHeight:"31px"});
$(this.toolBox).css({color:"#ffffff","text-shadow":"1px 1px #000000"});$(this.toolBox).html("<b>"+getLanguage("frmaboutcaption","Contact")+"</b>");$(this.contentBox).css({"text-shadow":"1px 1px #000000"});$(this.checkLeftBox).css({"font-family":"Georgia"});$(this.checkLeftBox).css({color:"#000000","text-shadow":"#ffffff 1px 1px"});$(this.checkLeftBox).html("<p><font size=3><b>"+getLanguage("frmaboutcontactinformation","Contact Information")+"</b></font></p><p><font size=1><b>"+getLanguage("frmaboutADDRESS",
"ADDRESS")+"</b></font><br><font size=0.5>"+bookConfig.AboutAddress+"</font></br></p><p><font size=1><b>"+getLanguage("frmaboutEMAIL","EMAIL")+"</b></font><br><a href=mailto:"+bookConfig.AboutEmail+"><font size=0.5 color='#000000'>"+bookConfig.AboutEmail+"</font></a></br></p><p><font size=1><b>"+getLanguage("frmaboutWEBSITE","WEBSITE")+"</b></font><br><a href="+bookConfig.AboutWebsite+"><font size=0.5 color='#000000'>"+bookConfig.AboutWebsite+"</font></a></br></p><p><font size=1><b>"+getLanguage("frmaboutMOBILE",
"MOBILE")+"</b></font><br><font size=0.5>"+bookConfig.AboutMobile+"</font></br></p><p><font size=1><b>"+getLanguage("frmaboutAUTHOR","AUTHOR")+"</b></font><br><font size=0.5>"+bookConfig.AboutAuthor+"</font></br></p>");$(this.checkRightBox).css({"font-family":"Georgia"});$(this.checkRightBox).css({color:"#000000","text-shadow":"#ffffff 1px 1px"});$(this.checkRightBox).html("<p><a href="+getLogoLink()[0]+"><img src='"+bookConfig.CompanyLogoFile+"'/></a></p><p><font size=1><b>"+getLanguage("frmaboutDESCRIPTION",
"DESCRIPTION")+"</b></font><br><font size=0.5>"+bookConfig.AboutDescription+"</font></br></p>");this.closeButton=$("<div></div>");this.closeButton.css({top:"0px",right:"0px",position:"absolute"});this.closeButton.append($("<img src='"+uiBaseURL+"close.png'/>").asImageButton());$(this.toolBox).append(this.closeButton);$(this.contentBack).css({border:"1px solid #666666"});$(this.contentBack).css({"-webkit-box-shadow":"0 0 1px rgba(40, 40, 40, 1)","-moz-box-shadow":"0 0 1px rgba(40, 40, 40, 1)","-o-box-shadow":"0 0 1px rgba(40, 40, 40, 1)",
"-ms-box-shadow":"0 0 1px rgba(40, 40, 40, 1)","box-shadow":"0 0 1px rgba(40, 40, 40, 1)"});this.fillContent();this.initEvent();$(this.background).css({display:"none"});$(this.contentBox).css({display:"none"});$(this.contentBack).css({display:"none"})}
aboutBar.prototype.onResize=function(){this.contentWidth=532;this.contentHeight=350;this.background.css({height:windowHeight+"px",bottom:"0px"});this.contentBox.css({height:this.contentHeight+"px",width:this.contentWidth+"px",left:(windowWidth-this.contentWidth)/2+"px"});this.contentBack.css({height:this.contentHeight+10+"px",width:this.contentWidth+10+"px",left:(windowWidth-this.contentWidth)/2-5+"px"});this.toolBox.css({width:this.contentWidth+"px",height:"31px",top:"0px",left:"0px"});this.checkBox.css({width:this.contentWidth+
"px",height:this.contentHeight-31+"px",top:"31px",left:"0px"});this.contentBox.css({top:(windowHeight-this.contentHeight)/2+"px"});this.contentBack.css({top:(windowHeight-this.contentHeight)/2-5+"px"});this.closeButton.css({top:"0px",right:"0px"})};aboutBar.prototype.setPosition=function(a,b,c){void 0==c&&(c=["left","top"]);$(this.background).css(c[0],a+"px");$(this.background).css(c[1],b+"px")};aboutBar.prototype.getShowStatu=function(){return this.showing};
aboutBar.prototype.setShowStatu=function(a){this.showing=a};aboutBar.prototype.showshow=function(){$(this.background).fadeIn(500);$(this.contentBox).fadeIn(500);$(this.contentBack).fadeIn(500);this.showing=!0};aboutBar.prototype.hideBox=function(){$(this.background).fadeOut(500);$(this.contentBox).fadeOut(500);$(this.contentBack).fadeOut(500);this.showing=!1};
aboutBar.prototype.initEvent=function(){var a=this;this.background.bind(_event._down,function(b){a.hideBox();a.showing=!1;stopEvent(b);return!1});this.closeButton.bind(_event._end,function(b){a.hideBox();a.showing=!1;stopEvent(b);return!1});this.closeButton.bind("mouseover",function(b){a.closeButton.css({cursor:"pointer"});stopEvent(b);return!1})};aboutBar.prototype.fillContent=function(){};function initYoutube(a,b,c,d){this.father=a;this.config=$.extend({width:400,height:300,x:0.02,y:0.02,alpha:1,id:null},b);this.youtubeFrame=null;null!=this.config.id&&(this.pw=c,this.ph=d,this.width=this.config.width*this.pw,this.height=this.config.height*this.ph,this.x=this.config.x*this.pw,this.y=this.config.y*this.ph,this.youtubeFrame=$("<iframe class='youtube-player' type='text/html' width='"+this.width+"' height='"+this.height+"' src='http://www.youtube.com/embed/"+this.config.id+"' frameborder='0' style='position: absolute; opacity: "+
this.config.alpha+"; left:"+this.x+"px; top:"+this.y+"px;'></iframe>"),a.append(this.youtubeFrame))}initYoutube.prototype.onResize=function(a,b){this.pw=a;this.ph=b;this.width=this.config.width*this.pw;this.height=this.config.height*this.ph;this.youtubeFrame.css({width:this.width+"px",height:this.height+"px"});this.setPosition()};initYoutube.prototype.setPosition=function(){this.x=this.config.x*this.pw;this.y=this.config.y*this.ph;this.youtubeFrame.css({top:this.y+"px",left:this.x+"px"})};
initYoutube.prototype.getPlayEvt=function(){return this.config.moviePlayTriggerEvt};initYoutube.prototype.getStopEvt=function(){return this.config.movieStopTriggerEvt};initYoutube.prototype.hide=function(){this.youtubeFrame.css({width:"0px",height:"0px"});this.youtubeFrame.css({display:"none"})};initYoutube.prototype.show=function(){this.youtubeFrame.css({width:this.width+"px",height:this.height+"px"});this.youtubeFrame.css({display:"block"})};function initVimeo(a,b,c,d){this.config=$.extend({width:400,height:300,x:0.02,y:0.02,alpha:1,id:null},b);this.vimeoFrame=null;null!=this.config.id&&(this.pw=c,this.ph=d,this.width=this.config.width*this.pw,this.height=this.config.height*this.ph,this.x=this.config.x*this.pw,this.y=this.config.y*this.ph,b=this.config.id.substring(this.config.id.lastIndexOf("/")+1),this.vimeoFrame=$("<iframe width='"+this.width+"' height='"+this.height+"' src='http://player.vimeo.com/video/"+b+"' frameborder='0' style='position: absolute; opacity: "+
this.config.alpha+"; left:"+this.x+"px; top:"+this.y+"px;' webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>"),a.append(this.vimeoFrame))}
initVimeo.prototype={onResize:function(a,b){this.pw=a;this.ph=b;this.vimeoFrame.css({width:this.pw*this.config.width+"px",height:this.ph*this.config.height+"px"});this.setPosition(this.config.x*this.pw,this.config.y*this.ph)},setPosition:function(a,b){this.vimeoFrame.css({top:b+"px",left:a+"px"})},getPlayEvt:function(){return this.config.moviePlayTriggerEvt},getStopEvt:function(){return this.config.movieStopTriggerEvt},hide:function(){this.vimeoFrame.css({display:"none"})},show:function(){this.vimeoFrame.css({display:"block"})}};function initVideo(a,b,c,d,e){this.config=$.extend({width:0.6,height:0.5,x:0.2,y:0.2,src:null,previewSrc:null,alpha:1},b);this.pw=c;this.ph=d;this.width=this.config.width*this.pw;this.height=this.config.height*this.ph;this.x=this.config.x*this.pw;this.y=this.config.y*this.ph;this.father=a;this.content=$("<div></div>");this.content.css({position:"absolute",left:this.x+"px",top:this.y+"px",width:this.width+"px",height:this.height+"px","background-color":"black"});this.father.append(this.content);"string"==
typeof this.config.previewSrc&&null!=this.config.previewSrc&&void 0!=this.config.previewSrc&&(this.content.css({background:"url("+this.config.previewSrc+")"}),this.content.css({"background-size":this.width+"px "+this.height+"px"}));if("string"==typeof this.config.src){if(null==this.config.src||".mp4"!=this.config.src.substr(this.config.src.length-4,4))return}else if(this.config.src=={})return;!0==isFlipPdf&&(this.config.src="../"+this.config.src);this.video=null;this.video=$("<video src='"+this.config.src+
"' controls preload='none'></video>");this.video.css({position:"absolute","z-index":1,left:"0px",top:"0px",width:"100%",height:"100%",opacity:this.config.alpha});this.content.append(this.video);void 0!=this.video[0].play&&(this.content.addVideoSkin(e),this.video.removeAttr("controls"))}
initVideo.prototype.onResize=function(a,b){this.pw=a;this.ph=b;this.width=this.config.width*this.pw;this.height=this.config.height*this.ph;this.content.css({width:this.width+"px",height:this.height+"px"});this.content.css({"background-size":this.width+"px "+this.height+"px"});this.content.resizeVideoSkin();this.setPosition()};initVideo.prototype.setPosition=function(){this.x=this.pw*this.config.x;this.y=this.ph*this.config.y;this.content.css({left:this.x+"px",top:this.y+"px"})};
initVideo.prototype.playVideo=function(){if(null!=this.video)try{this.video[0].play()}catch(a){}};initVideo.prototype.stopVideo=function(){if(null!=this.video)try{this.video[0].stop()}catch(a){}};initVideo.prototype.pauseVideo=function(){if(null!=this.video)try{this.video[0].pause()}catch(a){}};initVideo.prototype.getPlayEvt=function(){return this.config.moviePlayTriggerEvt};initVideo.prototype.getStopEvt=function(){return this.config.movieStopTriggerEvt};function initAudio(a,b,c,d,e){this.config=$.extend({width:80,height:30,x:20,y:20,src:null,alpha:1},b);this.audio=null;if(null!=this.config.src){this.originWidth=bookConfig.largePageWidth;this.pw=c;this.ph=d;this.width=this.config.width*this.pw;this.height=this.config.height*this.ph;this.x=this.config.x*this.pw;this.y=this.config.y*this.ph;this.father=a;a=b.key;this.themeName=e;this.content=$("<div></div>");this.content.css({position:"absolute",left:this.x+"px",top:this.y+"px",opacity:this.config.alpha});
this.father.append(this.content);this.audio=$("<audio controls ></audio>");this.audio.css({position:"absolute",width:this.width+"px",height:this.height+"px",left:"0px",top:"0px",opacity:this.config.alpha});this.content.audioResources=[];if(void 0==a)this.audio.attr("src",this.config.src),this.content.audioResources.push(this.config.src);else if(a in this.config.src)f=this.config.src[a],"./"==f.substr(0,2)&&(f="."+f),this.content.audioResources.push(f),this.audio.attr("src",f);else for(b=0;b<this.config.src.length;b++){var f=
this.config.src[b][a];"./"==f.substr(0,2)&&(f="."+f);this.content.audioResources.push(f);this.audio.append($("<source src='"+f+"'>"));0==b&&this.audio.attr("src",f)}this.content.append(this.audio);void 0!=this.audio[0].play&&(this.content.addAudioSkin(e),this.audio.removeAttr("controls"));this.resizeThemes={"default":"",wave:""};this.themeName in this.resizeThemes||void 0==this.themeName?this.content.css({width:this.width+"px",height:this.height+"px"}):this.resizeAudio(c,d)}}
initAudio.prototype.onResize=function(a,b){this.pw=a;this.ph=b;this.width=this.config.width*this.pw;this.height=this.config.height*this.ph;this.themeName in this.resizeThemes||void 0==this.themeName?(this.content.css({width:this.width+"px",height:this.height+"px"}),this.content.resizeAudioSkin()):this.resizeAudio(a,b);this.setPosition()};
initAudio.prototype.resizeAudio=function(a){a/=this.originWidth;this.content.css({"-webkit-transform-origin":"0% 0%","-moz-transform-origin":"0% 0%","-ms-transform-origin":"0% 0%","-o-transform-origin":"0% 0%","-webkit-transform":"scale("+a+")","-moz-transform":"scale("+a+")","-ms-transform":"scale("+a+")","-o-transform":"scale("+a+")"});this.content.refreshAudioSeek()};
initAudio.prototype.setPosition=function(){this.x=this.config.x*this.pw;this.y=this.config.y*this.ph;this.content.css({left:this.x+"px",top:this.y+"px"})};initAudio.prototype.play=function(){if(null!=this.audio)try{this.audio[0].play()}catch(a){}};initAudio.prototype.pause=function(){if(null!=this.audio)try{this.audio[0].pause()}catch(a){}};initAudio.prototype.stop=function(){null!=this.audio&&this.audio[0].stop()};initAudio.prototype.getPlayEvt=function(){return this.config.soundPlayTriggerEvt};
initAudio.prototype.getStopEvt=function(){return this.config.soundStopTriggerEvt};
function initAudioEditor(a,b,c){this.background=$("<div class='printBar'></div>");this.contentBox=$("<div class='printBG'></div>");this.closeButton=$("<div></div>");this.showing=!1;this.width=windowWidth;this.height=windowHeight;this.audioSrc=b;this.contentWidth=350;this.contentHeight=63;this.themeName="enjoy";this.background.css({height:this.height+"px",bottom:"0px"});this.contentBox.css({height:this.contentHeight+"px",width:this.contentWidth+"px",left:(this.width-this.contentWidth)/2+"px"});this.contentBox.css({top:(this.height-
this.contentHeight)/2+"px","border-radius":"0px"});this.audio=$("<audio controls ></audio>");this.audio.css({position:"absolute",width:this.contentWidth+"px",height:this.contentHeight+"px",left:"0px",top:"0px"});this.contentBox.audioResources=[];this.audio.attr("src",this.audioSrc);this.contentBox.audioResources.push(this.audioSrc);this.contentBox.append(this.audio);void 0!=this.audio[0].play&&(this.contentBox.addAudioSkin(this.themeName),this.audio.removeAttr("controls"),c&&(this.audio[0].autoPlay=
!0));$(a).append(this.background);$(a).append(this.contentBox);$(a).append(this.closeButton);this.closeButton.css({top:"30px",right:"30px",position:"absolute","z-index":"103"});this.closeButton.append($("<img src='"+uiBaseURL+"close.png'/>").asImageButton());this.initEvent();$(this.background).css("display","none");$(this.contentBox).css("display","none");$(this.closeButton).css("display","none");void 0!=leftRightButton&&null!=leftRightButton&&leftRightButton.setShow(!1)}
initAudioEditor.prototype.onResize=function(){this.contentWidth=360;this.contentHeight=70;this.background.css({height:windowHeight+"px",bottom:"0px"});this.contentBox.css({height:this.contentHeight+"px",width:this.contentWidth+"px",left:(windowWidth-this.contentWidth)/2+"px"});this.contentBox.css({top:(windowHeight-this.contentHeight)/2+"px"});this.closeButton.css({top:"30px",right:"30px"});void 0!=this.themeName&&(this.contentBox.css({width:this.contentWidth+"px",height:this.contentHeight+"px"}),
this.contentBox.resizeAudioSkin())};initAudioEditor.prototype.setPosition=function(a,b,c){void 0==c&&(c=["left","top"]);$(this.background).css(c[0],a+"px");$(this.background).css(c[1],b+"px")};initAudioEditor.prototype.getShowStatu=function(){return this.showing};initAudioEditor.prototype.setShowStatu=function(a){this.showing=a};initAudioEditor.prototype.showshow=function(){$(this.background).fadeIn(500);$(this.contentBox).fadeIn(500);$(this.closeButton).fadeIn(500);this.showing=!0};
initAudioEditor.prototype.hideBox=function(){var a=this;$(this.background).fadeOut(500,function(){a.contentBox.remove();a.closeButton.remove()});hideLeftRightButton()&&leftRightButton.setShow(!0);this.showing=!1};initAudioEditor.prototype.initEvent=function(){var a=this;this.background.bind(_event._down,function(){a.hideBox();a.showing=!1});this.closeButton.bind(_event._end,function(){a.hideBox();a.showing=!1});this.closeButton.bind("mouseover",function(){a.closeButton.css({cursor:"pointer"})})};
initAudioEditor.prototype.play=function(){if(null!=this.audio)try{this.audio[0].play()}catch(a){}};initAudioEditor.prototype.pause=function(){if(null!=this.audio)try{this.audio[0].pause()}catch(a){}};initAudioEditor.prototype.stop=function(){null!=this.audio&&this.audio[0].stop()};initAudioEditor.prototype.getPlayEvt=function(){return this.config.soundPlayTriggerEvt};initAudioEditor.prototype.getStopEvt=function(){return this.config.soundStopTriggerEvt};function initImage(a,b,c,d){this.config=$.extend({width:0.2,height:0.2,x:0.2,y:0.2,alpha:1,src:null},b);this.container=$("<div style='position: absolute;'></div>");this.img=$("<img style='position: absolute;width: 100%;height: 100%;'/>");this.imgBorder=$("<div class = 'bubble expose-square-solid' style='position: absolute;width: 100%;height: 100%;'></div>");null!=this.config.src&&(this.pw=c,this.ph=d,this.width=this.config.width*c,this.height=this.config.height*d,!0==isFlipPdf&&(this.config.src="."+
this.config.src),this.container.css({width:this.width,height:this.height,left:this.pw*this.config.x,top:this.ph*this.config.y,opacity:this.config.alpha,zIndex:102}),this.img.attr("src",this.config.src).css({width:this.width,height:this.height}),this.imgBorder.css({width:"100%",height:"100%"}),a.append(this.container),this.container.append(this.img),this.container.append(this.imgBorder),this.imgBorder.css({display:"none"}),this.father=a,this.initEvt())}
initImage.prototype={initEvt:function(){this.audios=this.slide=this.form=null;var a=this;a.zoomImg=null;if(void 0==this.config.action&&!/\.(gif)$/.test(a.config.src))this.container.hammer().on(_event._end,function(b){a.zoomImg=new HTML5ZoomImg(a.config.src,$("#tmpContainer"));b.preventDefault();b.stopPropagation();return!1});this.config.mouseOver==PageEditor.MouseOverType.AddBorder?(this.img.bind(_event._enter,function(){a.imgBorder.css({display:"block"});a.img.animate({opacity:"0.8"},300)}),this.img.bind(_event._down,
function(){a.imgBorder.css({display:"block"});a.img.animate({opacity:"0.8"},300)}),this.imgBorder.bind(_event._end,function(){a.imgBorder.css({display:"none"});a.img.animate({opacity:"1"},300)}),this.imgBorder.bind(_event._leave,function(){a.imgBorder.css({display:"none"});a.img.animate({opacity:"1"},300)})):this.config.mouseOver==PageEditor.MouseOverType.Zoom&&(this.img.bind(_event._enter,function(){a.img.animate({left:a.pw*a.config.x-0.05*a.width+"px",top:a.ph*a.config.y-0.05*a.height+"px",width:1.1*
a.width+"px",height:1.1*a.height+"px"},300)}),this.img.bind(_event._down,function(){a.img.animate({left:a.pw*a.config.x-0.05*a.width+"px",top:a.ph*a.config.y-0.05*a.height+"px",width:1.1*a.width+"px",height:1.1*a.height+"px"},300)}),this.img.bind(_event._end,function(){a.img.animate({left:a.pw*a.config.x+"px",top:a.ph*a.config.y+"px",width:a.width+"px",height:a.height+"px"},300)}),this.img.bind(_event._leave,function(){a.img.animate({left:a.pw*a.config.x+"px",top:a.ph*a.config.y+"px",width:a.width+
"px",height:a.height+"px"},300)}));if(void 0!=this.config.action){this.flag=0;this.linkURL=null;try{void 0!=this.config.action.length&&(this.config.action=this.config.action[0]),this.linkURL=this.config.action.url}catch(b){}var c;null!=this.linkURL&&"www"==this.linkURL.substr(0,3).toLowerCase()&&(this.linkURL="http://"+this.linkURL);try{c=this.config.action.triggerEventType}catch(d){c=null}a.img.bind(_event._down,function(){c==PageEditor.TriggerEventType.MouseDown&&actionEvent.call(a);browserType==
3?event.cancelBubble=true:event.stopPropagation()});a.img.bind(_event._enter,function(){c==PageEditor.TriggerEventType.MouseOver&&actionEvent.call(a)});a.img.bind(isTouch?_event._end:"mouseout",function(){c==PageEditor.TriggerEventType.MouseOut&&actionEvent.call(a)});a.imgBorder.bind(_event._down,function(){c==PageEditor.TriggerEventType.MouseDown&&actionEvent.call(a);browserType==3?event.cancelBubble=true:event.stopPropagation()});a.imgBorder.bind(_event._enter,function(){c==PageEditor.TriggerEventType.MouseOver&&
actionEvent.call(a)});a.imgBorder.bind(isTouch?_event._end:"mouseout",function(){c==PageEditor.TriggerEventType.MouseOut&&actionEvent.call(a)})}},onResize:function(a,b){this.pw=a;this.ph=b;this.width=a*this.config.width;this.height=b*this.config.height;this.container.width(this.width).height(this.height).css({left:this.config.x*a,top:this.config.y*b});this.img.width(this.width).height(this.height);if(null!=this.form)this.form.onResize(bookContainer.width(),bookContainer.height());if(null!=this.slide)this.slide.onResize(bookContainer.width(),
bookContainer.height());if(null!=this.audios)this.audios.onResize(bookContainer.width(),bookContainer.height())}};
var HTML5ZoomImg=Class({create:function(a,b){var c=this,d,e;this.$container=$(b);d=this.$container.width();e=this.$container.height();this.limitWidth=d;this.limitHeight=e;this.innerLimitWidth=606;this.innerLimitHeight=404;this.dragDivFalg=!0;this.dragImgFalg=!1;this.address=uiBaseURL;this.isFullFalg=!1;this.isOneToOneFalg=!0;this.scale=100;this.isMapShowFalg=!1;this.boxImgBG=$("<div style='position: absolute;margin: 0px;padding: 0px;border: 0px;left: 0px;top: 0px;background-color: #000000;opacity: 0;z-index: 99999;'></div>").css({width:d,height:e}).appendTo(this.$container);
this.outerBoxImg=$("<div class='fliphtml5-loading' style='position: absolute;margin: 0px;padding: 0px;border: 0px;left: 0px;top: 0px;overflow: hidden;z-index: 99999;'></div>").css({width:d,height:e}).appendTo(this.$container);this.innerBoxImg=$("<div style='position: absolute;overflow: hidden;cursor: pointer;background-color: rgba(0,0,0, 0.6);'></div>").css({boxShadow:"0px 0px 4px #000000"}).hide().appendTo(this.outerBoxImg);this.boxImgDiv=$("<div class='fliphtml5-boxDiv' style='position: absolute;'></div>").appendTo(this.innerBoxImg);
this.boxImg=$("<img style='position: absolute;width: 100%;height: 100%;padding: 0px;margin: 0px;'/>").appendTo(this.boxImgDiv);this.closeBox=$("<div style='position: absolute;left: auto;top: 0px;right: 0px;'></div>").append($("<img>",{src:this.address+"closeForm.png"})).appendTo(this.innerBoxImg);this.bindCloseBoxEvent();this.createControlBar(this.innerBoxImg);this.createImgMap(this.innerBoxImg);this.loadImg(a);this.dragDiv();this.dragImage();isTouch||(this.innerBoxImg.transition3D(),this.boxImgDiv.transition3D(),
this.mapPoint.transition3D());$(window).on("resize",function(){c.resize()});return this},bindCloseBoxEvent:function(){var a=this;a.closeBox.bind("mouseover",function(){a.closeBox.children("img").attr("src",a.address+"closeForm_down.png")});a.closeBox.bind("mouseout",function(){a.closeBox.children("img").attr("src",a.address+"closeForm.png")});a.closeBox.bind("click",function(){a.destroy()})},createControlBar:function(a){this.controlBar=$("<div class='control' style='position: absolute;width: 106px;height: 48px;overflow: hidden;bottom: -50px;top: auto;left: 50%;margin-left: -53px;border-top-left-radius: 10px;border-top-right-radius: 10px;background-color: rgba(0,0,0,0.6)'></div>").css({boxShadow:"0px 0px 4px #000000"}).appendTo(a);
this.oneToOne=$("<span class='one-to-one' style='position: absolute;'></span>").css({width:40,height:30,left:10,top:9,fontFamily:"serif",fontSize:28,lineHeight:"30px",color:"#7F8383",letterSpacing:"-5px",textAlign:"center"}).html("1:1").appendTo(this.controlBar);this.fullScreen=$("<div class='FullScreen' style='position: absolute'></div>").css({width:40,height:30,left:56,top:9}).append($("<img>",{src:this.address+"enterFull.png",css:{marginLeft:6,marginTop:1}})).appendTo(this.controlBar);this.bindControlEvents()},
bindControlEvents:function(){var a=this;isTouch?a.controlBar.css({bottom:2}).show():(this.innerBoxImg.bind("mouseover",function(){a.controlBar.stop(!1,!1).animate({bottom:2},400,"linear")}),this.innerBoxImg.bind("mouseout",function(){a.controlBar.stop(!1,!1).animate({bottom:-50},400,"linear")}));this.oneToOne.bind("click",function(){a.boxImgDiv.css({width:a.originalSize.width,height:a.originalSize.height,left:(a.innerBoxImg.width()-a.originalSize.width)/2,top:(a.innerBoxImg.height()-a.originalSize.height)/
2});a.dragImgFalg=a.innerBoxImg.width()>=a.boxImgDiv.width()&&a.innerBoxImg.height()>=a.boxImgDiv.height()?false:true;a.dragDivFalg=a.isFullFalg?false:a.innerBoxImg.width()>=a.boxImgDiv.width()&&a.innerBoxImg.height()>=a.boxImgDiv.height()?true:false;a.scale=100;a.isOneToOneFalg=a.isOneToOne();a.isMapShowFalg=a.isShowMap();a.setMapPoint()});this.oneToOne.bind("mouseover",function(){a.isOneToOneFalg||a.oneToOne.css({color:"#32B9EB"})});this.oneToOne.bind("mouseout",function(){a.isOneToOneFalg||a.oneToOne.css({color:"#ffffff"})});
this.fullScreen.bind("click",function(){var b=parseInt(a.boxImgDiv.css("left")),c=parseInt(a.boxImgDiv.css("top")),d=a.boxImgDiv.width(),e=a.boxImgDiv.height(),f=a.innerBoxImg.width(),g=a.innerBoxImg.height();if(a.isFullFalg){a.innerBoxImg.css({width:Math.max(a.innerLimitWidth,a.result.width),height:Math.max(a.innerLimitHeight,a.result.height),left:Math.max(0,(a.outerBoxImg.width()-Math.max(a.innerLimitWidth,a.result.width))/2),top:Math.max(0,(a.outerBoxImg.height()-Math.max(a.innerLimitHeight,a.result.height))/
2)});a.boxImgDiv.css({left:a.innerBoxImg.width()>=d?(a.innerBoxImg.width()-d)/2:Math.max(a.innerBoxImg.width()-d,b+(a.innerBoxImg.width()-f)/2),top:a.innerBoxImg.height()>=e?(a.innerBoxImg.height()-e)/2:Math.max(a.innerBoxImg.height()-e,c+(a.innerBoxImg.height()-g)/2)});a.dragDivFalg=a.innerBoxImg.width()>=a.boxImgDiv.width()&&a.innerBoxImg.height()>=a.boxImgDiv.height()?true:false;a.isFullFalg=false;a.fullScreen.children("img").attr("src",a.address+"enterFull.png")}else{a.innerBoxImg.css({width:a.$container.width(),
height:a.$container.height(),left:0,top:0});a.boxImgDiv.css({left:a.innerBoxImg.width()>=d?(a.innerBoxImg.width()-d)/2:Math.max(a.innerBoxImg.width()-d,b+(f-a.innerBoxImg.width())/2),top:a.innerBoxImg.height()>=e?(a.innerBoxImg.height()-e)/2:Math.max(a.innerBoxImg.height()-e,c+(g-a.innerBoxImg.height())/2)});a.isFullFalg=true;a.dragDivFalg=false;a.fullScreen.children("img").attr("src",a.address+"exitFull.png")}a.dragImgFalg=a.innerBoxImg.width()>=a.boxImgDiv.width()&&a.innerBoxImg.height()>=a.boxImgDiv.height()?
false:true;a.isShowMap();a.setMapPoint()});this.fullScreen.bind("mouseover",function(){a.isFullFalg?a.fullScreen.children("img").attr("src",a.address+"exitFull_over.png"):a.fullScreen.children("img").attr("src",a.address+"enterFull_over.png")});this.fullScreen.bind("mouseout",function(){a.isFullFalg?a.fullScreen.children("img").attr("src",a.address+"exitFull.png"):a.fullScreen.children("img").attr("src",a.address+"enterFull.png")})},isOneToOne:function(){if(this.originalSize.width==this.boxImgDiv.width()&&
this.originalSize.height==this.boxImgDiv.height())return this.oneToOne.css({color:"#7F8383"}),!0;this.oneToOne.css({color:"#ffffff"});return!1},loadImg:function(a){var b=this,c=new Image;c.onload=function(){c.onload=c.onerror=null;var a=this.width,e=this.height,f=b.selectWidthAdHeight(a,e);b.outerBoxImg.removeClass("fliphtml5-loading");b.boxImgDiv.css({width:f.width,height:f.height});b.innerBoxImg.css({width:Math.max(b.innerLimitWidth,f.width),height:Math.max(b.innerLimitHeight,f.height),left:Math.max(0,
(b.outerBoxImg.width()-Math.max(b.innerLimitWidth,f.width))/2),top:-Math.max(b.innerLimitHeight,f.height)-240});b.innerBoxImg.show().animate({top:Math.max(0,(b.outerBoxImg.height()-Math.max(b.innerLimitHeight,f.height))/2)},{duration:500,easing:"linear"});b.boxImgDiv.css({width:f.width,height:f.height,left:Math.max(0,(b.innerBoxImg.width()-f.width)/2),top:Math.max(0,(b.innerBoxImg.height()-f.height)/2)});b.originalSize={width:a,height:e};b.result=f;b.isOneToOneFalg=b.isOneToOne();isTouch?b.zoomInPad():
b.mouseZoom();b.setMapImg(a,e)};c.onerror=function(){c.onload=c.onerror=null;b.outerBoxImg.removeClass("fliphtml5-loading");var a=b.selectWidthAdHeight(18,20);b.boxImgDiv.css({width:a.width,height:a.height});b.innerBoxImg.css({width:Math.max(b.innerLimitWidth,a.width),height:Math.max(b.innerLimitHeight,a.height),left:Math.max(0,(b.outerBoxImg.width()-Math.max(b.innerLimitWidth,a.width))/2),top:-Math.max(b.innerLimitHeight,a.height)-240});b.innerBoxImg.show().animate({top:Math.max(0,(b.outerBoxImg.height()-
Math.max(b.innerLimitHeight,a.height))/2)},{duration:500,easing:"linear"});b.boxImgDiv.css({width:a.width,height:a.height,left:Math.max(0,(b.innerBoxImg.width()-a.width)/2),top:Math.max(0,(b.innerBoxImg.height()-a.height)/2)});b.originalSize={width:18,height:20};b.result=a;b.isOneToOneFalg=b.isOneToOne();isTouch?b.zoomInPad():b.mouseZoom();b.setMapImg(18,20)};c.src=a;b.boxImg.attr("src",a);b.mapImg.attr("src",a)},selectWidthAdHeight:function(a,b){var c={},d=a/b,e=this.limitWidth,f=this.limitHeight;
e>=a&&f<b?(c.width=d*f,c.height=f):e<a&&f>=b?(c.width=e,c.height=e/d):e<a&&f<b?e/d<=f?(c.width=e,c.height=e/d):d*f<=e?(c.width=d*f,c.height=f):console.log("Do not be so wonderful picture of uncle!"):(c.width=a,c.height=b);return c},dragDiv:function(){var a=this,b=a.innerBoxImg,c=$(document),d=!0,e,f,g,h;a.innerBoxImg.bind(_event._down,function(a){a=isTouch?a.originalEvent.touches:[a];1==a.length?d=!0:2<=a.length&&(d=!1);stopEvent(a[0])});b.bind(_event._down,function(j){a.dragDivFalg&&(j=isTouch?j.originalEvent.touches[0]:
j,isTouch||(j.preventDefault(),j.stopPropagation()),e=b[0].offsetLeft,f=b[0].offsetTop,g=j.clientX,h=j.clientY,c.bind(_event._move,function(a){if(d){a=isTouch?a.originalEvent.touches[0]:a;if(!isTouch){a.preventDefault();a.stopPropagation()}b.css({left:e+a.clientX-g,top:f+a.clientY-h})}}),c.bind(_event._end,function(a){a=isTouch?a.originalEvent.touches[0]:a;if(!isTouch){a.preventDefault();a.stopPropagation()}d=true;c.unbind(_event._move)}))})},mouseZoom:function(){var a=this,b=a.scale,c=a.result,d=
c.width,e=c.height;a.innerBoxImg.bind($.browser.mozilla?"DOMMouseScroll":"mousewheel",function(c){b=a.scale;c=c.originalEvent;c=c.wheelDelta||-c.detail;0<c?b+=0.2*b:0>c&&(b-=0.17*b);5>b?b=5:1600<b&&(b=1600);var g,h,j;h=a.boxImgDiv.width();j=a.boxImgDiv.height();var c=d*b/100,k=e*b/100;c<a.innerBoxImg.width()?g=(a.innerBoxImg.width()-d*b/100)/2:(g=parseInt(a.boxImgDiv.css("left")),g+=(h-c)/2,0<=g?g=0:g<=a.innerBoxImg.width()-c&&(g=a.innerBoxImg.width()-c));k<a.innerBoxImg.height()?j=(a.innerBoxImg.height()-
e*b/100)/2:(h=parseInt(a.boxImgDiv.css("top")),j=h+(j-k)/2,0<=j?j=0:j<=a.innerBoxImg.height()-k&&(j=a.innerBoxImg.height()-k));a.scale=b;a.boxImgDiv.animate({width:c,height:k,left:g,top:j},{duration:100,easing:"linear",complete:function(){a.isOneToOneFalg=a.isOneToOne();a.isMapShowFalg=a.isShowMap();a.setMapPoint();if(a.isFullFalg){a.dragDivFalg=false;a.dragImgFalg=a.boxImgDiv.width()>a.innerBoxImg.width()||a.boxImgDiv.height()>a.innerBoxImg.height()?true:false}else if(a.boxImgDiv.width()>a.innerBoxImg.width()||
a.boxImgDiv.height()>a.innerBoxImg.height()){a.dragDivFalg=false;a.dragImgFalg=true}else{a.dragDivFalg=true;a.dragImgFalg=false}}})})},zoomInPad:function(){var a=this,b=a.result,c=b.width,d=b.height,e,f,g,h,j,k=!1;a.boxImgDiv[0].addEventListener("touchstart",function(b){if(2<=b.touches.length){k=!0;var c=b.touches[0].pageX,d=b.touches[0].pageY,o=b.touches[1].pageX,b=b.touches[1].pageY;e=a.boxImgDiv.position().left;f=a.boxImgDiv.position().top;g=a.boxImgDiv.width();h=a.boxImgDiv.height();j=Math.sqrt(Math.pow(o-
c,2)+Math.pow(b-d,2))}},!1);document.addEventListener("touchmove",function(b){if(k&&2<=b.touches.length){var l,n;l=b.touches[0].pageX;n=b.touches[0].pageY;l=Math.sqrt(Math.pow(b.touches[1].pageX-l,2)+Math.pow(b.touches[1].pageY-n,2))/j;b=g*l;l*=h;n=(g-b)/2+e;var o=(h-l)/2+f;b<a.innerBoxImg.width()?n=(a.innerBoxImg.width()-b)/2:0<=n?n=0:n<=a.innerBoxImg.width()-b&&(n=a.innerBoxImg.width()-b);l<a.innerBoxImg.height()?o=(a.innerBoxImg.height()-l)/2:0<=o?o=0:o<=a.innerBoxImg.height()-l&&(o=a.innerBoxImg.height()-
l);a.boxImgDiv.width(b).height(l).css({left:n,top:o});a.isOneToOneFalg=a.isOneToOne();a.isMapShowFalg=a.isShowMap();a.setMapPoint();a.boxImgDiv.width()>c||a.boxImgDiv.height()>d?(a.dragDivFalg=!1,a.dragImgFalg=!0):(a.dragDivFalg=!0,a.dragImgFalg=!1)}},!1);document.addEventListener("touchend",function(){k=!1},!1);document.body.addEventListener("touchmove",function(){},!1)},dragImage:function(){var a=this,b=a.boxImgDiv,c=$(document),d=!0,e,f,g,h;a.innerBoxImg.bind(_event._down,function(a){a=isTouch?
a.originalEvent.touches:[a];1==a.length?d=!0:2<=a.length&&(d=!1);stopEvent(a[0])});b.bind(_event._down,function(j){a.dragImgFalg&&(j=isTouch?j.originalEvent.touches[0]:j,b.addClass("dragging"),e=b[0].offsetLeft,f=b[0].offsetTop,g=j.clientX,h=j.clientY,c.bind(_event._move,function(c){c=isTouch?c.originalEvent.touches[0]:c;if(d){var j=e+c.clientX-g,c=f+c.clientY-h;0<=j?j=0:j<=a.innerBoxImg.width()-a.boxImgDiv.width()&&(j=a.innerBoxImg.width()-a.boxImgDiv.width());0<=c?c=0:c<=a.innerBoxImg.height()-
a.boxImgDiv.height()&&(c=a.innerBoxImg.height()-a.boxImgDiv.height());b.width()>a.innerBoxImg.width()&&(b.css({left:j}),a.mapPoint.css({left:-j/(a.boxImgDiv.width()-a.innerBoxImg.width())*(a.mapDiv.width()-a.mapPoint.outerWidth())}));b.height()>a.innerBoxImg.height()&&(b.css({top:c}),a.mapPoint.css({top:-c/(a.boxImgDiv.height()-a.innerBoxImg.height())*(a.mapDiv.height()-a.mapPoint.outerHeight())}))}}),c.bind(_event._end,function(){c.unbind(_event._move);b.removeClass("dragging");d=!0}))})},resize:function(){var a=
this.$container.width(),b=this.$container.height();this.boxImgBG.css({width:a,height:b});this.outerBoxImg.css({width:a,height:b});this.isFullFalg?(this.innerBoxImg.css({width:a,height:b}),this.boxImgDiv.css({left:(a-this.boxImgDiv.width())/2,top:(b-this.boxImgDiv.height())/2}),this.setMapPoint()):this.innerBoxImg.css({left:(a-this.innerBoxImg.width())/2,top:(b-this.innerBoxImg.height())/2})},destroy:function(){var a=this,b=parseInt(a.innerBoxImg.css("left")),c=parseInt(a.innerBoxImg.css("top")),d=
a.innerBoxImg.width(),e=a.innerBoxImg.height();a.innerBoxImg.animate({height:0,width:0},{duration:400,easing:"linear",step:function(f,g){"height"==g.prop&&a.innerBoxImg.css({top:c+(e-f)/2});"width"==g.prop&&a.innerBoxImg.css({left:b+(d-f)/2})},complete:function(){a.boxImgBG.remove();a.outerBoxImg.remove()}})},createImgMap:function(a){this.map=$("<div class='ImageMap' style='position: absolute;left: auto;top: auto;right: 2px;bottom: 2px;width: 210px;height: 130px;overflow: hidden;border-radius: 4px;'></div>").css({boxShadow:"inset 1px 1px 0 rgba(0,0,0,.1),inset 0 -1px 0 rgba(0,0,0,.07)",
backgroundColor:"rgba(0,0,0,.6)"}).hide().appendTo(a);this.mapDiv=$("<div style='position: absolute;margin: 0px;padding: 0px;border: 0px;overflow: hidden;'></div>").appendTo(this.map);this.mapImg=$("<img style='position: absolute;width: 100%;height: 100%;left: 0px;top: 0px;padding: 0px;margin: 0px;border: 0px;'/>").appendTo(this.mapDiv);this.mapPoint=$("<div style='position: absolute;margin: 0px;padding: 0px;border: 2px solid #58AA38;width: 100%;height: 100%;'></div>").css({boxShadow:"inset 1px 1px 0 #ffffff,inset 0 -1px 0 #ffffff,inset -1px 0px 0 #ffffff"}).appendTo(this.mapDiv);
this.closeMap=$("<div style='position: absolute;left: auto;top: 0px;right: 0px;'></div>").append($("<img>",{src:this.address+"closeForm.png"})).appendTo(this.map);this.bindCloseMapEvent();this.dragMapPoint()},bindCloseMapEvent:function(){var a=this;a.closeMap.bind("mouseover",function(){a.closeMap.children("img").attr("src",a.address+"closeForm_down.png")});a.closeMap.bind("mouseout",function(){a.closeMap.children("img").attr("src",a.address+"closeForm.png")});a.closeMap.bind("click",function(){a.destroyMap()})},
setMapImg:function(a,b){var c=this.map.width(),d=this.map.height(),e=a/b,f=d*e,g=c/e,h,j,k,m;f>c?(h=c,j=g,k=0,m=(d-g)/2):g>d?(h=f,j=d,k=(c-f)/2,m=0):f/g==e&&(h=f,j=g,m=k=0);this.mapDiv.css({width:h,height:j,left:k,top:m})},setMapPoint:function(){var a=Math.min(this.mapDiv.width(),this.innerBoxImg.width()*this.mapDiv.width()/this.boxImgDiv.width())-4,b=Math.min(this.mapDiv.height(),this.innerBoxImg.height()*this.mapDiv.height()/this.boxImgDiv.height())-4,c=-parseInt(this.boxImgDiv.css("left"))/(this.boxImgDiv.width()-
this.innerBoxImg.width())*(this.mapDiv.width()-(a+4)),d=-parseInt(this.boxImgDiv.css("top"))/(this.boxImgDiv.height()-this.innerBoxImg.height())*(this.mapDiv.height()-(b+4));this.mapPoint.css({left:c,top:d,width:a,height:b})},isShowMap:function(){if(this.innerBoxImg.width()>=this.boxImgDiv.width()&&this.innerBoxImg.height()>=this.boxImgDiv.height())return this.map.hide(),!0;this.map.show();return!1},dragMapPoint:function(){var a=this,b=a.mapPoint,c=$(document),d,e,f,g;b.bind(_event._down,function(h){h=
isTouch?h.originalEvent.touches[0]:h;d=b[0].offsetLeft;e=b[0].offsetTop;f=h.clientX;g=h.clientY;c.bind(_event._move,function(c){var c=isTouch?c.originalEvent.touches[0]:c,h=d+c.clientX-f,c=e+c.clientY-g;0>=h?h=0:h>=a.mapDiv.width()-a.mapPoint.outerWidth()&&(h=a.mapDiv.width()-a.mapPoint.outerWidth());0>=c?c=0:c>=a.mapDiv.height()-a.mapPoint.outerHeight()&&(c=a.mapDiv.height()-a.mapPoint.outerHeight());b.width()<a.mapDiv.width()&&(b.css({left:h}),a.boxImgDiv.css({left:-h/(a.mapDiv.width()-a.mapPoint.outerWidth())*
(a.boxImgDiv.width()-a.innerBoxImg.width())}));b.height()<a.mapDiv.height()&&(b.css({top:c}),a.boxImgDiv.css({top:-c/(a.mapDiv.height()-a.mapPoint.outerHeight())*(a.boxImgDiv.height()-a.innerBoxImg.height())}))});c.bind(_event._end,function(){c.unbind(_event._move)})})},destroyMap:function(){var a=this,b=parseInt(a.map.css("right")),c=parseInt(a.map.css("bottom")),d=a.map.width(),e=a.map.height();a.map.animate({width:0,height:0,right:d/2,bottom:e/2},{duration:400,easing:"linear",step:function(f,g){"height"==
g.prop&&a.map.css({bottom:c+(e-f)/2});"width"==g.prop&&a.map.css({right:b+(d-f)/2})},complete:function(){a.map.remove()}})}});function initArrow(a,b,c,d,e){this.config=$.extend({StartX:0,StartY:0,EndX:100,EndY:100,width:200,height:20,x:0,y:0,alpha:1,lineWidth:1,lineType:null,dotWidth:3,color:null,arrowType:null,sh:"false",sx:4,sy:4,se:2,sr:null},b);this.pw=c;this.ph=d;this.color=colorTo0x(this.config.color);this.bstyle="Solid line"==this.config.lineType?"solid":"dashed";this.width=this.config.width*this.pw;this.height=this.config.height*this.ph;this.x=this.config.x*this.pw;this.y=this.config.y*this.ph;this.id="arrow"+e;
this.x1=this.x-10;this.y1=this.y-10;0>this.x-10&&(this.x1=0);0>this.y-10&&(this.y1=0);this.arrow=$("<canvas id="+this.id+" width="+(this.width+20)+" height="+(this.height+20)+" style='position: absolute;top:"+this.y1+"px;left:"+this.x1+"px'></canvas>");a.append(this.arrow);this.arrowcan(this.x,this.y,this.config.StartX,this.config.StartY,this.config.EndX,this.config.EndY,this.width,this.height,this.config.lineWidth,this.config.dotWidth,this.color,this.config.alpha,this.bstyle,this.config.sx,this.config.sy,
this.config.se,this.config.sr,this.config.sh)}initArrow.prototype.onResize=function(a,b){this.pw=a;this.ph=b;this.width=this.config.width*this.pw;this.height=this.config.height*this.ph;this.arrow.css({width:this.width+20+"px",height:this.height+20+"px"});this.setPosition()};initArrow.prototype.setPosition=function(){this.x=this.config.x*this.pw-10;this.y=this.config.y*this.ph-10;this.arrow.css({left:this.x+"px",top:this.y+"px"})};
initArrow.prototype.arrowcan=function(a,b,c,d,e,f,g,h,j,k,m,l,n,o,p,q,s,v){var t=b=a=0,r=0,u=0,w=this.arrow[0].getContext("2d"),k=parseFloat(k);w.clearRect(0,0,this.pw,this.ph);w.save();w.lineWidth=j;w.globalAlpha=l;w.strokeStyle=m;"false"!=v&&(w.shadowOffsetX=o,w.shadowOffsetY=p,w.shadowBlur=q,w.shadowColor=colorTo0x(s));0==c&&0==d?(u=r=10,a=g+10,b=h+10):0==c&&0!=d?(r=10,u=10+h,a=g+10,b=10):0!=c&&0==d?(r=10+g,a=u=10,b=h+10):(r=10+g,u=10+h,b=a=10);w.translate(0,0);w.beginPath();w.moveTo(r,u);"Double Arrow"==
this.config.arrowType&&(0==f-d?e>c?w.moveTo(r+5,u):w.moveTo(r-5,u):0==e-c&&(f>d?w.moveTo(r,u+5):w.moveTo(r,u-5)));if("solid"==n)0==f-d?e>c?w.lineTo(a-5,b):w.lineTo(a+5,b):0==e-c?f>d?w.lineTo(a,b-5):w.lineTo(a,b+5):w.lineTo(a,b);else{g=0;n=k+2;h=r;l=u;n=(0==f-d?e>c?(a-r)/n:(r-a)/n:0==e-c?f>d?(b-u)/n:(u-b)/n:d<f&&c<e?a-r>b-u?(a-r)/n:(b-u)/n:d>f&&c<e?a-r>u-b?(a-r)/n:(u-b)/n:d<f&&c>e?r-a>b-u?(r-a)/n:(b-u)/n:r-a>u-b?(r-b)/n:(u-b)/n)-1;for(i=0;i<n;i++)(w.moveTo(h,l),0==f-d?h=e>c?h+k:h-k:0==e-c?l=f>d?l+
k:l-k:d<f&&c<e?a-r>b-u?(g=Math.abs((b-u)/(a-r)),h+=k,l+=k*g):(g=Math.abs((a-r)/(b-u)),h+=k*g,l+=k):d>f&&c<e?a-r>u-b?(g=Math.abs((b-u)/(a-r)),h+=k,l-=k*g):(g=Math.abs((a-r)/(b-u)),h+=k*g,l-=k):d<f&&c>e?r-a>b-u?(g=Math.abs((b-u)/(a-r)),h-=k,l+=k*g):(g=Math.abs((a-r)/(b-u)),h-=k*g,l+=k):r-a>u-b?(g=Math.abs((b-u)/(a-r)),h-=k,l-=k*g):(g=Math.abs((a-r)/(b-u)),h-=k*g,l-=k),w.lineTo(h,l),0==f-d)?h=e>c?h+2:h-2:0==e-c?l=f>d?l+2:l-2:d<f&&c<e?a-r>b-u?(h+=2,l+=2*g):(h+=2*g,l+=2):d>f&&c<e?a-r>u-b?(h+=2,l-=2*g):
(h+=2*g,l-=2):d<f&&c>e?r-a>b-u?(h-=2,l+=2*g):(h-=2*g,l+=2):r-a>u-b?(h-=2,l-=2*g):(h-=2*g,l-=2)}w.fillStyle=m;w.stroke();w.save();t=2<1*j?15:10;"Double Arrow"==this.config.arrowType&&(w.moveTo(r,u),"Double Arrow"==this.config.arrowType&&(0==f-d?e>c?w.moveTo(r-1,u):w.moveTo(r+1,u):0==e-c&&(f>d?w.moveTo(r,u-1):w.moveTo(r,u+1))),w.translate(r,u),0<=b-u?w.rotate(4.7-Math.atan((a-r)/(b-u))):w.rotate(4.7-(Math.PI+Math.atan((a-r)/(b-u)))),w.lineTo(-t,t-5),w.lineTo(-(t-5),0),w.lineTo(-t,-(t-5)),w.lineTo(0,
0),w.fill(),w.restore());w.moveTo(a,b);w.translate(a,b);0<=b-u?w.rotate(1.5-Math.atan((a-r)/(b-u))):w.rotate(1.5-(Math.PI+Math.atan((a-r)/(b-u))));w.lineTo(-t,t-5);w.lineTo(-(t-5),0);w.lineTo(-t,-(t-5));w.lineTo(0,0);w.fill();w.restore()};function initLine(a,b,c,d,e){this.config=$.extend({StartX:0,StartY:0,EndX:100,EndY:100,width:200,height:20,x:0,y:0,alpha:1,lineAlpha:1,lineWidth:1,lineType:null,dotWidth:3,color:null,sh:"false",sx:4,sy:4,se:2,sr:null},b);this.pw=c;this.ph=d;this.color=colorTo0x(this.config.color);this.bstyle="Solid line"==this.config.lineType?"solid":"dashed";this.width=this.config.width*this.pw;this.height=this.config.height*this.ph;this.x=this.config.x*this.pw;this.y=this.config.y*this.ph;this.id="line"+e;this.x1=
this.x-10;this.y1=this.y-10;0>this.x-10&&(this.x1=0);0>this.y-10&&(this.y1=0);this.line=$("<canvas id="+this.id+" width="+(this.width+20)+" height="+(this.height+20)+" style='position: absolute;top:"+this.y1+"px;left:"+this.x1+"px'></canvas>");a.append(this.line);this.linecan(this.x,this.y,this.config.StartX,this.config.StartY,this.config.EndX,this.config.EndY,this.width,this.height,this.config.lineWidth,this.config.dotWidth,this.color,this.config.lineAlpha,this.bstyle,this.config.sx,this.config.sy,
this.config.se,this.config.sr,this.config.sh)}initLine.prototype.onResize=function(a,b){this.pw=a;this.ph=b;this.width=this.config.width*this.pw;this.height=this.config.height*this.ph;this.line.css({width:this.width+20+"px",height:this.height+20+"px"});this.setPosition()};initLine.prototype.setPosition=function(){this.x=this.config.x*this.pw-10;this.y=this.config.y*this.ph-10;this.line.css({left:this.x+"px",top:this.y+"px"})};
initLine.prototype.linecan=function(a,b,c,d,e,f,g,h,j,k,m,l,n,o,p,q,s,v){var t=b=a=0,r=0,a=this.line[0],u;try{u=a.getContext("2d")}catch(w){return}k=parseFloat(k);0==c&&0==d?(r=t=10,a=g+10,b=h+10):0==c&&0!=d?(t=10,r=10+h,a=g+10,b=10):0!=c&&0==d?(t=10+g,a=r=10,b=h+10):(t=10+g,r=10+h,b=a=10);u.moveTo(t,r);u.lineWidth=j;u.globalAlpha=l;u.strokeStyle=m;"false"!=v&&(u.shadowOffsetX=o,u.shadowOffsetY=p,u.shadowBlur=q,u.shadowColor=colorTo0x(s));if("solid"==n)u.lineTo(a,b);else{g=0;m=k+2;h=t;j=r;num=0==
f-d?e>c?(a-t)/m:(t-a)/m:0==e-c?f>d?(b-r)/m:(r-b)/m:d<f&&c<e?a-t>b-r?(a-t)/m:(b-r)/m:d>f&&c<e?a-t>r-b?(a-t)/m:(r-b)/m:d<f&&c>e?t-a>b-r?(t-a)/m:(b-r)/m:t-a>r-b?(t-b)/m:(r-b)/m;m=num-1;for(i=0;i<m;i++)(u.moveTo(h,j),0==f-d?h=e>c?h+k:h-k:0==e-c?j=f>d?j+k:j-k:d<f&&c<e?a-t>b-r?(g=Math.abs((b-r)/(a-t)),h+=k,j+=k*g):(g=Math.abs((a-t)/(b-r)),h+=k*g,j+=k):d>f&&c<e?a-t>r-b?(g=Math.abs((b-r)/(a-t)),h+=k,j-=k*g):(g=Math.abs((a-t)/(b-r)),h+=k*g,j-=k):d<f&&c>e?t-a>b-r?(g=Math.abs((b-r)/(a-t)),h-=k,j+=k*g):(g=Math.abs((a-
t)/(b-r)),h-=k*g,j+=k):t-a>r-b?(g=Math.abs((b-r)/(a-t)),h-=k,j-=k*g):(g=Math.abs((a-t)/(b-r)),h-=k*g,j-=k),u.lineTo(h,j),0==f-d)?h=e>c?h+2:h-2:0==e-c?j=f>d?j+2:j-2:d<f&&c<e?a-t>b-r?(h+=2,j+=2*g):(h+=2*g,j+=2):d>f&&c<e?a-t>r-b?(h+=2,j-=2*g):(h+=2*g,j-=2):d<f&&c>e?t-a>b-r?(h-=2,j+=2*g):(h-=2*g,j+=2):t-a>r-b?(h-=2,j-=2*g):(h-=2*g,j-=2)}u.stroke()};function initRe(a,b,c,d,e){this.config=$.extend({width:200,height:20,x:0,y:0,alpha:1,fillStyle:null,color:null,ColorA:null,ColorB:null,angle:90,spalpha:1,action:null,borderWidth:1,borderColor:null,borderAlpha:1,sh:"false",sx:4,sy:4,se:2,sr:null,round:!1,roundWidth:0},b);this.pw=c;this.ph=d;this.father=a;this.color=colorTo0x(this.config.color);this.width=this.config.width*this.pw;this.height=this.config.height*this.ph;this.x=this.config.x*this.pw;this.y=this.config.y*this.ph;this.id="re"+e;this.angle=
360-parseInt(this.config.angle);this.A=colorTo0x(this.config.ColorA);this.B=colorTo0x(this.config.ColorB);this.round=b.round;this.roundWidth=Math.ceil(b.roundWidth/2);this.Re=$("<div id="+this.id+" style='overflow: hidden;position:absolute;top:"+this.y+"px;left:"+this.x+"px;border:"+this.config.borderWidth+"px solid "+colorTo0x(this.config.borderColor)+";background:"+this.color+";height:"+this.height+"px;width:"+this.width+"px;opacity:"+this.config.spalpha+"'></div>");"false"!=this.config.sh&&this.Re.css({"box-shadow":this.config.sx+
"px "+this.config.sy+"px "+this.config.se+"px "+colorTo0x(this.config.sr),"-moz-box-shadow":this.config.sx+"px "+this.config.sy+"px "+this.config.se+"px "+colorTo0x(this.config.sr),"-webkit-box-shadow":this.config.sx+"px "+this.config.sy+"px "+this.config.se+"px "+colorTo0x(this.config.sr),"-ms-box-shadow":this.config.sx+"px "+this.config.sy+"px "+this.config.se+"px "+colorTo0x(this.config.sr),"-o-box-shadow":this.config.sx+"px "+this.config.sy+"px "+this.config.se+"px "+colorTo0x(this.config.sr)});
!0==this.round&&this.Re.css({"border-radius":this.roundWidth+"px"});if("gradient"==this.config.fillStyle)switch(b=this.A,c=this.B,this.Re.css({background:"linear-gradient("+this.angle+"deg, "+b+", "+c+")"}),browserType){case 1:this.Re.css({background:"-webkit-linear-gradient("+this.angle+"deg, "+b+", "+c+")"});break;case 2:this.Re.css({background:"-moz-linear-gradient("+this.angle+"deg, "+b+", "+c+")"});break;case 3:this.Re.css({background:"-ms-linear-gradient("+this.angle+"deg, "+b+", "+c+")"});
this.Re.css("filter","progid:DXImageTransform.Microsoft.Gradient( EndColorStr="+c+", StartColorStr="+b+")");break;case 4:this.Re.css({background:"-o-linear-gradient("+this.angle+"deg, "+b+", "+c+")"})}"none"==this.config.fillStyle&&this.Re.css({background:""});this.initEvent();a.append(this.Re)}
initRe.prototype.initEvent=function(){var a=this;this.flag=0;this.linkURL=this.audios=this.slide=this.form=null;if(null!=a.config.action){try{void 0!=this.config.action.length&&(this.config.action=this.config.action[0]),this.linkURL=this.config.action.url}catch(b){}var c;null!=this.linkURL&&"www"==this.linkURL.substr(0,3).toLowerCase()&&(this.linkURL="http://"+this.linkURL);try{c=this.config.action.triggerEventType}catch(d){c=null}this.Re.bind(_event._down,function(){c==PageEditor.TriggerEventType.MouseDown&&
actionEvent.call(a);browserType==3?event.cancelBubble=true:event.stopPropagation()});this.Re.bind("mouseover",function(){c==PageEditor.TriggerEventType.MouseOver&&actionEvent.call(a)});this.Re.bind(isTouch?_event._end:"mouseout",function(){c==PageEditor.TriggerEventType.MouseOut&&actionEvent.call(a)})}};
initRe.prototype.onResize=function(a,b){this.pw=a;this.ph=b;this.width=this.config.width*this.pw;this.height=this.config.height*this.ph;this.Re.css({width:this.width+"px",height:this.height+"px"});this.setPosition();if(null!=this.form)this.form.onResize(bookContainer.width(),bookContainer.height());if(null!=this.slide)this.slide.onResize(bookContainer.width(),bookContainer.height());if(null!=this.audios)this.audios.onResize(bookContainer.width(),bookContainer.height())};
initRe.prototype.setPosition=function(){this.x=this.config.x*this.pw;this.y=this.config.y*this.ph;this.Re.css({left:this.x+"px",top:this.y+"px"})};function initRound(a,b,c,d,e){this.config=$.extend({width:200,height:20,x:0,y:0,alpha:1,fillStyle:null,color:null,ColorA:null,ColorB:null,angle:"false",spalpha:1,action:null,borderWidth:1,borderColor:null,borderAlpha:1,sh:"false",sx:4,sy:4,se:2,sr:null},b);this.pw=c;this.ph=d;this.color=colorTo0x(this.config.color);this.father=a;this.width=this.config.width*this.pw;this.height=this.config.height*this.ph;this.x=this.config.x*this.pw;this.y=this.config.y*this.ph;this.id="round"+e;this.x1=this.x-10;
this.y1=this.y-10;0>this.x-10&&(this.x1=0);0>this.y-10&&(this.y1=0);this.rounds=$("<canvas id="+this.id+" width="+(this.width+20)+" height="+(this.height+20)+" style='position: absolute;top:"+this.y1+"px;left:"+this.x1+"px'></canvas>");this.father=a;this.initEvent();a.append(this.rounds);this.roundcan(this.x,this.y,this.width,this.height,this.color,this.config.fillStyle,this.config.ColorA,this.config.ColorB,this.config.alpha,this.config.borderWidth,this.config.spalpha,this.config.borderColor,this.config.borderAlpha,
this.config.sx,this.config.sy,this.config.se,this.config.sr,this.config.sh,360-parseInt(this.config.angle))}
initRound.prototype.initEvent=function(){var a=this;this.flag=0;this.audios=this.slide=this.form=null;this.linkURL;if(null!=a.config.action){try{void 0!=this.config.action.length&&(this.config.action=this.config.action[0]),this.linkURL=this.config.action.url}catch(b){}var c;null!=this.linkURL&&"www"==this.linkURL.substr(0,3).toLowerCase()&&(this.linkURL="http://"+this.linkURL);try{c=this.config.action.triggerEventType}catch(d){c=null}this.rounds.bind(_event._down,function(){c==PageEditor.TriggerEventType.MouseDown&&
actionEvent.call(a);browserType==3?event.cancelBubble=true:event.stopPropagation()});this.rounds.bind("mouseover",function(){c==PageEditor.TriggerEventType.MouseOver&&actionEvent.call(a)});this.rounds.bind(isTouch?_event._end:"mouseout",function(){c==PageEditor.TriggerEventType.MouseOut&&actionEvent.call(a)})}};
initRound.prototype.onResize=function(a,b){this.pw=a;this.ph=b;this.width=this.config.width*this.pw;this.height=this.config.height*this.ph;this.rounds.css({width:this.width+20+"px",height:this.height+20+"px"});this.setPosition();if(null!=this.form)this.form.onResize(bookContainer.width(),bookContainer.height());if(null!=this.slide)this.slide.onResize(bookContainer.width(),bookContainer.height());if(null!=this.audios)this.audios.onResize(bookContainer.width(),bookContainer.height())};
initRound.prototype.setPosition=function(){this.x=this.config.x*this.pw-10;this.y=this.config.y*this.ph-10;this.rounds.css({left:this.x+"px",top:this.y+"px"})};
initRound.prototype.roundcan=function(a,b,c,d,e,f,g,h,j,k,m,l,n,o,p,q,s,v,t){a=j=0;try{var r=this.rounds[0].getContext("2d")}catch(u){return}b=[c/2+10,d/2+10];j=c/2;a=d/2;r.save();r.beginPath();r.strokeStyle=colorTo0x(l);r.lineWidth=k;r.globalAlpha=m;"false"!=v&&(r.shadowOffsetX=o,r.shadowOffsetY=p,r.shadowBlur=q,r.shadowColor=colorTo0x(s));r.closePath();r.stroke();DrawEllipse(r,b,j,a);"gradient"==f&&(d=t*Math.PI/180,c=b[0]+j*Math.cos(d),d=b[1]+a*Math.sin(d),t=(t+180)*Math.PI/180,m=b[0]+j*Math.cos(t),
t=b[1]+a*Math.sin(t),t=r.createLinearGradient(c,d,m,t),t.addColorStop(0,colorTo0x(g)),t.addColorStop(1,colorTo0x(h)),r.fillStyle=t,r.fill());"none"==f&&(r.fillStyle=e,r.fill());0!=k&&r.stroke();r.closePath()};function DrawEllipse(a,b,c,d){var e=b[0]+c,f=b[1];a.moveTo(e,f);for(var g=0;360>=g;g++)f=g*Math.PI/180,e=b[0]+c*Math.cos(f),f=b[1]-d*Math.sin(f),a.lineTo(e,f)};function initText(a,b,c,d,e){this.config=$.extend({width:200,height:20,x:0,y:0,alpha:1,textStr:null,lineH:20,fontName:null,fontSize:12,color:null,tbold:"false",italic:"false",bgalpha:1,action:null,fillBg:"false",bgcolor:null,sh:"false",sx:4,sy:4,se:2,sr:null},b);this.pw=c;this.ph=d;this.originWidth=bookConfig.largePageWidth;this.originHeight=bookConfig.largePageHeight;null!=this.config.color&&(this.color=colorTo0x(this.config.color));this.father=a;this.width=this.config.width*this.originWidth;this.height=
this.config.height*this.originHeight;this.x=this.config.x*this.pw;this.y=this.config.y*this.ph;this.id="text"+e;this.pageH=this.config.pageH;b=new TextFormatAnalyzer(this.config.textStr);this.config.fontSize=b.getFontSize();this.config.color=b.getFontColor();this.color=colorTo0x(this.config.color);this.text=$("<div id="+this.id+" style='overflow: hidden;position:absolute;left:"+this.x+"px; top:"+this.y+"px;height:"+this.height+"px;width:"+this.width+"px;opacity:"+this.config.bgalpha+"'></div>");this.fontSize=
0.75*this.config.lineH*this.originHeight;this.text.append("<div style='word-break: break-word;font-family:"+this.config.fontName+";font-size:"+this.fontSize+"px;color:"+this.color+";'></div>");this.text.css({color:this.color});c="";this.textLine=b.getLines();for(d=0;d<this.textLine.length;d++)c=0<d?c+"<br>"+this.textLine[d]+"</br>":c+this.textLine[d];this.text.html(c);c=this.text.children("div:first");b.initFont(c);c.css({"margin-left":b.getLeftMargin()+"px","margin-right":b.getRightMargin()+"px",
"text-align":b.getAlign()});"false"!=this.config.sh&&this.text.css({"box-shadow":this.config.sx+"px "+this.config.sy+"px "+this.config.se+"px "+colorTo0x(this.config.sr),"-moz-box-shadow":this.config.sx+"px "+this.config.sy+"px "+this.config.se+"px "+colorTo0x(this.config.sr),"-webkit-box-shadow":this.config.sx+"px "+this.config.sy+"px "+this.config.se+"px "+colorTo0x(this.config.sr),"-ms-box-shadow":this.config.sx+"px "+this.config.sy+"px "+this.config.se+"px "+colorTo0x(this.config.sr),"-o-box-shadow":this.config.sx+
"px "+this.config.sy+"px "+this.config.se+"px "+colorTo0x(this.config.sr)});"false"==this.config.fillBg?this.text.css({background:""}):null!=this.config.bgcolor&&this.text.css({background:colorTo0x(this.config.bgcolor)});"false"!=this.config.tbold&&c.css({"font-weight":"bold"});"false"!=this.config.italic&&c.css({"font-style":"italic"});this.father=a;this.initEvent();a.append(this.text);this.fontSize=0.75*this.config.lineH*this.originHeight;this.text.css("font-size",this.fontSize+"px");this.resizeText(this.pw,
this.ph)}
initText.prototype.initEvent=function(){var a=this;this.flag=0;this.linkURL=this.audios=this.slide=this.form=null;if(null!=a.config.action){try{void 0!=this.config.action.length&&(this.config.action=this.config.action[0]),this.linkURL=this.config.action.url}catch(b){}var c;null!=this.linkURL&&"www"==this.linkURL.substr(0,3).toLowerCase()&&(this.linkURL="http://"+this.linkURL);try{c=this.config.action.triggerEventType}catch(d){c=null}this.text.bind(_event._down,function(){c==PageEditor.TriggerEventType.MouseDown&&actionEvent.call(a);
browserType==3?event.cancelBubble=true:event.stopPropagation()});this.text.bind("mouseover",function(){c==PageEditor.TriggerEventType.MouseOver&&actionEvent.call(a);browserType==3?event.cancelBubble=true:event.stopPropagation()});this.text.bind(isTouch?_event._end:"mouseout",function(){c==PageEditor.TriggerEventType.MouseOut&&actionEvent.call(a)})}};
initText.prototype.onResize=function(a,b){this.pw=a;this.ph=b;this.setPosition();if(null!=this.form)this.form.onResize(bookContainer.width(),bookContainer.height());if(null!=this.slide)this.slide.onResize(bookContainer.width(),bookContainer.height());if(null!=this.audios)this.audios.onResize(bookContainer.width(),bookContainer.height());this.text.css("font-size",this.fontSize+"px");this.resizeText(this.pw,this.ph)};
initText.prototype.resizeText=function(a,b){var c=b/this.originHeight;this.text.css({"-webkit-transform-origin":"0% 0%","-moz-transform-origin":"0% 0%","-ms-transform-origin":"0% 0%","-o-transform-origin":"0% 0%","-webkit-transform":"scale("+c+")","-moz-transform":"scale("+c+")","-ms-transform":"scale("+c+")","-o-transform":"scale("+c+")"})};initText.prototype.setPosition=function(){this.x=this.config.x*this.pw;this.y=this.config.y*this.ph;this.text.css({left:this.x+"px",top:this.y+"px"})};
function TextFormatAnalyzer(a){this.originalFormat=a;null!=a&&(this.analyzedText=a.toLowerCase().replaceAll('"',""))}
TextFormatAnalyzer.prototype={getAlign:function(){return this.analyzedText.subBetween("align=",">").trim()},getLeftMargin:function(){var a=this.analyzedText.subBetween("leftmargin="," ").trim();return""==a?0:parseInt(a)},getRightMargin:function(){var a=this.analyzedText.subBetween("rightmargin="," ").trim();return""==a?0:parseInt(a)},getFontFamily:function(){var a=this.analyzedText.subBetween("face="," ").trim();""==a&&(a="Arial");return a},getFontColor:function(){var a=this.analyzedText.subBetween("color=",
" ").trim();""==a&&(a="#000000");return a},getFontSize:function(){var a=this.analyzedText.subBetween("size="," ").trim();""==a&&(a="16");return a},getLetterSpace:function(){var a=this.analyzedText.subBetween("letterspacing="," ").trim();""==a&&(a="0");return a},initFont:function(a){var b=this.getFontFamily(),c=this.getFontColor(),d=this.getFontSize(),e=this.getLetterSpace();a.css({"font-family":b,color:c,"font-size":d+"px","letter-spacing":e+"px"})},getText:function(){for(var a=[],a=[],b=loadXMLString("<xml>"+
this.originalFormat+"</xml>").getElementsByTagName("TEXTFORMAT"),c=0;c<b.length;c++)if(null!=b[c].getElementsByTagName("FONT")[0].firstChild){var d=b[c].getElementsByTagName("FONT")[0].firstChild.nodeValue;b[c].getElementsByTagName("P");null==d&&(d=b[c].getElementsByTagName("B")[0].firstChild.nodeValue);null==d&&(d=b[c].getElementsByTagName("I")[0].firstChild.nodeValue);null==d&&(d=b[c].getElementsByTagName("U")[0].firstChild.nodeValue);null!=d&&a.push(d)}b="";for(c=0;c<a.length;c++)b=b+"<br>"+a[c]+
"</br>";return b},getTextLines:function(){for(var a=[],a=[],b=loadXMLString("<xml>"+this.originalFormat+"</xml>").getElementsByTagName("P"),c=0;c<b.length;c++)if(null!=b[c].getElementsByTagName("FONT")[0].firstChild){var d=b[c].getElementsByTagName("FONT")[0].firstChild.nodeValue;null==d&&(d=b[c].getElementsByTagName("B")[0].firstChild.nodeValue);null==d&&(d=b[c].getElementsByTagName("I")[0].firstChild.nodeValue);null==d&&(d=b[c].getElementsByTagName("U")[0].firstChild.nodeValue);null!=d&&a.push(d)}b=
"";for(c=0;c<a.length;c++)b=b+"<br>"+a[c]+"</br>";return b},getLines:function(){for(var a=[],a=[],b=loadXMLString("<xml>"+this.originalFormat+"</xml>").getElementsByTagName("TEXTFORMAT"),c=0;c<b.length;c++)if(null!=b[c].getElementsByTagName("FONT")[0].firstChild){var d=b[c].getElementsByTagName("FONT")[0].firstChild.nodeValue;b[c].getElementsByTagName("P");null==d&&(d=b[c].getElementsByTagName("B")[0].firstChild.nodeValue);null==d&&(d=b[c].getElementsByTagName("I")[0].firstChild.nodeValue);null==
d&&(d=b[c].getElementsByTagName("U")[0].firstChild.nodeValue);null!=d&&a.push(d)}return a}};function initButton(a,b,c,d){this.config=$.extend({width:0.2,height:0.2,x:0.2,y:0.2,alpha:1,src:null},b);this.pw=c;this.ph=d;this.width=c*this.config.width;this.height=d*this.config.height;this.button=null;var b=[],e=this,b="button_watermark01.swf,button_watermark02.swf,button_watermark03.swf,button_watermark04.swf,button_watermark05.swf,button_watermark06.swf,button_watermark07.swf,button_watermark08.swf,button_watermark09.swf,button_glossy01.swf,button_glossy02.swf,button_glossy03.swf,button_glossy04.swf,button_glossy05.swf,button_glossy06.swf,button_glossy07.swf,button_glossy08.swf,button_glossy09.swf,button_glossy10.swf,button_glossy11.swf,button_glossy12.swf,button_glossy13.swf,button_glossy14.swf,button_glossy15.swf,button_glossy16.swf,button_glossy17.swf,button_push01.swf,button_push02.swf,button_push03.swf,button_push04.swf,button_push05.swf,button_push06.swf,button_lineLight01.swf,button_lineLight02.swf,button_lineLight03.swf,button_lineLight04.swf,button_lineLight05.swf,button_star01.swf,button_star02.swf,button_star03.swf,button_star04.swf,button_star05.swf,button_glitter01.swf,button_glitter02.swf,button_glitter03.swf,button_glitter04.swf,button_glitter05.swf,button_glitter06.swf,button_shadow01.swf,button_shadow02.swf,button_shadow03.swf,button_shadow04.swf,button_shadow05.swf,button_shadow06.swf,button_bottomLight01.swf,button_bottomLight02.swf,button_bottomLight03.swf,button_bottomLight04.swf,button_bottomLight05.swf,button_bottomLight06.swf,button_bottomLight07.swf,button_bottomLight08.swf,button_bottomLight09.swf,button_bottomLight10.swf,button_other01.swf,button_other02.swf,button_other03.swf".split(",");
null==this.config.src||"null"==this.config.src?this.button=$("<button type = 'button'></button>"):(!0==isFlipPdf&&(this.config.src="."+this.config.src),c=this.config.src.substring(this.config.src.lastIndexOf("/")+1,this.config.src.length),this.swfButton=0<=b.indexOf(c))?(this.config.Format.color=colorTo0x(this.config.Format.color),this.button=$("<div></div>"),this.buttonEvt=$("<div></div>"),isTouchDevice()?(this.button.css({"-webkit-border-radius":"8px","-moz-border-radius":"5px","border-radius":"8px",
"background-image":getBrowserPre()+"linear-gradient(top,rgba(185,185,185,1) 0%, rgba(122,122,122,1) 45%, rgba(80, 80, 80, 1) 46%, rgba(53,53,53,1) 100%)","-webkit-box-shadow":"0 0 10px rgba(40, 40, 40, 0.7)","-moz-box-shadow":"0 0 10px rgba(40, 40, 40, 0.7)","-o-box-shadow":"0 0 10px rgba(40, 40, 40, 0.7)","-ms-box-shadow":"0 0 10px rgba(40, 40, 40, 0.7)","box-shadow":"0 0 10px rgba(40, 40, 40, 0.7)"}),this.buttonEvt.css({"-webkit-border-radius":"8px","-moz-border-radius":"5px","border-radius":"8px",
"background-color":"#333333",opacity:0.2,display:"none",width:this.width+"px",height:this.height+"px"})):(this.button.flash({swf:this.config.src,width:this.width+"px",height:this.height+"px",wmode:"transparent"}),this.buttonEvt.css({display:"none",width:this.width+"px",height:this.height+"px"})),this.buttonCaption=new label(this.config.buttonCaption,this.button),this.buttonCaption.setFont(1*this.config.HRate*this.ph/2,bookConfig.iconColor,this.config.Format.font),this.buttonCaption.setLabelPosition(this.buttonCaption.getWidth()>
this.width?0:(this.width-this.buttonCaption.getWidth())/2,this.config.captionY*this.height/100),this.button.append(this.buttonEvt),this.button.bind(_event._down,function(){e.buttonEvt.css({display:"block"})}),this.button.bind(_event._end,function(){e.buttonEvt.css({display:"none"})}),this.button.bind("mouseleave",function(){e.buttonEvt.css({display:"none"})})):".swf"==this.config.src.substr(this.config.src.length-4,4)?this.button=$("<div></div>"):(this.button=$("<img />"),this.button.attr({src:this.config.src}));
this.button.css({position:"absolute",width:this.width+"px",height:this.height+"px",left:this.pw*this.config.x+"px",top:this.ph*this.config.y+"px",opacity:this.config.alpha});a.append(this.button);this.father=a;this.initEvt()}
initButton.prototype.onResize=function(a,b){this.pw=a;this.ph=b;this.width=this.config.width*a;this.height=this.config.height*b;this.button.css({width:this.width+"px",height:this.height+"px"});this.setPosition(this.config.x*a,this.config.y*b);if(null!=this.form)this.form.onResize(bookContainer.width(),bookContainer.height());if(null!=this.slide)this.slide.onResize(bookContainer.width(),bookContainer.height());if(null!=this.audios)this.audios.onResize(bookContainer.width(),bookContainer.height());
this.swfButton&&(isTouchDevice()?(this.buttonCaption.setFont(2*this.config.HRate*this.height/3,bookConfig.iconColor,this.config.Format.font),this.buttonCaption.setLabelPosition(this.buttonCaption.getWidth()>this.width?0:(this.width-this.buttonCaption.getWidth())/2,this.config.captionY*this.height/100),this.buttonEvt.css({width:this.width+"px",height:this.height+"px"})):(this.hide(),this.show()))};initButton.prototype.hide=function(){isTouchDevice()||this.button.html("")};
initButton.prototype.show=function(){var a=this;!isTouchDevice()&&this.swfButton&&(this.buttonEvt=$("<div></div>"),this.button.flash({swf:this.config.src,width:this.width+"px",height:this.height+"px",wmode:"transparent"}),this.buttonEvt.css({display:"none",width:this.width+"px",height:this.height+"px"}),this.buttonCaption=new label(this.config.buttonCaption,this.button),this.buttonCaption.setFont(1*this.config.HRate*this.ph/2,bookConfig.iconColor,this.config.Format.font),this.buttonCaption.setLabelPosition(this.buttonCaption.getWidth()>
this.width?0:(this.width-this.buttonCaption.getWidth())/2,this.config.captionY*this.height/100),this.button.append(this.buttonEvt),this.button.bind(_event._down,function(){a.buttonEvt.css({display:"block"})}),this.button.bind(_event._end,function(){a.buttonEvt.css({display:"none"})}),this.button.bind("mouseleave",function(){a.buttonEvt.css({display:"none"})}))};initButton.prototype.setPosition=function(a,b){this.button.css({left:a+"px",top:b+"px"})};
initButton.prototype.initEvt=function(){this.audios=this.slide=this.form=null;if(void 0!=this.config.action){var a=this;this.flag=0;this.linkURL=null;try{void 0!=this.config.action.length&&(this.config.action=this.config.action[0]),this.linkURL=this.config.action.url}catch(b){}var c;null!=this.linkURL&&"www"==this.linkURL.substr(0,3).toLowerCase()&&(this.linkURL="http://"+this.linkURL);try{c=this.config.action.triggerEventType}catch(d){c=null}this.button.bind(_event._down,function(){c==PageEditor.TriggerEventType.MouseDown&&
actionEvent.call(a);browserType==3?event.cancelBubble=true:event.stopPropagation()});this.button.bind("mouseover",function(){c==PageEditor.TriggerEventType.MouseOver&&actionEvent.call(a)});this.button.bind(isTouch?_event._end:"mouseout",function(){c==PageEditor.TriggerEventType.MouseOut&&actionEvent.call(a)})}};function initArea(a,b,c,d,e){this.config=$.extend({width:200,height:20,x:0,y:0,alpha:1,color:null,rounds:"false",ellipseWidth:5,ellipseHeight:5,action:null,sh:"false",sx:4,sy:4,se:2,sr:null},b);this.pw=c;this.ph=d;this.father=a;this.color=colorTo0x(this.config.color);this.width=this.config.width*this.pw;this.height=this.config.height*this.ph;this.x=this.config.x*this.pw;this.y=this.config.y*this.ph;this.id="Area"+e;this.Area="false"!=this.config.sh?$("<div id="+this.id+" style='overflow: hidden;position:absolute;top:"+
this.y+"px;left:"+this.x+"px;background:"+this.color+";height:"+this.height+"px;width:"+this.width+"px;box-shadow:"+this.config.sx+"px "+this.config.sy+"px "+this.config.se+"px "+colorTo0x(this.config.sr)+";opacity:"+this.config.alpha+"'></div>"):$("<div id="+this.id+" style='overflow: hidden;position:absolute;top:"+this.y+"px;left:"+this.x+"px;background:"+this.color+";height:"+this.height+"px;width:"+this.width+"px;opacity:"+this.config.alpha+"'></div>");"false"!=this.config.rounds&&this.Area.css({"border-radius":this.config.ellipseWidth+
"px "+this.config.ellipseHeight+"px"});this.father=a;this.initEvent();a.append(this.Area)}
initArea.prototype.initEvent=function(){var a=this;this.flag=0;this.audios=this.slide=this.form=null;this.linkURL;if(null!=a.config.action){try{void 0!=this.config.action.length&&(this.config.action=this.config.action[0]),this.linkURL=this.config.action.url}catch(b){}var c;null!=this.linkURL&&"www"==this.linkURL.substr(0,3).toLowerCase()&&(this.linkURL="http://"+this.linkURL);try{c=this.config.action.triggerEventType}catch(d){c=null}this.Area.bind(_event._down,function(){c==PageEditor.TriggerEventType.MouseDown&&
actionEvent.call(a);browserType==3?event.cancelBubble=true:event.stopPropagation()});this.Area.bind("mouseover",function(){c==PageEditor.TriggerEventType.MouseOver&&actionEvent.call(a)});this.Area.bind(isTouch?_event._end:"mouseout",function(){c==PageEditor.TriggerEventType.MouseOut&&actionEvent.call(a)})}};
initArea.prototype.onResize=function(a,b){this.pw=a;this.ph=b;this.width=this.config.width*this.pw;this.height=this.config.height*this.ph;this.Area.css({width:this.width+"px",height:this.height+"px"});this.setPosition();if(null!=this.form)this.form.onResize(bookContainer.width(),bookContainer.height());if(null!=this.slide)this.slide.onResize(bookContainer.width(),bookContainer.height());if(null!=this.audios)this.audios.onResize(bookContainer.width(),bookContainer.height())};
initArea.prototype.setPosition=function(){this.x=this.config.x*this.pw;this.y=this.config.y*this.ph;this.Area.css({left:this.x+"px",top:this.y+"px"})};function initVideoForm(a,b,c,d){this.config=$.extend({width:400,height:300,src:null,alpha:0.3,caption:"",closeIconURL:uiBaseURL+"close.png"},b);this.father=a;null!=this.config.src&&(this.config.width=parseInt(this.config.width),this.config.height=parseInt(this.config.height),this.sw=c,this.sh=d,this.th=28,this.background=new grayBackground(a,"#333333",this.config.alpha,c,d),this.form=$("<div></div>"),this.titleBar=$("<div></div>"),!0==isFlipPdf&&(this.config.src="../"+this.config.src),""!=this.config.closeIconURL&&
(this.closeButton=new button(1,this.titleBar,{iconURL:this.config.closeIconURL},!0),this.closeButton.setButtonPosition(this.config.width-28,0)),""!=this.config.caption&&(this.captionLabel=new label(this.config.caption,this.titleBar),this.captionLabel.setLabelPosition(5,3,["left","top"]),this.captionLabel.setFont(14,"#dddddd","Tahoma")),this.video=$("<video src='"+this.config.src+"' controls='controls'></video>"),this.form.css({width:this.config.width+4+"px",height:this.config.height+4+"px",left:(c-
this.config.width)/2+"px",top:(d-this.config.height)/2+"px","background-color":"#dddddd","-webkit-border-radius":"5px","-moz-border-radius":"5px","-ms-border-radius":"5px","border-radius":"5px",position:"absolute","z-index":201}),this.titleBar.css({width:this.config.width+"px",height:this.th+"px",left:"2px",top:"2px","border-top-left-radius":"5px","border-top-right-radius":"5px",position:"absolute","background-color":"#111111"}),this.video.css({width:this.config.width+"px",height:this.config.height-
this.th+"px",top:this.th+2+"px",left:"2px",position:"absolute"}),a.append(this.form),this.form.append(this.titleBar),this.form.append(this.video),this.initEvent())}initVideoForm.prototype.onResize=function(a,b){this.sw=a;this.sh=b;this.background.onResize(a,b);this.setPosition()};initVideoForm.prototype.setPosition=function(){this.form.css({left:(this.sw-this.config.width)/2+"px",top:(this.sh-this.config.height)/2+"px"})};
initVideoForm.prototype.initEvent=function(){var a=this;this.closeButton.onMouseUp(this,this.closeForm);var b=!1,c,d;this.titleBar.bind(_event._down,function(e){e=isTouch?e.originalEvent.touches:[e];b=!0;c=Point(e[0].pageX,e[0].pageY);d=Point(a.form.offset().left,a.form.offset().top);return!1});this.titleBar.bind(_event._move,function(e){e=isTouch?e.originalEvent.touches:[e];b&&a.form.css({top:d.y+(e[0].pageY-c.y)+"px",left:d.x+(e[0].pageX-c.x)+"px"});return!1});this.titleBar.bind(_event._end,function(){return b=
!1});this.titleBar.bind("mouseleave",function(){return b=!1})};initVideoForm.prototype.closeForm=function(){var a=this;this.form.animate({width:20,height:20,left:this.sw/2-10,top:this.sh/2-10},200,function(){a.background.hide();a.form.remove()})};function grayBackground(a,b,c,d,e){this.sw=d;this.sh=e;this.background=$("<div ></div>");this.background.css({width:d+"px",height:e+"px",background:b,opacity:c,"z-index":200,position:"absolute",left:"0px",top:"0px"});a.append(this.background)}grayBackground.prototype.onResize=function(a,b){this.sw=a;this.sh=b;this.background.css({width:a+"px",height:b+"px"})};
grayBackground.prototype.setPosition=function(a,b,c){void 0==c&&(c=["left","top"]);this.background.css(c[0],a+"px");this.background.css(c[1],b+"px")};grayBackground.prototype.show=function(){this.father.append(this.background)};grayBackground.prototype.hide=function(){this.background.remove()};grayBackground.prototype.setZindex=function(a){this.background.css({"z-index":a})};grayBackground.prototype.onMouseUp=function(a,b){$(this.background).bind(_event._down,function(){b.call(a)})};function initSlideShow(a,b,c,d){this.photos=$.extend([],b);if(0==this.photos.length){if(void 0==this.photos.url)return;this.photos=[this.photos]}this.father=a;this.sw=c-8;this.sh=d-8;this.imgIndex=-1;this.imgWidth=200;this.imgHeight=300;this.boxWidth=200;this.boxHeight=300;this.loadingImageHeight=this.loadingImageWidth=32;this.slideShowBG=new grayBackground(a,"#333333",0.3,c,d);this.photoBox=$("<div></div>");this.leftBar=$("<div></div>");this.rightBar=$("<div></div>");this.img=$("<img style='position : absolute;' />");
a.append(this.photoBox);a.append(this.leftBar);a.append(this.rightBar);this.leftButton=new button(1,this.leftBar,{iconURL:uiBaseURL+"previous_down.png"});this.rightButton=new button(1,this.rightBar,{iconURL:uiBaseURL+"next_down.png"});this.closeButton=new button(1,a,{iconURL:uiBaseURL+"close.png"},!0);this.leftButton.setButtonPosition(0,29,["left","top"]);this.rightButton.setButtonPosition(0,29,["right","top"]);this.closeButton.setButtonPosition(this.sw-45,5);this.closeButton.setCSS({"z-index":210});
this.rightBar.css({"z-index":202,width:"100px",height:"100px",right:"0px",top:(this.sh-100)/2+"px",position:"absolute"});this.leftBar.css({"z-index":203,width:"100px",height:"100px",left:"0px",top:(this.sh-100)/2+"px",position:"absolute"});this.photoBox.css({width:this.boxWidth+"px",height:this.boxHeight+"px",left:(this.sw-this.boxWidth)/2+"px",top:(this.sh-this.boxHeight)/2+"px",position:"absolute","background-color":"#eeeeee","z-index":201,"-webkit-box-shadow":"0 0 10px rgba(255, 255, 255, 0.7)",
"-moz-box-shadow":"0 0 10px rgba(255, 255, 255, 0.7)","-ms-box-shadow":"0 0 10px rgba(255, 255, 255, 0.7)","-o-box-shadow":"0 0 10px rgba(255, 255, 255, 0.7)","box-shadow":"0 0 10px rgba(255, 255, 255, 0.7)"});this.loadingImage=$("<div><img src='"+uiBaseURL+"progress.gif' style='position:absolute;'/></div>");this.loadingImage.css({"z-index":-1,left:(this.boxWidth-this.loadingImageWidth)/2+"px",top:(this.boxHeight-this.loadingImageHeight)/2+"px"});this.loadingImage.css({width:this.loadingImageWidth+
"px",height:this.loadingImageHeight+"px",position:"absolute"});this.photoBox.append(this.loadingImage);this.changeImage(0);var e=this;this.photoBox.bind(_event._down,function(){e.nextPage()});this.closeButton.onMouseUp(this,this.hide);this.slideShowBG.onMouseUp(this,this.hide);this.leftButton.onMouseDown(this,this.prePage);this.rightButton.onMouseDown(this,this.nextPage);this.leftButton.mouseEnterJump();this.rightButton.mouseEnterJump();void 0!=leftRightButton&&null!=leftRightButton&&leftRightButton.setShow(!1)}
initSlideShow.prototype.nextPage=function(){var a=this.imgIndex+1;a>=this.photos.length&&(a=0);this.changeImage(a)};initSlideShow.prototype.prePage=function(){var a=this.imgIndex-1;0>a&&(a=this.photos.length-1);this.changeImage(a)};initSlideShow.prototype.onResize=function(a,b){this.sw=a-8;this.sh=b-8;this.slideShowBG.onResize(a,b);this.setPosition()};
initSlideShow.prototype.setPosition=function(){this.photoBox.css({left:(this.sw-this.boxWidth)/2+"px",top:(this.sh-this.boxHeight)/2+"px"});this.leftButton.setButtonPosition(0,29,["left","top"]);this.rightButton.setButtonPosition(0,29,["right","top"]);this.rightBar.css({right:"0px",top:(this.sh-100)/2+"px",position:"absolute"});this.leftBar.css({left:"0px",top:(this.sh-100)/2+"px",position:"absolute"});this.closeButton.setButtonPosition(this.sw-45,5)};
initSlideShow.prototype.changeImage=function(a){if(this.imgIndex!=a){this.imgIndex=a;this.img.remove();a=this.photos[a].url;!0==isFlipPdf&&(a="."+a);var b=this;this.img.attr("src",a);this.img.load(function(){b.imgWidth=b.img[0].naturalWidth;b.imgHeight=b.img[0].naturalHeight;var a=b.imgWidth,d=b.imgHeight;if(b.imgWidth>b.sw||b.imgHeight>b.sh)a=b.imgWidth/b.imgHeight,a>b.sw/b.sh?(a=b.sw,d=b.sw*b.imgHeight/b.imgWidth):(d=b.sh,a*=b.sh);b.img.css({width:a+"px",height:d+"px"});b.boxWidth!=a||b.boxHeight!=
d?(b.photoBox.animate({width:a+8,height:d+8,left:(b.sw-a)/2,top:(b.sh-d)/2},300,function(){b.photoBox.append(b.img)}),b.loadingImage.css({left:(a+8-b.loadingImageWidth)/2,top:(d+8-b.loadingImageHeight)/2})):b.photoBox.append(b.img);b.boxWidth=a;b.boxHeight=d;b.img.css({left:"4px",top:"4px"})})}};initSlideShow.prototype.setImagePosition=function(){};initSlideShow.prototype.show=function(){};
initSlideShow.prototype.hide=function(){var a=this;this.photoBox.animate({width:20,height:20,top:this.sh/2-10,left:this.sw/2-10},200,function(){a.leftBar.remove();a.rightBar.remove();a.closeButton.remove();a.photoBox.remove();a.slideShowBG.hide()});hideLeftRightButton()&&leftRightButton.setShow(!0)};function initCallout(a,b,c,d,e){this.config=$.extend({width:200,height:20,x:0,y:0,alpha:1,textStr:null,pageH:812,lineH:20,fontName:null,fontSize:12,color:null,tbold:"false",italic:"false",bgalpha:1,action:null,fillBg:"false",bgcolor:null,direct:"Down",cx1:0,cy1:0,cx2:0,cy2:0,pointx:0,pointy:0,cornerRadiut:5,borderWidth:3,borderColor:null,bordreAlpha:1,sh:"false",sx:4,sy:4,se:2,sr:null},b);this.pw=c;this.ph=d;this.father=a;this.originWidth=bookConfig.largePageWidth;this.originHeight=bookConfig.largePageHeight;
this.width=this.config.width*bookConfig.largePageWidth;this.height=this.config.height*bookConfig.largePageHeight;this.x=this.config.x*c;this.y=this.config.y*d;this.cx1=this.config.cx1*this.width;this.cy1=this.config.cy1*this.height;this.cx2=this.config.cx2*this.width;this.cy2=this.config.cy2*this.height;this.pointx=this.config.pointx*this.width;this.pointy=this.config.pointy*this.height;this.fontSize=0.75*this.config.lineH*this.originHeight;this.id="callout"+e;this.cl=this.ct=this.hl=this.wl=this.canl=
this.cant=this.canh=this.canw=0;b=new TextFormatAnalyzer(this.config.textStr);this.text=b.getLines();null==this.config.fontName&&(this.config.fontName=b.getFontFamily().split(",")[0],this.config.fontSize=b.getFontSize(),this.config.color=b.getFontColor(),this.color=colorTo0x(this.config.color));switch(this.config.direct){case "Down":if(0>this.pointx){this.canw=this.width-this.pointx+20;this.canh=this.pointy+20;this.cant=this.y-10;this.canl=this.x-(this.canw-this.width-10);break}this.canw=this.pointx>
this.width?this.pointx+20:this.width+20;this.canh=this.pointy+20;this.cant=this.y-10;this.canl=this.x-10;break;case "left":if(0>this.pointy){this.canw=this.width-this.pointx+20;this.canh=this.height-this.pointy+20;this.cant=this.y-10;this.canl=this.x+this.pointx+40;break}this.pointy>this.height?(this.canw=this.width-this.pointx+20,this.canh=this.pointy+20):(this.canw=this.width-this.pointx+20,this.canh=this.height+20);this.cant=this.y-10;this.canl=this.x+this.pointx+40;break;case "Up":if(0>this.pointx){this.canw=
this.width-this.pointx+20;this.canh=this.height-this.pointy+20;this.cant=this.y-(this.canh-this.height-10);this.canl=this.x-(this.canw-this.width-10);break}this.canw=this.pointx>this.width?this.pointx+20:this.width+20;this.canh=this.height-this.pointy+20;this.cant=this.y-(this.canh-this.height-10);this.canl=this.x-10;break;case "Right":if(0>this.pointy){this.canw=this.pointx+20;this.canh=this.height-this.pointy+20;this.cant=this.y-(this.canh-this.height-10);this.canl=this.x-10;break}this.pointy>this.height?
(this.canw=this.pointx+20,this.canh=this.pointy+20):(this.canw=this.pointx+20,this.canh=this.height+20);this.cant=this.y-10;this.canl=this.x-10}this.wl=this.canw/this.pw;this.hl=this.canh/this.ph;this.ct=this.cant/this.ph;this.cl=this.canl/this.pw;this.callout=$("<canvas id="+this.id+" width="+this.canw+" height="+this.canh+" style='position: absolute;top:"+this.cant+"px;left:"+this.canl+"px'></canvas>");a.append(this.callout);this.calloutDown();this.resizeCallout(d);this.father=a;this.initEvent()}
initCallout.prototype.resizeCallout=function(a){a/=bookConfig.largePageHeight;this.callout.css({"-webkit-transform-origin":"0% 0%","-moz-transform-origin":"0% 0%","-ms-transform-origin":"0% 0%","-o-transform-origin":"0% 0%","-webkit-transform":"scale("+a+")","-moz-transform":"scale("+a+")","-ms-transform":"scale("+a+")","-o-transform":"scale("+a+")"})};
initCallout.prototype.calloutDown=function(){var a=[],b=[],c,d,e=this.callout[0].getContext("2d"),f,g,h,j,k,m,l,n,o,p,q,s,v,t,r,u,w,B,x,y,C,D,E,G,z,A,H,F;switch(this.config.direct){case "Down":if(0>this.pointx){f=this.canw-this.width-10;g=20;h=this.canw-this.width-10;j=10;c=this.canw-this.width;d=10;k=this.canw-20;m=10;l=this.canw-10;n=10;o=this.canw-10;p=20;q=this.canw-10;s=this.height;v=this.canw-10;t=this.height+10;r=this.canw-20;u=this.height+10;w=this.canw-(this.width-this.cx2)-10;B=this.height+
10;x=10;y=this.pointy+10;C=this.canw-(this.width-this.cx1)-10;D=this.height+10;E=this.canw-this.width;G=this.height+10;z=this.canw-(this.width+10);A=this.height+10;H=this.canw-(this.width+10);F=this.height;break}f=10;g=20;j=h=10;c=20;d=10;k=this.width;m=10;l=this.width+10;n=10;o=this.width+10;p=20;q=this.width+10;s=this.height;v=this.width+10;t=this.height+10;r=this.width;u=this.height+10;w=this.cx2+10;B=this.height+10;x=this.pointx+10;y=this.pointy+10;C=this.cx1+10;D=this.height+10;E=20;G=this.height+
10;z=10;A=10+this.height;H=10;F=this.height;break;case "left":if(0>this.pointy){f=this.canw-this.width-10;g=this.canh-this.height;h=this.canw-this.width-10;j=this.canh-this.height-10;c=this.canw-this.width;d=this.canh-this.height-10;k=this.canw-20;m=this.canh-this.height-10;l=this.canw-10;n=this.canh-this.height-10;o=this.canw-10;p=this.canh-this.height;q=this.canw-10;s=this.canh-20;v=this.canw-10;t=this.canh-10;r=this.canw-20;u=this.canh-10;w=this.canw-this.width-10;B=this.canh-20;x=this.canw-this.width-
10;y=this.canh-10;C=this.canw-this.width;D=this.canh-10;E=this.canw-this.width-10;G=this.canh-(this.height-this.cy2+10);A=z=10;H=this.canw-this.width-10;F=this.canh-(this.height-this.cy1+10);break}this.pointy>this.height?(h=this.canw-this.width-10,j=10,l=this.canw-10,n=10,v=this.canw-10,t=this.height+10,x=this.canw-this.width-10,y=this.height+10,E=this.canw-this.width-10,G=this.cy2+10,z=10,A=this.canh-10):(h=this.canw-this.width-10,j=10,l=this.canw-10,n=10,v=this.canw-10,t=this.height+10,x=this.canw-
this.width-10,y=this.height+10,E=this.canw-this.width-10,G=this.cy2+10,z=10,A=this.pointy);H=this.canw-this.width-10;F=this.cy1+10;f=h;g=j+10;c=h+10;d=j;k=l-10;m=n;o=l;p=n+10;q=v;s=t-10;r=v-10;u=t;w=x+10;B=y;C=x;D=y-10;break;case "Up":if(0>this.pointx){h=this.canw-this.width-10;j=this.canh-this.height-10;k=this.canw-(this.width-this.cx2)-10;m=this.canh-this.height-10;n=l=10;o=this.canw-(this.width-this.cx1)-10;p=this.canh-this.height-10;v=this.canw-10;t=this.canh-this.height-10;x=this.canw-10;y=this.canh-
10;z=this.canw-this.width-10;A=this.canh-10;f=h;g=j+10;c=h+10;d=j;q=v-10;s=t;r=v;u=t+10;w=x;B=y-10;C=x-10;D=y;E=z+10;G=A;H=z;F=A-10;break}h=10;j=this.canh-this.height-10;k=this.cx2+10;m=this.canh-this.height-10;l=this.pointx+10;n=10;o=this.cx1+10;p=this.canh-this.height-10;v=this.width+10;t=this.canh-this.height-10;x=this.width+10;y=this.canh-10;z=10;A=this.canh-10;f=h;g=j+10;c=h+10;d=j;q=v-10;s=t;r=v;u=t+10;w=x;B=y-10;C=x-10;D=y;E=z+10;G=A;H=z;F=A-10;break;case "Right":if(0>this.pointy){l=this.width+
10;n=this.canh-this.height-10;q=this.width+10;s=this.canh-(this.height-this.cy2+10);v=this.canw-10;t=10;r=this.width+10;u=this.canh-(this.height-this.cy1+10);x=this.width+10;y=this.canh-10;z=10;A=this.canh-10;f=h;g=j+10;c=h+10;d=j;k=l-10;m=n;o=l;p=n+10;w=x;B=y-10;C=x-10;D=y;E=z+10;G=A;H=z;F=A-10;break}this.pointy>this.height?(l=this.width+10,n=10,q=this.width+10,s=this.cy2+10,v=this.canw-10,t=this.canh-10):(j=h=10,l=this.width+10,n=10,q=this.width+10,s=this.cy2+10,v=this.canw-10,t=this.pointy);r=
this.width+10;u=this.cy1+10;x=this.width+10;y=this.height+10;z=10;A=this.height+10;f=h;g=j+10;c=h+10;d=j;k=l-10;m=n;o=l;p=n+10;w=x;B=y-10;C=x-10;D=y;E=z+10;G=A;H=z;F=A-10}switch(this.config.direct){case "Down":e.beginPath();e.lineWidth="0";e.globalAlpha=this.config.bgalpha;e.strokeStyle=this.color;e.fillStyle=colorTo0x(this.config.bgcolor);e.moveTo(f,g);e.quadraticCurveTo(h,j,c,d);e.lineTo(k,m);e.quadraticCurveTo(l,n,o,p);e.lineTo(q,s);e.quadraticCurveTo(v,t,r,u);e.lineTo(w,B);e.lineTo(x,y);e.lineTo(C,
D);e.lineTo(E,G);e.quadraticCurveTo(z,A,H,F);break;case "left":e.beginPath();e.lineWidth="0";e.globalAlpha=this.config.bgalpha;e.strokeStyle=this.color;e.fillStyle=colorTo0x(this.config.bgcolor);e.moveTo(f,g);e.quadraticCurveTo(h,j,c,d);e.lineTo(k,m);e.quadraticCurveTo(l,n,o,p);e.lineTo(q,s);e.quadraticCurveTo(v,t,r,u);e.lineTo(w,B);e.quadraticCurveTo(x,y,C,D);e.lineTo(E,G);e.lineTo(z,A);e.lineTo(H,F);break;case "Up":e.beginPath();e.lineWidth="0";e.globalAlpha=this.config.bgalpha;e.strokeStyle=this.color;
e.fillStyle=colorTo0x(this.config.bgcolor);e.moveTo(f,g);e.quadraticCurveTo(h,j,c,d);e.lineTo(k,m);e.lineTo(l,n);e.lineTo(o,p);e.lineTo(q,s);e.quadraticCurveTo(v,t,r,u);e.lineTo(w,B);e.quadraticCurveTo(x,y,C,D);e.lineTo(E,G);e.quadraticCurveTo(z,A,H,F);break;case "Right":e.beginPath(),e.lineWidth="0",e.globalAlpha=this.config.bgalpha,e.strokeStyle=this.color,e.fillStyle=colorTo0x(this.config.bgcolor),e.moveTo(f,g),e.quadraticCurveTo(h,j,c,d),e.lineTo(k,m),e.quadraticCurveTo(l,n,o,p),e.lineTo(q,s),
e.lineTo(v,t),e.lineTo(r,u),e.lineTo(w,B),e.quadraticCurveTo(x,y,C,D),e.lineTo(E,G),e.quadraticCurveTo(z,A,H,F)}e.strokeStyle=colorTo0x(this.config.borderColor);e.lineWidth=5;e.closePath();e.fill();"false"!=this.config.sh&&(e.shadowOffsetX=this.config.sx,e.shadowOffsetY=this.config.sy,e.shadowBlur=this.config.se,e.shadowColor=colorTo0x(this.config.sr),e.strokeStyle=colorTo0x(this.config.borderColor));e.stroke();e.fill();e.shadowOffsetX=0;e.shadowOffsetY=0;e.shadowBlur=100;e.shadowColor=0;e.fillStyle=
this.color;e.font=this.fontSize+"px "+this.config.fontName;for(j=h=0;j<this.text.length;j++)if(b=[],a=this.text[j],e.measureText(a).width<=this.width-3.5)e.fillText(a,f+5,g+(j+h)*(this.fontSize+this.fontSize/2)+2*this.fontSize/3);else{a=a.split(" ");d=a[0];for(k=0;k<a.length;k++)k==a.length-1?b.push(d):(c=d+" "+a[k+1],e.measureText(c).width<=this.width-3.5?d=c:(b.push(d),d=a[k+1]));for(a=0;a<b.length;a++)e.fillText(b[a],f+5,g+(j+h+a)*(this.fontSize+this.fontSize/2)+2*this.fontSize/3);h+=b.length-
1}e.globalCompositeOperation="source-atop";e.strokeStyle=colorTo0x(this.config.borderColor);e.shadowColor=colorTo0x(this.config.borderColor);e.shadowBlur=50;e.shadowOffsetX=0;e.shadowOffsetY=0;e.stroke()};
initCallout.prototype.initEvent=function(){var a=this;this.flag=0;this.linkURL=this.form=this.form=null;if(null!=a.config.action){try{void 0!=this.config.action.length&&(this.config.action=this.config.action[0]),this.linkURL=this.config.action.url}catch(b){}var c;null!=this.linkURL&&"www"==this.linkURL.substr(0,3).toLowerCase()&&(this.linkURL="http://"+this.linkURL);try{c=this.config.action.triggerEventType}catch(d){c=null}this.callout.bind(_event._down,function(){c==PageEditor.TriggerEventType.MouseDown&&
actionEvent.call(a);browserType==3?event.cancelBubble=true:event.stopPropagation()});this.callout.bind("mouseover",function(){c==PageEditor.TriggerEventType.MouseOver&&actionEvent.call(a)});this.callout.bind(isTouch?_event._end:"mouseout",function(){c==PageEditor.TriggerEventType.MouseOut&&actionEvent.call(a)})}};
initCallout.prototype.onResize=function(a,b){this.pw=a;this.ph=b;this.width=this.wl*bookConfig.largePageWidth;this.height=this.hl*bookConfig.largePageHeight;this.setPosition();this.resizeCallout(b);if(null!=this.form)this.form.onResize(bookContainer.width(),bookContainer.height());if(null!=this.slide)this.slide.onResize(bookContainer.width(),bookContainer.height());if(null!=this.audios)this.audios.onResize(bookContainer.width(),bookContainer.height())};
initCallout.prototype.setPosition=function(){this.x=this.cl*this.pw;this.y=this.ct*this.ph;this.callout.css({left:this.x+"px",top:this.y+"px"})};function initAText(a,b,c,d,e){this.config=$.extend({width:200,height:20,x:0,y:0,alpha:1,textStr:null,fontName:null,fontSize:12,color:null,tbold:"false",italic:"false",align:"left",action:null,repeat:"false",moveSpeed:1,sh:"false",sx:4,sy:4,se:2,sr:null},b);this.pw=c;this.ph=d;this.originWidth=bookConfig.largePageWidth;this.originHeight=bookConfig.largePageHeight;this.father=a;this.speed=12E3*(1/this.config.moveSpeed);this.width=this.config.width*this.originWidth;this.height=this.config.height*this.originHeight;
this.x=this.config.x*this.pw;this.y=this.config.y*this.ph;this.id="text"+e;this.scrollid="scroll"+this.id;b=new TextFormatAnalyzer(this.config.textStr);this.text=b.getTextLines();null==this.config.fontName&&(this.config.fontName=b.getFontFamily().split(",")[0],this.config.fontSize=b.getFontSize(),this.config.align=b.getAlign(),this.config.color=b.getFontColor(),this.color=colorTo0x(this.config.color));this.atext=$("<div id="+this.id+" style='overflow: hidden;position:absolute;left:"+this.x+"px; top:"+
this.y+"px;height:"+this.height+"px;width:"+this.width+"px;opacity:"+this.config.alpha+"'></div>");"false"!=this.config.sh&&this.atext.css({"box-shadow":this.config.sx+"px "+this.config.sy+"px "+this.config.se+"px "+colorTo0x(this.config.sr),"-moz-box-shadow":this.config.sx+"px "+this.config.sy+"px "+this.config.se+"px "+colorTo0x(this.config.sr),"-webkit-box-shadow":this.config.sx+"px "+this.config.sy+"px "+this.config.se+"px "+colorTo0x(this.config.sr),"-ms-box-shadow":this.config.sx+"px "+this.config.sy+
"px "+this.config.se+"px "+colorTo0x(this.config.sr),"-o-box-shadow":this.config.sx+"px "+this.config.sy+"px "+this.config.se+"px "+colorTo0x(this.config.sr)});this.atext2=$("<div id="+this.scrollid+" style='word-break: break-word;font-family:"+this.config.fontName+";width:100%;font-size:"+this.config.fontSize+"px;color:"+this.color+";text-align:"+this.config.align+";'>"+this.text+"</div>");"false"!=this.config.tbold&&this.atext2.css({"font-weight":"bold"});"false"!=this.config.italic&&this.atext2.css({"font-style":"italic"});
this.father=a;this.initEvent();a.append(this.atext);this.atext.append(this.atext2);this.initScroll();this.onResize(c,d)}initAText.prototype.initScroll=function(){this._wrap=this.atext2;this.initScrollText()};initAText.prototype.initScrollText=function(){var a=this,b=a._wrap,c=b.height();b.animate({marginTop:-c+"px"},a.speed,function(){"true"==a.config.repeat?(b.css("marginTop",a.height),a.initScrollText()):b.css("marginTop",0)})};
initAText.prototype.initEvent=function(){var a=this;this.flag=0;this.linkURL;if(null!=a.config.action){try{void 0!=this.config.action.length&&(this.config.action=this.config.action[0]),this.linkURL=this.config.action.url}catch(b){}var c;null!=this.linkURL&&"www"==this.linkURL.substr(0,3).toLowerCase()&&(this.linkURL="http://"+this.linkURL);try{c=this.config.action.triggerEventType}catch(d){c=null}this.atext.bind(_event._down,function(){c==PageEditor.TriggerEventType.MouseDown&&actionEvent.call(a);
browserType==3?event.cancelBubble=true:event.stopPropagation()});this.atext.bind(_event._move,function(){c==PageEditor.TriggerEventType.MouseOver&&actionEvent.call(a)});this.atext.bind(_event._end,function(){c==PageEditor.TriggerEventType.MouseOut&&actionEvent.call(a)})}};
initAText.prototype.onResize=function(a,b){this.pw=a;this.ph=b;this.setPosition();if(null!=this.form)this.form.onResize(bookContainer.width(),bookContainer.height());if(null!=this.slide)this.slide.onResize(bookContainer.width(),bookContainer.height());if(null!=this.audios)this.audios.onResize(bookContainer.width(),bookContainer.height());this.fontSize=0.75*this.config.lineH*this.originHeight;this.atext.css("font-size",this.fontSize+"px");this.atext2.css("font-size",this.fontSize+"px");this.resizeText(a)};
initAText.prototype.resizeText=function(a){a/=this.originWidth;this.atext.css({"-webkit-transform-origin":"0% 0%","-moz-transform-origin":"0% 0%","-ms-transform-origin":"0% 0%","-o-transform-origin":"0% 0%","-webkit-transform":"scale("+a+")","-moz-transform":"scale("+a+")","-ms-transform":"scale("+a+")","-o-transform":"scale("+a+")"})};initAText.prototype.setPosition=function(){this.x=this.config.x*this.pw;this.y=this.config.y*this.ph;this.atext.css({left:this.x+"px",top:this.y+"px"})};function initFlashShow(a,b,c,d){this.pw=c;this.ph=d;this.config=$.extend({width:0.2,height:0.2,x:0.2,y:0.2,photo:null,repeatPlay:!0,customSize:!1},b);null!=this.config.photo&&(this.showingA=!0,this.showingIndex=1,this.background=$("<div></div>"),this.totalImage=this.config.photo.Image.length,this.moveTo=1,this.width=this.pw*this.config.width,this.height=this.ph*this.config.height,this.background.css({width:this.width+"px",height:this.height+"px",left:this.config.x*this.pw+"px",top:this.config.y*this.ph+
"px",position:"absolute",overflow:"hidden"}),this.photoA=new animateImage(this.background,this.config.photo,this.width,this.height,this.config.repeatPlay,this.config.customSize,this.config.photo.width,this.config.photo.width),this.photoB=new animateImage(this.background,this.config.photo,this.width,this.height,this.config.repeatPlay,this.config.customSize,this.config.photo.width,this.config.photo.width),a.append(this.background),this.photoB.fillImage(2),this.photoA.fillImage(1),this.initChangeImageEvent(!0))}
initFlashShow.prototype={onResize:function(a,b){this.pw=a;this.ph=b;this.width=this.pw*this.config.width;this.height=this.ph*this.config.height;this.background.css({width:this.width+"px",height:this.height+"px"});this.photoA.onResize(a,b);this.photoB.onResize(a,b);this.setPosition()},setPosition:function(){this.background.css({left:this.pw*this.config.x+"px",top:this.ph*this.config.y+"px"})},initChangeImageEvent:function(a){var b=this,c=this.photoA.getImage(),d=this.photoB.getImage(),e,f;a||(c=this.photoB.getImage(),
d=this.photoA.getImage());switch(this.moveTo){case 1:e=f=1;break;case 2:e=f=-1;break;case 3:f=1;e=-1;break;case 4:f=-1,e=1}this.moveTo=4==this.moveTo?1:this.moveTo+1;var g=c.position().left+66*f,h=c.position().top+66*e,j=c.position().left+77*f,k=c.position().top+77*e;c.animate({left:g,top:h},{queue:!1,duration:3E3,complete:function(){b.showingIndex++;if(!(b.showingInde>b.totalImage)||b.config.repeatPlay){if(b.showingIndex>b.totalImage)b.showingIndex=0;c.animate({opacity:0,left:j,top:k},500,function(){a?
b.photoA.fillImage(b.showingIndex+1):b.photoB.fillImage(b.showingIndex+1);c.css({"z-index":0});d.css({"z-index":1})});b.initChangeImageEvent(!a)}}}).animate({opacity:1},500)}};function animateImage(a,b,c,d,e,f,g,h){this.img=$("<img />");this.imgIndex=-1;this.imageArr=b;this.bw=c;this.bh=d;this.repeat=e;a.append(this.img);this.img.css({position:"absolute"});f&&void 0!=g&&void 0!=h&&this.img.css({width:g+"px",height:h+"px"})}
animateImage.prototype.fillImage=function(a){if(this.imgIndex==a)this.img.css({left:(this.bw-this.img[0].width)/2+"px",top:(this.bh-this.img[0].height)/2+"px"});else if(!(a>this.imageArr.Image.length)||this.repeat){a>this.imageArr.Image.length&&(a=1);this.imgIndex==a;var b=this;this.img.attr("src",b.getImageDiv(a));this.img.load(function(){b.img.css({left:(b.bw-this.width)/2+"px",top:(b.bh-this.height)/2+"px"})})}};animateImage.prototype.getImageDiv=function(a){return this.imageArr.Image[a-1].photo};
animateImage.prototype.setZIndex=function(a){this.img.css("z-index",a)};animateImage.prototype.onResize=function(a,b){this.bw=a;this.bh=b;this.img.css({left:(this.bw-this.img[0].width)/2+"px",top:(this.bh-this.img[0].height)/2+"px"})};animateImage.prototype.setPosition=function(a,b){this.img.css({left:a+"px",top:b+"px"})};animateImage.prototype.animate=function(){};animateImage.prototype.getImage=function(){return this.img};function initSound(a,b,c,d,e){this.config=$.extend({width:80,height:30,x:20,y:20,src:null,alpha:1,soundPlay:null,skinType:null},b);this.sound=null;null!=this.config.src&&(this.arr=null,this.arr="undefined"!=typeof this.config.src.path?this.config.src.path:this.config.src[0].path,this.pw=c,this.ph=d,this.width=this.config.width*this.pw,this.height=this.config.height*this.ph,this.x=this.config.x*this.pw,this.y=this.config.y*this.ph,this.h1=this.height/6,this.h2=this.height/3,this.c=this.nflay=this.flay=
0,this.st=null,this.id="AdvancedSound"+e,this.sounddiv=$("<div style='position:absolute; width:"+this.width+"px;height:"+this.height+"px;top:"+this.y+"px;left:"+this.x+"px;background:url("+uiBaseURL+"audio.png);background-size:"+this.width+"px "+this.height+"px;background-repeat:no-repeat;'></div>"),this.sound=$("<audio id='"+this.id+"' src='"+this.arr+"'></audio>"),this.preimg=$("<img src='"+uiBaseURL+"Pre_down.png' style='position:absolute; left:10px;bottom:5px;cursor:pointer;' />"),this.playimg=
$("<img src='"+uiBaseURL+"Play_down.png' style='position:absolute; left:50px;bottom:5px;cursor:pointer;'/>"),this.nextimg=$("<img src='"+uiBaseURL+"Nextpage_down.png' style='position:absolute; left:90px;bottom:5px;cursor:pointer;' />"),this.soundname=$("<div style='position:absolute; right:10px;top:"+this.h2+"px;color:#389ac2;font-size:10px;'></div>"),this.soundtime=$("<div style='position:absolute; right:10px;top:"+this.h1+"px;color:#389ac2;font-size:10px;'></div>"),a.append(this.sounddiv),this.sounddiv.append(this.sound),
this.sounddiv.append(this.preimg),this.sounddiv.append(this.playimg),this.sounddiv.append(this.nextimg),this.sounddiv.append(this.soundname),this.sounddiv.append(this.soundtime),null!=this.config.src&&this.initEvent())}
initSound.prototype.initEvent=function(){var a=this;a.nflay=0;var b=a.playimg[0],c=a.sound[0],d=a.config.src[0].path,e=typeof a.config.src.path;"undefined"!=e?a.soundname.html(this.getname(a.config.src.path)):a.soundname.html(this.getname(d));a.soundtime.html("00:00 / 00:00");this.playimg.bind(_event._down,function(){0==a.flay?(b.src=uiBaseURL+"Pause_down.png",c.play(),a.flay=1,a.gettime(c.duration)):(b.src=uiBaseURL+"Play_down.png",c.pause(),a.flay=0,clearTimeout(a.st))});this.preimg.bind(_event._down,
function(){c.pause();clearTimeout(a.st);"undefined"!=e?c.src=a.config.src.path:0<a.nflay&&a.nflay<a.config.src.length?(c.src=a.config.src[a.nflay-1].path,a.soundname.html(a.getname(a.config.src[a.nflay].path)),a.nflay-=1):(c.src=d,a.soundname.html(a.getname(d)));c.play();b.src=uiBaseURL+"Pause_down.png";a.flay=1;setTimeout(function(){a.c=0;a.gettime(c.duration)},1E3)});this.nextimg.bind(_event._down,function(){c.pause();clearTimeout(a.st);"undefined"!=e?c.src=a.config.src.path:a.nflay<a.config.src.length?
(a.nflay+=1,c.src=a.config.src[a.nflay].path,a.soundname.html(a.getname(a.config.src[a.nflay].path)),a.nflay+=1):(c.src=d,a.soundname.html(a.getname(d)),a.nflay=0);c.play();b.src=uiBaseURL+"Pause_down.png";a.flay=1;setTimeout(function(){a.c=0;a.gettime(c.duration)},1E3)})};
initSound.prototype.gettime=function(a){var b=this,c=null,d=0,e=null,c=b.c%60,e=parseInt(a%60),e=10>e?"0"+e:e,f=parseInt(a/60);b.c<a&&(b.c+=1,60>b.c?c=10>b.c?"00:0"+b.c:"00:"+b.c:(d=parseInt(b.c/60),c=10>d?10>c?"0"+d+":0"+c:"0"+d+":"+c:10>c?d+":0"+c:d+":"+c),10>f?b.soundtime.html(c+" / 0"+f+":"+e):b.soundtime.html(c+" / "+f+":"+e),b.st=setTimeout(function(){b.gettime(a)},1E3))};initSound.prototype.getname=function(a){var b=[],b=a.split("/");return b[b.length-1].split(".")[0]};
initSound.prototype.onResize=function(a,b){this.pw=a;this.ph=b;this.width=this.config.width*this.pw;this.height=this.config.height*this.ph;this.sounddiv.css({width:this.width+"px",height:this.height+"px"});this.sounddiv.css("background-size",this.width+"px "+this.height+"px");this.soundname.css("top",this.height/3+"px");this.soundtime.css("top",this.height/6+"px");this.setPosition()};
initSound.prototype.setPosition=function(){this.x=this.config.x*this.pw;this.y=this.config.y*this.ph;this.sounddiv.css({left:this.x+"px",top:this.y+"px"})};function initEffText(a,b,c,d,e){this.config=$.extend({width:200,height:20,x:0,y:0,alpha:1,textStr:null,fontName:null,fontSize:12,color:null,tbold:"false",italic:"false",moveSpeed:0,action:null,sh:"false",sx:4,sy:4,se:2,sr:null},b);this.pw=c;this.ph=d;this.originWidth=bookConfig.largePageWidth;this.originHeight=bookConfig.largePageHeight;this.color=colorTo0x(this.config.color);"#0"==this.color&&(this.color="#000");this.father=a;this.speed=this.pos=0;this.speed="ChangeSpeed"==this.config.moveSpeed?
250:50;this.width=this.config.width*this.originWidth;this.height=this.config.height*this.originHeight;this.x=this.config.x*this.pw;this.y=this.config.y*this.ph;this.id="efftext"+e;this.scrollid="efftext"+this.id;this.fontSize=0.75*this.config.lineH*this.originHeight;b=new TextFormatAnalyzer(this.config.textStr);this.config.textStr=b.getTextLines();this.config.fontSize=b.getFontSize();this.config.color=b.getFontColor();this.color=colorTo0x(this.config.color);this.efftext="false"!=this.config.sh?$("<div id="+
this.id+" style='overflow: hidden;position:absolute;left:"+this.x+"px; top:"+this.y+"px;height:"+this.height+"px;width:"+this.width+"px;box-shadow:"+this.config.sx+"px "+this.config.sy+"px "+this.config.se+"px "+colorTo0x(this.config.sr)+";opacity:"+this.config.alpha+"'></div>"):$("<div id="+this.id+" style='overflow: hidden;position:absolute;left:"+this.x+"px; top:"+this.y+"px;height:"+this.height+"px;width:"+this.width+"px;opacity:"+this.config.alpha+"'></div>");this.efftext2=$("<div id="+this.scrollid+
" style='word-break: break-word;font-family:"+this.config.fontName+";width:"+this.width+"px;font-size:"+this.fontSize+"px;color:"+this.color+";'></div>");"false"!=this.config.tbold&&this.efftext.css({"font-weight":"bold"});"false"!=this.config.italic&&this.efftext.css({"font-style":"italic"});this.father=a;this.initEvent();a.append(this.efftext);this.efftext.append(this.efftext2);this.initeffAmin();this.onResize(c,d)}
initEffText.prototype.initeffAmin=function(){var a=this,b,c=a.config.textStr;this.efftext2.html(c.substring(0,a.pos));a.pos++==c.length?(a.pos=0,clearTimeout(b)):b=setTimeout(function(){a.initeffAmin()},a.speed)};
initEffText.prototype.initEvent=function(){var a=this;this.flag=0;this.linkURL=null;if(null!=a.config.action){try{void 0!=this.config.action.length&&(this.config.action=this.config.action[0]),this.linkURL=this.config.action.url}catch(b){}var c;null!=this.linkURL&&"www"==this.linkURL.substr(0,3).toLowerCase()&&(this.linkURL="http://"+this.linkURL);try{c=this.config.action.triggerEventType}catch(d){c=null}this.efftext.bind(_event._down,function(){c==PageEditor.TriggerEventType.MouseDown&&actionEvent.call(a);
browserType==3?event.cancelBubble=true:event.stopPropagation()});this.efftext.bind("mouseover",function(){c==PageEditor.TriggerEventType.MouseOver&&actionEvent.call(a)});this.efftext.bind(isTouch?_event._end:"mouseout",function(){c==PageEditor.TriggerEventType.MouseOut&&actionEvent.call(a)})}};
initEffText.prototype.onResize=function(a,b){this.pw=a;this.ph=b;this.setPosition();if(null!=this.form)this.form.onResize(bookContainer.width(),bookContainer.height());if(null!=this.slide)this.slide.onResize(bookContainer.width(),bookContainer.height());if(null!=this.audios)this.audios.onResize(bookContainer.width(),bookContainer.height());this.fontSize=0.75*this.config.lineH*this.originHeight;this.resizeText(a)};
initEffText.prototype.resizeText=function(a){a/=this.originWidth;this.efftext.css({"-webkit-transform-origin":"0% 0%","-moz-transform-origin":"0% 0%","-ms-transform-origin":"0% 0%","-o-transform-origin":"0% 0%","-webkit-transform":"scale("+a+")","-moz-transform":"scale("+a+")","-ms-transform":"scale("+a+")","-o-transform":"scale("+a+")"})};initEffText.prototype.setPosition=function(){this.x=this.config.x*this.pw;this.y=this.config.y*this.ph;this.efftext.css({left:this.x+"px",top:this.y+"px"})};function initPngImage(a,b,c,d){this.config=$.extend({width:0.2,height:0.2,x:0.2,y:0.2,alpha:1,src:null},b);this.img=$("<img>");if(null!=this.config.src){this.pw=c;this.ph=d;this.width=this.config.width*c;this.height=this.config.height*d;this.left=this.pw*this.config.x;this.top=this.ph*this.config.y;var e=this;this.img.load(function(){initPngImage.prototype.onImageLoad.apply(e,arguments)});this.img.css({position:"absolute",width:"0px",height:"0px",left:this.left+"px",top:this.top+"px",opacity:this.config.alpha});
this.img.attr({src:this.config.src});a.append(this.img);this.father=a;this.initEvt()}}initPngImage.prototype.onImageLoad=function(){var a=this.img[0];this.imageWidth=a.naturalWidth;this.imageHeight=a.naturalHeight;this.fitImage()};
initPngImage.prototype.fitImage=function(){var a=this.imageWidth/this.imageHeight,b,c,d;a>this.width/this.height?(c=this.width,d=c/a,a=this.left,b=(this.height-d)/2+this.top):(d=this.height,c=d*a,a=(this.width-c)/2+this.left,b=this.top);this.img.css({left:a+"px",top:b+"px",width:c+"px",height:d+"px"})};
initPngImage.prototype.initEvt=function(){this.audios=this.slide=this.form=null;if(void 0!=this.config.action){var a=this;this.flag=0;this.linkURL;try{void 0!=this.config.action.length&&(this.config.action=this.config.action[0]),this.linkURL=this.config.action.url}catch(b){}var c;null!=this.linkURL&&"www"==this.linkURL.substr(0,3).toLowerCase()&&(this.linkURL="http://"+this.linkURL);try{c=this.config.action.triggerEventType}catch(d){c=null}this.img.bind(_event._down,function(){c==PageEditor.TriggerEventType.MouseDown&&
actionEvent.call(a);browserType==3?event.cancelBubble=true:event.stopPropagation()});this.img.bind("mouseover",function(){c==PageEditor.TriggerEventType.MouseOver&&actionEvent.call(a)});this.img.bind(isTouch?_event._end:"mouseout",function(){c==PageEditor.TriggerEventType.MouseOut&&actionEvent.call(a)})}};
initPngImage.prototype.onResize=function(a,b){this.pw=a;this.ph=b;this.width=a*this.config.width;this.height=b*this.config.height;this.left=this.pw*this.config.x;this.top=this.ph*this.config.y;this.fitImage();this.width>this.height?this.img.css({height:this.height+"px",left:this.pw*this.config.x+"px",top:this.ph*this.config.y+"px"}):this.img.css({width:this.width+"px",left:this.pw*this.config.x+"px",top:this.ph*this.config.y+"px"});this.setPosition(this.config.x*a,this.config.y*b);if(null!=this.form)this.form.onResize(bookContainer.width(),
bookContainer.height());if(null!=this.slide)this.slide.onResize(bookContainer.width(),bookContainer.height());if(null!=this.audios)this.audios.onResize(bookContainer.width(),bookContainer.height())};initPngImage.prototype.setPosition=function(a,b){this.img.css({left:a+"px",top:b+"px"})};function initAminText(a,b,c,d,e){this.config=$.extend({width:200,height:20,x:0,y:0,alpha:1,effectType:null,textStr:null,fontName:null,fontSize:12,color:null,tbold:"false",italic:"false",align:"left",action:null,sh:"false",sx:4,sy:4,se:2,sr:null},b);this.pw=c;this.ph=d;this.originWidth=bookConfig.largePageWidth;this.originHeight=bookConfig.largePageHeight;this.father=a;this.pos=0;this.width=this.config.width*this.originWidth;this.height=this.config.height*this.originHeight;this.x=this.config.x*this.pw;
this.y=this.config.y*this.ph;this.id="amintext"+e;this.scrollid="animscroll"+this.id;b=new TextFormatAnalyzer(this.config.textStr);this.config.textStr=b.getTextLines();null==this.config.fontName&&(this.config.fontName=b.getFontFamily().split(",")[0],this.config.fontSize=b.getFontSize(),this.config.align=b.getAlign(),this.config.color=b.getFontColor(),this.color=colorTo0x(this.config.color));this.amintext=$("<div style='overflow: hidden;position:absolute;left:"+this.x+"px; top:"+this.y+"px;height:"+
this.height+"px;width:"+this.width+"px;opacity:"+this.config.alpha+"'></div>");"false"!=this.config.sh&&this.amintext.css({"box-shadow":this.config.sx+"px "+this.config.sy+"px "+this.config.se+"px "+colorTo0x(this.config.sr),"-moz-box-shadow":this.config.sx+"px "+this.config.sy+"px "+this.config.se+"px "+colorTo0x(this.config.sr),"-o-box-shadow":this.config.sx+"px "+this.config.sy+"px "+this.config.se+"px "+colorTo0x(this.config.sr),"-ms-box-shadow":this.config.sx+"px "+this.config.sy+"px "+this.config.se+
"px "+colorTo0x(this.config.sr),"-webkit-box-shadow":this.config.sx+"px "+this.config.sy+"px "+this.config.se+"px "+colorTo0x(this.config.sr)});this.amintext2=$("<div style='word-break: break-word;font-family:"+this.config.fontName+";width:100%;font-size:"+this.config.fontSize+"px;color:"+this.color+";text-align:"+this.config.align+";'></div>");"false"!=this.config.tbold&&this.amintext2.css({"font-weight":"bold"});"false"!=this.config.italic&&this.amintext2.css({"font-style":"italic"});this.father=
a;this.initEvent();a.append(this.amintext);this.amintext.append(this.amintext2);switch(this.config.effectType){case "Default":this.initAmin();break;case "Letter Spacing":this.litterText(this.config.textStr);break;case "Scale Word":this.amintext2.css("text-align","center");a=Array(this.config.textStr);this.RightText(a[0],0,this.amintext2,"PText2","#365933","#9daF33",50,0);break;case "Right To Left":this.amintext2.css("text-align","center");a=Array(this.config.textStr);this.RightText(a[0],0,this.amintext2,
"PText2","#365933","#9daF33",50,0);break;case "Center To Edges":this.initAmin()}this.resizeText(c)}initAminText.prototype.initAmin=function(){var a=this,b,c=a.config.textStr;a.pos<c.length?this.amintext2.html(c.substr(0,a.pos)+"I"):this.amintext2.html(c);a.pos++==c.length?(a.pos=0,clearTimeout(b)):b=setTimeout(function(){a.initAmin()},100)};
initAminText.prototype.RightText=function(a,b,c,d,e,f,g,h){var j=this,k=tmp1="";if(b<=a.length){if("<"==a.charAt(b)){for(;">"!=a.charAt(b);)b++;b++}if("&"==a.charAt(b)&&" "!=a.charAt(b+1)){for(;";"!=a.charAt(b);)b++;b++}k=a.slice(0,b);tmp1=a.charAt(b++);c.html("<span class="+d+" style='text-align:center;'><font color='"+e+"'>"+k+"</font><font color='"+f+"'>"+tmp1+"</font></span>");setTimeout(function(){j.RightText(a,b,c,d,e,f,g,h)},g)}};
initAminText.prototype.litterText=function(a){for(var b="",c=a.length,d=0;d<c;d++)b+="<span id='"+(this.scrollid+"d"+d)+"' style='position: relative;left:0;top:0; display:none;top:-30px;'>"+a.charAt(d)+"</span>";idTObject.html(b);this.ScrollText(0,c-1)};initAminText.prototype.ScrollText=function(a,b){var c=this,d=c.amintext2;d.css("display","inline");d.animate({top:"0px"},50,function(){a<b&&c.ScrollText(a+1,b)})};
initAminText.prototype.initEvent=function(){var a=this;this.flag=0;this.linkURL=null;if(null!=a.config.action){try{void 0!=this.config.action.length&&(this.config.action=this.config.action[0]),this.linkURL=this.config.action.url}catch(b){}var c;null!=this.linkURL&&"www"==this.linkURL.substr(0,3).toLowerCase()&&(this.linkURL="http://"+this.linkURL);try{c=this.config.action.triggerEventType}catch(d){c=null}this.amintext.bind(_event._down,function(){c==PageEditor.TriggerEventType.MouseDown&&actionEvent.call(a);
browserType==3?event.cancelBubble=true:event.stopPropagation()});this.amintext.bind("mouseover",function(){c==PageEditor.TriggerEventType.MouseOver&&actionEvent.call(a)});this.amintext.bind(isTouch?_event._end:"mouseout",function(){c==PageEditor.TriggerEventType.MouseOut&&actionEvent.call(a)})}};
initAminText.prototype.onResize=function(a,b){this.pw=a;this.ph=b;this.setPosition();if(null!=this.form)this.form.onResize(bookContainer.width(),bookContainer.height());if(null!=this.slide)this.slide.onResize(bookContainer.width(),bookContainer.height());if(null!=this.audios)this.audios.onResize(bookContainer.width(),bookContainer.height());this.amintext.css("font-size",this.fontSize+"px");this.amintext2.css("font-size",this.fontSize+"px");this.resizeText(this.pw)};
initAminText.prototype.resizeText=function(a){a/=this.originWidth;this.amintext.css({"-webkit-transform-origin":"0% 0%","-moz-transform-origin":"0% 0%","-ms-transform-origin":"0% 0%","-o-transform-origin":"0% 0%","-webkit-transform":"scale("+a+")","-moz-transform":"scale("+a+")","-ms-transform":"scale("+a+")","-o-transform":"scale("+a+")"})};initAminText.prototype.setPosition=function(){this.x=this.config.x*this.pw;this.y=this.config.y*this.ph;this.amintext.css({left:this.x+"px",top:this.y+"px"})};function initStarText(a,b,c,d,e){this.config=$.extend({width:200,height:20,x:0,y:0,alpha:1,textStr:null,fontName:null,fontSize:12,color:null,tbold:"false",italic:"false",align:"left",action:null,repeat:"false",moveSpeed:1,sh:"false",sx:4,sy:4,se:2,sr:null},b);this.pw=c;this.ph=d;this.originWidth=bookConfig.largePageWidth;this.originHeight=bookConfig.largePageHeight;this.father=a;this.speed=22E3*(1/this.config.moveSpeed);this.width=this.config.width*this.originWidth;this.height=this.config.height*
this.originHeight;this.x=this.config.x*this.pw;this.y=this.config.y*this.ph;this.id="startext"+e;this.scrollid="starwars"+this.id;this.textli="";this.offset=0;this.stepping=0.2;b=new TextFormatAnalyzer(this.config.textStr);this.text=b.getTextLines().split("<br/>");null==this.config.fontName&&(this.config.fontName=b.getFontFamily().split(",")[0],this.config.fontSize=b.getFontSize(),this.config.align=b.getAlign(),this.config.color=b.getFontColor(),this.color=colorTo0x(this.config.color));for(b=0;b<
this.text.length;b++)this.textli=this.textli+"<li style='list-style-type:none;'>"+this.text[b]+"</li>";this.startext=$("<div style='overflow: hidden;position:absolute;left:"+this.x+"px; top:"+this.y+"px;height:"+this.height+"px;width:"+this.width+"px;opacity:"+this.config.alpha+"'></div>");"false"!=this.config.sh&&this.startext.css({"box-shadow":this.config.sx+"px "+this.config.sy+"px "+this.config.se+"px "+colorTo0x(this.config.sr),"-moz-box-shadow":this.config.sx+"px "+this.config.sy+"px "+this.config.se+
"px "+colorTo0x(this.config.sr),"-webkit-box-shadow":this.config.sx+"px "+this.config.sy+"px "+this.config.se+"px "+colorTo0x(this.config.sr),"-ms-box-shadow":this.config.sx+"px "+this.config.sy+"px "+this.config.se+"px "+colorTo0x(this.config.sr),"-o-box-shadow":this.config.sx+"px "+this.config.sy+"px "+this.config.se+"px "+colorTo0x(this.config.sr)});this.startext2=$("<div style='word-break: break-word;font-family:"+this.config.fontName+";width:100%;font-size:"+this.config.fontSize+"px;color:"+
this.color+";text-align:"+this.config.align+";'></div>");"false"!=this.config.tbold&&this.startext2.css({"font-weight":"bold"});"false"!=this.config.italic&&this.startext2.css({"font-style":"italic"});this.father=a;this.initEvent();a.append(this.startext);this.startext.append(this.startext2);this.startext2.append(this.textli);this.initScroll();this.onResize(c,d)}
initStarText.prototype.initScroll=function(){this._wrap=this.startext2;var a=this.text.length;this._wrap.height();for(var b=a;0<=b;b--)$(a[b]).css("fontSize",this.config.fontSize-this.offset+"px"),this.offset+=this.stepping;this._wrap.css("marginTop",this.height);this.initScrollText()};
initStarText.prototype.initScrollText=function(){var a=this,b=a._wrap,c=a.tid,d=b.height();b.animate({marginTop:-d+"px"},a.speed,function(){if("true"==a.config.repeat){for(var d=c;0<=d;d--)$(c[d]).css("fontSize",a.config.fontSize-a.offset+"pt"),a.offset+=a.stepping;b.css("marginTop",a.height);a.offset=0;a.stepping=0.2;a.initScrollText()}else b.css("marginTop",0)})};
initStarText.prototype.initEvent=function(){var a=this;this.flag=0;this.linkURL=null;if(null!=a.config.action){try{void 0!=this.config.action.length&&(this.config.action=this.config.action[0]),this.linkURL=this.config.action.url}catch(b){}var c;null!=this.linkURL&&"www"==this.linkURL.substr(0,3).toLowerCase()&&(this.linkURL="http://"+this.linkURL);try{c=this.config.action.triggerEventType}catch(d){c=null}this.startext.bind(_event._down,function(){c==PageEditor.TriggerEventType.MouseDown&&actionEvent.call(a);
browserType==3?event.cancelBubble=true:event.stopPropagation()});this.startext.bind("mouseover",function(){c==PageEditor.TriggerEventType.MouseOver&&actionEvent.call(a)});this.startext.bind(isTouch?_event._end:"mouseout",function(){c==PageEditor.TriggerEventType.MouseOut&&actionEvent.call(a)})}};
initStarText.prototype.onResize=function(a,b){this.pw=a;this.ph=b;this.setPosition();if(null!=this.form)this.form.onResize(bookContainer.width(),bookContainer.height());if(null!=this.slide)this.slide.onResize(bookContainer.width(),bookContainer.height());if(null!=this.audios)this.audios.onResize(bookContainer.width(),bookContainer.height());this.fontSize=0.75*this.config.lineH*this.originHeight;this.startext.css("font-size",this.fontSize+"px");this.startext2.css("font-size",this.fontSize+"px");this.resizeText(a)};
initStarText.prototype.resizeText=function(a){a/=this.originWidth;this.startext.css({"-webkit-transform-origin":"0% 0%","-moz-transform-origin":"0% 0%","-ms-transform-origin":"0% 0%","-o-transform-origin":"0% 0%","-webkit-transform":"scale("+a+")","-moz-transform":"scale("+a+")","-ms-transform":"scale("+a+")","-o-transform":"scale("+a+")"})};initStarText.prototype.setPosition=function(){this.x=this.config.x*this.pw;this.y=this.config.y*this.ph;this.startext.css({left:this.x+"px",top:this.y+"px"})};function initBanner(a,b,c,d,e){this.config=$.extend({width:200,height:20,x:0,y:0,alpha:1,action:null,banners:null},b);this.pw=c;this.ph=d;this.father=a;this.width=this.config.width*this.pw;this.height=this.config.height*this.ph;this.x=this.config.x*this.pw;this.y=this.config.y*this.ph;this.a=this.config.banners.banner;this.id="banner"+e;this.image=null;if("string"==typeof this.a.imageUrl)this.image="<li><img src='"+this.a.imageUrl+"' /></li>";else for(b=0;b<this.a.length;b++)this.image=null!=this.image?
this.image+"<li><img src='"+this.a[b].imageUrl+"' /></li>":"<li><img src='"+this.a[b].imageUrl+"' /></li>";this.banner=$("<div style='left:"+this.x+"px;top:"+this.y+"px;'></div>");this.bannerul=$("<ul></ul>");this.bannerli=$(this.image);a.append(this.banner);this.banner.append(this.bannerul);this.bannerul.append(this.bannerli);this.imageamin();this.father=a;this.initEvent()}
initBanner.prototype.imageamin=function(){this.banner.jFlip(this.width,this.height,{background:"white",cornersTop:!1,scale:"fill"},this.x,this.y)};
initBanner.prototype.initEvent=function(){var a=this;this.flag=0;this.linkURL;if(null!=a.config.action){try{void 0!=this.config.action.length&&(this.config.action=this.config.action[0]),this.linkURL=this.config.action.url}catch(b){}var c;null!=this.linkURL&&"www"==this.linkURL.substr(0,3).toLowerCase()&&(this.linkURL="http://"+this.linkURL);try{c=this.config.action.triggerEventType}catch(d){c=null}this.banner.bind(_event._down,function(){c==PageEditor.TriggerEventType.MouseDown&&actionEvent.call(a);
browserType==3?event.cancelBubble=true:event.stopPropagation()});this.banner.bind(_event._move,function(){c==PageEditor.TriggerEventType.MouseOver&&actionEvent.call(a)});this.banner.bind(_event._end,function(){c==PageEditor.TriggerEventType.MouseOut&&actionEvent.call(a)})}};initBanner.prototype.onResize=function(a,b){this.pw=a;this.ph=b;this.width=this.config.width*this.pw;this.height=this.config.height*this.ph;$(".bannerdiv canvas").css({width:this.width+"px",height:this.height+"px"});this.setPosition()};
initBanner.prototype.setPosition=function(){this.x=this.config.x*this.pw;this.y=this.config.y*this.ph;$(".bannerdiv").css({left:this.x+"px",top:this.y+"px"})};function initPrint(a,b,c,d,e){this.config=$.extend({width:0.2,height:0.2,x:0.2,y:0.2,alpha:1,src:null},b);this.background=$("<div style = 'z-index:100;'></div>");this.overArea=$("<div></div>");this.img=$("<div></div>");this.imageIndex=e;this.pw=c;this.ph=d;this.width=this.config.width*c;this.height=this.config.height*d;this.background.css({position:"absolute",width:this.width+"px",height:this.height+"px",left:this.pw*this.config.x+"px",top:this.ph*this.config.y+"px",opacity:this.config.alpha,"z-index":"101",
border:this.config.borderWidth+"px solid "+colorTo0x(this.config.borderColor)});this.backcolor=colorTo0x(this.config.overColor);this.overArea.css({position:"absolute",width:this.width+"px",height:this.height+"px",left:"0px",top:"0px",opacity:this.config.overAlpha,background:this.backcolor,"z-index":"101"});this.img.css({position:"absolute",right:"10px",top:"10px","z-index":"102"});a.append(this.background);this.background.append(this.overArea);this.overArea.append(this.img);this.image=$("<img src = '"+
uiBaseURL+"print_icon.png'>");this.img.append(this.image);this.printArea=$("<canvas></canvas>");this.printw=this.config.width*bookConfig.largePageWidth;this.printh=this.config.height*bookConfig.largePageHeight;this.printArea.css({left:0,top:-windowHeight+"px",width:this.printw+"px",height:this.printh+"px",position:"absolute"});this.printImageA=$("<div></div>");this.father=a;this.initEvt();this.overArea.hide()}
initPrint.prototype.initEvt=function(){this.audios=this.slide=this.form=null;var a=this;this.background.mouseEnterZoom();this.background.bind(_event._enter,function(){a.overArea.show()});this.background.bind(_event._down,function(){a.overArea.show()});this.background.bind(_event._end,function(){a.overArea.hide()});this.background.bind(_event._leave,function(){a.overArea.hide()});this.img.bind("mouseover",function(){a.img.css({cursor:"pointer"})});this.image.bind(_event._enter,function(){a.img.css({background:colorDiv(a.backcolor,
30)})});this.image.bind(_event._down,function(){a.img.css({background:colorDiv(a.backcolor,30)})});this.image.bind(_event._end,function(){a.img.css({background:""})});this.image.bind(_event._leave,function(){a.img.css({background:""})});this.image.click(function(){sendvisitinfo(5,getShownPageString());if(browserType==BrowserType.MS&&isBelowIE10Browser())alert("Your browser is not support PrintArea.");else{a.printImageA.empty();a.printArea.empty();var b=a.printArea[0].getContext("2d"),c=a.printArea.width(),
d=a.printArea.height(),e=a.printArea[0].getContext("2d");b.canvas.width=c;b.canvas.height=d;e.canvas.width=c;e.canvas.height=d;var f=new Image;f.src=+bookConfig.largePath+a.imageIndex+".jpg";var g=new Image;$(f).load(function(){e.drawImage(f,-a.config.x*bookConfig.largePageWidth,-a.config.y*bookConfig.largePageHeight);b.drawImage(e.canvas,0,0);g.src=$(a.printArea)[0].toDataURL("image/png");$(g).load(function(){a.printImageA.printArea()})});a.printImageA.append(g)}})};
initPrint.prototype.onResize=function(a,b){this.pw=a;this.ph=b;this.width=a*this.config.width;this.height=b*this.config.height;this.setPosition(this.config.x*a,this.config.y*b);this.background.css({position:"absolute",width:this.width+"px",height:this.height+"px",left:this.pw*this.config.x+"px",top:this.ph*this.config.y+"px"});this.overArea.css({position:"absolute",width:this.width+"px",height:this.height+"px",left:"0px",top:"0px"});this.img.css({position:"absolute",right:"10px",top:"10px"});this.background.mouseEnterZoom()};
initPrint.prototype.setPosition=function(){};function initAlphaTransitionBanner(a,b,c,d){function e(){f.timer0=setInterval(function(){if(0<f.alpha){f.alpha-=1;$(f.currentImageHolder).css({opacity:f.alpha/100});var a=0,a=0<f.currentImage?(f.currentImage-1)%f.images.length:f.images.length-1;f.imgTitle.html(f.photos[a].imageName)}else clearInterval(f.timer0),f.currentImageHolder==f.image0Holder?($(f.image0Holder).css({"z-index":"207"}),$(f.image1Holder).css({"z-index":"208"}),f.alpha=100,$(f.currentImageHolder).css({opacity:f.alpha/100}),f.currentImageHolder=
f.image1Holder,f.image0Holder.empty().append(f.images[f.currentImage])):($(f.image0Holder).css({"z-index":"208"}),$(f.image1Holder).css({"z-index":"207"}),f.alpha=100,$(f.currentImageHolder).css({opacity:f.alpha/100}),f.currentImageHolder=f.image0Holder,f.image1Holder.empty().append(f.images[f.currentImage])),f.currentImage=(f.currentImage+1)%f.images.length,f.timer1=setTimeout(e,f.interval)},20)}this.config=$.extend({width:0.2,height:0.2,x:0.2,y:0.2,alpha:1,src:null},b);this.photos=$.extend([],b.images);
if(!(1>this.photos.length)){this.father=a;this.pw=c;this.ph=d;this.imgIndex=-1;this.imgWidth=this.config.width*c;this.imgHeight=this.config.height*d;this.boxWidth=this.imgWidth-8;this.boxHeight=this.imgHeight-8;this.x=this.config.x*this.pw;this.y=this.config.y*this.ph;this.interval=3E3;this.fadeTime=10;this.alpha=100;this.images=[];this.background=$("<div></div>");this.background.css({"z-index":"199",border:"1px solid #333333"});this.background.css({width:this.imgWidth,height:this.imgHeight});this.slideShowBG=
new grayBackground(this.background,"#ffffff",1,this.imgWidth,this.imgHeight);this.toolBar=$("<div></div>");this.toolBar.css({width:this.boxWidth,height:"35px",position:"relative"});this.toolBar.css({"z-index":"209"});this.toolBG=new grayBackground(this.toolBar,"#000000",0.3,this.boxWidth,35);this.toolBG.setZindex("210");this.toolBG.setPosition(0,0);this.imgTitle=$("<div></div>");this.imgTitle.css({overflow:"hidden",width:this.boxWidth-20+"px",height:"20px",position:"absolute","z-index":"211",background:"",
left:"10px",top:"7px",color:"#ffffff"});this.image0Holder=$("<div></div>");this.image1Holder=$("<div></div>");this.img=$("<img style='position : absolute;' />");this.leftButton=new button(1,this.toolBar,{iconURL:uiBaseURL+"previous_down.png"});this.rightButton=new button(1,this.toolBar,{iconURL:uiBaseURL+"next_down.png"});a.append(this.background);this.background.append(this.image1Holder);this.background.append(this.image0Holder);this.background.append(this.toolBar);this.toolBar.css({left:(this.imgWidth-
this.boxWidth)/2+"px",top:(this.imgHeight-this.boxHeight)/2+"px"});this.toolBar.append(this.imgTitle);this.rightButton.setCSS({"z-index":212,right:"0px",top:"13px"});this.leftButton.setCSS({"z-index":212,right:"20px",top:"13px"});this.background.css({left:this.x+"px",top:this.y+"px",position:"absolute","-webkit-box-shadow":"0 0 10px rgba(40, 40, 40, 0.7)","-moz-box-shadow":"0 0 10px rgba(40, 40, 40, 0.7)","-ms-box-shadow":"0 0 10px rgba(40, 40, 40, 0.7)","-o-box-shadow":"0 0 10px rgba(40, 40, 40, 0.7)",
"box-shadow":"0 0 10px rgba(40, 40, 40, 0.7)"});this.image0Holder.css({width:this.boxWidth+"px",height:this.boxHeight+"px",left:(this.imgWidth-this.boxWidth)/2+"px",top:(this.imgHeight-this.boxHeight)/2+"px",position:"absolute","z-index":202});this.image1Holder.css({width:this.boxWidth+"px",height:this.boxHeight+"px",left:(this.imgWidth-this.boxWidth)/2+"px",top:(this.imgHeight-this.boxHeight)/2+"px",position:"absolute","z-index":202});this.addItem();var f=this;this.leftButton.onMouseDown(this,this.prePage);
this.rightButton.onMouseDown(this,this.nextPage);this.currentImageHolder=this.image0Holder;this.currentImage=2%this.images.length;this.image0Holder.append(this.images[0]);this.image1Holder.append(this.images[1]);this.imgTitle.html(this.photos[0].imageName);f=this;this.timer1=setTimeout(e,this.interval);this.toolBar.show();this.leftButton.remove();this.rightButton.remove()}}
initAlphaTransitionBanner.prototype.nextPage=function(){clearInterval(this.timer0);var a=0,a=0<this.currentImage?(this.currentImage-1)%this.images.length:this.images.length-1;this.imgTitle.html(this.photos[a].imageName);this.currentImageHolder==this.image0Holder?($(this.image0Holder).css({"z-index":"207"}),$(this.image1Holder).css({"z-index":"208"}),this.alpha=100,$(this.currentImageHolder).css({opacity:this.alpha/100}),this.currentImageHolder=this.image1Holder,this.image0Holder.empty().append(this.images[this.currentImage])):
($(this.image0Holder).css({"z-index":"208"}),$(this.image1Holder).css({"z-index":"207"}),this.alpha=100,$(this.currentImageHolder).css({opacity:this.alpha/100}),this.currentImageHolder=this.image0Holder,this.image1Holder.empty().append(this.images[this.currentImage]));this.currentImage=(this.currentImage+1)%this.images.length};
initAlphaTransitionBanner.prototype.prePage=function(){var a=0,a=2<this.currentImage?(this.currentImage-3)%this.images.length:1==this.currentImage?this.images.length-2:this.images.length-3;this.imgTitle.html(this.photos[a].imageName);this.currentImageHolder==this.image0Holder?($(this.image0Holder).css({"z-index":"207"}),$(this.image1Holder).css({"z-index":"208"}),this.alpha=100,$(this.currentImageHolder).css({opacity:this.alpha/100}),this.currentImageHolder=this.image1Holder,this.image1Holder.empty().append(this.images[a])):
($(this.image0Holder).css({"z-index":"208"}),$(this.image1Holder).css({"z-index":"207"}),this.alpha=100,$(this.currentImageHolder).css({opacity:this.alpha/100}),this.currentImageHolder=this.image0Holder,this.image0Holder.empty().append(this.images[this.index]));this.currentImage=(this.currentImage-1)%this.images.length};
initAlphaTransitionBanner.prototype.addItem=function(){for(var a=0;a<this.photos.length;a++){var b=$("<div></div>");b.css({width:this.boxWidth+"px",height:this.boxHeight+"px"});image=$("<img style='position : absolute;' />");image.remove();var c=this.photos[a].url;!0==isFlipPdf&&(c="."+c);image.attr("src",c);image.css({width:this.boxWidth+"px",height:this.boxHeight+"px"});b.append(image);this.images[a]=b}};
initAlphaTransitionBanner.prototype.onResize=function(a,b){this.pw=a;this.ph=b;this.imgWidth=this.config.width*this.pw;this.imgHeight=this.config.height*this.ph;this.boxWidth=this.imgWidth-8;this.boxHeight=this.imgHeight-8;this.background.css({width:this.imgWidth,height:this.imgHeight});this.toolBar.css({width:this.boxWidth,height:"35px"});this.toolBG.onResize(this.boxWidth,35);this.toolBG.setPosition(0,0);this.imgTitle.css({width:this.boxWidth-20+"px",height:"20px",left:"10px",top:"7px"});this.slideShowBG.onResize(this.imgWidth,
this.imgHeight);for(var c=0;c<this.images.length;c++)this.images[c].children().css({width:this.boxWidth+"px",height:this.boxHeight+"px"});this.setPosition()};
initAlphaTransitionBanner.prototype.setPosition=function(){this.x=this.config.x*this.pw;this.y=this.config.y*this.ph;this.background.css({left:this.x+"px",top:this.y+"px",position:"absolute"});this.image0Holder.css({width:this.boxWidth+"px",height:this.boxHeight+"px",left:(this.imgWidth-this.boxWidth)/2+"px",top:(this.imgHeight-this.boxHeight)/2+"px",position:"absolute"});this.image1Holder.css({width:this.boxWidth+"px",height:this.boxHeight+"px",left:(this.imgWidth-this.boxWidth)/2+"px",top:(this.imgHeight-
this.boxHeight)/2+"px",position:"absolute"})};initAlphaTransitionBanner.prototype.changeImage=function(a){this.imgIndex=a;this.img.remove();a=this.photos[a].url;!0==isFlipPdf&&(a="."+a);var b=this;this.img.attr("src",a);this.img.load(function(){var a=b.boxWidth,d=b.boxHeight;b.img.css({width:a+"px",height:d+"px"});b.boxWidth!=a||b.boxHeight!=d?b.image0Holder.animate({width:a+8,height:d+8,left:(b.pw-a)/2,top:(b.ph-d)/2},300,function(){b.image0Holder.append(b.img)}):(b.image0Holder.append(b.img),b.image1Holder.append(b.img))})};
initAlphaTransitionBanner.prototype.setImagePosition=function(){};initAlphaTransitionBanner.prototype.show=function(){};initAlphaTransitionBanner.prototype.hide=function(){};function initCarousel(a,b,c,d,e){this.config=$.extend({width:200,height:20,x:0,y:0,alpha:1,images:null},b);this.pw=c;this.ph=d;this.father=a;this.width=this.config.width*this.pw;this.height=this.config.height*this.ph;this.x=this.config.x*this.pw;this.y=this.config.y*this.ph;this.id="carousel"+e;this.config.images!={}&&(this.images=this.config.images.node,this.content=$("<div></div>"),this.content.css({position:"absolute",left:this.x+"px",top:this.y+"px",width:this.width+"px",height:this.height+"px",
border:"0px solid red"}),this.currentIndex=0,this.father.append(this.content),this.initImages(),this.startMove())}
initCarousel.prototype.initImages=function(){if(!(void 0==this.images||null==this.images||0==this.images.length)){this.refreshImageAndPosition();this.carouselList=new CarouselImageList;this.carouselList.setResources(this.aImages);this.carouselList.setPositions(this.aPositions);for(var a=0;a<this.aPositions.length;a++)this.carouselList.addInstance(new CarouselImage(this.content,this.aPositions[a]));this.carouselList.loadResources();this.carouselList.blurAll()}};
initCarousel.prototype.refreshImageAndPosition=function(){if(!(void 0==this.images||null==this.images||0==this.images.length)){var a=this.width/5;this.aImages=[];this.aPositions=[];var b=5;5>this.images.length&&(b=Math.min(this.images.length,3));switch(b){case 1:this.aImages.push(this.images[0].url);this.aPositions.push(new CarouselPosition(0,0,this.width,this.height,1));break;case 2:this.aImages.push(this.images[0].url);this.aImages.push(this.images[(this.currentIndex+1)%this.images.length].url);
b=Math.ceil((this.width-a)/2);this.aPositions.push(new CarouselPosition(b,0,a,a,2));b=Math.ceil((this.width-3*a+5)/2)+(2*a-5);this.aPositions.push(new CarouselPosition(b,5,a-5,a-5,1));break;case 3:this.aImages.push(this.images[(this.currentIndex-1+this.images.length)%this.images.length].url);this.aImages.push(this.images[this.currentIndex%this.images.length].url);this.aImages.push(this.images[(this.currentIndex+1)%this.images.length].url);b=Math.ceil((this.width-3*a+10)/2);this.aPositions.push(new CarouselPosition(b,
5,a-5,a-5,0));b=Math.ceil((this.width-a)/2);this.aPositions.push(new CarouselPosition(b,0,a,a,2));b=Math.ceil((this.width-3*a+10)/2)+(2*a-5);this.aPositions.push(new CarouselPosition(b,5,a-5,a-5,1));break;case 5:this.aImages.push(this.images[(this.currentIndex-2+this.images.length)%this.images.length].url),this.aImages.push(this.images[(this.currentIndex-1+this.images.length)%this.images.length].url),this.aImages.push(this.images[this.currentIndex%this.images.length].url),this.aImages.push(this.images[(this.currentIndex+
1)%this.images.length].url),this.aImages.push(this.images[(this.currentIndex+2)%this.images.length].url),b=Math.ceil((this.width-5*a+20)/2),this.aPositions.push(new CarouselPosition(b,5,2*a-5,2*a-5,0)),b=Math.ceil((this.width-3*a+10)/2),this.aPositions.push(new CarouselPosition(b,5,2*a-5,2*a-5,2)),b=Math.ceil((this.width-2*a)/2),this.aPositions.push(new CarouselPosition(b,0,3*a,3*a,3)),b=Math.ceil((this.width-3*a+10)/2)+(2*a-5),this.aPositions.push(new CarouselPosition(b,5,2*a-5,2*a-5,2)),b=Math.ceil((this.width-
5*a+20)/2)+(4*a-15),this.aPositions.push(new CarouselPosition(b,5,2*a-5,2*a-5,1))}}};initCarousel.prototype.startMove=function(){var a=this;this.timer=window.setInterval(function(){a.move(1)},2E3)};initCarousel.prototype.stopMove=function(){window.clearInterval(this.timer)};
initCarousel.prototype.move=function(a){this.currentIndex+=a;0>this.currentIndex&&(this.currentIndex+=this.images.length);this.currentIndex%=this.images.length;var b=[];switch(this.carouselList.instanceCount()){case 1:b.push(this.images[0].url);break;case 2:b.push(this.images[this.currentIndex%this.images.length].url);b.push(this.images[(this.currentIndex+1)%this.images.length].url);break;case 3:b.push(this.images[(this.currentIndex-1+this.images.length)%this.images.length].url);b.push(this.images[this.currentIndex%
this.images.length].url);b.push(this.images[(this.currentIndex+1)%this.images.length].url);break;case 5:b.push(this.images[(this.currentIndex-2+this.images.length)%this.images.length].url),b.push(this.images[(this.currentIndex-1+this.images.length)%this.images.length].url),b.push(this.images[this.currentIndex%this.images.length].url),b.push(this.images[(this.currentIndex+1)%this.images.length].url),b.push(this.images[(this.currentIndex+2)%this.images.length].url)}this.carouselList.setResources(b);
this.carouselList.move(a)};initCarousel.prototype.onResize=function(a,b){this.pw=a;this.ph=b;this.width=this.config.width*this.pw;this.height=this.config.height*this.ph;this.content.css({width:this.width+"px",height:this.height+"px"});this.setPosition();this.refreshImageAndPosition();this.carouselList.setResources(this.aImages);this.carouselList.setPositions(this.aPositions);this.carouselList.resizeAll()};
initCarousel.prototype.setPosition=function(){this.x=this.config.x*this.pw;this.y=this.config.y*this.ph;this.content.css({left:this.x+"px",top:this.y+"px"})};function CarouselImage(a,b){this.father=a;this.instance=$('<img style="position:absolute"></img');this.father.append(this.instance);this.imageHeight=this.imageWidth=0;var c=this;this.instance.load(function(){CarouselImage.prototype.onImageLoad.apply(c,arguments)});this.setArea(b.left,b.top,b.width,b.height);this.setZindex(b.zindex)}
CarouselImage.prototype={blur:function(a){!0==a?this.instance.css({"-webkit-filter":"blur(2px)","-moz-filter":"blur(2px)","-o-filter":"blur(2px)","-ms-filter":"blur(2px)",filter:"blur(2px)"}):this.instance.css({"-webkit-filter":"blur(0px)","-moz-filter":"blur(0px)","-o-filter":"blur(0px)","-ms-filter":"blur(0px)",filter:"blur(0px)"})},setSrc:function(a){this.instance[0].src=a},getSrc:function(){return this.instance[0].src},onImageLoad:function(){var a=this.instance[0];this.imageWidth=a.naturalWidth;
this.imageHeight=a.naturalHeight;this.instance.css({height:Math.ceil(this.imageHeight*this.instance.width()/this.imageWidth)+"px"})},move:function(a,b){this.instance.css({left:a+"px",top:b+"px"})},resize:function(a,b){var c=b;0<this.imageWidth&&0<this.imageHeight&&(c=Math.ceil(this.imageHeight*this.instance.width()/this.imageWidth));this.instance.css({width:a+"px",height:c+"px"})},setArea:function(a,b,c,d){this.move(a,b);this.resize(c,d)},setZindex:function(a){this.instance.css({"z-index":a})},gotoPosition:function(a){var b=
a.height;0<this.imageWidth&&0<this.imageHeight&&(b=Math.ceil(this.imageHeight*a.width/this.imageWidth));var c=this;this.instance.animate({left:a.left,top:a.top,width:a.width,height:b},500,function(){c.setZindex(a.zindex)})}};function CarouselPosition(a,b,c,d,e){this.left=Math.ceil(a);this.top=Math.ceil(b);this.width=Math.ceil(c);this.height=Math.ceil(d);this.zindex=e}
CarouselPosition.prototype={asString:function(){return"left:"+this.left+",top:"+this.top+",width:"+this.width+",height:"+this.height+",z-index:"+this.zindex}};function CarouselImageList(){this.imageResources=[];this.imagePositions=[];this.imageInstances=[]}
CarouselImageList.prototype={setResources:function(a){for(;0<this.imageResources.length;)this.imageResources.pop();for(var b=0;b<a.length;b++)this.imageResources.push(a[b])},setPositions:function(a){for(;0<this.imagePositions.length;)this.imagePositions.pop();for(var b=0;b<a.length;b++)this.imagePositions.push(a[b])},addInstance:function(a){this.imageInstances.push(a)},instanceCount:function(){return this.imageInstances.length},loadResources:function(){for(var a=this.imageInstances.length,b=0;b<a;b++){var c=
this.imageInstances[b];c.getSrc()!=this.imageResources[b]&&c.setSrc(this.imageResources[b])}},move:function(a){var b=this.imageInstances.length;if(0!=b){for(var c=this.imageInstances[0],d=0;d<b;d++){var e=d+a;0>e&&(e+=b);e>=b&&(e%=b);var f=this.imageInstances[e];this.imageInstances[d]=0==e?c:f}for(d=0;d<b;d++)this.imageInstances[d].gotoPosition(this.imagePositions[d]);this.loadResources();this.blurAll()}},resizeAll:function(){var a=this.imageInstances.length;if(0!=a)for(var b=0;b<a;b++)this.imageInstances[b].gotoPosition(this.imagePositions[b])},
blurAll:function(){for(var a=this.imageInstances.length,b=Math.floor((a+1)/2)-1,c=0;c<a;c++){var d=this.imageInstances[c];c!=b?d.blur(!0):d.blur(!1)}}};function initDynamicShow(a,b,c,d,e){this.config=$.extend({width:200,height:20,x:0,y:0,alpha:1,images:null},b);this.pw=c;this.ph=d;this.father=a;this.width=this.config.width*this.pw;this.childWidth=Math.ceil(this.width/4);this.height=this.config.height*this.ph;this.x=this.config.x*this.pw;this.y=this.config.y*this.ph;this.borderWidth=this.config.borderWidth;this.id="dynshow"+e;this.config.images!={}&&(this.images=this.config.images.Image,this.maxZindex=this.images.length+1,this.content=$("<div></div>"),
this.content.css({position:"absolute",left:this.x+"px",top:this.y+"px",width:this.width+"px",height:this.height+"px",border:"0px solid red"}),this.currentIndex=0,this.father.append(this.content),this.init())}
initDynamicShow.prototype={init:function(){this.imageInstances=[];if(0!=this.images.length){for(var a=0;a<this.images.length;a++){var b=new ImageInstance(this,a);b.setImage(this.images[a].Image);this.content.append(b);this.imageInstances.push(b)}this.currentIndex=-1;this.initButtons()}},initButtons:function(){this.leftButton=$('<img src="'+uiBaseURL+'pre_image.png" style="position:absolute;z-index:1000"></img>');this.rightButton=$('<img src="'+uiBaseURL+'next_image.png" style="position:absolute;z-index:1000"></img>');
this.setButtonPosition();var a=this;this.leftButton.bind(_event._click,function(){initDynamicShow.prototype.preImage.apply(a,arguments)});this.rightButton.bind(_event._click,function(){initDynamicShow.prototype.nextImage.apply(a,arguments)});isTouchDevice()||(this.leftButton.css({display:"none"}),this.rightButton.css({display:"none"}));this.content.append(this.leftButton);this.content.append(this.rightButton);this.content.bind(_event._enter,function(){a.leftButton.css({display:"block"});a.rightButton.css({display:"block"})});
this.content.bind(_event._leave,function(){a.leftButton.css({display:"none"});a.rightButton.css({display:"none"})})},preImage:function(){-1!=this.currentIndex&&this.imageInstances[this.currentIndex].hide();this.currentIndex=(this.currentIndex-1+this.images.length)%this.images.length;this.imageInstances[this.currentIndex].show()},nextImage:function(){-1!=this.currentIndex&&this.imageInstances[this.currentIndex].hide();this.currentIndex=(this.currentIndex+1)%this.images.length;this.imageInstances[this.currentIndex].show()},
showImage:function(a){-1!=a&&(-1!=this.currentIndex&&this.imageInstances[this.currentIndex].hide(),this.currentIndex=a,this.imageInstances[this.currentIndex].show())},setButtonPosition:function(){var a=(this.height-32)/2;this.leftButton.css({left:"0px",top:a+"px"});this.rightButton.css({right:"0px",top:a+"px"})},onResize:function(a,b){this.pw=a;this.ph=b;this.width=this.config.width*this.pw;this.height=this.config.height*this.ph;this.content.css({width:this.width+"px",height:this.height+"px"});this.setPosition();
this.setButtonPosition();this.childWidth=Math.ceil(this.width/4);for(var c=0;c<this.imageInstances.length;c++)this.imageInstances[c].onResize()},setPosition:function(){this.x=this.config.x*this.pw;this.y=this.config.y*this.ph;this.content.css({left:this.x+"px",top:this.y+"px"})}};
function ImageInstance(a,b){var c=this;this.father=a;this.zIndex=b;this.imageHeight=this.imageWidth=0;this.height=this.width=this.father.childWidth;this.borderWidth=Math.ceil(this.father.borderWidth/2);this.maxLeft=this.father.width-this.width;this.maxTop=this.father.height-this.height;var d=randomPosition(this.maxLeft,this.maxTop);this.rotation=d.rotation;this.animate=[];this.instance=$("<img></img>");this.instance.css({position:"absolute",left:d.left+"px",top:d.top+"px",width:this.width+"px",height:this.height+
"px",display:"none"});this.instance.rotate(this.rotation);this.setBorderWidth(this.borderWidth);this.initShadow();this.instance.load(function(){ImageInstance.prototype.onImageLoad.apply(c,arguments)});this.instance.bind(_event._click,function(){c.father.currentIndex==c.zIndex?(c.hide(),c.father.currentIndex=-1):c.father.showImage(c.zIndex)});a.content.append(this.instance)}
ImageInstance.prototype={initShadow:function(){this.instance.css({"-moz-box-shadow":"2px 2px 4px #252525","box-shadow":"2px 2px 4px #252525","-webkit-box-shadow":"2px 2px 4px #252525","-ms-box-shadow":"2px 2px 4px #252525","-o-box-shadow":"2px 2px 4px #252525"})},onImageLoad:function(){var a=this.instance[0];this.imageWidth=a.naturalWidth;this.imageHeight=a.naturalHeight;this.height=Math.ceil(this.imageHeight*this.width/this.imageWidth);this.maxTop=this.father.height-this.height;this.instance.css({height:this.height+
"px",display:"block"})},setImage:function(a){this.instance.attr("src",a)},onResize:function(){this.width=this.father.childWidth;this.height=0<this.imageWidth&&0<this.imageHeight?Math.ceil(this.imageHeight*this.width/this.imageWidth):this.width;this.maxLeft=this.father.width-this.width;this.maxTop=this.father.height-this.height;if(this.zIndex!=this.father.currentIndex){var a=this.getPosition(),b=this.width/a.width;a.left=Math.floor(a.left*b);a.top=Math.floor(a.top*b);a.width=this.width;a.height=this.height}else a=
this.getTopPosition();this.moveTo(a)},resize:function(a,b){this.width=a;this.height=b;this.instance.css({width:this.width+"px",height:this.height+"px"})},move:function(){this.instance.css({left:this.left+"px",top:this.top+"px"})},setZindex:function(a){this.instance.css({"z-index":a})},setBorderWidth:function(a){this.instance.css({border:a+"px solid white"})},getTopPosition:function(){if(this.imageWidth/this.imageHeight>this.father.width/this.father.height)var a=this.father.width,b=a*this.imageHeight/
this.imageWidth,c=(this.father.height-b)/2-this.father.borderWidth,d=0,e=0;else b=this.father.height,a=b*this.imageWidth/this.imageHeight,e=c=0,d=(this.father.width-a)/2-this.father.borderWidth;return new DynImagePostion(d,c,a,b,e)},show:function(){if(!(0==this.imageWidth||0==this.imageHeight)){var a=this.getTopPosition();a.borderWidth=this.father.borderWidth;this.setZindex(this.father.maxZindex);this.moveTo(a,function(){this.setZindex(this.father.maxZindex)})}},hide:function(){if(!(0==this.imageWidth||
0==this.imageHeight)){var a=randomPosition(this.maxLeft,this.maxTop),a=new DynImagePostion(a.left,a.top,this.width,this.height,a.rotation);this.setZindex(this.father.maxZindex-1);a.borderWidth=this.borderWidth;this.moveTo(a,function(){this.setZindex(this.zIndex)})}},moveTo:function(a,b){var c=null,d=0,e=this,f=window.setInterval(function(){!1==e.isInAnimate(f)&&e.animate.push(f);if(!1!=e.isRunning(f)){null==c&&(c=e.getPosition());var g=$.easing.swing(null,d,c.left,a.left-c.left,20),h=$.easing.swing(null,
d,c.top,a.top-c.top,20),j=$.easing.swing(null,d,c.width,a.width-c.width,20),k=$.easing.swing(null,d,c.height,a.height-c.height,20),m=$.easing.swing(null,d,c.rotation,a.rotation-c.rotation,20),l=$.easing.swing(null,d,c.borderWidth,a.borderWidth-c.borderWidth,20);e.instance.css({left:g+"px",top:h+"px",width:j+"px",height:k+"px"});e.instance.rotate(m);e.setBorderWidth(l);e.rotation=m;20==d++&&(window.clearInterval(f),e.animate.shift(),void 0!=b&&b.apply(e,arguments))}},20)},isInAnimate:function(a){for(var b=
0;b<this.animate.length;b++)if(a==this.animate[b])return!0;return!1},isRunning:function(a){return a==this.animate[0]},getPosition:function(){var a=parseInt(this.instance.css("left").replace("px","")),b=parseInt(this.instance.css("top").replace("px","")),c=this.instance.width(),d=this.instance.height(),a=new DynImagePostion(a,b,c,d,this.rotation),b=this.instance.css("border"),b=parseInt(b.replace("px solid white"));a.borderWidth=b;return a}};
function DynImagePostion(a,b,c,d,e){this.left=a;this.top=b;this.width=c;this.height=d;this.rotation=e}DynImagePostion.prototype={asString:function(){return"left:"+this.left+",top:"+this.top+",width:"+this.width+",height:"+this.height+",rotation:"+this.rotation}};function randomPosition(a,b){var c=Math.floor(Math.random()*a),d=Math.floor(Math.random()*b),e=75-Math.floor(150*Math.random());return{left:c,top:d,rotation:e}};function initFlipJump(a,b,c,d,e){this.config=$.extend({width:200,height:20,x:0,y:0,images:null},b);this.pw=c;this.ph=d;this.father=a;this.width=this.config.width*this.pw;this.height=this.config.height*this.ph;this.x=this.config.x*this.pw;this.y=this.config.y*this.ph;this.id="jump"+e;this.itemHeight=Math.floor(0.7*this.height);this.config.images!={}&&(this.images=this.config.images.Image,this.imageCount=this.images.length,this.minZindex=0,this.maxZindex=this.images.length+1,a=!0==this.config.addBorder?
1:0,this.content=$("<div></div>"),this.content.css({position:"absolute",left:this.x+"px",top:this.y+"px",width:this.width+"px",height:this.height+"px",border:a+"px solid "+colorTo0x(this.config.borderColor)}),!0==this.config.addBackground&&this.content.css({background:colorTo0x(this.config.backgroundColor),opacity:this.config.backgroundAlpha}),this.father.append(this.content),this.init())}
initFlipJump.prototype={init:function(){this.busy=!1;this.imageItems=[];for(var a=0;a<this.imageCount;a++){var b=new FlipJumpItem(this,0==a?!1:!0);b.setImage(this.images[a].Image);this.imageItems.push(b)}this.resetZindex();this.resetJumpEvent();1<this.imageCount&&this.initButtons()},initButtons:function(){this.leftButton=$('<img src="'+uiBaseURL+'pre_image.png" style="position:absolute;z-index:1000"></img>');this.rightButton=$('<img src="'+uiBaseURL+'next_image.png" style="position:absolute;z-index:1000"></img>');
this.setButtonPosition();var a=this;this.leftButton.bind(_event._click,function(){initFlipJump.prototype.preImage.apply(a,arguments)});this.rightButton.bind(_event._click,function(){initFlipJump.prototype.nextImage.apply(a,arguments)});isTouchDevice()||(this.leftButton.css({display:"none"}),this.rightButton.css({display:"none"}));this.content.append(this.leftButton);this.content.append(this.rightButton);this.content.bind(_event._enter,function(){a.leftButton.css({display:"block"});a.rightButton.css({display:"block"})});
this.content.bind(_event._leave,function(){a.leftButton.css({display:"none"});a.rightButton.css({display:"none"})})},preImage:function(){if(!0!=this.busy){this.busy=!0;var a=this.imageItems[this.imageCount-1],b=this;this.imageItems[0].randomRotate();a.rotateTo(0,40);a.jumpUp(function(){a.setZindex(b.maxZindex);a.jumpDown(function(){b.imageItems.pop();b.imageItems.unshift(a);b.resetZindex();b.busy=!1})})}},nextImage:function(){if(!0!=this.busy){this.busy=!0;var a=this.imageItems[0],b=this;this.imageItems[1].rotateTo(0);
a.randomRotate(40);a.jumpUp(function(){a.setZindex(b.minZindex);a.jumpDown(function(){b.imageItems.shift();b.imageItems.push(a);b.resetZindex();b.busy=!1})})}},resetZindex:function(){for(var a=0;a<this.imageItems.length;a++)this.imageItems[a].setZindex(this.imageItems.length-a)},resetJumpEvent:function(){for(var a=this,b=0;b<this.imageItems.length;b++)this.imageItems[b].instance.bind(_event._click,function(){initFlipJump.prototype.nextImage.apply(a,arguments)})},setButtonPosition:function(){var a=
(this.height-32)/2;this.leftButton.css({left:"0px",top:a+"px"});this.rightButton.css({right:"0px",top:a+"px"})},onResize:function(a,b){this.pw=a;this.ph=b;this.width=this.config.width*this.pw;this.height=this.config.height*this.ph;this.content.css({width:this.width+"px",height:this.height+"px"});this.setPosition();this.setButtonPosition();this.itemHeight=Math.floor(0.7*this.height);for(var c=0;c<this.imageItems.length;c++)this.imageItems[c].resize()},setPosition:function(){this.x=this.config.x*this.pw;
this.y=this.config.y*this.ph;this.content.css({left:this.x+"px",top:this.y+"px"})}};
function FlipJumpItem(a,b){var c=this;this.father=a;this.initRotate=b;this.rotation=0;this.height=this.width=a.itemHeight;this.imageHeight=this.imageWidth=0;this.instance=$("<img></img>");this.instance.css({position:"absolute",left:"0px",top:"0px",width:this.width+"px",height:this.height+"px",border:"2px solid white",display:"none"});this.instance.load(function(){FlipJumpItem.prototype.onImageLoad.apply(c,arguments)});this.initShadow();a.content.append(this.instance)}
FlipJumpItem.prototype={initShadow:function(){this.instance.css({"-moz-box-shadow":"2px 2px 4px #252525","box-shadow":"2px 2px 4px #252525","-webkit-box-shadow":"2px 2px 4px #252525","-ms-box-shadow":"2px 2px 4px #252525","-o-box-shadow":"2px 2px 4px #252525"})},getRandomRotation:function(){return 60-Math.ceil(120*Math.random())},onImageLoad:function(){var a=this.instance[0];this.imageWidth=a.naturalWidth;this.imageHeight=a.naturalHeight;this.width=Math.ceil(this.height*this.imageWidth/this.imageHeight);
this.left=Math.ceil((this.father.width-this.width)/2);this.top=Math.ceil((this.father.height-this.height)/2);this.instance.css({left:this.left+"px",top:this.top+"px",width:this.width+"px",height:this.height+"px",display:"block"});!0==this.initRotate&&(a=this.getRandomRotation(),this.instance.rotate(a),this.rotation=a)},setImage:function(a){this.instance.attr("src",a)},setZindex:function(a){this.instance.css({"z-index":a})},randomRotate:function(a){this.rotateTo(this.getRandomRotation(),a)},rotateTo:function(a,
b){var c=this.rotation,d=20;void 0!=b&&(d=b);var e=this,f=0,g=window.setInterval(function(){var b=$.easing.swing(null,f,c,a-c,d);e.instance.rotate(b);e.rotation=b;f++>=d&&window.clearInterval(g)},20)},jumpUp:function(a){this.instance.animate({top:Math.floor(1.3*-this.height)},400,a)},jumpDown:function(a){this.instance.animate({top:this.top},400,a)},resize:function(){0==this.imageWith&&0==this.imageHeight||(this.height=this.father.itemHeight,this.width=Math.ceil(this.height*this.imageWidth/this.imageHeight),
this.left=Math.ceil((this.father.width-this.width)/2),this.top=Math.ceil((this.father.height-this.height)/2),this.instance.animate({left:this.left,top:this.top,width:this.width,height:this.height},400))}};function initRotate3D(a,b,c,d,e){this.config=$.extend({width:200,height:20,x:0,y:0,images:null},b);this.pw=c;this.ph=d;this.father=a;this.width=this.config.width*this.pw;this.height=this.config.height*this.ph;this.x=this.config.x*this.pw;this.y=this.config.y*this.ph;this.id="3d"+e;this.config.images!={}&&(this.images=this.config.images.Image,this.topZindex=this.imageCount=this.images.length,a=!0==this.config.addBorder?1:0,this.content=$("<div></div>"),this.content.css({position:"absolute",overflow:"hidden",
left:this.x+"px",top:this.y+"px",width:this.width+"px",height:this.height+"px",border:a+"px solid "+colorTo0x(this.config.borderColor)}),!0==this.config.addBackground&&this.content.css({background:colorTo0x(this.config.backgroundColor),opacity:this.config.backgroundAlpha/100}),this.father.append(this.content),this.init(),this.rotateTimer=-1,this.step=0)}
initRotate3D.prototype={init:function(){this.imageItems=[];for(var a=0;a<this.imageCount;a++){var b=new Rotate3DItem(this,a);b.setImage(this.images[a].Image);this.imageItems.push(b)}this.imageItems[0].show();this.currentIndex=0;1<this.imageCount&&this.initButtons()},initButtons:function(){this.leftButton=$('<img src="'+uiBaseURL+'pre_image.png" style="position:absolute;z-index:1000"></img>');this.rightButton=$('<img src="'+uiBaseURL+'next_image.png" style="position:absolute;z-index:1000"></img>');
this.setButtonPosition();var a=this;this.leftButton.bind(_event._down,function(){initRotate3D.prototype.preImage.apply(a,arguments)});this.rightButton.bind(_event._down,function(){initRotate3D.prototype.nextImage.apply(a,arguments)});this.leftButton.bind(_event._end,function(){initRotate3D.prototype.stopRotate.apply(a,arguments)});this.rightButton.bind(_event._end,function(){initRotate3D.prototype.stopRotate.apply(a,arguments)});this.leftButton.bind(_event._leave,function(){initRotate3D.prototype.stopRotate.apply(a,
arguments)});this.rightButton.bind(_event._leave,function(){initRotate3D.prototype.stopRotate.apply(a,arguments)});isTouchDevice()||(this.leftButton.css({display:"none"}),this.rightButton.css({display:"none"}));this.content.append(this.leftButton);this.content.append(this.rightButton);this.content.bind(_event._enter,function(){a.leftButton.css({display:"block"});a.rightButton.css({display:"block"})});this.content.bind(_event._leave,function(){a.leftButton.css({display:"none"});a.rightButton.css({display:"none"})})},
setButtonPosition:function(){var a=(this.height-32)/2;this.leftButton.css({left:"0px",top:a+"px"});this.rightButton.css({right:"0px",top:a+"px"})},onResize:function(a,b){this.pw=a;this.ph=b;this.width=this.config.width*this.pw;this.height=this.config.height*this.ph;this.content.css({width:this.width+"px",height:this.height+"px"});this.setPosition();this.setButtonPosition();for(var c=0;c<this.imageItems.length;c++)this.imageItems[c].resize()},setPosition:function(){this.x=this.config.x*this.pw;this.y=
this.config.y*this.ph;this.content.css({left:this.x+"px",top:this.y+"px"})},preImage:function(){this.step=-1;this.startRotate()},nextImage:function(){this.step=1;this.startRotate()},startRotate:function(){var a=this;this.doRotate();window.clearInterval(this.rotateTimer);this.rotateTimer=window.setInterval(function(){initRotate3D.prototype.doRotate.apply(a,arguments)},120)},doRotate:function(){var a=this.currentIndex;this.currentIndex+=this.step;0>this.currentIndex&&(this.currentIndex+=this.imageCount);
this.currentIndex>=this.imageCount&&(this.currentIndex%=this.imageCount);this.imageItems[a].hide();this.imageItems[this.currentIndex].show()},stopRotate:function(){window.clearInterval(this.rotateTimer);this.step=0;this.rotateTimer=-1}};
function Rotate3DItem(a,b){var c=this;this.father=a;this.zIndex=b;this.height=this.father.height;this.width=this.father.width;this.imageHeight=this.imageWidth=0;this.instance=$("<img></img>");this.instance.css({position:"absolute",left:"0px",top:"0px",width:this.width+"px",height:this.height+"px",display:"none"});this.setZindex(b);this.initShadow();this.instance.load(function(){Rotate3DItem.prototype.onImageLoad.apply(c,arguments)});a.content.append(this.instance)}
Rotate3DItem.prototype={initShadow:function(){var a=this.father.config;!0==a.sh&&this.instance.css({"box-shadow":a.sx+"px "+a.sy+"px "+a.se+"px "+colorTo0x(a.sr),"-moz-box-shadow":a.sx+"px "+a.sy+"px "+a.se+"px "+colorTo0x(a.sr),"-webkit-box-shadow":a.sx+"px "+a.sy+"px "+a.se+"px "+colorTo0x(a.sr),"-ms-box-shadow":a.sx+"px "+a.sy+"px "+a.se+"px "+colorTo0x(a.sr),"-o-box-shadow":a.sx+"px "+a.sy+"px "+a.se+"px "+colorTo0x(a.sr)})},onImageLoad:function(){var a=this.instance[0];this.imageWidth=a.naturalWidth;
this.imageHeight=a.naturalHeight;this.height=Math.floor(0.9*this.father.height);this.width=Math.ceil(this.height*this.imageWidth/this.imageHeight);this.left=Math.ceil((this.father.width-this.width)/2);this.top=Math.ceil((this.father.height-this.height)/2);this.instance.css({left:this.left+"px",top:this.top+"px",width:this.width+"px",height:this.height+"px",display:"block"})},setImage:function(a){this.instance.attr("src",a)},setZindex:function(a){this.instance.css({"z-index":a})},show:function(){this.setZindex(this.father.topZindex)},
hide:function(){this.setZindex(this.zIndex)},resize:function(){0==this.imageWidth&&0==this.imageHeight||(this.height=Math.floor(0.9*this.father.height),this.width=Math.ceil(this.height*this.imageWidth/this.imageHeight),this.left=Math.ceil((this.father.width-this.width)/2),this.top=Math.ceil((this.father.height-this.height)/2),this.instance.animate({left:this.left,top:this.top,width:this.width,height:this.height},400))}};var canvasMask=new function(){function a(d,h){e=d.offsetWidth;f=d.offsetHeight;b.width=e;b.height=f;c.drawImage(a,0,0,e,f);c.globalCompositeOperation="source-atop";c.drawImage(d,0,0);d.src=b.toDataURL();d.setAttribute("isAdd","1");h.innerHTML="";h.appendChild(d)}var b=document.createElement("canvas"),c;try{c=b.getContext("2d")}catch(d){return}var a=!1,e=0,f=0;return{addMask:function(b,c){"1"!=b.getAttribute("isAdd")&&(a=document.createElement("img"),a.src=b.getAttribute("data-mask"),b.complete&&a(b,
c),b.onload=function(){a(b,c)})}}};function initEmbeddedSlideshow(a,b,c,d){this.config=$.extend({width:0.2,height:0.2,x:0.2,y:0.2,alpha:1,src:null},b);this.photos=$.extend([],b.images);1>this.photos.length||(this.father=a,this.pw=c,this.ph=d,this.imgIndex=-1,this.imgWidth=this.config.width*c,this.imgHeight=this.config.height*d,this.boxWidth=this.imgWidth-8,this.boxHeight=this.imgHeight-8,this.x=this.config.x*this.pw,this.y=this.config.y*this.ph,this.interval=0,this.fadeTime=400,this.alpha=0,this.nextAlpha=100,this.nextTop=this.nextLeft=
this.top=this.left=0,this.images=[],this.background=$("<div></div>"),this.background.css({"z-index":"199"}),this.background.css({width:this.imgWidth,height:this.imgHeight}),this.image0Holder=$("<div class='type3'></div>"),this.image1Holder=$("<div class='type3'></div>"),this.image2Holder=$("<div class='type3'></div>"),this.image3Holder=$("<div class='type3'></div>"),this.img=$("<img style='position : absolute;' />"),a.append(this.background),this.background.append(this.image3Holder),this.background.append(this.image2Holder),
this.background.append(this.image1Holder),this.background.append(this.image0Holder),this.background.css({left:this.x+"px",top:this.y+"px",position:"absolute",overflow:"hidden"}),this.image0Holder.css({width:this.boxWidth+"px",height:this.boxHeight+"px",left:(this.imgWidth-this.boxWidth)/2+"px",top:(this.imgHeight-this.boxHeight)/2+"px","-webkit-mask-size":this.boxWidth+"px "+this.boxHeight+"px",position:"absolute","z-index":202}),this.image1Holder.css({width:this.boxWidth+"px",height:this.boxHeight+
"px",left:(this.imgWidth-this.boxWidth)/2+"px",top:(this.imgHeight-this.boxHeight)/2+"px","-webkit-mask-size":this.boxWidth+"px "+this.boxHeight+"px",position:"absolute","z-index":202}),this.image2Holder.css({width:this.boxWidth+"px",height:this.boxHeight+"px",left:(this.imgWidth-this.boxWidth)/2+"px",top:(this.imgHeight-this.boxHeight)/2+"px","-webkit-mask-size":this.boxWidth+"px "+this.boxHeight+"px",position:"absolute","z-index":202}),this.image3Holder.css({width:this.boxWidth+"px",height:this.boxHeight+
"px",left:(this.imgWidth-this.boxWidth)/2+"px",top:(this.imgHeight-this.boxHeight)/2+"px","-webkit-mask-size":this.boxWidth+"px "+this.boxHeight+"px",position:"absolute","z-index":202}),this.addItem(),this.currentImageHolder=this.image0Holder,this.nextImageHolder=this.image1Holder,this.currentImage=0,this.nextImage=1,this.image0Holder.append(this.images[0]),this.image1Holder.append(this.images[(this.currentImage+1)%this.images.length]),this.image2Holder.append(this.images[(this.currentImage+2)%this.images.length]),
this.image3Holder.append(this.images[(this.currentImage+3)%this.images.length]),this.moveLeft=this.boxWidth/5,this.moveTop=this.boxHeight/5,this.tranLeft=this.moveLeft/100,this.tranTop=this.moveTop/100,$(this.image0Holder.children()).css({left:-this.moveLeft,top:-this.moveTop}),$(this.image1Holder.children()).css({left:this.moveLeft,top:-this.moveTop}),$(this.image2Holder.children()).css({left:this.moveLeft,top:this.moveTop}),$(this.image3Holder.children()).css({left:-this.moveLeft,top:this.moveTop}),
this.image0Holder.css({opacity:"0"}),this.image1Holder.css({opacity:"0"}),this.image2Holder.css({opacity:"0"}),this.image3Holder.css({opacity:"1"}),this.timer1=setTimeout(this.transition(),this.interval))}
initEmbeddedSlideshow.prototype.transition=function(){var a=this;a.timer0=setInterval(function(){0<a.fadeTime?(a.fadeTime-=1,300<a.fadeTime&&400>=a.fadeTime?0<a.nextAlpha&&100>=a.alpha&&(a.alpha+=1,a.nextAlpha-=1,$(a.image0Holder).css({opacity:a.alpha/100}),$(a.image3Holder).css({opacity:a.nextAlpha/100}),a.left=parseFloat($(a.image0Holder.children()).css("left").replace("px",""))+a.tranLeft,a.top=parseFloat($(a.image0Holder.children()).css("top").replace("px",""))+a.tranTop,a.nextLeft=parseFloat($(a.image3Holder.children()).css("left").replace("px",
""))+a.tranLeft,a.nextTop=parseFloat($(a.image3Holder.children()).css("top").replace("px",""))-a.tranTop,$(a.image0Holder.children()).css({left:a.left,top:a.top}),$(a.image1Holder.children()).css({left:a.moveLeft,top:-a.moveTop}),$(a.image2Holder.children()).css({left:a.moveLeft,top:a.moveTop}),$(a.image3Holder.children()).css({left:a.nextLeft,top:a.nextTop}),301==a.fadeTime&&(a.currentImage=(a.currentImage+1)%a.images.length,a.nextImage=(a.nextImage+1)%a.images.length,a.image1Holder.empty().append(a.images[a.currentImage]),
a.image2Holder.empty().append(a.images[a.nextImage]),a.image1Holder.css({opacity:"0"}),a.image2Holder.css({opacity:"0"}),$(a.image1Holder.children()).css({left:a.moveLeft,top:-a.moveTop}),$(a.image2Holder.children()).css({left:a.moveLeft,top:a.moveTop}))):200<a.fadeTime&&300>=a.fadeTime?0<a.alpha&&100>=a.nextAlpha&&(a.nextAlpha+=1,a.alpha-=1,$(a.image0Holder).css({opacity:a.alpha/100}),$(a.image1Holder).css({opacity:a.nextAlpha/100}),a.left=parseFloat($(a.image0Holder.children()).css("left").replace("px",
""))+a.tranLeft,a.top=parseFloat($(a.image0Holder.children()).css("top").replace("px",""))+a.tranTop,a.nextLeft=parseFloat($(a.image1Holder.children()).css("left").replace("px",""))-a.tranLeft,a.nextTop=parseFloat($(a.image1Holder.children()).css("top").replace("px",""))+a.tranTop,$(a.image0Holder.children()).css({left:a.left,top:a.top}),$(a.image1Holder.children()).css({left:a.nextLeft,top:a.nextTop}),$(a.image2Holder.children()).css({left:a.moveLeft,top:a.moveTop}),$(a.image3Holder.children()).css({left:-a.moveLeft,
top:a.moveTop}),202==a.fadeTime&&(a.currentImage=(a.currentImage+1)%a.images.length,a.nextImage=(a.nextImage+1)%a.images.length,a.image2Holder.empty().append(a.images[a.currentImage]),a.image3Holder.empty().append(a.images[a.nextImage]),a.image3Holder.css({opacity:"0"}),a.image2Holder.css({opacity:"0"}),$(a.image2Holder.children()).css({left:a.moveLeft,top:a.moveTop}),$(a.image3Holder.children()).css({left:-a.moveLeft,top:a.moveTop}))):100<a.fadeTime&&200>=a.fadeTime?0<a.nextAlpha&&100>=a.alpha&&
(a.alpha+=1,a.nextAlpha-=1,$(a.image2Holder).css({opacity:a.alpha/100}),$(a.image1Holder).css({opacity:a.nextAlpha/100}),a.left=parseFloat($(a.image2Holder.children()).css("left").replace("px",""))-a.tranLeft,a.top=parseFloat($(a.image2Holder.children()).css("top").replace("px",""))-a.tranTop,a.nextLeft=parseFloat($(a.image1Holder.children()).css("left").replace("px",""))-a.tranLeft,a.nextTop=parseFloat($(a.image1Holder.children()).css("top").replace("px",""))+a.tranTop,$(a.image0Holder.children()).css({left:-a.moveLeft,
top:-a.moveTop}),$(a.image1Holder.children()).css({left:a.nextLeft,top:a.nextTop}),$(a.image2Holder.children()).css({left:a.left,top:a.top}),$(a.image3Holder.children()).css({left:-a.moveLeft,top:a.moveTop}),101==a.fadeTime&&(a.currentImage=(a.currentImage+1)%a.images.length,a.nextImage=(a.nextImage+1)%a.images.length,a.image3Holder.empty().append(a.images[a.currentImage]),a.image0Holder.empty().append(a.images[a.nextImage]),a.image3Holder.css({opacity:"0"}),a.image0Holder.css({opacity:"0"}),$(a.image0Holder.children()).css({left:-a.moveLeft,
top:-a.moveTop}),$(a.image3Holder.children()).css({left:-a.moveLeft,top:a.moveTop}))):0<a.fadeTime&&100>=a.fadeTime&&0<a.alpha&&100>=a.nextAlpha&&(a.nextAlpha+=1,a.alpha-=1,$(a.image2Holder).css({opacity:a.alpha/100}),$(a.image3Holder).css({opacity:a.nextAlpha/100}),a.left=parseFloat($(a.image2Holder.children()).css("left").replace("px",""))-a.tranLeft,a.top=parseFloat($(a.image2Holder.children()).css("top").replace("px",""))-a.tranTop,a.nextLeft=parseFloat($(a.image3Holder.children()).css("left").replace("px",
""))+a.tranLeft,a.nextTop=parseFloat($(a.image3Holder.children()).css("top").replace("px",""))-a.tranTop,$(a.image0Holder.children()).css({left:-a.moveLeft,top:-a.moveTop}),$(a.image1Holder.children()).css({left:a.moveLeft,top:-a.moveTop}),$(a.image2Holder.children()).css({left:a.left,top:a.top}),$(a.image3Holder.children()).css({left:a.nextLeft,top:a.nextTop}),1==a.fadeTime&&(a.currentImage=(a.currentImage+1)%a.images.length,a.nextImage=(a.nextImage+1)%a.images.length,a.image0Holder.empty().append(a.images[a.currentImage]),
a.image1Holder.empty().append(a.images[a.nextImage]),a.image0Holder.css({opacity:"0"}),a.image1Holder.css({opacity:"0"}),$(a.image0Holder.children()).css({left:-a.moveLeft,top:-a.moveTop}),$(a.image1Holder.children()).css({left:a.moveLeft,top:-a.moveTop})))):(clearInterval(a.timer0),a.fadeTime=400,a.timer1=setTimeout(a.transition(),a.interval))},20)};
initEmbeddedSlideshow.prototype.addItem=function(){for(var a=this,b=0;b<a.photos.length;b++){var c=$("<div></div>");c.css({width:a.boxWidth+"px",height:a.boxHeight+"px",position:"absolute"});var d=$('<img data-mask="'+uiBaseURL+'centerblur.png"/>');d.css("position","absolute");var e=a.photos[b].Image;!0==isFlipPdf&&(e="."+e);c.append(d);$(d).load(function(){var b=$(this)[0];$(this).css({left:(a.boxWidth-b.naturalWidth)/2+"px",top:(a.boxHeight-b.naturalHeight)/2+"px",position:"absolute"})}).attr("src",
e);a.images[b]=c}};initEmbeddedSlideshow.prototype.resizeItem=function(){for(var a=0;a<this.photos.length;a++){var b=this.images[a],c=b.children(),d=c[0];void 0!=c&&null!=c&&$(c).css({left:(this.boxWidth-d.naturalWidth)/2+"px",top:(this.boxHeight-d.naturalHeight)/2+"px",position:"absolute"});this.images[a]=b}};
initEmbeddedSlideshow.prototype.onResize=function(a,b){this.pw=a;this.ph=b;this.imgWidth=this.config.width*this.pw;this.imgHeight=this.config.height*this.ph;this.boxWidth=this.imgWidth-8;this.boxHeight=this.imgHeight-8;this.moveLeft=this.boxWidth/5;this.moveTop=this.boxHeight/5;this.tranLeft=this.moveLeft/100;this.tranTop=this.moveTop/100;this.background.css({width:this.imgWidth,height:this.imgHeight});this.setPosition()};
initEmbeddedSlideshow.prototype.setPosition=function(){this.x=this.config.x*this.pw;this.y=this.config.y*this.ph;this.background.css({left:this.x+"px",top:this.y+"px",position:"absolute"});this.image0Holder.css({width:this.boxWidth+"px",height:this.boxHeight+"px",left:(this.imgWidth-this.boxWidth)/2+"px",top:(this.imgHeight-this.boxHeight)/2+"px","-webkit-mask-size":this.boxWidth+"px "+this.boxHeight+"px",position:"absolute"});this.image1Holder.css({width:this.boxWidth+"px",height:this.boxHeight+
"px",left:(this.imgWidth-this.boxWidth)/2+"px",top:(this.imgHeight-this.boxHeight)/2+"px","-webkit-mask-size":this.boxWidth+"px "+this.boxHeight+"px",position:"absolute"});this.image2Holder.css({width:this.boxWidth+"px",height:this.boxHeight+"px",left:(this.imgWidth-this.boxWidth)/2+"px",top:(this.imgHeight-this.boxHeight)/2+"px","-webkit-mask-size":this.boxWidth+"px "+this.boxHeight+"px",position:"absolute"});this.image3Holder.css({width:this.boxWidth+"px",height:this.boxHeight+"px",left:(this.imgWidth-
this.boxWidth)/2+"px",top:(this.imgHeight-this.boxHeight)/2+"px","-webkit-mask-size":this.boxWidth+"px "+this.boxHeight+"px",position:"absolute"});$(this.image0Holder.children()).css({width:this.boxWidth+"px",height:this.boxHeight+"px",left:-this.moveLeft,top:-this.moveTop});$(this.image1Holder.children()).css({width:this.boxWidth+"px",height:this.boxHeight+"px",left:this.moveLeft,top:-this.moveTop});$(this.image2Holder.children()).css({width:this.boxWidth+"px",height:this.boxHeight+"px",left:this.moveLeft,
top:this.moveTop});$(this.image3Holder.children()).css({width:this.boxWidth+"px",height:this.boxHeight+"px",left:-this.moveLeft,top:this.moveTop});this.resizeItem()};initEmbeddedSlideshow.prototype.setImagePosition=function(){};initEmbeddedSlideshow.prototype.show=function(){};initEmbeddedSlideshow.prototype.hide=function(){};function initFlashSwf(a,b,c,d){this.config=$.extend({width:0.2,height:0.2,x:0.2,y:0.2,alpha:1,src:null},b);this.father=a;this.pw=c;this.ph=d;this.width=c*this.config.width;this.height=d*this.config.height;this.left=c*this.config.x;this.top=d*this.config.y;this.content=$("<div></div>");this.content.css({position:"absolute",left:this.left,top:this.top,width:this.width,height:this.height});a.append(this.content);isTouchDevice()||(!0==isFlipPdf&&(this.config.src="."+this.config.src),this.content.flash({swf:this.config.src,
width:this.width+"px",height:this.height+"px",wmode:"transparent"}))}
initFlashSwf.prototype={onResize:function(a,b){this.pw=a;this.ph=b;this.width=this.config.width*a;this.height=this.config.height*b;this.content.css({width:this.width+"px",height:this.height+"px"});this.content.flash().remove();this.content.flash({swf:this.config.src,width:this.width+"px",height:this.height+"px",wmode:"transparent"});this.setPosition(this.config.x*a,this.config.y*b)},setPosition:function(a,b){this.content.css({left:a+"px",top:b+"px"})},hide:function(){this.content.html("")},show:function(){this.content.flash({swf:this.config.src,
width:this.width+"px",height:this.height+"px",wmode:"transparent"})}};(function(a){var b=0;a.fn.printArea=function(){var c=a(this);a("iframe#printArea_"+b).remove();b++;var d="printArea_"+b;iframe=document.createElement("IFRAME");a(iframe).attr({style:"position:absolute;width:0px;height:0px;left:-500px;top:-500px;",id:d});document.body.appendChild(iframe);var e=iframe.contentWindow.document;a(document).find("link").filter(function(){return"stylesheet"==a(this).attr("rel").toLowerCase()}).each(function(){e.write('<link type="text/css" rel="stylesheet" href="'+a(this).attr("href")+
'" >')});e.write('<div class="'+a(c).attr("class")+'">'+a(c).html()+"</div>");e.close();c=iframe.contentWindow;c.close();c.focus();c.print()}})(jQuery);var textWidth=function(a,b){var c=$("<pre>"+a+"</pre>").css({color:bookConfig.iconColor,display:"none","font-size":b.size,"font-family":b.fontName});$("body").append(c);var d=Point(c.width(),c.height());c.remove();return d};
function label(a,b){this.labelBox=$('<div style = "position : absolute;font-family:Tahoma,Georgia,Serif;font-size:12px">'+a+"</div>");this.caption=a;this.fontSize="12px";this.fontColor="#f0f0f0";this.fontName="Tahoma";var c=textWidth(a,{size:this.fontSize,fontName:this.fontName});this.width=c.x;this.height=c.y;b.append(this.labelBox)}label.prototype.getWidth=function(){return this.width};label.prototype.getHeight=function(){return this.height};label.prototype.getCaption=function(){return this.caption};
label.prototype.setCaption=function(a){this.caption=a;this.labelBox[0].innerHTML=a;a=textWidth(a,{size:this.fontSize,fontName:this.fontName});this.width=a.x;this.height=a.y};label.prototype.setLabelPosition=function(a,b,c){void 0==c&&(c=["left","top"]);this.labelBox.css(c[0],a+"px");this.labelBox.css(c[1],b+"px")};label.prototype.onResize=function(a,b){this.width=a;this.height=b;this.labelBox.css({width:a+"px",height:b+"px"})};
label.prototype.setFont=function(a,b,c){null==a?a=this.fontSize:this.fontSize=a;null==b?b=this.fontColor:this.fontColor=b;null==c?c=this.fontName:this.fontName=c;this.labelBox.css({"font-size":a,color:b,"font-family":c});a=textWidth(this.caption,{size:a,fontName:c});this.width=a.x;this.height=a.y};label.prototype.setFontSize=function(a){null==a?a=this.fontSize:this.fontSize=a;this.labelBox.css({"font-size":a});a=textWidth(this.caption,{size:a,fontName:this.fontName});this.width=a.x;this.height=a.y};
label.prototype.riseAWord=function(a){var b=this.caption;-1==b.indexOf(a)&&(a=a.toLowerCase());-1!=b.indexOf(a)&&(newCaption=b.replaceAll(a,"<font color=red><strong>"+a+"</strong></font>"),this.labelBox[0].innerHTML=newCaption)};label.prototype.shortWord=function(a){this.caption.length>a&&(this.caption=this.caption.substring(0,a)+"..",this.setCaption(this.caption))};label.prototype.setCSS=function(a){this.labelBox.css(a)};function tipsBox(a,b){this.visible=!1;this.caption=a;this.background=$("<div style = 'position : absolute;'></div>");this.contentBox=new label(a,this.background);this.contentBox.setFont("16px","#f0f0f0",null);this.width=this.contentBox.getWidth()+12;this.height=40;$(b).append(this.background);$(this.background).css({width:this.width+"px",height:this.height+"px","-webkit-border-radius":"10px","-moz-border-radius":"10px","-o-border-radius":"10px","border-radius":"10px","-webkit-box-shadow":"0 0 15px rgba(40, 40, 40, 0.6)",
"-moz-box-shadow":"0 0 15px rgba(40, 40, 40, 0.6)","-ms-box-shadow":"0 0 15px rgba(40, 40, 40, 0.6)","-o-box-shadow":"0 0 15px rgba(40, 40, 40, 0.6)","box-shadow":"0 0 15px rgba(40, 40, 40, 0.6)","background-color":"#554433",display:"none","z-index":110});this.contentBox.setLabelPosition(4,(this.height-this.contentBox.getHeight())/2-3)}tipsBox.prototype.setTimer=function(){var a=this;this.timer=window.setInterval(function(){a.hideTipsBox();window.clearInterval(a.timer)},1500)};
tipsBox.prototype.resetTimer=function(){window.clearInterval(this.timer);this.setTimer()};tipsBox.prototype.setPosition=function(a,b,c){void 0==c&&(c=["left","top"]);$(this.background).css(c[0],a+"px");$(this.background).css(c[1],b+"px")};tipsBox.prototype.onResize=function(a,b){this.width=a;this.height=b;$(this.background).css({width:a+"px",height:b+"px"});this.contentBox.setLabelPosition(4,(b-this.contentBox.getHeight())/2)};tipsBox.prototype.getWidth=function(){return this.width};
tipsBox.prototype.getHeight=function(){return this.height};tipsBox.prototype.setCaption=function(a){this.contentBox.setCaption(a);this.caption=a;this.contentBox.setLabelPosition(4,(this.height-this.contentBox.getHeight())/2-3)};tipsBox.prototype.showTipsBox=function(){this.visible?this.resetTimer():(this.setTimer(),this.visible=!0,$(this.background).css({display:"block","z-index":110}),$(this.background).animate({opacity:0.9},300))};
tipsBox.prototype.hideTipsBox=function(){var a=this;this.visible&&(this.visible=!1,$(this.background).animate({opacity:0},300,function(){$(a.background).css({display:"none","z-index":1})}))};function rimFlip(){}rimFlip.prototype.addRimFlip=function(){};rimFlip.prototype.clearTimer=function(){};rimFlip.prototype.removeRimFlip=function(){};rimFlip.prototype.setFlipBack=function(){};function initProgressBar(a,b){this.width=60;this.height=30;this.progress=new label("Loading",a);this.caption=this.originCaption=b;this.captionLength=this.caption.length;this.progress.setCSS({display:"none"})}initProgressBar.prototype.setPosition=function(a,b){this.progress.setLabelPosition((a-this.width)/2,(b-this.height)/2)};
initProgressBar.prototype.addTimer=function(){var a=this;this.timerId=window.setInterval(function(){a.caption+=".";a.caption.length>a.captionLength+3&&(a.caption=originCaption);a.progress.setCaption(a.caption)},600)};initProgressBar.prototype.removeTimer=function(){window.clearInterval(this.timerId)};initProgressBar.prototype.show=function(){this.progress.setCSS({display:"block"});this.caption=this.originCaption;this.addTimer()};
initProgressBar.prototype.hide=function(){this.progress.setCSS({display:"none"});this.removeTimer()};initProgressBar.prototype.setIndex=function(a){this.progress.setCSS({"z-index":a})};var rotate=function(a){return" rotate("+a+"deg)"},translate=function(a,b){return 3!=browserType?" translate3d("+a+"px,"+b+"px,0px)":" translate("+a+"px,"+b+"px)"};
$.fn.transform=function(a,b){if(void 0==this.getOrigin||null==this.getOrigin)this.getOrigin=!1;if(!this.getOrigin){this.getOrigin=!0;this.originX=parseInt(this.css("left"));this.originY=parseInt(this.css("top"));if(void 0==this.originX||null==this.originX||isNaN(this.originX))this.originX=0;if(void 0==this.originY||null==this.originY||isNaN(this.originY))this.originY=0}this.css({left:this.originX+a+"px",top:this.originY+b+"px"});return this};
var scaleTran=function(a){return" scale("+a+")"},isLeft=function(a){return 0==a||2==a},isRight=function(a){return 1==a||3==a},isTop=function(a){return 0==a||1==a},isBottom=function(a){return 2==a||3==a},playFlipSound=function(){if(!(!getBool("FlipSound",!0)||void 0==flipAudio||null==flipAudio||void 0==flipAudio[0].play))try{flipAudio[0].play()}catch(a){}},nextPageFun=function(){bookType==BookType.normal_book?(flipBook.gotoPage(2*Math.floor(flipBook.getCurrentPageIndex()/2+1)),"undefined"!=typeof speakConfig&&
"none"!=speakConfig.title&&0==flagspeak&&($("#LectureText").stop(!0),$("#LectureText").css("marginTop",0),LectureAudio(Math.floor(flipBook.getCurrentPageIndex()/2+1)),LectureSoll(Math.floor(flipBook.getCurrentPageIndex()/2+1)))):bookType==BookType.single_book?singlePageBook.gotoPage(singlePageBook.currentPageIndex+1):bookType==BookType.zoom_book?!0==zoomBook.doublePage?zoomBook.gotoPage(2*Math.floor(zoomBook.currentIndex/2+1)):zoomBook.gotoPage(parseInt(zoomBook.currentIndex)+1):bookType==BookType.slide_book?
(slideBook.gotoPage(2*Math.floor(slideBook.getCurrentPageIndex()/2+1)),"undefined"!=typeof speakConfig&&"none"!=speakConfig.title&&0==flagspeak&&($("#LectureText").stop(!0),$("#LectureText").css("marginTop",0),LectureAudio(Math.floor(slideBook.getCurrentPageIndex()/2+1)),LectureSoll(Math.floor(slideBook.getCurrentPageIndex()/2+1)))):bookType==BookType.singleSlide_book?singleSlideBook.gotoPage(parseInt(singleSlideBook.currentIndex)+1):bookType==BookType.catalog_book?(catalogBook.gotoPage(2*Math.floor(catalogBook.getCurrentPageIndex()/
2+1)),"undefined"!=typeof speakConfig&&"none"!=speakConfig.title&&0==flagspeak&&($("#LectureText").stop(!0),$("#LectureText").css("marginTop",0),LectureAudio(Math.floor(catalogBook.getCurrentPageIndex()/2+1)),LectureSoll(Math.floor(catalogBook.getCurrentPageIndex()/2+1)))):bookType==BookType.singleCatalog_book?singleCatalogBook.gotoPage(parseInt(singleCatalogBook.currentIndex)+1):bookType==BookType.phone_book?(phoneBook.gotoPage(2*Math.floor(phoneBook.getCurrentPageIndex()/2+1)),"undefined"!=typeof speakConfig&&
"none"!=speakConfig.title&&0==flagspeak&&($("#LectureText").stop(!0),$("#LectureText").css("marginTop",0),LectureAudio(Math.floor(phoneBook.getCurrentPageIndex()/2+1)),LectureSoll(Math.floor(phoneBook.getCurrentPageIndex()/2+1)))):bookType==BookType.singlePhone_book&&singlePhoneBook.gotoPage(parseInt(singlePhoneBook.currentIndex)+1)},previousPageFun=function(){bookType==BookType.normal_book?(flipBook.gotoPage(2*Math.floor(flipBook.getCurrentPageIndex()/2-1)+1),"undefined"!=typeof speakConfig&&"none"!=
speakConfig.title&&0==flagspeak&&($("#LectureText").stop(!0),$("#LectureText").css("marginTop",0),LectureAudio(Math.floor(flipBook.getCurrentPageIndex()/2-1)),LectureSoll(Math.floor(flipBook.getCurrentPageIndex()/2-1)))):bookType==BookType.single_book?singlePageBook.gotoPage(singlePageBook.currentPageIndex-1):bookType==BookType.zoom_book?!0==zoomBook.doublePage?zoomBook.gotoPage(2*Math.floor(zoomBook.currentIndex/2-1)+1):zoomBook.gotoPage(zoomBook.currentIndex-1):bookType==BookType.slide_book?slideBook.gotoPage(slideBook.currentIndex-
1):bookType==BookType.singleSlide_book?singleSlideBook.gotoPage(parseInt(singleSlideBook.currentIndex)-1):bookType==BookType.catalog_book?catalogBook.gotoPage(catalogBook.currentIndex-1):bookType==BookType.singleCatalog_book?singleCatalogBook.gotoPage(parseInt(singleCatalogBook.currentIndex)-1):bookType==BookType.phone_book?phoneBook.gotoPage(phoneBook.currentIndex-1):bookType==BookType.singlePhone_book&&singlePhoneBook.gotoPage(singlePhoneBook.currentIndex-1)},firstPageFun=function(){bookType==BookType.normal_book?
flipBook.gotoPage(1):bookType==BookType.single_book?singlePageBook.gotoPage(1):bookType==BookType.zoom_book?zoomBook.gotoPage(1):bookType==BookType.slide_book?slideBook.gotoPage(1):bookType==BookType.singleSlide_book?singleSlideBook.gotoPage(1):bookType==BookType.catalog_book?catalogBook.gotoPage(1):bookType==BookType.singleCatalog_book?singleCatalogBook.gotoPage(1):bookType==BookType.phone_book?phoneBook.gotoPage(1):bookType==BookType.singlePhone_book&&singlePhoneBook.gotoPage(1)},lastPageFun=function(){bookType==
BookType.normal_book?flipBook.gotoPage(totalPageCount):bookType==BookType.single_book?singlePageBook.gotoPage(originTotalPageCount):bookType==BookType.zoom_book?zoomBook.gotoPage(originTotalPageCount):bookType==BookType.slide_book?slideBook.gotoPage(originTotalPageCount):bookType==BookType.singleSlide_book?singleSlideBook.gotoPage(originTotalPageCount):bookType==BookType.catalog_book?catalogBook.gotoPage(originTotalPageCount):bookType==BookType.singleCatalog_book?singleCatalogBook.gotoPage(originTotalPageCount):
bookType==BookType.phone_book?phoneBook.gotoPage(originTotalPageCount):bookType==BookType.singlePhone_book&&singlePhoneBook.gotoPage(originTotalPageCount)},gotoPageFun=function(a){bookType==BookType.normal_book?flipBook.gotoPage(a):bookType==BookType.single_book?singlePageBook.gotoPage(a):bookType==BookType.zoom_book?zoomBook.gotoPage(a):bookType==BookType.slide_book?slideBook.gotoPage(a):bookType==BookType.singleSlide_book?singleSlideBook.gotoPage(a):bookType==BookType.catalog_book?catalogBook.gotoPage(a):
bookType==BookType.singleCatalog_book?singleCatalogBook.gotoPage(a):bookType==BookType.phone_book?phoneBook.gotoPage(a):bookType==BookType.singlePhone_book&&singlePhoneBook.gotoPage(a)},getPageDir=function(a,b,c){if(0>=a||void 0!=c&&a>c)return"";var d;if(void 0!=fliphtml5_pages&&0<fliphtml5_pages.length){c=fliphtml5_pages[a-1];if(void 0!=c&&null!=c)switch(b){case "normal":d=void 0==c.n?c.l:c.n;break;case "large":d=c.l;break;case "thumb":d=c.t}if(void 0==d)switch(b){case "normal":return d=getString("normalPath",
"files/page/")+a+".jpg";case "large":return d=getString("largePath","files/large/")+a+".jpg";case "thumb":return d=getString("thumbPath","files/thumbnail/")+a+".jpg"}return void 0==d?"":d}switch(b){case "normal":return d=getString("normalPath","files/page/")+a+".jpg",void 0==d?"":d;case "large":return d=getString("largePath","files/large/")+a+".jpg",void 0==d?"":d;case "thumb":return d=getString("thumbPath","files/thumbnail/")+a+".jpg",void 0==d?"":d}},getPageWidthHeight=function(a,b,c,d){var e=Point(0,
0);a/b>c/d?(e.x=c*b/d,e.y=b):(e.x=a,e.y=a*d/c);return e},getPageWidthHeightByWidth=function(a,b,c,d){b=Point(0,0);b.x=a;b.y=a*d/c;return b},pointToLineDistance=function(a,b,c,d,e,f){var g=f-d,h=c-e;return Math.abs(g*a+h*b+(e*d-c*f))/Math.sqrt(g*g+h*h)},globalToBook=function(a,b,c,d){void 0==d&&(d=!1);return d?Point(b-singlePageBook.getLeft(),c-singlePageBook.getTop()):Point(b-((a?0:flipBook.getPageWidth())+flipBook.getLeft()),c-flipBook.getTop())},changeShowBook=function(a){switch(a){case 0:bookType=
BookType.normal_book;singlePageBook.setSingleBookVisible(!1);zoomBook.hide();slideBook.hide();phoneBook.hide();catalogBook.hide();singleCatalogBook.hide();singlePhoneBook.hide();singleSlideBook.hide();flipBook.show();_rimFlip.isRimFlip&&(singlePageBook.currentPage.resetPage(),singlePageBook.currentPage.setSideAUp(!0),_rimFlip.clearTimer(),_rimFlip.addRimFlip());zoomBook.changePageMode(!0);thumbnail.mergeAll();break;case 1:bookType=BookType.single_book;singlePageBook.setSingleBookVisible(!0);zoomBook.hide();
slideBook.hide();phoneBook.hide();catalogBook.hide();singleCatalogBook.hide();singlePhoneBook.hide();singleSlideBook.hide();flipBook.hide();_rimFlip.isRimFlip&&(currentPage2.resetPage(),_rimFlip.clearTimer(),_rimFlip.addRimFlip());zoomBook.changePageMode(!1);thumbnail.fissionAll();break;case 2:bookType=BookType.zoom_book;singlePageBook.setSingleBookVisible(!1);zoomBook.show();slideBook.hide();phoneBook.hide();catalogBook.hide();singleCatalogBook.hide();singlePhoneBook.hide();singleSlideBook.hide();
flipBook.hide();_rimFlip.isRimFlip&&(singlePageBook.currentPage.resetPage(),singlePageBook.currentPage.setSideAUp(!0),currentPage2.resetPage(),currentPage2.setSideUp(!0),_rimFlip.clearTimer(),_rimFlip.setFlipBack(!1));!0==zoomBook.doublePage?thumbnail.mergeAll():thumbnail.fissionAll();zoomBook.showPage.forceReset(Point(0,0));zoomBook.showPage.animateMax();break;case 3:bookType=BookType.slide_book;singlePageBook.setSingleBookVisible(!1);zoomBook.hide();slideBook.show();phoneBook.hide();catalogBook.hide();
singleCatalogBook.hide();singlePhoneBook.hide();singleSlideBook.hide();flipBook.hide();_rimFlip.isRimFlip&&(singlePageBook.currentPage.resetPage(),singlePageBook.currentPage.setSideAUp(!0),currentPage2.resetPage(),currentPage2.setSideUp(!0),_rimFlip.clearTimer(),_rimFlip.setFlipBack(!1));thumbnail.mergeAll();break;case 4:bookType=BookType.phone_book;singlePageBook.setSingleBookVisible(!1);zoomBook.hide();slideBook.hide();catalogBook.hide();singleCatalogBook.hide();singlePhoneBook.hide();singleSlideBook.hide();
phoneBook.show();flipBook.hide();_rimFlip.isRimFlip&&(singlePageBook.currentPage.resetPage(),singlePageBook.currentPage.setSideAUp(!0),currentPage2.resetPage(),currentPage2.setSideUp(!0),_rimFlip.clearTimer(),_rimFlip.setFlipBack(!1));thumbnail.mergeAll();break;case 5:bookType=BookType.singlePhone_book;singlePageBook.setSingleBookVisible(!1);zoomBook.hide();slideBook.hide();catalogBook.hide();singleCatalogBook.hide();singleSlideBook.hide();singlePhoneBook.show();phoneBook.hide();flipBook.hide();_rimFlip.isRimFlip&&
(singlePageBook.currentPage.resetPage(),singlePageBook.currentPage.setSideAUp(!0),currentPage2.resetPage(),currentPage2.setSideUp(!0),_rimFlip.clearTimer(),_rimFlip.setFlipBack(!1));thumbnail.fissionAll();break;case 6:bookType=BookType.singleSlide_book;singlePageBook.setSingleBookVisible(!1);zoomBook.hide();slideBook.hide();catalogBook.hide();singleCatalogBook.hide();singlePhoneBook.hide();singleSlideBook.show();phoneBook.hide();flipBook.hide();_rimFlip.isRimFlip&&(singlePageBook.currentPage.resetPage(),
singlePageBook.currentPage.setSideAUp(!0),currentPage2.resetPage(),currentPage2.setSideUp(!0),_rimFlip.clearTimer(),_rimFlip.setFlipBack(!1));thumbnail.fissionAll();break;case 7:bookType=BookType.catalog_book;singlePageBook.setSingleBookVisible(!1);zoomBook.hide();catalogBook.show();singleCatalogBook.hide();slideBook.hide();phoneBook.hide();singlePhoneBook.hide();singleSlideBook.hide();flipBook.hide();_rimFlip.isRimFlip&&($(singlePageBook).data().currentPage.resetPage(),$(singlePageBook).data().currentPage.setSideAUp(!0),
currentPage2.resetPage(),currentPage2.setSideUp(!0),_rimFlip.clearTimer(),_rimFlip.setFlipBack(!1));thumbnail.mergeAll();break;case 8:bookType=BookType.singleCatalog_book,singlePageBook.setSingleBookVisible(!1),zoomBook.hide(),slideBook.hide(),singlePhoneBook.hide(),singleSlideBook.hide(),catalogBook.hide(),singleCatalogBook.show(),phoneBook.hide(),flipBook.hide(),_rimFlip.isRimFlip&&($(singlePageBook).data().currentPage.resetPage(),$(singlePageBook).data().currentPage.setSideAUp(!0),currentPage2.resetPage(),
currentPage2.setSideUp(!0),_rimFlip.clearTimer(),_rimFlip.setFlipBack(!1)),thumbnail.fissionAll()}},computeMousePoint=function(a,b,c,d,e,f){var g=function(){return 0<=a.indexOf("l")},h=function(){return 0<=a.indexOf("t")},j=function(){return 0<=a.indexOf("b")},k=Point(b,c),m,l,n,o;n=g()?d-b:b;o=j()?e-c:c;m=Math.sqrt(Math.pow(n,2)+Math.pow(o,2));l=Math.sqrt(Math.pow(n,2)+Math.pow(e-o,2));var p;if(m>d&&l>f){n=Math.abs(n/(e-o));var q=d/e;if(0>=o&&n>=q){if(k=b,p=c,n>q&&(k=g()?d-(d-k)*d/m:k*d/m,p=j()?
e-(e-p)*d/m:p*d/m),0>o)n=g()?d-k:k,o=j()?e-p:p,l=Math.sqrt(Math.pow(n,2)+Math.pow(e-o,2)),k=g()?d-(d-k)*f/l:k*f/l,p=h()?e-(e-p)*f/l:p*f/l}else m-d>=l-f?(k=g()?d-(d-b)*d/m:b*d/m,p=j()?e-(e-c)*d/m:c*d/m):(k=g()?d-(d-b)*f/l:b*f/l,p=h()?e-(e-c)*f/l:c*f/l);k=Point(k,p)}else if(m>d&&(k=g()?d-(d-b)*d/m:b*d/m,p=j()?e-(e-c)*d/m:c*d/m,k=Point(k,p)),l>f)k=g()?d-(d-b)*f/l:b*f/l,p=h()?e-(e-c)*f/l:c*f/l,k=Point(k,p);h()&&0==k.y?k.y=0.002*e:j()&&k.y==e&&(k.y=0.998*e);return k},computePoint=function(a,b,c,d,e,f,
g,h){var j,k;j=Point(b,c);j=computeMousePoint(a,b,c,d,e,f);c=j.x;k=j.y;j=function(){return 0<=a.indexOf("l")};b=function(){return 0<=a.indexOf("t")};switch(a){case "tl":actualPoint=Point(c,k);middlePoint=Point(d-actualPoint.x/2,k/2);endPoint=Point(2*d,0);break;case "tr":actualPoint=Point(d-c,k);middlePoint=Point(d-actualPoint.x/2,actualPoint.y/2);endPoint=Point(-d,0);break;case "bl":actualPoint=Point(c,e-k);middlePoint=Point(d-actualPoint.x/2,actualPoint.y/2);endPoint=Point(2*d,e);break;case "br":actualPoint=
Point(d-c,e-k),middlePoint=Point(d-actualPoint.x/2,actualPoint.y/2),endPoint=Point(-d,e)}var m=Point(0,0),l=Math.PI/2,n=Math.atan2(actualPoint.y,actualPoint.x);k=l-n;var c=180*k/Math.PI,o=k-Math.atan2(middlePoint.y,middlePoint.x);distance=Math.max(0,Math.sin(o)*Math.sqrt(Math.pow(middlePoint.x,2)+Math.pow(middlePoint.y,2)));noMovePoint=Point(distance*Math.sin(k),distance*Math.cos(k));var p,q;if(k>l&&(noMovePoint.x+=Math.abs(noMovePoint.y*Math.tan(n)),noMovePoint.y=0,m=Math.PI-k,f=f-e/Math.sin(m)-
(noMovePoint.x-e/Math.tan(m))*Math.cos(m),m=Point(Math.round(f*Math.cos(m)),Math.round(f*Math.sin(m))),j()&&(m.x=-m.x),b()))m.y=-m.y;n=Math.sqrt(Math.pow(endPoint.x-actualPoint.x,2)+Math.pow(endPoint.y-actualPoint.y,2));f=Math.round(noMovePoint.y/Math.tan(k)+noMovePoint.x);j()&&(f=d-f);l=j()?f:d-f;o=l*Math.cos(2*k);p=l*Math.sin(2*k);f=Point(Math.round(f+(j()?-o:o)),Math.round(b()?p:e-p));p=l*Math.sin(k);var s=actualPoint.x/2,v=actualPoint.y/2,l=Point(100*(s/d),100*(v/e)),n=n<d?n/d:1,o=100<p?(p-100)/
p:0;b()||(l.y=100-l.y);j()&&(l.x=100-l.x);q=Point(100*(p*Math.sin(k)/d),100*(p*Math.cos(k)/e));j()||(q.x=100-q.x);b()||(q.y=100-q.y);var t=getBrowserPre();if("-webkit-"!=t){var r=Point(s,v);b()||(r.y=e-r.y);j()&&(r.x=d-r.x);var s=100,s=Math.round(100*o),v=Math.round(100*(0.8*(1-o)+o)),u=j()?d:0,w=b()?0:e,u=r.x-u,w=r.y-w,r=Math.atan2(-w,u),r=180*r/Math.PI,u=getShadowRate(u,w,d,e,b());g.css({"background-image":t+"linear-gradient( "+r+"deg,  rgba(0,0,0,0) "+s*u+"%, rgba(0,0,0,"+0.2*n+") "+v*u+"%, rgba(255,255,255,"+
0.2*n+") "+100*u+"%)"});k=Point(p*Math.sin(k),p*Math.cos(k));j()||(k.x=d-k.x);b()||(k.y=e-k.y);u=j()?0:d;w=b()?0:e;u=k.x-u;w=k.y-w;r=Math.atan2(-w,u);r=180*r/Math.PI;u=getShadowRate(u,w,d,e,b());s=100*u;ff_gradientStart=0.6*s;h.css({"background-image":t+"linear-gradient( "+r+"deg, rgba(0,0,0,0) "+ff_gradientStart+"%, rgba(0,0,0,"+0.4*n+") "+s+"%, rgba(0,0,0,0) 100% )"})}"-webkit-"==t&&(g.css({"background-image":t+"gradient(linear, "+(j()?100:0)+"% "+(b()?0:100)+"%, "+l.x+"% "+l.y+"%, color-stop("+
o+",rgba(0,0,0,0)), color-stop("+(0.8*(1-o)+o)+",rgba(0,0,0,"+0.2*n+")), to(rgba(255,255,255,"+0.2*n+")))"}),h.css({"background-image":t+"gradient(linear, "+(j()?0:100)+"% "+(b()?0:100)+"%, "+q.x+"% "+q.y+"%,  color-stop(0.6,rgba(0,0,0,0)), color-stop(1, rgba(0,0,0,"+0.2*n+")), to(rgba(0,0,0,0)))"}));return{Angle:c,Mv:m,Df:f,NomovePoint:noMovePoint}},getShadowRate=function(a,b,c,d,e){var f=0,g=1,g=Math.sqrt(Math.pow(a,2)+Math.pow(b,2));Math.atan2(b,a);var h=Math.sqrt(Math.pow(c,2)+Math.pow(d,2)),
a=Math.abs(a),j=Math.abs(b),k=Math.atan2(d,c),c=Math.atan2(j,a),a=Math.abs(k-c),h=h*Math.cos(a),g=g/h;if(e&&0>b||!e&&0<b)f=d*Math.sin(c)/h;return g+f},setCurrentIndexTextField=function(a,b){var c=bookConfig.totalPagesCaption,d=bookConfig.pageNumberCaption;void 0==c&&(c="");void 0==d&&(d="");var e;""!=d?1!=a&&a!=totalPageCount&&b?(e=2*Math.floor(a/2),d=getShownPageNumber(e),e=getShownPageNumber(e+1),a=rightToLeft?e+"-"+d:d+"-"+e):a=getShownPageNumber(a):1!=a&&a!=totalPageCount&&b&&(d=e=2*Math.floor(a/
2),e+=1,a=rightToLeft?e+"-"+d:d+"-"+e);""==c?(c=totalPageCount,b||(c=originTotalPageCount)):(c=d=parseInt(c),b||(c=totalPageCount-originTotalPageCount+d));$("#fbCurrentPageIndex").text(a);pageIndexTextField.val(rightToLeft?c+"/"+a:a+"/"+c)},getShownPageNumber=function(a){var b=bookConfig.pageNumberCaption;if(""==b||void 0==b)return a;";"!=b.substr(b.length-1,1)&&(b+=";");for(var b=b.split(";"),c=[],d=0,e=0,f=0,g=b.length;f<g-1;f++)if(!(""==b[f]||void 0==b[f]))if(e=b[f].split(":"),-1<e[1].indexOf("+")){d=
e[0];g=d.indexOf("-");sMinPage=d.substring(0,g);sMaxPage=d.substring(g+1,d.length);for(var h=parseInt(sMinPage),j=parseInt(sMaxPage),e=parseInt(e[1].replace("+","")),d=j,g=h;g<=j;g++)c[g]=g-h+e}else h=parseInt(e[0]),c[h]=void 0==e[1]?"":e[1];return a>d?a:c[a]},getSpeedArray=function(a,b){for(var c=b/2,d=(a-a/4)/c,e=Array(b),f=0;f<b;f++)e[f]=f<c?a-(c-f)*d:a+(f-c+1)*d;return e.reverse()},getBrowserPre=function(){switch(browserType){case 3:return"-ms-";case 2:return"-moz-";case 1:return"-webkit-";case 4:return"-o-"}},
getPoint=function(a){if(void 0==a.getOrigin||null==a.getOrigin)a.getOrigin=!1;if(!a.getOrigin){a.getOrigin=!0;a.originX=parseInt(a.css("left"));a.originY=parseInt(a.css("top"));if(void 0==a.originX||null==a.originX||isNaN(a.originX))a.originX=0;if(void 0==a.originY||null==a.originY||isNaN(a.originY))a.originY=0}return Point(parseInt(a.css("left"))-a.originX,parseInt(a.css("top"))-a.originY)},getBookPoint=function(a){return bookType!=BookType.slide_book&&bookType!=BookType.singleSlide_book&&bookType!=
BookType.catalog_book&&bookType!=BookType.singleCatalog_book?getTransform(a[0]):getPoint(a)},getTransform=function(a){var b;switch(browserType){case 3:(b=a.style["-ms-transform"])&&null!=b&&(b=b.match(/translate\((.*?)\)/));break;case 2:(b=a.style["-moz-transform"])&&null!=b&&(b=b.match(/translate3d\((.*?)\)/));break;case 1:(b=a.style["-webkit-transform"])&&null!=b&&(b=b.match(/translate3d\((.*?)\)/));break;case 4:(b=a.style["-o-transform"])&&null!=b&&(b=b.match(/translate3d\((.*?)\)/));break;default:(b=
a.style.transform)&&null!=b&&(b=b.match(/translate3d\((.*?)\)/))}if(void 0==b||null==b)a=a.style.transform,void 0!=a&&null!=a&&(b=a.match(/translate3d\((.*?)\)/),null==b&&(b=a.match(/translate\((.*?)\)/)));if(null==b||""==b||2>b.length)return Point(0,0);b=b[1].split(", ");return Point(parseInt(b[0],10),parseInt(b[1],10))},actionEvent=function(){this.config.action.actionType==PageEditor.ActionType.GOTO_PAGE?gotoPageFun(this.config.action.pageIndex):this.config.action.actionType==PageEditor.ActionType.OPEN_URL?
(void 0==this.config.action.linkTarget&&(this.config.action.linkTarget="_blank"),sendvisitinfo(3,getShownPageString()),window.open(this.linkURL,this.config.action.linkTarget)):this.config.action.actionType==PageEditor.ActionType.OPEN_WINDOW?this.form=new initVideoForm(tmpContainer,{width:this.config.action.windowWidth,height:this.config.action.windowHeight,src:this.config.action.resourceContent,caption:this.config.action.caption},bookContainer.width(),bookContainer.height()):this.config.action.actionType==
PageEditor.ActionType.SLIDE_SHOW?this.slide=new initSlideShow(tmpContainer,this.config.action.photos.photo,bookContainer.width(),bookContainer.height()):this.config.action.actionType==PageEditor.ActionType.PLAY_AUDIO?(this.audios=new initAudioEditor(tmpContainer,this.config.action.audioURL,this.config.action.autoPlay),this.audios.showshow()):this.config.action.actionType==PageEditor.ActionType.ACTION_JS&&null!=this.config.action.scriptFun&&eval(this.config.action.scriptFun)},getAliasValue=function(a){a=
bookConfig[a]?bookConfig[a]:aliasConfig[a]?aliasConfig[a]:void 0;if(a instanceof Array){if(!(1>a.length))for(var b=0;b<a.length;b++){if(void 0!=bookConfig[a[b]])return bookConfig[a[b]];if(b==a.length-1)break}}else return a},getString=function(a,b){var c=getAliasValue(a);return void 0==c?b:c},getInt=function(a,b){var c=getAliasValue(a);try{return isNaN(c)||void 0==c?b:Number(c)}catch(d){return b}},getBool=function(a,b){var c=["true","yes","show","enable"],d=["false","no","hide","disable"],e=getAliasValue(a);
try{e=e.toLowerCase()}catch(f){return b}return 0>c.indexOf(e)&&0>d.indexOf(e)?b:0<=c.indexOf(e)},parseBool=function(a,b){if(!0===a||!1===a)return a;if(void 0==a)return!1;void 0==b&&(b=!1);var c=["true","yes","show","enable"],d=["false","no","hide","disable"],a=a.toLowerCase();return 0>c.indexOf(a)&&0>d.indexOf(a)?b:0<=c.indexOf(a)},getColor=function(a,b){var c=getAliasValue(a);return void 0!=c?colorTo0x(c):b},getImage=function(a){if(0<iconArray.length)for(var b=0;b<iconArray.length;b++)if(iconArray[b].url==
a)return iconArray[b].img;return new Image},getLanguage=function(a,b){return selectedLanguage[a]?selectedLanguage[a]:b},highlightSearchFun=function(a,b){if(0!=positionForPages.length){var c=!1;if(void 0==frmSearch||null==frmSearch)c=!0;frmSearch.isSearchShow||(c=!0);0==frmSearch.itemCount&&(c=!0);var d=frmSearch.textField.val().toLowerCase();""==d&&(c=!0);if(!0==c)clearHighlightFun(a);else{for(var e,c=0;c<positionForPages.length;c++)if(positionForPages[c].page==b){e=positionForPages[c].positions;
break}if(void 0==e)clearHighlightFun(a);else{var f="url("+uiBaseURL+"highlight.png)",g="",h="",j="",k="";if(0<e.length){for(c=0;c<e.length;c++){var m=e[c];if(-1<m.word.toLowerCase().indexOf(d))var l=m.left/(1-m.width),n=m.top/(1-m.height),g=g+f+",",k=k+"no-repeat,",h=h+100*l+"% "+100*n+"%,",j=j+100*m.width+"% "+100*m.height+"%,"}0<g.length?(g=g.substr(0,g.length-1),k=k.substr(0,k.length-1),h=h.substr(0,h.length-1),j=j.substr(0,j.length-1),a.css({"background-image":g,"background-repeat":k,"background-position":h,
"-webkit-background-size":j,"-o-background-size":j,"background-size":j,display:"block"})):clearHighlightFun(a)}else clearHighlightFun(a)}}}},clearHighlightFun=function(a){a.css({"background-image":""});a.css({display:"none"})},stopEvent=function(a){try{var b=a||window.event;b.preventDefault?(b.preventDefault(),b.stopPropagation()):(b.returnValue=!1,b.cancelBubble=!0)}catch(c){}},getShownPage=function(){var a=[];if(bookType==BookType.normal_book){var b=flipBook.getCurrentPageIndex(),b=2*Math.floor(b/
2),c=b+1;rightToLeft?(a.push(c),a.push(b)):(a.push(b),a.push(c))}bookType==BookType.single_book&&(b=singlePageBook.currentPageIndex,a.push(b));bookType==BookType.zoom_book&&(zoomBook.doublePage?(b=zoomBook.getCurrentPageIndex(),b=2*Math.floor(b/2),c=b+1,rightToLeft?(a.push(c),a.push(b)):(a.push(b),a.push(c))):(b=zoomBook.currentIndex,a.push(b)));if(bookType==BookType.slide_book){if(void 0==slideBook)return;b=slideBook.getCurrentPageIndex();b=2*Math.floor(b/2);c=b+1;rightToLeft?(a.push(c),a.push(b)):
(a.push(b),a.push(c))}if(bookType==BookType.singleSlide_book){if(void 0==singleSlideBook)return;b=parseInt(singleSlideBook.currentIndex);a.push(b)}if(bookType==BookType.catalog_book){if(void 0==catalogBook)return;b=catalogBook.getCurrentPageIndex();b=2*Math.floor(b/2);c=b+1;rightToLeft?(a.push(c),a.push(b)):(a.push(b),a.push(c))}if(bookType==BookType.singleCatalog_book){if(void 0==singleCatalogBook)return;b=parseInt(singleCatalogBook.currentIndex);a.push(b)}if(bookType==BookType.phone_book){if(void 0==
phoneBook)return;b=phoneBook.getCurrentPageIndex();b=2*Math.floor(b/2);c=b+1;rightToLeft?(a.push(c),a.push(b)):(a.push(b),a.push(c))}if(bookType==BookType.singlePhone_book){if(void 0==singlePhoneBook)return;b=singlePhoneBook.currentIndex;a.push(b)}return a},getShownPageString=function(){var a=getShownPage();return 1==a.length?a[0]+"":a[0]+"-"+a[1]},isIE=function(){navigator.userAgent.toLowerCase();return $.browser.msie},isIE11=function(){navigator.userAgent.toLowerCase();return 11==$.browser.version},
isPad=function(){return 0<navigator.userAgent.toLowerCase().indexOf("pad")},isIpad=function(){var a=navigator.userAgent.toLowerCase();return 0<a.indexOf("ipad")&&0<a.indexOf("safari")},isPC=function(){return 0<navigator.userAgent.toLowerCase().indexOf("pc")},isPhone=function(){var a=navigator.userAgent.toLowerCase();return 0<a.indexOf("phone")||0<a.indexOf("mobile")},isIpod=function(){return 0<navigator.userAgent.toLowerCase().indexOf("ipod")},isNokiaPhone=function(){var a=navigator.userAgent.toLowerCase();
return 0<a.indexOf("msie")&&0<a.indexOf("wpdesktop")},isPhoneBook=function(){return(isPhone()||isIpod()||isNokiaPhone())&&!isPad()&&!isPC()?!0:!1},isMiniStyle=Class({create:function(a){this.init(a);this.onResize();this.initEvent()},init:function(a){var b=this;this.miniLogo=$("<div><img style='right:0px;bottom:0px;' src='"+bookConfig.appLogoIcon+"'/></div>");this.miniLogo.css({position:"absolute",right:0,bottom:0});$(this.miniLogo).mouseOverCursor();a.append($(this.miniLogo));var c=bookConfig.appLogoLinkURL,
d=getString("appLogoOpenWindow","_blank");if("_Self"==d||"Self"==d||"self"==d)d="_self";void 0==c||""==c?(c="javascript:Void();",d="_self"):"http"!=c.substr(0,4)&&(c="http://"+c);this.miniLogo.css({opacity:"0.5"});this.miniLogo.bind(_event._end,function(){c!=void 0&&c!=null&&window.open(c,d)});this.miniLogo.bind(_event._enter,function(){b.miniLogo.css({opacity:"1"})});this.miniLogo.bind(_event._leave,function(){b.miniLogo.css({opacity:"0.5"})});this.width=220;this.height=35;this.box=$("<div></div>");
this.box.css({width:this.width+"px",height:this.height+"px","z-index":"300",color:"#ffffff","font-size":"15px",position:"relative"});this.background=$("<div></div>");this.background.css({width:"100%",height:"100%",background:"#000000",opacity:"0.5","border-radius":"5px","z-index":"0",position:"abosolute"});this.title=$("<div class='printBox'></div>");this.title.css({"z-index":"1","line-height":"100%",height:"100%",width:"100%",left:"0px",top:"0px","vertical-align":"middle","text-align":"center","text-shadow":"1px 1px #000000",
position:"abosolute"});this.title.html("<b>Click to view in fullscreen.</b>");this.box.append(this.background);this.box.append(this.title);tmpContainer.append(this.box)},onResize:function(){this.box.css({left:(windowWidth-this.width)/2+"px",top:(windowHeight-this.height)/2+"px"})},initEvent:function(){var a=this;this.box.mouseOverCursor();this.box.bind(_event._end,function(){var b=$("body")[0];fullScreenApi.supportsFullScreen?fullScreenApi.isFullScreen()?fullScreenApi.cancelFullScreen():fullScreenApi.requestFullScreen(b):
b.webkitSupportsFullscreen&&b.webkitEnterFullscreen(Element.ALLOW_KEYBOARD_INPUT);a.box.css({display:"none"});return!1});$(document).bind(fullScreenApi.fullScreenEventName,function(){toolBar.changeFullscreenIcon(fullScreenApi.isFullScreen())})},clearStyle:function(){this.box.empty()},isMini:function(){if(bookType!=BookType.phone_book&&bookType!=BookType.singlePhone_book){if((400>=windowWidth||400>=windowHeight)&&getBool("MiniStyle","true")&&!fullScreenApi.isFullScreen())return void 0!=this.box&&null!=
this.box&&this.box.css({display:"block"}),!0;void 0!=this.box&&null!=this.box&&this.box.css({display:"none"});return!1}}});function isBelowIE9(){return $.browser.msie?9>$.browser.version?!0:!1:!1}function hideLeftRightButton(){return void 0!=leftRightButton&&null!=leftRightButton&&3!=bookType&&4!=bookType&&5!=bookType&&6!=bookType&&7!=bookType&&8!=bookType?!0:!1}
function addAdSense(a,b,c,d,e){loadJavascript("http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js",function(){var f=document.createElement("ins"),f=$(f);f.addClass("adsbygoogle");f.css({display:"inline-block",width:c+"px",height:d+"px"});f.attr("data-ad-client",e);var g=$("<div/>");g.css({position:"absolute","z-index":1,left:a+"px",top:b+"px",width:c+"px",height:d+"px"});$("body").append(g);g.append(f);eval("(adsbygoogle = window.adsbygoogle || []).push({});")})}
var BookInfo=Class({statics:{getCurrentPages:function(){return getShownPage()},getPageCount:function(){return bookConfig.totalPageCount},isRightToLeft:function(){return rightToLeft},getBookType:function(){return bookType},getBook:function(){var a;switch(this.getBookType()){case BookType.normal_book:a=flipBook;break;case BookType.single_book:a=singlePageBook;break;case BookType.zoom_book:a=zoomBook;break;case BookType.slide_book:a=slideBook;break;case BookType.phone_book:a=singlePhoneBook;break;case BookType.singlePhone_book:a=
phoneBook;break;case BookType.singleSlide_book:a=singleSlideBook;break;case BookType.catalog_book:a=catalogBook;break;case BookType.singleCatalog_book:a=singleCatalogBook}return a},left:function(){return this.getBook().getLeft()},top:function(){return this.getBook().getTop()},width:function(){return this.getBook().getWidth()},height:function(){return this.getBook().getHeight()},scale:function(){return this.getBook().getScale()},container:function(){return bookContainer}}}),checkBookConfig=function(){void 0==
bookConfig.searchColor&&(bookConfig.searchColor="#00ffff");void 0==bookConfig.searchAlpha&&(bookConfig.searchAlpha=0.3);void 0==bookConfig.appLogoIcon&&(bookConfig.appLogoIcon="");void 0==bookConfig.appLogoLinkURL&&(bookConfig.appLogoLinkURL="");void 0==bookConfig.HomeURL&&(bookConfig.HomeURL="");void 0==bookConfig.appLogoOpenWindow&&(bookConfig.appLogoOpenWindow="Blank");void 0==bookConfig.bookTitle&&(bookConfig.bookTitle="FLIPBOOK");void 0==bookConfig.bookDescription&&(bookConfig.bookDescription=
"");void 0==bookConfig.toolbarColor&&(bookConfig.toolbarColor="#27181A");void 0==bookConfig.iconColor&&(bookConfig.iconColor="#FFFFFF");void 0==bookConfig.pageNumColor&&(bookConfig.pageNumColor="#000000");void 0==bookConfig.loadingBackground&&(bookConfig.loadingBackground="#333333");void 0==bookConfig.logoHeight&&(bookConfig.logoHeight="");void 0==bookConfig.logoPadding&&(bookConfig.logoPadding="");void 0==bookConfig.logoTop&&(bookConfig.logoTop="");void 0==bookConfig.HomeButtonVisible&&(bookConfig.HomeButtonVisible=
"Hide");void 0==bookConfig.ShareButtonVisible&&(bookConfig.ShareButtonVisible="Hide");void 0==bookConfig.ThumbnailsButtonVisible&&(bookConfig.ThumbnailsButtonVisible="Hide");void 0==bookConfig.thumbnailColor&&(bookConfig.thumbnailColor="#FFFFFF");void 0==bookConfig.thumbnailAlpha&&(bookConfig.thumbnailAlpha=70);void 0==bookConfig.ZoomButtonVisible&&(bookConfig.ZoomButtonVisible="Hide");void 0==bookConfig.TableOfContentButtonVisible&&(bookConfig.TableOfContentButtonVisible="Hide");void 0==bookConfig.BookMarkButtonVisible&&
(bookConfig.BookMarkButtonVisible="Hide");void 0==bookConfig.bookmarkBackground&&(bookConfig.bookmarkBackground="#000000");void 0==bookConfig.bookmarkFontColor&&(bookConfig.bookmarkFontColor="#cccccc");void 0==bookConfig.SearchButtonVisible&&(bookConfig.SearchButtonVisible="Hide");void 0==bookConfig.FullscreenButtonVisible&&(bookConfig.FullscreenButtonVisible="Show");void 0==bookConfig.leastSearchChar&&(bookConfig.leastSearchChar=0);void 0==bookConfig.searchBackground&&(bookConfig.searchBackground=
"#383838");void 0==bookConfig.searchFontColor&&(bookConfig.searchFontColor="#000000");void 0==bookConfig.PrintButtonVisible&&(bookConfig.PrintButtonVisible="Hide");void 0==bookConfig.printWatermarkFile&&(bookConfig.printWatermarkFile="");void 0==bookConfig.BackgroundSoundButtonVisible&&(bookConfig.BackgroundSoundButtonVisible="Hide");void 0==bookConfig.BackgroundSoundURL&&(bookConfig.BackgroundSoundURL="");void 0==bookConfig.BackgroundSoundLoop&&(bookConfig.BackgroundSoundLoop=-1);void 0==bookConfig.HelpButtonVisible&&
(bookConfig.HelpButtonVisible="Hide");void 0==bookConfig.helpContentFileURL&&(bookConfig.helpContentFileURL="");void 0==bookConfig.helpWidth&&(bookConfig.helpWidth=400);void 0==bookConfig.helpHeight&&(bookConfig.helpHeight=450);void 0==bookConfig.showHelpContentAtFirst&&(bookConfig.showHelpContentAtFirst="No");void 0==bookConfig.aboutButtonVisible&&(bookConfig.aboutButtonVisible="Hide");void 0==bookConfig.aboutContactInfoTxt&&(bookConfig.aboutContactInfoTxt="");void 0==bookConfig.AutoPlayButtonVisible&&
(bookConfig.AutoPlayButtonVisible="Hide");void 0==bookConfig.autoPlayAutoStart&&(bookConfig.autoPlayAutoStart="No");void 0==bookConfig.autoPlayDuration&&(bookConfig.autoPlayDuration=3);void 0==bookConfig.autoPlayLoopCount&&(bookConfig.autoPlayLoopCount=1);void 0==bookConfig.minZoomWidth&&(bookConfig.minZoomWidth=403);void 0==bookConfig.minZoomHeight&&(bookConfig.minZoomHeight=518);void 0==bookConfig.mouseWheelFlip&&(bookConfig.mouseWheelFlip="yes");void 0==bookConfig.DownloadButtonVisible&&(bookConfig.DownloadButtonVisible=
"Hide");void 0==bookConfig.DownloadURL&&(bookConfig.DownloadURL="");void 0==bookConfig.bgBeginColor&&(bookConfig.bgBeginColor="#E6E6E6");void 0==bookConfig.bgEndColor&&(bookConfig.bgEndColor="#E3E3E3");void 0==bookConfig.bgMRotation&&(bookConfig.bgMRotation=90);void 0==bookConfig.backGroundImgURL&&(bookConfig.backGroundImgURL="");void 0==bookConfig.LeftShadowWidth&&(bookConfig.LeftShadowWidth=100);void 0==bookConfig.LeftShadowAlpha&&(bookConfig.LeftShadowAlpha=1);void 0==bookConfig.RightShadowWidth&&
(bookConfig.RightShadowWidth=40);void 0==bookConfig.RightShadowAlpha&&(bookConfig.RightShadowAlpha=1);void 0==bookConfig.pageBackgroundColor&&(bookConfig.pageBackgroundColor="#FFFFFF");void 0==bookConfig.flipshortcutbutton&&(bookConfig.flipshortcutbutton="Hide");void 0==bookConfig.OriginPageIndex&&(bookConfig.OriginPageIndex=1);void 0==bookConfig.HardPageEnable&&(bookConfig.HardPageEnable="No");void 0==bookConfig.RightToLeft&&(bookConfig.RightToLeft="No");void 0==bookConfig.flippingTime?bookConfig.flippingTime=
0.3:0.2>bookConfig.flippingTime?bookConfig.flippingTime=0.2:bookConfig.flippingTime=bookConfig.flippingTime;void 0==bookConfig.retainBookCenter&&(bookConfig.retainBookCenter="Yes");void 0==bookConfig.totalPagesCaption&&(bookConfig.totalPagesCaption="");void 0==bookConfig.pageNumberCaption&&(bookConfig.pageNumberCaption="");void 0==bookConfig.topMargin&&(bookConfig.topMargin=10);void 0==bookConfig.bottomMargin&&(bookConfig.bottomMargin=10);void 0==bookConfig.leftMargin&&(bookConfig.leftMargin=10);
void 0==bookConfig.rightMargin&&(bookConfig.rightMargin=10);void 0==bookConfig.LinkDownColor&&(bookConfig.LinkDownColor="#0000FF");void 0==bookConfig.LinkAlpha&&(bookConfig.LinkAlpha=0.4);void 0==bookConfig.OpenWindow&&(bookConfig.OpenWindow="Blank");void 0==bookConfig.googleAnalyticsID&&(bookConfig.googleAnalyticsID="");void 0==bookConfig.language&&(bookConfig.language="English");void 0==bookConfig.AboutAddress&&(bookConfig.AboutAddress="");void 0==bookConfig.AboutEmail&&(bookConfig.AboutEmail="support@fliphtml5.com");
void 0==bookConfig.AboutMobile&&(bookConfig.AboutMobile="");void 0==bookConfig.AboutWebsite&&(bookConfig.AboutWebsite="http://www.fliphtml5.com");void 0==bookConfig.AboutDescription&&(bookConfig.AboutDescription="");void 0==bookConfig.AboutAuthor&&(bookConfig.AboutAuthor="fliphtml5.com");void 0==bookConfig.totalPageCount&&(bookConfig.totalPageCount=52);void 0==bookConfig.largePageWidth&&(bookConfig.largePageWidth=1440);void 0==bookConfig.largePageHeight&&(bookConfig.largePageHeight=1728);void 0==
bookConfig.normalPath&&(bookConfig.normalPath="files/page/");void 0==bookConfig.largePath&&(bookConfig.largePath="files/large/");void 0==bookConfig.thumbPath&&(bookConfig.thumbPath="files/thumb/");void 0==bookConfig.FlipStyle&&(bookConfig.FlipStyle="flip");void 0==bookConfig.showDoublePage&&(bookConfig.showDoublePage="yes");void 0==bookConfig.QRPath&&(bookConfig.QRPath="files/extfile/QRURL.png");void 0==bookConfig.QRCode&&(bookConfig.QRCode="Show");void 0==bookConfig.FlipSound&&(bookConfig.FlipSound=
"Yes");void 0==bookConfig.MiniStyle&&(bookConfig.MiniStyle="Show");void 0==bookConfig.AnnotationButtonVisible&&(bookConfig.AnnotationButtonVisible="hide");void 0==bookConfig.CompanyLogoFile&&(bookConfig.CompanyLogoFile="");void 0==bookConfig.haveAdSense&&(bookConfig.haveAdSense="No");void 0==bookConfig.adSenseLeft&&(bookConfig.adSenseLeft=0);void 0==bookConfig.adSenseTop&&(bookConfig.adSenseTop=0);void 0==bookConfig.adSenseWidth&&(bookConfig.adSenseWidth=0);void 0==bookConfig.adSenseHeight&&(bookConfig.adSenseHeight=
0);void 0==bookConfig.adSenseClientId&&(bookConfig.adSenseClientId="");void 0==bookConfig.addPaperCoil&&(bookConfig.addPaperCoil="No");void 0==bookConfig.HomeButtonIcon&&(bookConfig.HomeButtonIcon="");void 0==bookConfig.AnnotationButtonIcon&&(bookConfig.AnnotationButtonIcon="");void 0==bookConfig.ShareButtonIcon&&(bookConfig.ShareButtonIcon="");void 0==bookConfig.ThumbnailButtonIcon&&(bookConfig.ThumbnailButtonIcon="");void 0==bookConfig.ZoomInButtonIcon&&(bookConfig.ZoomInButtonIcon="");void 0==
bookConfig.ZoomOutButtonIcon&&(bookConfig.ZoomOutButtonIcon="");void 0==bookConfig.FullscreenButtonIcon&&(bookConfig.FullscreenButtonIcon="");void 0==bookConfig.ExitFullscreenButtonIcon&&(bookConfig.ExitFullscreenButtonIcon="");void 0==bookConfig.BookmarkButtonIcon&&(bookConfig.BookmarkButtonIcon="");void 0==bookConfig.TableOfContentButtonIcon&&(bookConfig.TableOfContentButtonIcon="");void 0==bookConfig.SearchButtonIcon&&(bookConfig.SearchButtonIcon="");void 0==bookConfig.PrintButtonIcon&&(bookConfig.PrintButtonIcon=
"");void 0==bookConfig.BackgroundSoundButtonOnIcon&&(bookConfig.BackgroundSoundButtonOnIcon="");void 0==bookConfig.BackgroundSoundButtonOffIcon&&(bookConfig.BackgroundSoundButtonOffIcon="");void 0==bookConfig.HelpButtonIcon&&(bookConfig.HelpButtonIcon="");void 0==bookConfig.AboutButtonIcon&&(bookConfig.AboutButtonIcon="");void 0==bookConfig.AutoPlayStartButtonIcon&&(bookConfig.AutoPlayStartButtonIcon="");void 0==bookConfig.AutoPlayStopButtonIcon&&(bookConfig.AutoPlayStopButtonIcon="");void 0==bookConfig.DownloadButtonIcon&&
(bookConfig.DownloadButtonIcon="");try{void 0!=staticAd&&!0==staticAd.haveAd&&(bookConfig.retainBookCenter="No")}catch(a){}},CreateNoteRemark=function(){noteCookie=new NoteCookie(tmpContainer);textRemark=new Remark;signature=new Signature(tmpContainer);annotationShapes=window.annotationShapes;textRemark.bindOnCreated(this,this.resetButton);noteCookie.bindOnCreated(this,this.resetButton);annotationShapes.bindOnCreated(this,this.resetButton);signature.bindOnCreated(this,this.resetButton)},AddNotesByContainers=
function(a,b,c){$(c).css({background:"rgba(0,0,0,0)"});void 0!=noteCookie&&noteCookie.setContainers(a,b,c);void 0!=textRemark&&textRemark.setContainers(a,b,c);void 0!=signature&&signature.setContainers(a,b,c);void 0!=annotationShapes&&annotationShapes.setContainers(a,b,c);void 0!=bookmark&&bookmark.setContainers(a,b,c)},ifOnStageResize=function(){return bookType==BookType.catalog_book||bookType==BookType.singleCatalog_book?!1:!0};function searchFromPages(a,b){for(var c=[],b=b.trim().toLowerCase(),d=null,d=-1==b.indexOf(" ")?[b]:b.split(" "),e=0,e=0;e<a.length;e++){var f=a[e].trim().toLowerCase(),g=f,h=-1,j=-1,k=-1,m=0,l=!0,n;for(n=0;n<d.length;n++){var g=new KMP(g,d[n]),o=d[n].length;if(g.match()){var p=m+g.getIndex();if(p>k)k=p,m=p+d[n].length,g=f.substring(m),0==n&&(h=p),n==d.length-1&&(j=p+o);else{l=!1;break}}else{l=!1;break}}l&&(k=[],k.search_page=e+1,k.search_title="page "+(e+1),h=f.substring(0,h).lastIndexOf("."),-1==
h?h=0:h++,m=f.substring(j),l=m.indexOf(".")+1,l=-1==l?m.length():j+l,f=f.substring(h,l),k.search_text=f,c.push(k))}return c};var KMP=function(a,b){this.__string=a;this.__pattern=b;this.__next=[];this.__times=0;this.__index=-1;for(var c=0,c=0;c<b.length;c++)this.__next[c]=1>=c?c-1:this.next(b.substring(0,c));this.__times=0;this.__index=-1};KMP.prototype.next=function(a){for(var b=Math.ceil(a.length/2);0<b&&0!=a.substring(0,b).compareTo(a.substring(a.length-b,a.length));)b--;return b};
KMP.prototype.match=function(){for(var a=0,b=0,c=-1;a<this.__string.length&&b<this.__pattern.length;){if(this.__string.charAt(a)==this.__pattern.charAt(b))0===b&&(c=a),a++,b++;else{for(var d=this.__next[b];-1!=d&&this.__pattern.charAt(d)==this.__pattern.charAt(b);)d=this.__next[d];b=d;-1==b?(a++,b=0):c=a-b}this.__times++}return b==this.__pattern.length?(this.__index=c,!0):!1};KMP.prototype.getTimes=function(){return this.__times};KMP.prototype.getIndex=function(){return this.__index};
String.prototype.compareTo=function(a){var b=this.length,c=a.length,d=Math.min(b,c),e=this.split(""),a=a.split(""),f=0,g=0;if(f==g){g=f;for(d+=f;g<d;){var h=e[g],j=a[g];if(h!=j)return h-j;g++}}else for(;0!=d--;)if(h=e[f++],j=a[g++],h!=j)return h-j;return b-c};String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")};
String.prototype.replaceAll=function(a,b){for(var c=this.indexOf(a),d=[],e=this;-1!=c;){var c=c+a.length,f=e.substring(0,c),e=e.substring(c),f=f.replace(a,b);d.push(f);c=e.indexOf(a)}""!==e&&d.push(e);return d.join("")};String.prototype.subBetween=function(a,b){if(void 0==a||void 0==b)return"";var c=this.length,d=this.indexOf(a);if(-1==d)return"";d+=a.length;c=this.substring(d,c).indexOf(b);return-1==c?"":this.substring(d,c+d)};function bookShadow(a,b,c){this.backgroun=$("<div></div>");this.width=a;this.height=b;$(this.backgroun).css({position:"absolute",width:this.width+"px",height:this.height+"px","-webkit-box-shadow":"0 0 15px rgba(40, 40, 40, 0.7)","-moz-box-shadow":"0 0 15px rgba(40, 40, 40, 0.7)","-o-box-shadow":"0 0 15px rgba(40, 40, 40, 0.7)","-ms-box-shadow":"0 0 15px rgba(40, 40, 40, 0.7)","box-shadow":"0 0 15px rgba(40, 40, 40, 0.7)"});$(c).append(this.backgroun)}
bookShadow.prototype.onResize=function(a,b,c){this.width=c?2*a:a;this.height=b;$(this.backgroun).css({width:this.width+"px",height:this.height+"px"})};bookShadow.prototype.setPosition=function(a,b){$(this.backgroun).css({top:b+"px",left:a+"px"})};
bookShadow.prototype.showShadow=function(){$(this.backgroun).css({"-webkit-box-shadow":"0 0 15px rgba(40, 40, 40, 0.7)","-moz-box-shadow":"0 0 15px rgba(40, 40, 40, 0.7)","-o-box-shadow":"0 0 15px rgba(40, 40, 40, 0.7)","-ms-box-shadow":"0 0 15px rgba(40, 40, 40, 0.7)","box-shadow":"0 0 15px rgba(40, 40, 40, 0.7)"})};
bookShadow.prototype.hideShadow=function(){$(this.backgroun).css({"-webkit-box-shadow":"0 0 15px rgba(40, 40, 40, 0)","-moz-box-shadow":"0 0 15px rgba(40, 40, 40, 0.7)","-o-box-shadow":"0 0 15px rgba(40, 40, 40, 0.7)","-ms-box-shadow":"0 0 15px rgba(40, 40, 40, 0.7)","box-shadow":"0 0 15px rgba(40, 40, 40, 0.7)"})};var BookSide=Class({hasProfessional:function(){if(void 0==pageEditor||null==pageEditor||0==pageEditor.length)return!1;for(var a=0;a<pageEditor.length;a++){var b=pageEditor[a];if(b&&0<b.length)return!0}return!1},initMMItems:function(){this.linkArray=[];this.youtubeArray=[];this.videoArray=[];this.audioArray=[];this.imageArray=[];this.buttonArray=[];this.flashShowArray=[];this.lineArray=[];this.arrowArray=[];this.roundArray=[];this.reArray=[];this.textArray=[];this.areaArray=[];this.calloutArray=[];
this.atextArray=[];this.startextArray=[];this.aminArray=[];this.atimageArray=[];this.alimageArray=[];this.slideShowArray=[];this.efftextArray=[];this.soundArray=[];this.bannerArray=[];this.carouselArray=[];this.dynshowArray=[];this.jumpArray=[];this.rotate3DArray=[];this.vimeoArray=[];this.flashSwfArray=[]},clearMM:function(){this.MMBackground.empty();this.initMMItems()},initMM:function(){if(this.hasProfessional()&&!(0>=this.imageIndex||pageEditor.length<this.imageIndex||0==pageEditor[this.imageIndex-
1].length))for(var a=pageEditor[this.imageIndex-1],b=0;b<a.length;b++){var c=a[b];if(void 0!=c){var d=c.annotype;if(d==PageEditor.AnnoType.ANNO_LINK){var e={width:c.location.width,height:c.location.height,x:c.location.x,y:c.location.y,alpha:c.alpha,downColor:c.downColor,downAlpha:c.downAlpha,overColor:c.overColor,overAlpha:c.overAlpha,outColor:c.outColor,outAlpha:c.outAlpha,action:c.action};this.linkArray.push(new initLink(this.MMBackground,e,this.width,this.height))}else d==PageEditor.AnnoType.ANNO_YOUTUBE||
d==PageEditor.AnnoType.ANNO_YOUTUBE1||d==PageEditor.AnnoType.ANNO_YOUTUBE2||d==PageEditor.AnnoType.ANNO_YOUTUBE3||d==PageEditor.AnnoType.ANNO_YOUTUBE4?(e={width:c.location.width,height:c.location.height,x:c.location.x,y:c.location.y,alpha:c.alpha,id:c.videoId,moviePlayTriggerEvt:c.moviePlayTriggerEvt,movieStopTriggerEvt:c.movieStopTriggerEvt},d!=PageEditor.AnnoType.ANNO_YOUTUBE&&(e.id=c.videoID),this.youtubeArray.push(new initYoutube(this.MMBackground,e,this.width,this.height))):d==PageEditor.AnnoType.ANNO_VIMEO||
d==PageEditor.AnnoType.ANNO_VIMEO2?(e={width:c.location.width,height:c.location.height,x:c.location.x,y:c.location.y,alpha:c.alpha,id:c.videoID,moviePlayTriggerEvt:c.moviePlayTriggerEvt,movieStopTriggerEvt:c.movieStopTriggerEvt,playerParameters:c.playerParameters},this.vimeoArray.push(new initVimeo(this.MMBackground,e,this.width,this.height))):d==PageEditor.AnnoType.ANNO_VIDEO?(e={width:c.location.width,height:c.location.height,x:c.location.x,y:c.location.y,alpha:c.alpha,src:c.url,previewSrc:c.previewUrl,
moviePlayTriggerEvt:c.PlayTriggerEvt,movieStopTriggerEvt:c.StopTriggerEvt},e=new initVideo(this.MMBackground,e,this.width,this.height,"round"),this.videoArray.push(e)):d==PageEditor.AnnoType.ANNO_AUDIO?(e={width:c.location.width,height:c.location.height,x:c.location.x,y:c.location.y,alpha:c.alpha,src:c.soundURL,soundPlayTriggerEvt:c.soundPlayTriggerEvt,soundStopTriggerEvt:c.soundStopTriggerEvt},e=new initAudio(this.MMBackground,e,this.width,this.height,"default"),this.audioArray.push(e)):d==PageEditor.AnnoType.ANNO_IMAGE?
(e={width:c.location.width,height:c.location.height,x:c.location.x,y:c.location.y,alpha:c.alpha,src:c.url,action:c.action,mouseOver:c.mouseOverEffect},this.imageArray.push(new initImage(this.MMBackground,e,this.width,this.height))):d==PageEditor.AnnoType.ANNO_BUTTON?(e={width:c.location.width,height:c.location.height,x:c.location.x,y:c.location.y,alpha:c.alpha,src:c.url,action:c.action,buttonCaption:c.buttonCaption,captionY:c.captionY,HRate:c.HRate,Format:c.Format},this.buttonArray.push(new initButton(this.MMBackground,
e,this.width,this.height,this.imageIndex+b))):d==PageEditor.AnnoType.ANNO_SWF?(e={width:c.location.width,height:c.location.height,x:c.location.x,y:c.location.y,alpha:c.alpha,src:c.swfURL,shadow:c.shadow},this.flashSwfArray.push(new initFlashSwf(this.MMBackground,e,this.width,this.height))):d==PageEditor.AnnoType.ANNO_FLASHSHOW?(e={width:c.location.width,height:c.location.height,x:c.location.x,y:c.location.y,alpha:c.alpha,photo:c.Images,repeatPlay:c.isRepeat},this.flashShowArray.push(new initFlashShow(this.MMBackground,
e,this.width,this.height))):d==PageEditor.AnnoType.ANNO_LINE?(e={StartX:c.lineStartPX,StartY:c.lineStartPY,EndX:c.lineEndPX,EndY:c.lineEndPY,x:c.location.x,y:c.location.y,width:c.location.width,height:c.location.height,lineAlpha:c.lineAlpha,alpha:c.alpha,lineWidth:c.lineWidth,lineType:c.lineType,dotWidth:c.dotWidth,color:c.color,sh:c.shadow.hasDropShadow,sx:c.shadow.shadowBlurX,sy:c.shadow.shadowBlurY,se:c.shadow.shadowDistance,sr:c.shadow.shadowColor},this.lineArray.push(new initLine(this.MMBackground,
e,this.width,this.height,this.imageIndex+b))):d==PageEditor.AnnoType.ANNO_ARROW?(e={StartX:c.lineStartPX,StartY:c.lineStartPY,EndX:c.lineEndPX,EndY:c.lineEndPY,x:c.location.x,y:c.location.y,width:c.location.width,height:c.location.height,alpha:c.alpha,lineWidth:c.lineWidth,lineType:c.lineType,dotWidth:c.dotWidth,color:c.color,sh:c.shadow.hasDropShadow,sx:c.shadow.shadowBlurX,sy:c.shadow.shadowBlurY,se:c.shadow.shadowDistance,arrowType:c.arrowType,sr:c.shadow.shadowColor},this.arrowArray.push(new initArrow(this.MMBackground,
e,this.width,this.height,this.imageIndex+b))):d==PageEditor.AnnoType.ANNO_ROUND?(e={x:c.location.x,y:c.location.y,width:c.location.width,height:c.location.height,alpha:c.alpha,fillStyle:c.fillStyle,color:c.color,ColorA:c.gradientColorA,ColorB:c.gradientColorB,angle:c.angle,spalpha:c.spalpha,borderWidth:c.borderWidth,borderColor:c.borderColor,borderAlpha:c.borderAlpha,sh:c.shadow.hasDropShadow,sx:c.shadow.shadowBlurX,sy:c.shadow.shadowBlurY,se:c.shadow.shadowDistance,sr:c.shadow.shadowColor,action:c.action},
this.roundArray.push(new initRound(this.MMBackground,e,this.width,this.height,this.imageIndex+b))):d==PageEditor.AnnoType.ANNO_RECTANGLE?(e={x:c.location.x,y:c.location.y,width:c.location.width,height:c.location.height,alpha:c.alpha,fillStyle:c.fillStyle,color:c.color,ColorA:c.gradientColorA,ColorB:c.gradientColorB,angle:c.angle,spalpha:c.spalpha,borderWidth:c.borderWidth,borderColor:c.borderColor,borderAlpha:c.borderAlpha,sh:c.shadow.hasDropShadow,sx:c.shadow.shadowBlurX,sy:c.shadow.shadowBlurY,
se:c.shadow.shadowDistance,sr:c.shadow.shadowColor,round:parseBool(c.round,!1),roundWidth:Math.max(parseInt(c.ellipseWidth),parseInt(c.ellipseHeight)),action:c.action},this.reArray.push(new initRe(this.MMBackground,e,this.width,this.height,this.imageIndex+b))):d==PageEditor.AnnoType.ANNO_TEXT?(e={x:c.location.x,y:c.location.y,width:c.location.width,height:c.location.height,alpha:c.alpha,textStr:c.textStr,lineH:c.lineHeightRation,fontName:c.formats.defaultFormat.fontName,fontSize:c.formats.defaultFormat.fontSize,
color:c.formats.defaultFormat.color,tbold:c.formats.defaultFormat.bold,italic:c.formats.defaultFormat.italic,pageH:c.formats.defaultFormat.pageH,bgalpha:c.background.alpha,fillBg:c.background.fillBg,bgcolor:c.background.color,sh:c.shadow.hasDropShadow,sx:c.shadow.shadowBlurX,sy:c.shadow.shadowBlurY,se:c.shadow.shadowDistance,sr:c.shadow.shadowColor,action:c.action},this.textArray.push(new initText(this.MMBackground,e,this.width,this.height,this.imageIndex+b))):d==PageEditor.AnnoType.ANNO_AREA?(e=
{x:c.location.x,y:c.location.y,width:c.location.width,height:c.location.height,alpha:c.alpha,color:c.color,rounds:c.round,ellipseWidth:c.ellipseWidth,ellipseHeight:c.ellipseHeight,sh:c.shadow.hasDropShadow,sx:c.shadow.shadowBlurX,sy:c.shadow.shadowBlurY,se:c.shadow.shadowDistance,sr:c.shadow.shadowColor,action:c.action},this.areaArray.push(new initArea(this.MMBackground,e,this.width,this.height,this.imageIndex+b))):d==PageEditor.AnnoType.ANNO_CALLOUT?(e={x:c.location.x,y:c.location.y,width:c.location.width,
height:c.location.height,alpha:c.alpha,textStr:c.textStr,lineH:c.lineHeightRation,pageH:c.formats.defaultFormat.pageH,fontName:c.formats.defaultFormat.fontName,fontSize:c.formats.defaultFormat.fontSize,color:c.formats.defaultFormat.color,tbold:c.formats.defaultFormat.bold,italic:c.formats.defaultFormat.italic,bgalpha:c.background.alpha,fillBg:c.background.fillBg,bgcolor:c.background.color,direct:c.hookDirect,cx1:c.hookContr1RatioX,cy1:c.hookContr1RatioY,cx2:c.hookContr2RatioX,cy2:c.hookContr2RatioY,
pointx:c.hookContrPointRatioX,pointy:c.hookContrPointRatioY,cornerRadiut:c.cornerRadiut,borderWidth:c.borderWidth,borderColor:c.borderColor,bordreAlpha:c.bordreAlpha,sh:c.shadow.hasDropShadow,sx:c.shadow.shadowBlurX,sy:c.shadow.shadowBlurY,se:c.shadow.shadowDistance,sr:c.shadow.shadowColor,action:c.action},this.calloutArray.push(new initCallout(this.MMBackground,e,this.width,this.height,this.imageIndex+b))):d==PageEditor.AnnoType.ANNO_ATEXT?(e={x:c.location.x,y:c.location.y,width:c.location.width,
height:c.location.height,alpha:c.alpha,textStr:c.strText,fontName:c.format.font,fontSize:c.format.size,color:c.format.color,tbold:c.format.bold,italic:c.format.italic,align:c.format.align,action:c.action,repeat:c.repeat,moveSpeed:c.moveSpeed,pageH:c.format.pageH,sh:c.shadow.hasDropShadow,sx:c.shadow.shadowBlurX,sy:c.shadow.shadowBlurY,se:c.shadow.shadowDistance,sr:c.shadow.shadowColor},this.atextArray.push(new initAText(this.MMBackground,e,this.width,this.height,this.imageIndex+b))):d==PageEditor.AnnoType.ANNO_STARTEXT?
(e={x:c.location.x,y:c.location.y,width:c.location.width,height:c.location.height,alpha:c.alpha,textStr:c.strText,fontName:c.format.font,fontSize:c.format.size,color:c.format.color,tbold:c.format.bold,italic:c.format.italic,align:c.format.align,action:c.action,repeat:c.repeat,moveSpeed:c.moveSpeed,lineH:c.HRate,sh:c.shadow.hasDropShadow,sx:c.shadow.shadowBlurX,sy:c.shadow.shadowBlurY,se:c.shadow.shadowDistance,sr:c.shadow.shadowColor},this.startextArray.push(new initStarText(this.MMBackground,e,this.width,
this.height,this.imageIndex+b))):d==PageEditor.AnnoType.ANNO_TEXTANIM?(e={x:c.location.x,y:c.location.y,width:c.location.width,height:c.location.height,alpha:c.alpha,effectType:c.effectType,textStr:c.textStr,fontName:c.formats.defaultFormat.fontName,fontSize:c.formats.defaultFormat.fontSize,color:c.formats.defaultFormat.color,tbold:c.formats.defaultFormat.bold,italic:c.formats.defaultFormat.italic,action:c.action,lineH:c.HRate,sh:c.shadow.hasDropShadow,sx:c.shadow.shadowBlurX,sy:c.shadow.shadowBlurY,
se:c.shadow.shadowDistance,sr:c.shadow.shadowColor},this.aminArray.push(new initAminText(this.MMBackground,e,this.width,this.height,this.imageIndex+b))):d==PageEditor.AnnoType.ANNO_ATIMAGE?(e={width:c.location.width,height:c.location.height,x:c.location.x,y:c.location.y,alpha:c.alpha,src:c.url,action:c.action},this.atimageArray.push(new initPngImage(this.MMBackground,e,this.width,this.height))):d==PageEditor.AnnoType.ANNO_EFFECTTEXT?(e={x:c.location.x,y:c.location.y,width:c.location.width,height:c.location.height,
alpha:c.alpha,textStr:c.htmlText,moveSpeed:c.effectStyle,lineH:c.HRate,sh:c.shadow.hasDropShadow,sx:c.shadow.shadowBlurX,sy:c.shadow.shadowBlurY,se:c.shadow.shadowDistance,sr:c.shadow.shadowColor},this.efftextArray.push(new initEffText(this.MMBackground,e,this.width,this.height,this.imageIndex+b))):d==PageEditor.AnnoType.ANNO_ADVANCEDSOUND?(e={width:c.location.width,height:c.location.height,x:c.location.x,y:c.location.y,alpha:c.alpha,src:c.soundList.sound,skinType:c.skinType,soundPlay:c.soundPlayTriggerEvt},
this.soundArray.push(new initSound(this.MMBackground,e,this.width,this.height,this.imageIndex+b))):d==PageEditor.AnnoType.ANNO_CAROUSEL?(e={width:c.location.width,height:c.location.height,x:c.location.x,y:c.location.y,alpha:c.alpha,images:c.Images},this.carouselArray.push(new initCarousel(this.MMBackground,e,this.width,this.height,this.imageIndex+b))):d==PageEditor.AnnoType.ANNO_DYNSHOW?(e={width:c.location.width,height:c.location.height,x:c.location.x,y:c.location.y,alpha:c.alpha,images:c.Images,
borderWidth:c.borderWidth},this.dynshowArray.push(new initDynamicShow(this.MMBackground,e,this.width,this.height,this.imageIndex+b))):d==PageEditor.AnnoType.ANNO_BANNER?(e={width:c.location.width,height:c.location.height,x:c.location.x,y:c.location.y,alpha:c.alpha,action:c.action,banners:c.banners},this.bannerArray.push(new initBanner(this.MMBackground,e,this.width,this.height,this.imageIndex+b))):d==PageEditor.AnnoType.ANNO_FLIPJUMP?(e={width:c.location.width,height:c.location.height,x:c.location.x,
y:c.location.y,alpha:c.alpha,images:c.Images,addBackground:parseBool(c.addBack),addBorder:parseBool(c.addBorder),backgroundColor:c.backgroundColor,backgroundAlpha:c.backgroundColorAlpha,borderColor:c.backgroundBorderColor},this.jumpArray.push(new initFlipJump(this.MMBackground,e,this.width,this.height,this.imageIndex+b))):d==PageEditor.AnnoType.ANNO_PLUGIN&&c.className==PLUGIN_ROTATE3D?(e={width:c.location.width,height:c.location.height,x:c.location.x,y:c.location.y,alpha:c.alpha,images:c.componentData.Images,
addBackground:parseBool(c.componentData.addBack),addBorder:parseBool(c.componentData.addBorder),backgroundColor:c.componentData.backColor,backgroundAlpha:c.componentData.backAlpha,borderColor:c.componentData.borderColor,sh:parseBool(c.shadow.hasDropShadow),sx:c.shadow.shadowBlurX,sy:c.shadow.shadowBlurY,se:c.shadow.shadowDistance,sr:c.shadow.shadowColor},this.rotate3DArray.push(new initRotate3D(this.MMBackground,e,this.width,this.height,this.imageIndex+b))):d==PageEditor.AnnoType.ANNO_VIDEO1?(e={width:c.location.width,
height:c.location.height,x:c.location.x,y:c.location.y,alpha:c.alpha,src:c.videoURL,previewSrc:c.previewUrl,moviePlayTriggerEvt:c.PlayTriggerEvt,movieStopTriggerEvt:c.StopTriggerEvt},e=new initVideo(this.MMBackground,e,this.width,this.height,"smallblack"),this.videoArray.push(e)):d==PageEditor.AnnoType.ANNO_VIDEO2?(e={width:c.location.width,height:c.location.height,x:c.location.x,y:c.location.y,alpha:c.alpha,src:c.videoURL,previewSrc:c.previewUrl,moviePlayTriggerEvt:c.PlayTriggerEvt,movieStopTriggerEvt:c.StopTriggerEvt},
e=new initVideo(this.MMBackground,e,this.width,this.height),this.videoArray.push(e)):d==PageEditor.AnnoType.ANNO_PLUGIN&&c.className==PLUGIN_VIDEO1?(e={width:c.location.width,height:c.location.height,x:c.location.x,y:c.location.y,alpha:c.alpha,src:c.componentData.videoURL,previewSrc:c.previewUrl,moviePlayTriggerEvt:c.PlayTriggerEvt,movieStopTriggerEvt:c.StopTriggerEvt},e=new initVideo(this.MMBackground,e,this.width,this.height,"classic"),this.videoArray.push(e)):d==PageEditor.AnnoType.ANNO_PLUGIN&&
c.className==PLUGIN_VIDEO2?(e={width:c.location.width,height:c.location.height,x:c.location.x,y:c.location.y,alpha:c.alpha,src:c.componentData.videoURL,previewSrc:c.previewUrl,moviePlayTriggerEvt:c.PlayTriggerEvt,movieStopTriggerEvt:c.StopTriggerEvt},e=new initVideo(this.MMBackground,e,this.width,this.height),this.videoArray.push(e)):d==PageEditor.AnnoType.ANNO_AUDIO1?(e={width:c.location.width,height:c.location.height,x:c.location.x,y:c.location.y,alpha:c.alpha,src:c.soundList=={}?"":c.soundList.sound,
key:"path",soundPlayTriggerEvt:c.soundPlayTriggerEvt,soundStopTriggerEvt:c.soundStopTriggerEvt},e=new initAudio(this.MMBackground,e,this.width,this.height,"advanced"),this.audioArray.push(e)):d==PageEditor.AnnoType.ANNO_AUDIO2?(e={width:c.location.width,height:c.location.height,x:c.location.x,y:c.location.y,alpha:c.alpha,src:c.data=={}?"":c.data.item,key:"fname",soundPlayTriggerEvt:c.soundPlayTriggerEvt,soundStopTriggerEvt:c.soundStopTriggerEvt},e=new initAudio(this.MMBackground,e,this.width,this.height,
"wave"),this.audioArray.push(e)):d==PageEditor.AnnoType.ANNO_PLUGIN&&c.className in audioThemeNames?(e={width:c.location.width,height:c.location.height,x:c.location.x,y:c.location.y,alpha:c.alpha,src:!c.componentData||!c||c.componentData.songs=={}||void 0==c.componentData.songs?{}:c.componentData.songs.song,key:"url",soundPlayTriggerEvt:c.soundPlayTriggerEvt,soundStopTriggerEvt:c.soundStopTriggerEvt},c=void 0,"GlassAudioPlayer"==pageEditor[this.imageIndex-1][b].className&&(c="glass"),"SimpleAudioPlayer"==
pageEditor[this.imageIndex-1][b].className&&(c="simple"),"StandardAudioPlayer"==pageEditor[this.imageIndex-1][b].className&&(c="enjoy"),"StandardAudioPlayer02"==pageEditor[this.imageIndex-1][b].className&&(c="decent"),"StandardAudioPlayer03"==pageEditor[this.imageIndex-1][b].className&&(c="tree"),"StandardAudioPlayer04"==pageEditor[this.imageIndex-1][b].className&&(c="christmas"),"StandardAudioPlayer05"==pageEditor[this.imageIndex-1][b].className&&(c="turnonoff"),"StandardAudioPlayer06"==pageEditor[this.imageIndex-
1][b].className&&(c="fade"),e=new initAudio(this.MMBackground,e,this.width,this.height,c),this.audioArray.push(e)):d==PageEditor.AnnoType.ANNO_ALPHATRANSITIONBANNER?(e={width:c.location.width,height:c.location.height,x:c.location.x,y:c.location.y,alpha:c.alpha,src:c.url,action:c.action,images:c.Images.node},this.alimageArray.push(new initAlphaTransitionBanner(this.MMBackground,e,this.width,this.height))):d==PageEditor.AnnoType.ANNO_EMBEDDEDSLIDESHOW?(e={width:c.location.width,height:c.location.height,
x:c.location.x,y:c.location.y,alpha:c.alpha,images:c.Images.Image},this.slideShowArray.push(new initEmbeddedSlideshow(this.MMBackground,e,this.width,this.height))):d==PageEditor.AnnoType.ANNO_PRINT&&(e={width:c.location.width,height:c.location.height,x:c.location.x,y:c.location.y,alpha:c.alpha,overAlpha:c.overAlpha,borderColor:c.borderColor,overColor:c.overColor,borderWidth:c.barderWidth,printTitle:c.printTitle,printDesc:c.printDesc},this.areaArray.push(new initPrint(this.MMBackground,e,this.width,
this.height,this.imageIndex)))}}},initSlider:function(){if(window.hiSliderFactory){var a=sliderJS[this.imageIndex-1];void 0!=a&&(this.slider=window.hiSliderFactory({container:this.MMBackground,slide:a,initialWidth:this.width,initialHeight:this.height}),this.slider.resize(this.width,this.height),!0==this.playSliderAfterLoad&&this.playSlider())}},playSlider:function(){this.slider?(this.slider.replay(),this.playSliderAfterLoad=!1):this.playSliderAfterLoad=!0},resetSlider:function(){this.slider&&this.slider.reset();
this.playSliderAfterLoad=!1},openSliderOrNot:function(a){if(!(void 0==a||null==a)){for(var b=!1,c=0;c<a.length;c++)if(a[c]==this.imageIndex){b=!0;break}!0==b?this.playSlider():this.resetSlider()}},resizeSlider:function(a,b){this.slider&&this.slider.resize(a,b)},onMMResize:function(a,b){this.MMBackground.css({width:a+"px",height:b+"px"});this.resizeSlider(a,b);for(var c=0;c<this.linkArray.length;c++)this.linkArray[c].onResize(a,b);for(c=0;c<this.youtubeArray.length;c++)this.youtubeArray[c].onResize(a,
b);for(c=0;c<this.videoArray.length;c++)this.videoArray[c].onResize(a,b);for(c=0;c<this.audioArray.length;c++)this.audioArray[c].onResize(a,b);for(c=0;c<this.imageArray.length;c++)this.imageArray[c].onResize(a,b);for(c=0;c<this.buttonArray.length;c++)this.buttonArray[c].onResize(a,b);for(c=0;c<this.flashShowArray.length;c++)this.flashShowArray[c].onResize(a,b);for(c=0;c<this.arrowArray.length;c++)this.arrowArray[c].onResize(a,b);for(c=0;c<this.lineArray.length;c++)this.lineArray[c].onResize(a,b);
for(c=0;c<this.reArray.length;c++)this.reArray[c].onResize(a,b);for(c=0;c<this.textArray.length;c++)this.textArray[c].onResize(a,b);for(c=0;c<this.roundArray.length;c++)this.roundArray[c].onResize(a,b);for(c=0;c<this.areaArray.length;c++)this.areaArray[c].onResize(a,b);for(c=0;c<this.calloutArray.length;c++)this.calloutArray[c].onResize(a,b);for(c=0;c<this.atextArray.length;c++)this.atextArray[c].onResize(a,b);for(c=0;c<this.startextArray.length;c++)this.startextArray[c].onResize(a,b);for(c=0;c<this.aminArray.length;c++)this.aminArray[c].onResize(a,
b);for(c=0;c<this.atimageArray.length;c++)this.atimageArray[c].onResize(a,b);for(c=0;c<this.efftextArray.length;c++)this.efftextArray[c].onResize(a,b);for(c=0;c<this.soundArray.length;c++)this.soundArray[c].onResize(a,b);for(c=0;c<this.bannerArray.length;c++)this.bannerArray[c].onResize(a,b);for(c=0;c<this.carouselArray.length;c++)this.carouselArray[c].onResize(a,b);for(c=0;c<this.dynshowArray.length;c++)this.dynshowArray[c].onResize(a,b);for(c=0;c<this.jumpArray.length;c++)this.jumpArray[c].onResize(a,
b);for(c=0;c<this.rotate3DArray.length;c++)this.rotate3DArray[c].onResize(a,b);for(c=0;c<this.vimeoArray.length;c++)this.vimeoArray[c].onResize(a,b);for(c=0;c<this.flashSwfArray.length;c++)this.flashSwfArray[c].onResize(a,b);for(c=0;c<this.slideShowArray.length;c++)this.slideShowArray[c].onResize(a,b);for(c=0;c<this.alimageArray.length;c++)this.alimageArray[c].onResize(a,b)},showLoading:function(){this.side.append(this.loadingImg)},hideLoading:function(){this.loadingImg.remove()}});
function normalSide(a,b){var c=this;this.imageIndex=0;this.width=300;this.height=400;this.side=$("<div class='side'></div>");this.sideContent=$("<div class='sideContent'></div>");this.sideImg=$("<img />");this.grayShadow=$("<div class='kong edgeShadow' ></div>");this.searchHighlight=$("<div class='kong' id='highlight'></div>");this.grayShadow.css({display:"none"});this.isLeft=b;this.rightToLeft=rightToLeft;var d=parseBool(bookConfig.addPaperCoil);this.isLeft?(this.midShadow=$("<div class='leftShadow'></div>"),
this.midShadow.css({width:userConfig.leftShadowWidth+"px",opacity:userConfig.leftShadowAlpha}),d&&(this.midCoil=$("<div class='leftPaperCoil'></div>"))):(this.midShadow=$("<div class='rightShadow'></div>"),this.midShadow.css({width:userConfig.rightShadowWidth+"px",opacity:userConfig.rightShadowAlpha}),d&&(this.midCoil=$("<div class='rightPaperCoil'></div>")));d=getColor("pageBackgroundColor","#f5f5f5");this.side.css({"background-color":d,overflow:"hidden"});this.sideContent.css("background-color",
d);this.side.css({overflow:"hidden"});this.MMBackground=$("<div style='position : absolute; z-index : 6;'></div>");this.loadingImg=$("<img src='"+uiBaseURL+"progress.gif' style='position: absolute;' />");this.loadingImg.css({left:(this.width-LOADING_WIDTH)/2+"px",top:(this.height-LOADING_HEIGHT)/2+"px"});this.initMMItems();this.slider=null;this.playSliderAfterLoad=!1;a.append(this.side);this.side.append(this.sideContent);this.side.append(this.midShadow);this.side.append(this.MMBackground);this.midShadow.css("z-index",
5);this.midCoil&&(this.side.append(this.midCoil),this.midCoil.css("z-index",5));this.side.hammer().on("doubletap",function(){if(bookType==BookType.normal_book){flipBook.zoomToPage(c.imageIndex);return false}})}normalSide.prototype.getSide=function(){return this.side};
normalSide.prototype.fillContent=function(a){if(a!=this.imageIndex){this.imageIndex=a;null!=this.slider&&(this.slider.destroy(),this.slider=null);this.sideContent.empty();this.MMBackground.empty();a<=originTotalPageCount&&this.showLoading();this.isLeft=0==a%2;this.rightToLeft&&(this.isLeft=!this.isLeft);var b=this;try{this.sideImg.attr("src",getPageDir(this.imageIndex,"normal",originTotalPageCount)),this.imgLoaded=0,this.sideImg.load(function(){b.hideLoading();b.sideContent.append(b.sideImg);b.sideContent.append(b.grayShadow);
b.sideContent.append(b.searchHighlight);b.searchHighlight.css({opacity:0.8});b.clearMM();b.initMM();b.initSlider()})}catch(c){this.hideLoading()}}};normalSide.prototype.initMM=function(){this._super();AddNotesByContainers(BookType.normal_book,this.imageIndex,this.MMBackground);this.showOrHideYoutube(getShownPage())};normalSide.prototype.showOrHideYoutube=function(a){if(!(void 0==a||null==a)){for(var b=!1,c=0;c<a.length;c++)if(a[c]==this.imageIndex){b=!0;break}!0==b?this.showYoutube():this.hideYoutube()}};
normalSide.prototype.hideYoutube=function(){for(var a=0;a<this.youtubeArray.length;a++)this.youtubeArray[a].hide()};normalSide.prototype.showYoutube=function(){for(var a=0;a<this.youtubeArray.length;a++)this.youtubeArray[a].show()};
normalSide.prototype.imgFlipOver=function(a){a?(this.sideImg.css({"-webkit-transform":"scaleX(-1)","-moz-transform":"scaleX(-1)"}),this.MMBackground.css({"-webkit-transform":"scaleX(-1)","-moz-transform":"scaleX(-1)"}),this.midShadow.attr("class",this.isLeft?"rightShadow":"leftShadow"),this.midShadow.css({left:this.isLeft?"0px":"auto",right:this.isLeft?"auto":"0px"})):(this.sideImg.css({"-webkit-transform":"scaleX(1)","-moz-transform":"scaleX(1)"}),this.MMBackground.css({"-webkit-transform":"scaleX(1)",
"-moz-transform":"scaleX(1)"}),this.midShadow.attr("class",this.isLeft?"leftShadow":"rightShadow"),this.midShadow.css({left:this.isLeft?"auto":"0px",right:this.isLeft?"0px":"auto"}));this.midCoil&&(this.midCoil.attr("class",this.isLeft?"rightPaperCoil":"leftPaperCoil"),this.midCoil.css({left:this.isLeft?"0px":"auto",right:this.isLeft?"auto":"0px"}));this.grayShadow.css({display:this.isLeft?"block":"none"})};
normalSide.prototype.addHistoryTexts=function(a){if(!(void 0==a||null==a)){for(var b=!1,c=0;c<a.length;c++)if(a[c]==this.imageIndex){b=!0;break}!0==b&&AddNotesByContainers(BookType.normal_book,this.imageIndex,this.MMBackground)}};normalSide.prototype.changeTo0x=function(a){var b=a;"#"!=a.substr(0,1)&&"0x"!=a.substr(0,2)&&(b="#"+parseInt(a).toString(16));"0x"==a.substr(0,2)&&(b=a.replace("0x","#"));return b};
normalSide.prototype.showGray=function(){this.searchHighlight.css({display:"block"});this.isLeft&&browserType!=BrowserType.MS&&this.grayShadow.css({display:"block"});for(var a=0;a<this.youtubeArray.length;a++)this.youtubeArray[a].show();for(a=0;a<this.flashSwfArray.length;a++)this.flashSwfArray[a].show();for(a=0;a<this.buttonArray.length;a++)this.buttonArray[a].show()};
normalSide.prototype.hideGray=function(){this.clearHighlight();this.grayShadow.css({display:"none"});for(var a=0;a<this.youtubeArray.length;a++)this.youtubeArray[a].hide();for(a=0;a<this.flashSwfArray.length;a++)this.flashSwfArray[a].hide();for(a=0;a<this.buttonArray.length;a++)this.buttonArray[a].hide()};normalSide.prototype.highlightSearch=function(){highlightSearchFun(this.searchHighlight,this.imageIndex)};normalSide.prototype.clearHighlight=function(){clearHighlightFun(this.searchHighlight)};
normalSide.prototype.onResize=function(a,b){this.side.css({width:a+"px",height:b+"px"});this.sideContent.css({width:a+"px",height:b+"px"});this.sideImg.css({width:a+"px",height:b+"px"});this.searchHighlight.css({width:a+"px",height:b+"px"});this.onMMResize(a,b);var c=a/450;this.midShadow.css({height:b+"px",width:Math.floor(this.isLeft?c*userConfig.leftShadowWidth:c*userConfig.rightShadowWidth)+"px"});this.midCoil&&this.midCoil.css({height:b+"px"});this.loadingImg.css({left:(a-32)/2+"px",top:(b-32)/
2+"px"});browserType!=BrowserType.MS&&(this.grayShadow.css({width:a+"px",height:b+"px",left:0.3*b-a+"px",top:-b/3+"px"}),this.grayShadow.rotate(30));this.width=a;this.height=b};normalSide.prototype.sideAddChild=function(a){this.side.append(a)};
normalSide.prototype.enterSide=function(){for(var a=0;a<this.youtubeArray.length;a++)this.youtubeArray[a].getPlayEvt(),this.youtubeArray[a].getStopEvt(),this.youtubeArray[a].show();for(a=0;a<this.flashSwfArray.length;a++)this.flashSwfArray[a].show();for(a=0;a<this.buttonArray.length;a++)this.buttonArray[a].show();for(a=0;a<this.videoArray.length;a++)this.videoArray[a].getPlayEvt()==PageEditor.PlayEvt.EVT_PLAY&&this.videoArray[a].playVideo(),this.videoArray[a].getPlayEvt()==PageEditor.PlayEvt.EVT_STOP&&
this.videoArray[a].pauseVideo();for(a=0;a<this.audioArray.length;a++)this.audioArray[a].getPlayEvt()==PageEditor.PlayEvt.EVT_PLAY&&this.audioArray[a].play()};
normalSide.prototype.leaveSide=function(){for(var a=0;a<this.youtubeArray.length;a++)this.youtubeArray[a].getPlayEvt(),this.youtubeArray[a].getStopEvt(),this.youtubeArray[a].hide();for(a=0;a<this.flashSwfArray.length;a++)this.flashSwfArray[a].hide();for(a=0;a<this.buttonArray.length;a++)this.buttonArray[a].hide();for(a=0;a<this.videoArray.length;a++)this.videoArray[a].getStopEvt()==PageEditor.PlayEvt.EVT_PLAY&&this.videoArray[a].playVideo(),this.videoArray[a].getStopEvt()==PageEditor.PlayEvt.EVT_STOP&&
this.videoArray[a].pauseVideo();for(a=0;a<this.audioArray.length;a++)this.audioArray[a].pause();this.searchHighlight.css({"background-image":""});this.resetSlider()};
normalSide.prototype.initZoom=function(){var a=!1;this.zw=this.width;this.zh=this.height;this.isZoom=!1;var b=Point(0,0),c=Point(0,0);this.side.bind(_event._down,function(d){d=d.originalEvent.touches;2==d.length&&(a=!0,b=Point(d[0].pageX,d[0].pageY),c=Point(d[1].pageX,d[1].pageY))});this.side.bind(_event._end,function(){});this.side.bind(_event._move,function(d){d=d.originalEvent.touches;a&&(100<=Math.pow(b.x-d[0].pageX,2)+Math.pow(b.y-d[0].pageY,2)||(Math.pow(c.x-d[1].pageX,2),Math.pow(c.y-d[1].pageY,
2)))})};normalSide.extend(BookSide);function normalPage(){this.pageStatu=!1;this.corner="tr";this.pageIndex=1;this.isHardPage=!1;this.pageVisible=!0;this.width=300;this.height=400;this.maskWidth=500;this.isLastPageReset=!1}
normalPage.prototype.create=function(a){this.page=$("<div class='paper'></div>");this.maskA=$("<div class='pageMask'></div>");this.maskB=$("<div class='pageMask'></div>");this.sideAPosition=$("<div class='sidePosition'></div>");this.sideBPosition=$("<div class='sidePosition'></div>");this.flipBackShadow=$("<div class='backShadow'></div>");this.flipFrontShadow=$("<div class='frontShadow'></div>");this.sideA=new normalSide(this.sideAPosition,!1);this.sideB=new normalSide(this.sideBPosition,!0);this.page.append(this.flipBackShadow);
a.append(this.page);this.page.append(this.maskA);this.page.append(this.maskB);this.maskA.append(this.sideAPosition);this.maskB.append(this.sideBPosition);this.sideAPosition.append(this.sideA.side);this.sideBPosition.append(this.sideB.side);!0==$.browser.mozilla&&(this.maskA.css("border-top","1px solid transparent"),this.maskB.css("border-top","1px solid transparent"))};normalPage.prototype.getSideA=function(){return this.sideA};normalPage.prototype.getSideB=function(){return this.sideB};
normalPage.prototype.onResize=function(a,b,c,d){this.page.css({width:a+"px",height:b+"px",left:d+"px"});this.maskA.css({width:a+"px",height:b+"px"});this.maskB.css({width:a+"px",height:b+"px"});this.flipBackShadow.css({width:a+"px",height:b+"px"});this.flipFrontShadow.css({width:a+"px",height:b+"px"});this.sideAPosition.css({width:a+"px",height:b+"px"});this.sideBPosition.css({width:a+"px",height:b+"px"});this.sideA.onResize(a,b);this.sideB.onResize(a,b);this.width=a;this.height=b;this.maskWidth=
c};normalPage.prototype.fillSideA=function(a){this.sideA.fillContent(a);this.pageIndex=a;this.isHardPage=!1;1==a&&hardPageEnable&&3!=browserType&&(this.isHardPage=!0)};normalPage.prototype.fillSideB=function(a){this.sideB.fillContent(a);a==totalPageCount&&hardPageEnable&&3!=browserType&&(this.isHardPage=!0)};
normalPage.prototype.beginFlip=function(a){this.corner=a;this.isLeft()?(this.sideA.sideAddChild(this.flipFrontShadow),this.pageStatu=!0):(this.sideB.sideAddChild(this.flipFrontShadow),this.pageStatu=!1);1>=flipBook.gotoPageIndex&&flipBook.bmt.leftBox.hide();flipBook.gotoPageIndex>=totalPageCount&&flipBook.bmt.rightBox.hide();3>=flipBook.gotoPageIndex&&flipBook.setLeftThicknessVisible(!1);flipBook.gotoPageIndex>=totalPageCount-2&&flipBook.setRightThicknessVisible(!1);this.maskA.css({width:this.maskWidth+
"px",height:this.maskWidth+"px"});this.maskB.css({width:this.maskWidth+"px",height:this.maskWidth+"px"});flipBook.normalBookShadow.hideShadow()};
normalPage.prototype.flipToPoint=function(a,b,c){if(this.isHardPage)this.hardFlip(a,c);else if(this.isCorner(a,b))this.resetPage(this.isLeft());else{var d=computePoint(this.corner,a,b,this.width,this.height,this.maskWidth,this.flipFrontShadow,this.flipBackShadow),a=d.Angle,b=d.Df,e=d.NomovePoint,d=d.Mv,f=this.isLeft(),g=this.isBottom();c&&(this.showShadow(),this.page.css({left:f?"0px":this.width+"px"}),this.sideAPosition.css({right:f?"0px":"auto",left:f?"auto":"0px",top:g?"auto":"0px",bottom:g?"0px":
"auto"}),this.sideBPosition.css({right:f?"0px":"auto",left:f?"auto":"0px",top:g?"auto":"0px",bottom:g?"0px":"auto"}),this.setSideUp(f),f?this.sideA.hideGray():this.sideB.hideGray());switch(this.corner){case "tl":this.rotateElement(this.maskA,"100% 0%",translate(-e.x+this.width-this.maskWidth+d.x,-e.y+d.y)+rotate(-a));this.rotateElement(this.maskB,"100% 0%",translate(-e.x+this.width-this.maskWidth+d.x,-e.y+d.y)+rotate(-a));this.rotateElement(this.sideBPosition,"100% 0%",rotate(a)+translate(e.x-d.x,
e.y-d.y));this.rotateElement(this.sideAPosition,"100% 0%",rotate(a)+translate(e.x+b.x-d.x,e.y+b.y-d.y));this.rotateElement(this.sideA.side,"100% 0%",translate(-this.width,0)+rotate(2*(90-a)));break;case "tr":this.rotateElement(this.maskA,"0% 0%",translate(e.x+d.x,-e.y+d.y)+rotate(a));this.rotateElement(this.maskB,"0% 0%",translate(e.x+d.x,-e.y+d.y)+rotate(a));this.rotateElement(this.sideAPosition,"0% 0%",rotate(-a)+translate(-e.x-d.x,e.y-d.y));this.rotateElement(this.sideBPosition,"0% 0%",rotate(-a)+
translate(-e.x-d.x+b.x,e.y+b.y-d.y));this.rotateElement(this.sideB.getSide(),"0% 0%",translate(0,0)+rotate(2*(a-90)));break;case "bl":this.rotateElement(this.maskA,"100% 100%",translate(-e.x+this.width-this.maskWidth+d.x,e.y+this.height-this.maskWidth+d.y)+rotate(a));this.rotateElement(this.maskB,"100% 100%",translate(-e.x+this.width-this.maskWidth+d.x,e.y+this.height-this.maskWidth+d.y)+rotate(a));this.rotateElement(this.sideBPosition,"100% 100%",rotate(-a)+translate(e.x-d.x,-e.y-d.y));this.rotateElement(this.sideAPosition,
"100% 100%",rotate(-a)+translate(e.x+b.x-d.x,-e.y-d.y+b.y));this.rotateElement(this.sideA.getSide(),"100% 100%",translate(-this.width,-this.height)+rotate(2*(a-90)));break;case "br":this.rotateElement(this.maskA,"0% 100%",translate(e.x+d.x,e.y+this.height-this.maskWidth+d.y)+rotate(-a)),this.rotateElement(this.maskB,"0% 100%",translate(e.x+d.x,e.y+this.height-this.maskWidth+d.y)+rotate(-a)),this.rotateElement(this.sideAPosition,"0% 100%",rotate(a)+translate(-e.x-d.x,-e.y-d.y)),this.rotateElement(this.sideBPosition,
"0% 100%",rotate(a)+translate(-e.x+b.x-d.x,-e.y+b.y-d.y)),this.rotateElement(this.sideB.getSide(),"0% 100%",translate(0,-this.height)+rotate(2*(90-a)))}}};normalPage.prototype.flipToAnPoint=function(a,b,c){this.beginFlip(c);this.flipToPoint(a,b,!0);"tl"==c||"bl"==c?this.setSideUp(!0):this.setSideUp(!1)};normalPage.prototype.endFlip=function(){this.hideShadow();this.pageStatu=this.isLeft()?!1:!0;this.sideA.showGray();this.sideB.showGray();flipBook.normalBookShadow.showShadow()};
normalPage.prototype.hardFlip=function(a,b){var c=!1;if("tl"==this.corner||"bl"==this.corner)c=!0;var d=c?a-this.width:a;d<-this.width&&(d=-this.width);d>=this.width&&(d=this.width);d=180*Math.acos(d/this.width)/Math.PI;c?(b&&(this.sideA.imgFlipOver(!0),this.page.css({"-webkit-perspective-origin":"right center","-webkit-transform-origin":"100% 50%","-webkit-transform-style":"preserve-3d","-moz-perspective-origin":"right center","-moz-transform-origin":"100% 50%","-moz-transform-style":"preserve-3d",
"z-index":20})),d=180-d,this.page.css({"-webkit-transform":"perspective(3000px) rotateY("+d+"deg) translate3d(0px,0px,-1px)","-moz-transform":"perspective(3000px) rotateY("+d+"deg)"}),90<=d?this.setSideUp(!0):this.setSideUp(!1)):(b&&(this.sideB.imgFlipOver(!0),this.page.css({"-webkit-perspective-origin":"left center","-webkit-transform-origin":"0% 50%","-webkit-transform-style":"preserve-3d","-moz-transform-style":"preserve-3d","-moz-perspective-origin":"left center","-moz-transform-origin":"0% 50%",
"z-index":20})),this.page.css({"-webkit-transform":"perspective(3000px) rotateY("+-d+"deg)","-moz-transform":"perspective(3000px) rotateY("+-d+"deg)"}),90<=d?this.setSideUp(!1):this.setSideUp(!0))};
normalPage.prototype.resetPage=function(a){var b=this;this.isHardPage&&(this.sideA.imgFlipOver(!1),this.sideB.imgFlipOver(!1),!this.isLastPageReset&&this.pageIndex+1==totalPageCount?(this.isLastPageReset=!0,window.setTimeout(function(){b.page.css({"-webkit-transform-style":"flat","-moz-transform-style":"flat","-webkit-transform":"rotateY(0deg)","-moz-transform":"rotateY(0deg)","-o-transform":"rotateY(0deg)","-ms-transform":"rotateY(0deg)",transform:"rotateY(0deg)"})},10)):b.page.css({"-webkit-transform-style":"flat",
"-moz-transform-style":"flat","-webkit-transform":"rotateY(0deg)","-moz-transform":"rotateY(0deg)","-o-transform":"rotateY(0deg)","-ms-transform":"rotateY(0deg)",transform:"rotateY(0deg)"}));this.page.css({left:a?"0px":this.width+"px"});this.maskA.css({top:"0px",left:"0px",bottom:"auto",right:"auto",width:this.width,height:this.height});this.maskB.css({top:"0px",left:"0px",bottom:"auto",right:"auto",width:this.width,height:this.height});this.rotateElement(this.maskA,"0% 0%",translate(0,0)+rotate(0));
this.rotateElement(this.maskB,"0% 0%",translate(0,0)+rotate(0));this.sideAPosition.css({top:"0px",left:"0px",bottom:"auto",right:"auto"});this.sideBPosition.css({top:"0px",left:"0px",bottom:"auto",right:"auto"});this.rotateElement(this.sideAPosition,"0% 0%",translate(0,0)+rotate(0));this.rotateElement(this.sideBPosition,"0% 0%",translate(0,0)+rotate(0));this.rotateElement(this.sideA.getSide(),"0% 0%",translate(0,0)+rotate(0));this.rotateElement(this.sideB.getSide(),"0% 0%",translate(0,0)+rotate(0))};
normalPage.prototype.setSideUp=function(a){this.maskA.css({"z-index":a?2:1});this.maskB.css({"z-index":a?1:2})};normalPage.prototype.rotateElement=function(a,b,c){a.css({"-webkit-transform-origin":b,"-moz-transform-origin":b,"-ms-transform-origin":b,"-o-transform-origin":b,"-webkit-transform":c,"-moz-transform":c,"-ms-transform":c,"-o-transform":c})};
normalPage.prototype.translateElement=function(a,b,c){a.css({"-webkit-transform":"translate("+b+"px,"+c+"px)","-moz-transform":"translate("+b+"px,"+c+"px)","-o-transform":"translate("+b+"px,"+c+"px)","-ms-transform":"translate("+b+"px,"+c+"px)"})};normalPage.prototype.isTop=function(){return 0<=this.corner.indexOf("t")};normalPage.prototype.isLeft=function(){return 0<=this.corner.indexOf("l")};normalPage.prototype.isBottom=function(){return 0<=this.corner.indexOf("b")};
normalPage.prototype.isRight=function(){return 0<=this.corner.indexOf("r")};normalPage.prototype.isCorner=function(a,b){var c=0;this.isTop()&&0==b&&c++;this.isBottom()&&b==this.height&&c++;this.isLeft()&&0==a&&c++;this.isRight()&&a==this.width&&c++;return 2==c};normalPage.prototype.setPageVisible=function(a){a?(this.page.css({display:"block"}),this.pageVisible=!0):(this.page.css({display:"none"}),this.pageVisible=!1)};normalPage.prototype.getPageStatu=function(){return this.pageStatu};
normalPage.prototype.setPageStatu=function(a){this.pageStatu=a};normalPage.prototype.showShadow=function(){this.flipFrontShadow.css({display:"block"});this.flipBackShadow.css({display:"block"})};normalPage.prototype.hideShadow=function(){this.flipFrontShadow.css({display:"none"});this.flipBackShadow.css({display:"none"})};normalPage.prototype.setCSS=function(a){this.page.css(a)};function rightToLeftNormalPage(){normalPage.call(this)}$.extend(rightToLeftNormalPage.prototype,normalPage.prototype);
rightToLeftNormalPage.prototype.create=function(a){this.page=$("<div class='paper'></div>");this.maskA=$("<div class='pageMask'></div>");this.maskB=$("<div class='pageMask'></div>");this.sideAPosition=$("<div class='sidePosition'></div>");this.sideBPosition=$("<div class='sidePosition'></div>");this.flipBackShadow=$("<div class='backShadow'></div>");this.flipFrontShadow=$("<div class='frontShadow'></div>");this.sideA=new normalSide(this.sideAPosition,!0);this.sideB=new normalSide(this.sideBPosition,
!1);a.append(this.page);this.page.append(this.flipBackShadow);this.page.append(this.maskA);this.page.append(this.maskB);this.maskA.append(this.sideAPosition);this.maskB.append(this.sideBPosition);this.sideAPosition.append(this.sideA.side);this.sideBPosition.append(this.sideB.side);!0==$.browser.mozilla&&(this.maskA.css("border-top","1px solid transparent"),this.maskB.css("border-top","1px solid transparent"))};
rightToLeftNormalPage.prototype.beginFlip=function(a){this.corner=a;this.isLeft()?(this.sideB.sideAddChild(this.flipFrontShadow),this.pageStatu=!0):(this.sideA.sideAddChild(this.flipFrontShadow),this.pageStatu=!1);1>=flipBook.gotoPageIndex&&flipBook.bmt.rightBox.hide();flipBook.gotoPageIndex>=totalPageCount&&flipBook.bmt.leftBox.hide();3>=flipBook.gotoPageIndex&&flipBook.setLeftThicknessVisible(!1);flipBook.gotoPageIndex>=totalPageCount-2&&flipBook.setRightThicknessVisible(!1);this.maskA.css({width:this.maskWidth+
"px",height:this.maskWidth+"px"});this.maskB.css({width:this.maskWidth+"px",height:this.maskWidth+"px"});flipBook.normalBookShadow.hideShadow()};
rightToLeftNormalPage.prototype.flipToPoint=function(a,b,c){if(this.isHardPage)this.hardFlip(a,c);else if(this.isCorner(a,b))this.resetPage(!this.isLeft());else{var d=computePoint(this.corner,a,b,this.width,this.height,this.maskWidth,this.flipFrontShadow,this.flipBackShadow),a=d.Angle,b=d.Df,e=d.NomovePoint,d=d.Mv,f=this.isLeft(),g=this.isBottom();c&&(this.showShadow(),this.page.css({left:f?"0px":this.width+"px"}),this.sideAPosition.css({right:f?"0px":"auto",left:f?"auto":"0px",top:g?"auto":"0px",
bottom:g?"0px":"auto"}),this.sideBPosition.css({right:f?"0px":"auto",left:f?"auto":"0px",top:g?"auto":"0px",bottom:g?"0px":"auto"}),this.setSideUp(!f),f?this.sideA.hideGray():this.sideB.hideGray());switch(this.corner){case "tl":this.rotateElement(this.maskA,"100% 0%",translate(-e.x+this.width-this.maskWidth+d.x,-e.y+d.y)+rotate(-a));this.rotateElement(this.maskB,"100% 0%",translate(-e.x+this.width-this.maskWidth+d.x,-e.y+d.y)+rotate(-a));this.rotateElement(this.sideAPosition,"100% 0%",rotate(a)+translate(e.x-
d.x,e.y-d.y));this.rotateElement(this.sideBPosition,"100% 0%",rotate(a)+translate(e.x+b.x-d.x,e.y+b.y-d.y));this.rotateElement(this.sideB.side,"100% 0%",translate(-this.width,0)+rotate(2*(90-a)));break;case "tr":this.rotateElement(this.maskA,"0% 0%",translate(e.x+d.x,-e.y+d.y)+rotate(a));this.rotateElement(this.maskB,"0% 0%",translate(e.x+d.x,-e.y+d.y)+rotate(a));this.rotateElement(this.sideBPosition,"0% 0%",rotate(-a)+translate(-e.x-d.x,e.y-d.y));this.rotateElement(this.sideAPosition,"0% 0%",rotate(-a)+
translate(-e.x-d.x+b.x,e.y+b.y-d.y));this.rotateElement(this.sideA.getSide(),"0% 0%",translate(0,0)+rotate(2*(a-90)));break;case "bl":this.rotateElement(this.maskA,"100% 100%",translate(-e.x+this.width-this.maskWidth+d.x,e.y+this.height-this.maskWidth+d.y)+rotate(a));this.rotateElement(this.maskB,"100% 100%",translate(-e.x+this.width-this.maskWidth+d.x,e.y+this.height-this.maskWidth+d.y)+rotate(a));this.rotateElement(this.sideAPosition,"100% 100%",rotate(-a)+translate(e.x-d.x,-e.y-d.y));this.rotateElement(this.sideBPosition,
"100% 100%",rotate(-a)+translate(e.x+b.x-d.x,-e.y-d.y+b.y));this.rotateElement(this.sideB.getSide(),"100% 100%",translate(-this.width,-this.height)+rotate(2*(a-90)));break;case "br":this.rotateElement(this.maskA,"0% 100%",translate(e.x+d.x,e.y+this.height-this.maskWidth+d.y)+rotate(-a)),this.rotateElement(this.maskB,"0% 100%",translate(e.x+d.x,e.y+this.height-this.maskWidth+d.y)+rotate(-a)),this.rotateElement(this.sideBPosition,"0% 100%",rotate(a)+translate(-e.x-d.x,-e.y-d.y)),this.rotateElement(this.sideAPosition,
"0% 100%",rotate(a)+translate(-e.x+b.x-d.x,-e.y+b.y-d.y)),this.rotateElement(this.sideA.getSide(),"0% 100%",translate(0,-this.height)+rotate(2*(90-a)))}}};
rightToLeftNormalPage.prototype.hardFlip=function(a,b){var c=!1;if("tl"==this.corner||"bl"==this.corner)c=!0;var d=c?a-this.width:a;d<-this.width&&(d=-this.width);d>=this.width&&(d=this.width);d=180*Math.acos(d/this.width)/Math.PI;c?(b&&(this.sideB.imgFlipOver(!0),this.page.css({"-webkit-perspective-origin":"right center","-webkit-transform-origin":"100% 50%","-webkit-transform-style":"preserve-3d","-moz-perspective-origin":"right center","-moz-transform-origin":"100% 50%","-moz-transform-style":"preserve-3d",
"z-index":20})),d=180-d,this.page.css({"-webkit-transform":"perspective(3000px) rotateY("+d+"deg) translate3d(0px,0px,-1px)","-moz-transform":"perspective(3000px) rotateY("+d+"deg)"}),90<=d?this.setSideUp(!1):this.setSideUp(!0)):(b&&(this.sideA.imgFlipOver(!0),this.page.css({"-webkit-perspective-origin":"left center","-webkit-transform-origin":"0% 50%","-webkit-transform-style":"preserve-3d","-moz-transform-style":"preserve-3d","-moz-perspective-origin":"left center","-moz-transform-origin":"0% 50%",
"z-index":20})),this.page.css({"-webkit-transform":"perspective(3000px) rotateY("+-d+"deg)","-moz-transform":"perspective(3000px) rotateY("+-d+"deg)"}),90<=d?this.setSideUp(!0):this.setSideUp(!1))};
rightToLeftNormalPage.prototype.resetPage=function(a){this.isHardPage&&(this.sideA.imgFlipOver(!1),this.sideB.imgFlipOver(!1),!this.isLastPageReset&&this.pageIndex+1==totalPageCount?(this.isLastPageReset=!0,window.setTimeout(function(){this.page.css({"-webkit-transform-style":"flat","-moz-transform-style":"flat","-webkit-transform":"rotateY(0deg)","-moz-transform":"rotateY(0deg)","-o-transform":"rotateY(0deg)","-ms-transform":"rotateY(0deg)",transform:"rotateY(0deg)"})},10)):this.page.css({"-webkit-transform-style":"flat",
"-moz-transform-style":"flat","-webkit-transform":"rotateY(0deg)","-moz-transform":"rotateY(0deg)","-o-transform":"rotateY(0deg)","-ms-transform":"rotateY(0deg)",transform:"rotateY(0deg)"}));this.page.css({left:!a?"0px":this.width+"px"});this.maskA.css({top:"0px",left:"0px",bottom:"auto",right:"auto",width:this.width,height:this.height});this.maskB.css({top:"0px",left:"0px",bottom:"auto",right:"auto",width:this.width,height:this.height});this.rotateElement(this.maskA,"0% 0%",translate(0,0)+rotate(0));
this.rotateElement(this.maskB,"0% 0%",translate(0,0)+rotate(0));this.sideAPosition.css({top:"0px",left:"0px",bottom:"auto",right:"auto"});this.sideBPosition.css({top:"0px",left:"0px",bottom:"auto",right:"auto"});this.rotateElement(this.sideAPosition,"0% 0%",translate(0,0)+rotate(0));this.rotateElement(this.sideBPosition,"0% 0%",translate(0,0)+rotate(0));this.rotateElement(this.sideA.getSide(),"0% 0%",translate(0,0)+rotate(0));this.rotateElement(this.sideB.getSide(),"0% 0%",translate(0,0)+rotate(0))};
function androidPage(){normalPage.call(this)}$.extend(androidPage.prototype,normalPage.prototype);
androidPage.prototype.flipToPoint=function(a,b,c){if(this.isHardPage)this.hardFlip(a,c);else if(this.isCorner(a,b))this.resetPage(this.isLeft());else{var d=computePoint(this.corner,a,this.isTop()?0:this.height,this.width,this.height,this.maskWidth,this.flipFrontShadow,this.flipBackShadow),a=d.Angle,b=d.Df,e=d.NomovePoint,d=d.Mv,f=this.isLeft(),g=this.isBottom();c&&(this.showShadow(),this.page.css({left:f?"0px":this.width+"px"}),this.sideAPosition.css({right:f?"0px":"auto",left:f?"auto":"0px",top:g?
"auto":"0px",bottom:g?"0px":"auto"}),this.sideBPosition.css({right:f?"0px":"auto",left:f?"auto":"0px",top:g?"auto":"0px",bottom:g?"0px":"auto"}),this.setSideUp(f),f?this.sideA.hideGray():this.sideB.hideGray());switch(this.corner){case "tl":this.rotateElement(this.maskA,"100% 0%",translate(-e.x+this.width-this.maskWidth+d.x,-e.y+d.y)+rotate(-a));this.rotateElement(this.maskB,"100% 0%",translate(-e.x+this.width-this.maskWidth+d.x,-e.y+d.y)+rotate(-a));this.rotateElement(this.sideBPosition,"100% 0%",
rotate(a)+translate(e.x-d.x,e.y-d.y));this.rotateElement(this.sideAPosition,"100% 0%",rotate(a)+translate(e.x+b.x-d.x,e.y+b.y-d.y));this.rotateElement(this.sideA.side,"100% 0%",translate(-this.width,0)+rotate(2*(90-a)));break;case "tr":this.rotateElement(this.maskA,"0% 0%",translate(e.x+d.x,-e.y+d.y)+rotate(a));this.rotateElement(this.maskB,"0% 0%",translate(e.x+d.x,-e.y+d.y)+rotate(a));this.rotateElement(this.sideAPosition,"0% 0%",rotate(-a)+translate(-e.x-d.x,e.y-d.y));this.rotateElement(this.sideBPosition,
"0% 0%",rotate(-a)+translate(-e.x-d.x+b.x,e.y+b.y-d.y));this.rotateElement(this.sideB.getSide(),"0% 0%",translate(0,0)+rotate(2*(a-90)));break;case "bl":this.rotateElement(this.maskA,"100% 100%",translate(-e.x+this.width-this.maskWidth+d.x,e.y+this.height-this.maskWidth+d.y)+rotate(a));this.rotateElement(this.maskB,"100% 100%",translate(-e.x+this.width-this.maskWidth+d.x,e.y+this.height-this.maskWidth+d.y)+rotate(a));this.rotateElement(this.sideBPosition,"100% 100%",rotate(-a)+translate(e.x-d.x,-e.y-
d.y));this.rotateElement(this.sideAPosition,"100% 100%",rotate(-a)+translate(e.x+b.x-d.x,-e.y-d.y+b.y));this.rotateElement(this.sideA.getSide(),"100% 100%",translate(-this.width,-this.height)+rotate(2*(a-90)));break;case "br":this.rotateElement(this.maskA,"0% 100%",translate(e.x+d.x,e.y+this.height-this.maskWidth+d.y)+rotate(-a)),this.rotateElement(this.maskB,"0% 100%",translate(e.x+d.x,e.y+this.height-this.maskWidth+d.y)+rotate(-a)),this.rotateElement(this.sideAPosition,"0% 100%",rotate(a)+translate(-e.x-
d.x,-e.y-d.y)),this.rotateElement(this.sideBPosition,"0% 100%",rotate(a)+translate(-e.x+b.x-d.x,-e.y+b.y-d.y)),this.rotateElement(this.sideB.getSide(),"0% 100%",translate(0,-this.height)+rotate(2*(90-a)))}}};function androidRightPage(){rightToLeftNormalPage.call(this)}$.extend(androidRightPage,rightToLeftNormalPage.prototype);
androidRightPage.prototype.flipToPoint=function(a,b,c){if(this.isHardPage)this.hardFlip(a,c);else if(this.isCorner(a,b))this.resetPage(!this.isLeft());else{var d=computePoint(this.corner,a,this.isTop()?0:this.height,this.width,this.height,this.maskWidth,this.flipFrontShadow,this.flipBackShadow),a=d.Angle,b=d.Df,e=d.NomovePoint,d=d.Mv,f=this.isLeft(),g=this.isBottom();c&&(this.showShadow(),this.page.css({left:f?"0px":this.width+"px"}),this.sideAPosition.css({right:f?"0px":"auto",left:f?"auto":"0px",
top:g?"auto":"0px",bottom:g?"0px":"auto"}),this.sideBPosition.css({right:f?"0px":"auto",left:f?"auto":"0px",top:g?"auto":"0px",bottom:g?"0px":"auto"}),this.setSideUp(!f),f?this.sideA.hideGray():this.sideB.hideGray());switch(this.corner){case "tl":this.rotateElement(this.maskA,"100% 0%",translate(-e.x+this.width-this.maskWidth+d.x,-e.y+d.y)+rotate(-a));this.rotateElement(this.maskB,"100% 0%",translate(-e.x+this.width-this.maskWidth+d.x,-e.y+d.y)+rotate(-a));this.rotateElement(this.sideAPosition,"100% 0%",
rotate(a)+translate(e.x-d.x,e.y-d.y));this.rotateElement(this.sideBPosition,"100% 0%",rotate(a)+translate(e.x+b.x-d.x,e.y+b.y-d.y));this.rotateElement(this.sideB.side,"100% 0%",translate(-this.width,0)+rotate(2*(90-a)));break;case "tr":this.rotateElement(this.maskA,"0% 0%",translate(e.x+d.x,-e.y+d.y)+rotate(a));this.rotateElement(this.maskB,"0% 0%",translate(e.x+d.x,-e.y+d.y)+rotate(a));this.rotateElement(this.sideBPosition,"0% 0%",rotate(-a)+translate(-e.x-d.x,e.y-d.y));this.rotateElement(this.sideAPosition,
"0% 0%",rotate(-a)+translate(-e.x-d.x+b.x,e.y+b.y-d.y));this.rotateElement(this.sideA.getSide(),"0% 0%",translate(0,0)+rotate(2*(a-90)));break;case "bl":this.rotateElement(this.maskA,"100% 100%",translate(-e.x+this.width-this.maskWidth+d.x,e.y+this.height-this.maskWidth+d.y)+rotate(a));this.rotateElement(this.maskB,"100% 100%",translate(-e.x+this.width-this.maskWidth+d.x,e.y+this.height-this.maskWidth+d.y)+rotate(a));this.rotateElement(this.sideAPosition,"100% 100%",rotate(-a)+translate(e.x-d.x,-e.y-
d.y));this.rotateElement(this.sideBPosition,"100% 100%",rotate(-a)+translate(e.x+b.x-d.x,-e.y-d.y+b.y));this.rotateElement(this.sideB.getSide(),"100% 100%",translate(-this.width,-this.height)+rotate(2*(a-90)));break;case "br":this.rotateElement(this.maskA,"0% 100%",translate(e.x+d.x,e.y+this.height-this.maskWidth+d.y)+rotate(-a)),this.rotateElement(this.maskB,"0% 100%",translate(e.x+d.x,e.y+this.height-this.maskWidth+d.y)+rotate(-a)),this.rotateElement(this.sideBPosition,"0% 100%",rotate(a)+translate(-e.x-
d.x,-e.y-d.y)),this.rotateElement(this.sideAPosition,"0% 100%",rotate(a)+translate(-e.x+b.x-d.x,-e.y+b.y-d.y)),this.rotateElement(this.sideA.getSide(),"0% 100%",translate(0,-this.height)+rotate(2*(90-a)))}}};var bookMouseDown=!1,nBookStatu=0;
function normalBook(a){this.pageWidth=300;this.pageHeight=400;this.width=600;this.height=400;this.maskWidth=500;this.gotoPageIndex=this.currentPageIndex=this.betweenPaperCount=1;this.intervalID=this.flipToPage=this.flippingPage=null;this.flipPoint=Point(0,0);this.totalFrame=30;var b=1E3*bookConfig.flippingTime;void 0!=b&&0<b&&(this.totalFrame=b/20);this.adContainer=$("<div id='adContainer'></div>");this.adContainer.css({position:"absolute","z-index":1});this.createBook(a)}
normalBook.prototype.createBook=function(a){this.flipBook=$("<div class='flipBook' id='flipBook' ></div>");"android"==device.name?(this.previousPage=new androidPage,this.currentPage=new androidPage,this.nextPage=new androidPage,this.currentPage2=new androidPage):(this.previousPage=new normalPage,this.currentPage=new normalPage,this.currentPage2=new normalPage,this.nextPage=new normalPage);this.previousPage.create(this.flipBook);this.currentPage.create(this.flipBook);this.currentPage2.create(this.flipBook);
this.nextPage.create(this.flipBook);this.leftThickness=thickness(!0);this.rightThickness=thickness(!1);this.normalBookShadow=new bookShadow(this.pageWidth,this.pageHeight,this.flipBook);this.bmt=new initBookMarkTab(this.flipBook);a.append(this.flipBook);this.flipBook.append(this.leftThickness);this.flipBook.append(this.rightThickness);this.currentPageIndex=oriPageIndex;this.fillNearPage(this.currentPageIndex);setCurrentIndexTextField(this.currentPageIndex,!0);1>=this.currentPageIndex&&this.bmt.leftBox.hide();
this.currentPageIndex>=totalPageCount&&this.bmt.rightBox.hide();3>=this.currentPageIndex&&this.leftThickness.setVisible(!1);this.currentPageIndex>=totalPageCount-2&&this.rightThickness.setVisible(!1);this.resetPageZIndex();this.initEvent();isTouchDevice()||this.initZoomHintTimer(a)};
normalBook.prototype.initZoomHintTimer=function(a){var b=this;this.mouseInBook=new Point(-1,-1);this.oldMouseInBook=new Point(-1,-1);this.zoomHint=null;this.trackMousePoint=function(a){var a=isTouch?a.originalEvent.touches:[a],d=a[0].pageY;b.mouseInBook.x=a[0].pageX;b.mouseInBook.y=d};bookContainer.bind(_event._move,this.trackMousePoint);this.zoomHintTimer=window.setInterval(function(){if(bookType!=BookType.normal_book)b.clearZoomHintTimer();else if(null==b.zoomHint)if(-1==b.oldMouseInBook.x)b.oldMouseInBook.x=
b.mouseInBook.x,b.oldMouseInBook.y=b.mouseInBook.y;else if(b.oldMouseInBook.x==b.mouseInBook.x&&b.oldMouseInBook.y==b.mouseInBook.y){var c=globalToBook(!0,b.mouseInBook.x,b.mouseInBook.y);0>c.x||c.x>b.width||0>c.y||c.y>b.height||(b.zoomHint=new divHint("Double click to zoom in.",b.mouseInBook.x+15,b.mouseInBook.y,a),b.zoomHint.show(),b.hideCount=0)}else b.oldMouseInBook.x=b.mouseInBook.x,b.oldMouseInBook.y=b.mouseInBook.y;else 2==++b.hideCount&&(bookContainer.unbind(_event._move,b.trackMousePoint),
b.zoomHint.destroy(),b.zoomHint=null,window.clearInterval(b.zoomHintTimer))},1500)};normalBook.prototype.clearZoomHintTimer=function(){try{window.clearInterval(this.zoomHintTimer)}catch(a){}null!=this.zoomHint&&(bookContainer.unbind(_event._move,this.trackMousePoint),this.zoomHint.destroy(),this.zoomHint=null)};
normalBook.prototype.insertStaticAd=function(){var a=this.flipBook.css("left"),b=this.flipBook.css("top");this.adContainer.css({left:a,top:b});this.adInstance=new HTML5AdSlider(this.adContainer,{paddingLeft:30,paddingTop:30,paddingRight:30,paddingBottom:30,loop:!1,timeout:2E3,effectDuration:1E3,data:staticAd.data});bookContainer.append(this.adContainer)};
normalBook.prototype.onResize=function(a,b){this.width=2*a;this.height=b;this.pageWidth=a;this.pageHeight=b;this.maskWidth=Math.sqrt(a*a+b*b);this.flipBook.css({width:this.width+"px",height:this.height+"px"});this.previousPage.onResize(a,b,this.maskWidth,0);this.currentPage.onResize(a,b,this.maskWidth,0);this.currentPage2.onResize(a,b,this.maskWidth,a);this.nextPage.onResize(a,b,this.maskWidth,a);this.leftThickness.onResize(25,b);this.rightThickness.onResize(25,b);normalEventRadius=Math.pow(Math.ceil(1*
a/3),2);this.normalBookShadow.onResize(this.pageWidth,this.pageHeight,1!=this.currentPageIndex&&this.currentPageIndex!=totalPageCount);this.normalBookShadow.setPosition(1==this.currentPageIndex?a:0,0);this.bmt.resize(b,60);var c=this.flipBook.css("left"),d=this.flipBook.css("top");this.adContainer.css({left:c,top:d,width:a+"px",height:b+"px"});this.adInstance&&this.adInstance.resize()};normalBook.prototype.getCurrentPageIndex=function(){return this.currentPageIndex};
normalBook.prototype.getPageWidth=function(a){if(void 0==a)return this.pageWidth;this.pageWidth=a};normalBook.prototype.getPageHeight=function(a){if(void 0==a)return this.pageHeight;this.pageHeight=a};normalBook.prototype.getWidth=function(){return this.width};normalBook.prototype.getHeight=function(){return this.height};normalBook.prototype.getScale=function(){return 1};normalBook.prototype.getLeft=function(){return this.flipBook.offset().left};normalBook.prototype.getTop=function(){return this.flipBook.offset().top};
normalBook.prototype.setCSS=function(a){this.flipBook.css(a)};normalBook.prototype.setPosition=function(a,b,c){void 0==c&&(c=["left","top"]);this.flipBook.css(c[0],a+"px");this.flipBook.css(c[1],b+"px")};
normalBook.prototype.timer=function(a,b,c,d,e,f,g,h){void 0==g&&(g=!1);void 0==h&&(h=!1);var j=0<=a.indexOf("l"),k=0<=a.indexOf("t");g||(this.currentPage.setCSS({"z-index":j?7:6}),this.currentPage2.setCSS({"z-index":j?6:7}));flipping=!0;stopFlip=!1;var m=0;Point(0,0);var l=this;try{window.clearInterval(this.intervalID)}catch(n){}this.intervalID=setInterval(function(){m++;l.flipPoint.x=$.easing.easeOutQuart(null,m,e.x,d.x-e.x,b);l.flipPoint.y=$.easing.easeOutQuart(null,m,e.y,d.y-e.y,b);if(f)l.flipPoint.y=
0.2*Math.sqrt(Math.pow(l.pageWidth,2)-Math.pow(j?l.flipPoint.x-l.pageWidth:l.flipPoint.x,2));if(m==b)l.flipPoint=d;if(stopFlip){window.clearInterval(l.intervalID);l.betweenPaperCount=j?-1:1;l.gotoPageIndex=j?Math.floor(l.currentPageIndex/2-1)*2+1:Math.floor(l.currentPageIndex/2+1)*2;var c=Point(j?2*l.pageWidth:-l.pageWidth,k?0:l.pageHeight);l.timer(a,l.totalFrame,20,c,l.flipPoint,false,true,true);l.movetoCenter(l.totalFrame,20,l.gotoPageIndex);auto_player.resetTimer()}else{l.flippingPage.flipToPoint(l.flipPoint.x,
l.flipPoint.y,m==1);if(m>=b){_rimFlip.isRimFlip||auto_player.resetTimer();window.clearInterval(l.intervalID);flipping=false;if(h||f){l.flippingPage.endFlip();l.afterGotoPage()}else if(g||!_rimFlip.isRimFlip)if(g){if(!f&&!h){nBookStatu=normalBookStatu.book_statu_ready;l.flippingPage.setSideUp(l.flippingPage.isLeft()?false:true);l.currentPageIndex>3&&!l.leftThickness.visible&&l.leftThickness.setVisible(true);l.currentPageIndex<totalPageCount-2&&!l.rightThickness.visible&&l.rightThickness.setVisible(true);
l.currentPageIndex>1&&l.bmt.leftBox.show();l.currentPageIndex<totalPageCount&&l.bmt.rightBox.show();if(l.currentPageIndex==1){l.normalBookShadow.onResize(l.pageWidth,l.pageHeight,false);l.normalBookShadow.setPosition(l.pageWidth,0)}else{if(l.currentPageIndex==totalPageCount)l.normalBookShadow.onResize(l.pageWidth,l.pageHeight,false);else l.normalBookShadow.onResize(l.pageWidth,l.pageHeight,true);l.normalBookShadow.setPosition(0,0)}l.normalBookShadow.showShadow();l.flippingPage.endFlip();l.resetPageZIndex()}}else bookMouseDown=
true}}},c)};
normalBook.prototype.movetoCenter=function(a,b,c){if(!1!=parseBool(bookConfig.retainBookCenter)){var d=(windowWidth-bookConfig.leftMargin-bookConfig.rightMargin-this.width)/2+bookConfig.leftMargin,e=d-this.width/4,f=d+this.width/4,g=this.getLeft(),h=d;1==c&&(h=e);d=bookConfig.totalPageCount;1==d%2&&d++;c==d&&(h=f);if(!(10>Math.abs(h-g))){var j=0,k=this,m=k.getTop();if(0==a)k.setPosition(iLeft,m);else var l=window.setInterval(function(){var b=$.easing.easeOutQuart(null,j,g,h-g,a);k.setPosition(b,m);
j++==a&&window.clearInterval(l)},b)}}};
normalBook.prototype.gotoPage=function(a){if(1>a||a>totalPageCount)_tipsBox.setCaption(1>a?"This is the first page":"This is the last page"),_tipsBox.showTipsBox();else if(0==nBookStatu&&this.setGotoPage(a)){a==totalPageCount&&this.nextPage.setPageVisible(!1);1==a&&this.previousPage.setPageVisible(!1);_rimFlip.removeRimFlip();nBookStatu=normalBookStatu.book_statu_auto_flip;this.gotoPageIndex=a;if(0<this.betweenPaperCount)var b=Point(this.pageWidth,0),c=Point(-this.pageWidth,0),d="tr";else b=Point(0,
0),c=Point(2*this.pageWidth,0),d="tl";this.flippingPage.setCSS({"z-index":7});this.flippingPage.beginFlip(d);playFlipSound();this.timer(d,this.totalFrame,20,c,b,!0);this.movetoCenter(this.totalFrame,20,a)}};normalBook.prototype.stopTimer=function(){window.clearInterval(this.intervalID)};
normalBook.prototype.afterGotoPage=function(){this.currentPageIndex=this.gotoPageIndex;this.currentPage.getSideB().leaveSide();this.currentPage2.getSideA().leaveSide();this.changePage();var a=getShownPage();this.currentPage.getSideA().showOrHideYoutube(a);this.currentPage.getSideB().showOrHideYoutube(a);this.currentPage2.getSideA().showOrHideYoutube(a);this.currentPage2.getSideB().showOrHideYoutube(a);if(1==this.currentPageIndex)this.normalBookShadow.onResize(this.pageWidth,this.pageHeight,!1),this.normalBookShadow.setPosition(this.pageWidth,
0);else{if(this.currentPageIndex==totalPageCount)this.normalBookShadow.onResize(this.pageWidth,this.pageHeight,!1);else this.normalBookShadow.onResize(this.pageWidth,this.pageHeight,!0);this.normalBookShadow.setPosition(0,0)}setCurrentIndexTextField(this.currentPageIndex,!0);var b=this;window.setTimeout(function(){nBookStatu=normalBookStatu.book_statu_ready;resizeBookAfterFlip&&onStageResize();3<b.currentPageIndex&&!b.leftThickness.visible&&b.leftThickness.setVisible(!0);b.currentPageIndex<totalPageCount-
2&&!b.rightThickness.visible&&b.rightThickness.setVisible(!0);1<b.currentPageIndex&&b.bmt.leftBox.show();b.currentPageIndex<totalPageCount&&b.bmt.rightBox.show();b.fillNearPage(b.currentPageIndex);b.resetPageZIndex();thumbnail.clearHighLight();thumbnail.setHighLight(b.currentPageIndex);b.currentPage.getSideB().enterSide();b.currentPage2.getSideA().enterSide();window.location.hash="#p="+b.currentPageIndex;var a=b.currentPageIndex,d=a;1<a&&a<totalPageCount&&(d=0==a%2?a+"-"+(a+1):a-1+"-"+a);sendvisitinfo(1,
d);b.bmt.separated(b.currentPageIndex)},30)};normalBook.prototype.openShownSlider=function(){var a=getShownPage();this.previousPage.getSideA().openSliderOrNot(a);this.previousPage.getSideB().openSliderOrNot(a);this.currentPage.getSideA().openSliderOrNot(a);this.currentPage.getSideB().openSliderOrNot(a);this.currentPage2.getSideA().openSliderOrNot(a);this.currentPage2.getSideB().openSliderOrNot(a);this.nextPage.getSideA().openSliderOrNot(a);this.nextPage.getSideB().openSliderOrNot(a)};
normalBook.prototype.stopAllSlider=function(){this.previousPage.getSideA().resetSlider();this.previousPage.getSideB().resetSlider();this.currentPage.getSideA().resetSlider();this.currentPage.getSideB().resetSlider();this.currentPage2.getSideA().resetSlider();this.currentPage2.getSideB().resetSlider();this.nextPage.getSideA().resetSlider();this.nextPage.getSideB().resetSlider()};normalBook.prototype.hide=function(){debug("normal book hide.");this.setCSS({display:"none"});this.stopAllSlider()};
normalBook.prototype.show=function(){debug("normal book show.");this.setCSS({display:"block"});this.openShownSlider();this.addHistoryTexts();this.bmt.refresh()};
normalBook.prototype.addHistoryTexts=function(){var a=[1];try{a=getShownPage()}catch(b){a=[1]}this.previousPage.getSideA().addHistoryTexts(a);this.previousPage.getSideB().addHistoryTexts(a);this.currentPage.getSideA().addHistoryTexts(a);this.currentPage.getSideB().addHistoryTexts(a);this.currentPage2.getSideA().addHistoryTexts(a);this.currentPage2.getSideB().addHistoryTexts(a);this.nextPage.getSideA().addHistoryTexts(a);this.nextPage.getSideB().addHistoryTexts(a)};
normalBook.prototype.changePage=function(){var a;1==this.betweenPaperCount?(a=this.nextPage,this.nextPage=this.previousPage,this.previousPage=this.currentPage,this.currentPage=this.currentPage2,this.currentPage2=a):-1==this.betweenPaperCount?(a=this.previousPage,this.previousPage=this.nextPage,this.nextPage=this.currentPage2,this.currentPage2=this.currentPage,this.currentPage=a):2==this.betweenPaperCount||-2==this.betweenPaperCount?(a=this.previousPage,this.previousPage=this.currentPage2,this.currentPage2=
a,a=this.currentPage,this.currentPage=this.nextPage,this.nextPage=a):-2>this.betweenPaperCount?(a=this.nextPage,this.nextPage=this.currentPage2,this.currentPage2=this.currentPage,this.currentPage=a):2<this.betweenPaperCount&&(a=this.currentPage,this.currentPage=this.currentPage2,this.currentPage2=this.previousPage,this.previousPage=a);this.addSearchHighlight();this.previousPage.getSideA().resetSlider();this.previousPage.getSideB().resetSlider();this.currentPage.getSideB().playSlider();this.currentPage2.getSideA().playSlider();
this.nextPage.getSideA().resetSlider();this.nextPage.getSideB().resetSlider()};
normalBook.prototype.addSearchHighlight=function(){var a=this.currentPage,b=this.currentPage2,c=this.currentPageIndex;a.getSideA().imageIndex==c&&a.getSideA().highlightSearch();a.getSideB().imageIndex==c&&a.getSideB().highlightSearch();b.getSideA().imageIndex==c&&b.getSideA().highlightSearch();b.getSideB().imageIndex==c&&b.getSideB().highlightSearch();c=0==c%2?c+1:c-1;0<c&&c<=totalPageCount&&(a.getSideA().imageIndex==c&&a.getSideA().highlightSearch(),a.getSideB().imageIndex==c&&a.getSideB().highlightSearch(),
b.getSideA().imageIndex==c&&b.getSideA().highlightSearch(),b.getSideB().imageIndex==c&&b.getSideB().highlightSearch())};normalBook.prototype.clearSearchHighlight=function(){this.currentPage.getSideA().clearHighlight();this.currentPage.getSideB().clearHighlight();this.currentPage2.getSideA().clearHighlight();this.currentPage2.getSideB().clearHighlight()};normalBook.prototype.setLeftThicknessVisible=function(a){this.leftThickness.setVisible(a)};normalBook.prototype.setRightThicknessVisible=function(a){this.rightThickness.setVisible(a)};
normalBook.prototype.setThicknessPosition=function(){this.leftThickness.setThicknessPosition(-25,0);this.rightThickness.setThicknessPosition(2*this.pageWidth-1,0)};normalBook.prototype.resetPageZIndex=function(){this.currentPage.setCSS({"z-index":4});this.currentPage2.setCSS({"z-index":5});this.nextPage.setCSS({"z-index":3});this.previousPage.setCSS({"z-index":2})};normalBook.prototype.fillAnPage=function(a,b){a.fillSideA(2*b-1);a.fillSideB(2*b)};
normalBook.prototype.fillNearPage=function(a){var b=Math.floor(a/2);3<a?(this.previousPage.setPageVisible(!0),this.previousPage.resetPage(!0),this.previousPage.setSideUp(!1),this.fillAnPage(this.previousPage,b-1)):this.previousPage.setPageVisible(!1);1<a?(this.currentPage.setPageVisible(!0),this.currentPage.resetPage(!0),this.currentPage.setSideUp(!1),this.fillAnPage(this.currentPage,b)):this.currentPage.setPageVisible(!1);2*Math.floor(a/2)+1<totalPageCount?(this.currentPage2.setPageVisible(!0),this.currentPage2.resetPage(!1),
this.currentPage2.setSideUp(!0),this.fillAnPage(this.currentPage2,b+1)):this.currentPage2.setPageVisible(!1);2*Math.floor(a/2)+3<totalPageCount?(this.nextPage.setPageVisible(!0),this.nextPage.resetPage(!1),this.nextPage.setSideUp(!0),this.fillAnPage(this.nextPage,b+2)):this.nextPage.setPageVisible(!1);this.addHistoryTexts()};
normalBook.prototype.setGotoPage=function(a){var b,c;this.currentPageIndex>a?(b=Math.floor(a/2),c=Math.floor(this.currentPageIndex/2),this.flippingPage=this.currentPage,1<c-b?(this.flipToPage=this.nextPage,this.flipToPage.resetPage(!0),this.flipToPage.setSideUp(!1),this.flipToPage.setCSS({"z-index":6}),this.flippingPage.fillSideA(2*b+1),this.flipToPage.fillSideA(2*b-1),this.flipToPage.fillSideB(2*b)):this.flipToPage=this.previousPage,1!=a?this.flipToPage.setPageVisible(!0):this.flipToPage.setPageVisible(!1)):
(b=Math.floor(a/2)+1,c=Math.floor(this.currentPageIndex/2)+1,this.flippingPage=this.currentPage2,1<b-c?(this.flipToPage=this.previousPage,this.flipToPage.resetPage(!1),this.flipToPage.setSideUp(!0),this.flipToPage.setCSS({"z-index":6}),this.flippingPage.fillSideB(2*b-2),this.flipToPage.fillSideA(2*b-1),this.flipToPage.fillSideB(2*b)):this.flipToPage=this.nextPage,a!=totalPageCount?this.flipToPage.setPageVisible(!0):this.flipToPage.setPageVisible(!1));this.betweenPaperCount=b-c;return b!=c};
normalBook.prototype.pointInPage=function(a,b,c){return 0<=a.x&&a.x<=b&&0<=a.y&&a.y<=c?"left":a.x<=2*b&&a.x>=b&&0<=a.y&&a.y<=c?"right":!1};
normalBook.prototype.initEvent=function(){var a=this,b=-1,c=void 0,d,e;this.twoFingerDown=!1;var f=normalBookStatu.book_statu_ready,g=normalBookStatu.book_statu_mag_flip;this.flipBook.bind(_event._down,function(b){b=isTouch?b.originalEvent.touches:[b];if(bookType==BookType.normal_book)if(2==b.length){if(nBookStatu==normalBookStatu.book_statu_mouse_flip){var c;"tl"==a.flippingPage.corner?c=Point(0,0):"tr"==a.flippingPage.corner?c=Point(a.pageWidth,0):"bl"==a.flippingPage.corner?c=Point(0,a.pageHeight):
"br"==a.flippingPage.corner&&(c=Point(a.pageWidth,a.pageHeight));window.clearInterval(a.intervalID);playFlipSound();a.timer(a.flippingPage.corner,a.totalFrame,20,c,a.flipPoint,!1,!0);a.movetoCenter(a.totalFrame,20,a.gotoPageIndex)}d=globalToBook(!0,b[0].pageX,b[0].pageY);e=globalToBook(!0,b[1].pageX,b[1].pageY);b=a.pointInPage(d,a.pageWidth,a.pageHeight);c=a.pointInPage(e,a.pageWidth,a.pageHeight);b==c&&b&&(a.twoFingerDown=b);bookMouseDown=!1}else{if(nBookStatu==f){c=globalToBook(!0,b[0].pageX,b[0].pageY);
if(0>c.x||c.x>a.width||0>c.y||c.y>a.height)return;var k=a.getCornerAndBeginPoint(c);if(null==k.corner)return;var m=k.corner,k=k.beginPoint;_rimFlip.removeRimFlip();nBookStatu=normalBookStatu.book_statu_mouse_flip;window.clearInterval(a.intervalID);a.flippingPage.beginFlip(m);a.timer(m,Math.floor(a.totalFrame/6),5,c,k,!1,!1)}if(nBookStatu==g){c=globalToBook(!0,b[0].pageX,b[0].pageY);if(0>c.x||c.x>a.width||0>c.y||c.y>a.height)return;nBookStatu=normalBookStatu.book_statu_mouse_flip;bookMouseDown=!0}b[0].preventDefault();
return!1}});bookContainer.bind(_event._move,function(h){if(bookType==BookType.normal_book){h=isTouch?h.originalEvent.touches:[h];if(2==h.length&&a.twoFingerDown){var j=globalToBook(!0,h[0].pageX,h[0].pageY),h=globalToBook(!0,h[1].pageX,h[1].pageY),k=Math.sqrt(Math.pow(d.x-e.x,2)+Math.pow(d.y-e.y,2));if(15<Math.sqrt(Math.pow(j.x-h.x,2)+Math.pow(j.y-h.y,2))-k){var m;"left"==a.twoFingerDown?m=2*Math.floor(a.currentPageIndex/2):"right"==a.twoFingerDown&&(m=2*Math.floor(a.currentPageIndex/2)+1);a.zoomToPage(m)}return!1}bookType==
BookType.normal_book&&!1==flipping&&(!1==bookMouseDown?(j=globalToBook(!0,h[0].pageX,h[0].pageY),0>j.x||j.x>a.width||0>j.y||j.y>a.height?bookContainer.css({cursor:"default"}):!1==a.isInBeginFlipRange(j)?bookContainer.css({cursor:"default"}):bookContainer.css({cursor:"pointer"})):bookContainer.css({cursor:"pointer"}));if(!1==bookMouseDown&&nBookStatu==f&&!1==flipping){j=globalToBook(!0,h[0].pageX,h[0].pageY);if(0>j.x||j.x>a.width||0>j.y||j.y>a.height)return;m=a.getCornerAndBeginPoint(j,4);if(null==
m.corner)return;h=m.corner;m=m.beginPoint;nBookStatu=g;_rimFlip.removeRimFlip();a.flippingPage.beginFlip(h);a.maganetPoint=j;window.clearInterval(a.intervalID);a.timer(h,Math.floor(a.totalFrame/6),10,j,m,!1,!1);return!1}if(nBookStatu==g){if(void 0==a.flippingPage||null==a.flippingPage)return;j=globalToBook(!0,h[0].pageX,h[0].pageY);h=!1;if(0>j.x||j.x>a.width||0>j.y||j.y>a.height)h=!0;m={corner:null,beginPoint:null};!1==h&&(m=a.getCornerAndBeginPoint(j,4));null==m.corner&&(j=Point(a.flippingPage.isLeft()?
0:a.pageWidth,a.flippingPage.isTop()?0:a.pageHeight),window.clearInterval(a.intervalID),a.timer(a.flippingPage.corner,Math.floor(a.totalFrame/6),20,j,a.maganetPoint,!1,!0,!1),nBookStatu=f,bookMouseDown=!1);return!1}bookMouseDown&&(j=globalToBook(a.flippingPage.isLeft(),h[0].pageX,h[0].pageY),a.flippingPage.flipToPoint(j.x,j.y,!1),-1!=b&&(c=j.x>b?!1:!0),b=j.x);return!1}});bookContainer.bind(_event._end,function(b){if(bookType==BookType.normal_book)if(b=isTouch?b.originalEvent.changedTouches:[b],bookMouseDown){a.twoFingerDown=
!1;var b=globalToBook(a.flippingPage.isLeft(),b[0].pageX,b[0].pageY),d,e,f=!0;if(a.flippingPage.isLeft()&&b.x>=a.pageWidth||!a.flippingPage.isLeft()&&0>=b.x)f=!1;void 0!=c&&(f=!(a.flippingPage.isLeft()^c));f||(a.gotoPageIndex=a.flippingPage.isLeft()?2*Math.floor(a.currentPageIndex/2-1)+1:2*Math.floor(a.currentPageIndex/2+1),a.betweenPaperCount=a.flippingPage.isLeft()?-1:1);d=Point(a.flippingPage.isLeft()?0:a.pageWidth,a.flippingPage.isTop()?0:a.pageHeight);e=Point(a.flippingPage.isLeft()?2*a.pageWidth:
-a.pageWidth,a.flippingPage.isTop()?0:a.pageHeight);d=f?d:e;window.clearInterval(a.intervalID);f?a.timer(a.flippingPage.corner,Math.floor(a.totalFrame/3),20,d,b,!1,!0,!f):(playFlipSound(),e=Math.floor(2*a.totalFrame/3),a.timer(a.flippingPage.corner,e,20,d,b,!1,!0,!f),a.movetoCenter(e,20,a.gotoPageIndex));bookMouseDown=!1}else flipping&&2==nBookStatu&&(stopFlip=!0)})};
normalBook.prototype.isInBeginFlipRange=function(a){var b=normalEventRadius,c=null;Math.pow(a.x,2)+Math.pow(a.y,2)<b?1<this.currentPageIndex&&(c=""):Math.pow(2*this.pageWidth-a.x,2)+Math.pow(a.y,2)<b?this.currentPageIndex<totalPageCount&&(c=""):Math.pow(a.x,2)+Math.pow(this.pageHeight-a.y,2)<b?1<this.currentPageIndex&&(c=""):Math.pow(this.width-a.x,2)+Math.pow(this.height-a.y,2)<b&&this.currentPageIndex<totalPageCount&&(c="");return null!=c};
normalBook.prototype.getCornerAndBeginPoint=function(a,b){void 0==b&&(b=1);var c=normalEventRadius/b,d="",e=null,f={corner:null,beginPoint:null};Math.pow(a.x,2)+Math.pow(a.y,2)<c?(d="tl",e=Point(0,0),this.flippingPage=this.currentPage,this.gotoPageIndex=2*Math.floor(this.currentPageIndex/2)-1,1<this.currentPageIndex&&5<a.x&&5<a.y&&(f.corner=d,f.beginPoint=e)):Math.pow(2*this.pageWidth-a.x,2)+Math.pow(a.y,2)<c?(d="tr",a.x-=this.pageWidth,e=Point(this.pageWidth,0),this.flippingPage=this.currentPage2,
this.gotoPageIndex=2*Math.floor(this.currentPageIndex/2+1),this.currentPageIndex<totalPageCount&&5<this.width-a.x&&5<a.y&&(f.corner=d,f.beginPoint=e)):Math.pow(a.x,2)+Math.pow(this.pageHeight-a.y,2)<c?(d="bl",e=Point(0,this.pageHeight),this.flippingPage=this.currentPage,this.gotoPageIndex=2*Math.floor(this.currentPageIndex/2)-1,1<this.currentPageIndex&&5<a.x&&5<this.height-a.y&&(f.corner=d,f.beginPoint=e)):Math.pow(this.width-a.x,2)+Math.pow(this.height-a.y,2)<c&&(d="br",a.x-=this.pageWidth,e=Point(this.pageWidth,
this.pageHeight),this.flippingPage=this.currentPage2,this.gotoPageIndex=2*Math.floor(this.currentPageIndex/2+1),this.currentPageIndex<totalPageCount&&5<this.width-a.x&&5<this.height-a.y&&(f.corner=d,f.beginPoint=e));return f};
normalBook.prototype.zoomToPage=function(a){0==nBookStatu&&(this.currentPage.getSideA().leaveSide(),this.currentPage.getSideB().leaveSide(),this.currentPage2.getSideA().leaveSide(),this.currentPage2.getSideB().leaveSide(),zoomBook.changePageMode(!0),zoomBook.currentIndex=a,zoomBook.showPage.fillContent(zoomBook.currentIndex),bookType=2,changeShowBook(2),toolBar.changeZoomIcon(!1),setCurrentIndexTextField(zoomBook.currentIndex,zoomBook.doublePage),thumbnail.clearHighLight(),thumbnail.setHighLight(zoomBook.currentIndex),
this.clearZoomHintTimer())};function rightToLeftNormalBook(a){normalBook.call(this,a)}$.extend(rightToLeftNormalBook.prototype,normalBook.prototype);
rightToLeftNormalBook.prototype.createBook=function(a){this.flipBook=$("<div class='flipBook' id='flipBook'></div>");"android"==device.name?(this.previousPage=new androidRightPage,this.currentPage=new androidRightPage,this.currentPage2=new androidRightPage,this.nextPage=new androidRightPage):(this.previousPage=new rightToLeftNormalPage,this.currentPage=new rightToLeftNormalPage,this.currentPage2=new rightToLeftNormalPage,this.nextPage=new rightToLeftNormalPage);this.previousPage.create(this.flipBook);
this.currentPage.create(this.flipBook);this.currentPage2.create(this.flipBook);this.nextPage.create(this.flipBook);this.leftThickness=thickness(!1);this.rightThickness=thickness(!0);this.normalBookShadow=new bookShadow(this.pageWidth,this.pageHeight,this.flipBook);a.append(this.flipBook);this.flipBook.append(this.leftThickness);this.flipBook.append(this.rightThickness);this.currentPageIndex=oriPageIndex;this.fillNearPage(this.currentPageIndex);setCurrentIndexTextField(this.currentPageIndex,!0);3>=
this.currentPageIndex&&this.leftThickness.setVisible(!1);this.currentPageIndex>=totalPageCount-2&&this.rightThickness.setVisible(!1);this.resetPageZIndex();this.initEvent();this.bmt=new initBookMarkTab(this.flipBook,!0);1>=this.currentPageIndex&&this.bmt.rightBox.hide();this.currentPageIndex>=totalPageCount&&this.bmt.leftBox.hide()};
rightToLeftNormalBook.prototype.insertStaticAd=function(){var a=this.flipBook.css("left"),a=parseInt(a.replace("px","")),b=this.flipBook.css("top"),c=this.flipBook.css("width"),c=parseInt(c.replace("px",""));this.adContainer.css({left:a+c/2+"px",top:b});this.adInstance=new HTML5AdSlider(this.adContainer,{paddingLeft:30,paddingTop:30,paddingRight:30,paddingBottom:30,loop:!1,timeout:2E3,effectDuration:1E3,data:staticAd.data});bookContainer.append(this.adContainer)};
rightToLeftNormalBook.prototype.onResize=function(a,b){this.width=2*a;this.height=b;this.pageWidth=a;this.pageHeight=b;this.maskWidth=Math.sqrt(a*a+b*b);this.flipBook.css({width:this.width+"px",height:this.height+"px"});this.previousPage.onResize(a,b,this.maskWidth,0);this.currentPage.onResize(a,b,this.maskWidth,0);this.currentPage2.onResize(a,b,this.maskWidth,0);this.nextPage.onResize(a,b,this.maskWidth,0);this.leftThickness.onResize(25,b);this.rightThickness.onResize(25,b);normalEventRadius=Math.pow(Math.ceil(1*
a/3),2);this.normalBookShadow.onResize(this.pageWidth,this.pageHeight,1!=this.currentPageIndex&&this.currentPageIndex!=totalPageCount);this.normalBookShadow.setPosition(this.currentPageIndex==totalPageCount?a:0,0);this.bmt.resize(b,60);var c=this.flipBook.css("left"),c=parseInt(c.replace("px",""))+a,d=this.flipBook.css("top");this.adContainer.css({left:c+"px",top:d,width:a+"px",height:b+"px"});this.adInstance&&this.adInstance.resize()};
rightToLeftNormalBook.prototype.setThicknessPosition=function(){this.leftThickness.setThicknessPosition(2*this.pageWidth-1,0);this.rightThickness.setThicknessPosition(-25,0)};
rightToLeftNormalBook.prototype.movetoCenter=function(a,b,c){if(!1!=parseBool(bookConfig.retainBookCenter)){var d=(windowWidth-bookConfig.leftMargin-bookConfig.rightMargin-this.width)/2+bookConfig.leftMargin,e=d+this.width/4,f=d-this.width/4,g=this.getLeft(),h=d;1==c&&(h=e);d=bookConfig.totalPageCount;1==d%2&&d++;c==d&&(h=f);if(!(10>Math.abs(h-g))){var j=0,k=this,m=k.getTop();if(0==a)k.setPosition(iLeft,m);else var l=window.setInterval(function(){var b=$.easing.swing(null,j,g,h-g,a);k.setPosition(b,
m);j++==a&&window.clearInterval(l)},b)}}};
rightToLeftNormalBook.prototype.gotoPage=function(a){if(1>a||a>totalPageCount)_tipsBox.setCaption(1>a?"This is the first page":"This is the last page"),_tipsBox.showTipsBox();else if(0==nBookStatu&&this.setGotoPage(a)){a==totalPageCount&&this.nextPage.setPageVisible(!1);1==a&&this.previousPage.setPageVisible(!1);_rimFlip.removeRimFlip();nBookStatu=normalBookStatu.book_statu_auto_flip;this.gotoPageIndex=a;if(0<this.betweenPaperCount)var b=Point(0,0),c=Point(2*this.pageWidth,0),d="tl";else b=Point(this.pageWidth,
0),c=Point(-this.pageWidth,0),d="tr";this.flippingPage.setCSS({"z-index":7});this.flippingPage.beginFlip(d);playFlipSound();this.timer(d,this.totalFrame,20,c,b,!0);this.movetoCenter(this.totalFrame,20,a)}};
rightToLeftNormalBook.prototype.timer=function(a,b,c,d,e,f,g,h){void 0==g&&(g=!1);void 0==h&&(h=!1);var j=0<=a.indexOf("l"),k=0<=a.indexOf("t");g||(this.currentPage.setCSS({"z-index":j?6:7}),this.currentPage2.setCSS({"z-index":j?7:6}));flipping=!0;stopFlip=!1;var m=0;Point(0,0);var l=this;this.intervalID=setInterval(function(){m++;l.flipPoint.x=e.x;l.flipPoint.y=e.y;l.flipPoint.x=$.easing.easeOutQuart(null,m,e.x,d.x-e.x,b);l.flipPoint.y=$.easing.easeOutQuart(null,m,e.y,d.y-e.y,b);if(f)l.flipPoint.y=
0.2*Math.sqrt(Math.pow(l.pageWidth,2)-Math.pow(j?l.flipPoint.x-l.pageWidth:l.flipPoint.x,2));if(m==b)l.flipPoint=d;if(stopFlip){window.clearInterval(l.intervalID);l.betweenPaperCount=j?1:-1;l.gotoPageIndex=j?Math.floor(l.currentPageIndex/2+1)*2:Math.floor(l.currentPageIndex/2-1)*2+1;var c=Point(j?2*l.pageWidth:-l.pageWidth,k?0:l.pageHeight);l.timer(a,l.totalFrame,20,c,l.flipPoint,false,true,true);l.movetoCenter(l.totalFrame,20,l.gotoPageIndex);auto_player.resetTimer()}else{l.flippingPage.flipToPoint(l.flipPoint.x,
l.flipPoint.y,m==1);if(m>=b){_rimFlip.isRimFlip||auto_player.resetTimer();window.clearInterval(l.intervalID);flipping=false;if(h||f){l.flippingPage.endFlip();l.afterGotoPage()}else if(g||!_rimFlip.isRimFlip)if(g){if(!f&&!h){nBookStatu=normalBookStatu.book_statu_ready;l.flippingPage.setSideUp(l.flippingPage.isLeft()?true:false);l.currentPageIndex>3&&!l.leftThickness.visible&&l.leftThickness.setVisible(true);l.currentPageIndex<totalPageCount-2&&!l.rightThickness.visible&&l.rightThickness.setVisible(true);
l.currentPageIndex>1&&l.bmt.rightBox.show();l.currentPageIndex<totalPageCount&&l.bmt.leftBox.show();if(l.currentPageIndex==1){l.normalBookShadow.onResize(l.pageWidth,l.pageHeight,false);l.normalBookShadow.setPosition(0,0)}else if(l.currentPageIndex==totalPageCount){l.normalBookShadow.onResize(l.pageWidth,l.pageHeight,false);l.normalBookShadow.setPosition(l.pageWidth,0)}else{l.normalBookShadow.onResize(l.pageWidth,l.pageHeight,true);l.normalBookShadow.setPosition(0,0)}l.normalBookShadow.showShadow()}}else bookMouseDown=
true}}},c)};
rightToLeftNormalBook.prototype.afterGotoPage=function(){this.currentPageIndex=this.gotoPageIndex;this.currentPage.getSideB().leaveSide();this.currentPage2.getSideA().leaveSide();this.changePage();1==this.currentPageIndex?(this.normalBookShadow.onResize(this.pageWidth,this.pageHeight,!1),this.normalBookShadow.setPosition(0,0)):this.currentPageIndex==totalPageCount?(this.normalBookShadow.onResize(this.pageWidth,this.pageHeight,!1),this.normalBookShadow.setPosition(this.pageWidth,0)):(this.normalBookShadow.onResize(this.pageWidth,this.pageHeight,
!0),this.normalBookShadow.setPosition(0,0));setCurrentIndexTextField(this.currentPageIndex,!0);var a=this;window.setTimeout(function(){nBookStatu=normalBookStatu.book_statu_ready;resizeBookAfterFlip&&onStageResize();a.currentPageIndex>3&&!a.leftThickness.visible&&a.leftThickness.setVisible(true);a.currentPageIndex<totalPageCount-2&&!a.rightThickness.visible&&a.rightThickness.setVisible(true);a.currentPageIndex>1&&a.bmt.rightBox.show();a.currentPageIndex<totalPageCount&&a.bmt.leftBox.show();a.fillNearPage(a.currentPageIndex);
a.resetPageZIndex();thumbnail.clearHighLight();thumbnail.setHighLight(a.currentPageIndex);a.currentPage.getSideB().enterSide();a.currentPage2.getSideA().enterSide();window.location.hash="#p="+a.currentPageIndex;var b=a.currentPageIndex,c=b;b>1&&b<totalPageCount&&(c=b%2==0?b+"-"+(b+1):b-1+"-"+b);sendvisitinfo(1,c);a.bmt.separated(a.currentPageIndex)},30)};
rightToLeftNormalBook.prototype.initEvent=function(){var a=this,b=-1,c=void 0,d,e;this.twoFingerDown=!1;var f=normalBookStatu.book_statu_ready,g=normalBookStatu.book_statu_mag_flip;this.flipBook.bind(_event._down,function(b){b=isTouch?b.originalEvent.touches:[b];if(2==b.length){if(nBookStatu==normalBookStatu.book_statu_mouse_flip){var c;"tl"==a.flippingPage.corner?c=Point(0,0):"tr"==a.flippingPage.corner?c=Point(a.pageWidth,0):"bl"==a.flippingPage.corner?c=Point(0,a.pageHeight):"br"==a.flippingPage.corner&&
(c=Point(a.pageWidth,a.pageHeight));window.clearInterval(a.intervalID);a.timer(a.flippingPage.corner,a.totalFrame,20,c,a.flipPoint,!1,!0)}d=globalToBook(!0,b[0].pageX,b[0].pageY);e=globalToBook(!0,b[1].pageX,b[1].pageY);b=a.pointInPage(d,a.pageWidth,a.pageHeight);c=a.pointInPage(e,a.pageWidth,a.pageHeight);b==c&&b&&(a.twoFingerDown=b);bookMouseDown=!1}else{if(nBookStatu==f){c=globalToBook(!0,b[0].pageX,b[0].pageY);if(0>c.x||c.x>a.width||0>c.y||c.y>a.height)return;var k=a.getCornerAndBeginPoint(c);
if(null==k.corner)return;var m=k.corner,k=k.beginPoint;_rimFlip.removeRimFlip();nBookStatu=normalBookStatu.book_statu_mouse_flip;window.clearInterval(a.intervalID);a.flippingPage.beginFlip(m);a.timer(m,10,20,c,k,!1,!1)}if(nBookStatu==g){b=globalToBook(!0,b[0].pageX,b[0].pageY);if(0>b.x||b.x>a.width||0>b.y||b.y>a.height)return;k=a.getCornerAndBeginPoint(b,4);if(null==k.corner)return;nBookStatu=normalBookStatu.book_statu_mouse_flip;bookMouseDown=!0}return!1}});bookContainer.bind(_event._move,function(h){h=
isTouch?h.originalEvent.touches:[h];if(2==h.length&&a.twoFingerDown){if(2!=bookType){var j=globalToBook(!0,h[0].pageX,h[0].pageY),h=globalToBook(!0,h[1].pageX,h[1].pageY);if(15<Math.abs(j.x-d.x)||15<Math.abs(j.y-d.y)||15<Math.abs(h.x-e.x)||15<Math.abs(h.y-e.y)){var k;"left"==a.twoFingerDown?k=2*Math.floor(a.currentPageIndex/2)+1:"right"==a.twoFingerDown&&(k=2*Math.floor(a.currentPageIndex/2));a.zoomToPage(k)}}}else if(bookType==BookType.normal_book&&!1==flipping&&(!1==bookMouseDown?(j=globalToBook(!0,
h[0].pageX,h[0].pageY),0>j.x||j.x>a.width||0>j.y||j.y>a.height?bookContainer.css({cursor:"default"}):!1==a.isInBeginFlipRange(j)?bookContainer.css({cursor:"default"}):bookContainer.css({cursor:"pointer"})):bookContainer.css({cursor:"pointer"})),!1==bookMouseDown&&nBookStatu==f&&!1==flipping)j=globalToBook(!0,h[0].pageX,h[0].pageY),0>j.x||j.x>a.width||0>j.y||j.y>a.height||(h=a.getCornerAndBeginPoint(j,4),null!=h.corner&&(k=h.corner,h=h.beginPoint,nBookStatu=g,_rimFlip.removeRimFlip(),window.clearInterval(a.intervalID),
a.flippingPage.beginFlip(k),a.maganetPoint=j,a.timer(k,Math.floor(a.totalFrame/6),10,j,h,!1,!1)));else{if(nBookStatu==g){if(void 0==a.flippingPage||null==a.flippingPage)return;j=globalToBook(!0,h[0].pageX,h[0].pageY);k=!1;if(0>j.x||j.x>a.width||0>j.y||j.y>a.height)k=!0;h={corner:null,beginPoint:null};!1==k&&(h=a.getCornerAndBeginPoint(j,4));null==h.corner&&(j=Point(a.flippingPage.isLeft()?0:a.pageWidth,a.flippingPage.isTop()?0:a.pageHeight),window.clearInterval(a.intervalID),a.timer(a.flippingPage.corner,
Math.floor(a.totalFrame/6),20,j,a.maganetPoint,!1,!0,!1),nBookStatu=f,bookMouseDown=!1);return!1}bookMouseDown&&(j=globalToBook(a.flippingPage.isLeft(),h[0].pageX,h[0].pageY),a.flippingPage.flipToPoint(j.x,j.y,!1),-1!=b&&(c=j.x>b?!1:!0),b=j.x);return!1}});bookContainer.bind(_event._end,function(b){b=isTouch?b.originalEvent.changedTouches:[b];if(bookMouseDown){a.twoFingerDown=!1;var b=globalToBook(a.flippingPage.isLeft(),b[0].pageX,b[0].pageY),d,e,f=!0;if(a.flippingPage.isLeft()&&b.x>=a.pageWidth||
!a.flippingPage.isLeft()&&0>=b.x)f=!1;void 0!=c&&(f=!(a.flippingPage.isLeft()^c));f||(a.gotoPageIndex=a.flippingPage.isLeft()?2*Math.floor(a.currentPageIndex/2+1):2*Math.floor(a.currentPageIndex/2-1)+1,a.betweenPaperCount=a.flippingPage.isLeft()?1:-1);d=Point(a.flippingPage.isLeft()?0:a.pageWidth,a.flippingPage.isTop()?0:a.pageHeight);e=Point(a.flippingPage.isLeft()?2*a.pageWidth:-a.pageWidth,a.flippingPage.isTop()?0:a.pageHeight);d=f?d:e;f?a.timer(a.flippingPage.corner,Math.floor(a.totalFrame/3),
20,d,b,!1,!0,!f):(playFlipSound(),e=Math.floor(2*a.totalFrame/3),a.timer(a.flippingPage.corner,e,20,d,b,!1,!0,!f),a.movetoCenter(e,20,a.gotoPageIndex));bookMouseDown=!1}else flipping&&2==nBookStatu&&(stopFlip=!0)})};
rightToLeftNormalBook.prototype.isInBeginFlipRange=function(a){var b=normalEventRadius,c=null;Math.pow(a.x,2)+Math.pow(a.y,2)<b?this.currentPageIndex<totalPageCount&&(c=""):Math.pow(2*this.pageWidth-a.x,2)+Math.pow(a.y,2)<b?1<this.currentPageIndex&&(c=""):Math.pow(a.x,2)+Math.pow(this.pageHeight-a.y,2)<b?this.currentPageIndex<totalPageCount&&(c=""):Math.pow(this.width-a.x,2)+Math.pow(this.height-a.y,2)<b&&1<this.currentPageIndex&&(c="");return null!=c};
rightToLeftNormalBook.prototype.getCornerAndBeginPoint=function(a,b){void 0==b&&(b=1);var c=normalEventRadius/b,d="",e=null,f={corner:null,beginPoint:null};Math.pow(a.x,2)+Math.pow(a.y,2)<c?(d="tl",e=Point(0,0),this.flippingPage=this.currentPage2,this.gotoPageIndex=2*Math.floor(this.currentPageIndex/2+1),this.currentPageIndex<totalPageCount&&5<a.x&&5<a.y&&(f.corner=d,f.beginPoint=e)):Math.pow(2*this.pageWidth-a.x,2)+Math.pow(a.y,2)<c?(d="tr",a.x-=this.pageWidth,e=Point(this.pageWidth,0),this.flippingPage=
this.currentPage,this.gotoPageIndex=2*Math.floor(this.currentPageIndex/2)-1,1<this.currentPageIndex&&5<this.width-a.x&&5<a.y&&(f.corner=d,f.beginPoint=e)):Math.pow(a.x,2)+Math.pow(this.pageHeight-a.y,2)<c?(d="bl",e=Point(0,this.pageHeight),this.flippingPage=this.currentPage2,this.gotoPageIndex=2*Math.floor(this.currentPageIndex/2+1),this.currentPageIndex<totalPageCount&&5<a.x&&5<this.height-a.y&&(f.corner=d,f.beginPoint=e)):Math.pow(this.width-a.x,2)+Math.pow(this.height-a.y,2)<c&&(d="br",a.x-=this.pageWidth,
e=Point(this.pageWidth,this.pageHeight),this.flippingPage=this.currentPage,this.gotoPageIndex=2*Math.floor(this.currentPageIndex/2)-1,1<this.currentPageIndex&&5<this.width-a.x&&5<this.height-a.y&&(f.corner=d,f.beginPoint=e));return f};var SingleBook=Class({create:function(a){this.mask=$("<div id='singleBookMask' style='display: none; position: absolute;'></div>");this.book=$("<div id='singleBook' class='singleBook' style='position: absolute;'></div>");a.append(this.mask);this.mask.append(this.book);this.thickness=thickness(rightToLeft);this.flippingPage={};this.flipToPage={};this.currentPageIndex=1;this.pageWidth=768;this.pageHeight=1024;this.maskWidth=1280;this.gotoPageIndex=this.differPageNum=this.bookStatu=0;this.isTop=this.isLeft=
this.bookMouseDown=!1;this.totalFrame=30;a=1E3*bookConfig.flippingTime;void 0!=a&&0<a&&(this.totalFrame=a/20);this.shadow=new bookShadow(this.pageWidth,this.pageHeight,this.book);this.cssObj={top:"0px",left:"0px",position:"absolute"};this.bookMouseDown=!1;this.bookStatu=singleBookStatu.book_statu_ready;this.createBook();this.initEvent()},createBook:function(){this.previousPage=new SinglePage(this);this.currentPage=new SinglePage(this);this.nextPage=new SinglePage(this);this.previousPage.setZIndex(1);
this.currentPage.setZIndex(3);this.nextPage.setZIndex(2);this.fillNearPage(oriPageIndex);this.book.append(this.thickness);this.currentPageIndex=oriPageIndex;oriPageIndex>=originTotalPageCount-1&&this.thickness.setVisible(!1)},gotoPage:function(a){if(1>a||a>originTotalPageCount)return _tipsBox.setCaption(1>a?"This is the first page":"This is the last page"),_tipsBox.showTipsBox(),!1;if(this.currentPageIndex==a||0!=this.bookStatu)return!1;_rimFlip.removeRimFlip();this.setGotoPage(a);this.bookStatu=
1;this.gotoPageIndex=a;var a=Point(0,0),b,c=Point(0,0);0<this.differPageNum?rightToLeft?(a.x=0,a.y=0,c.x=2*this.pageWidth,c.y=0,b="tl"):(a.x=this.pageWidth,a.y=0,c.x=-this.pageWidth,c.y=0,b="tr"):rightToLeft?(a.x=2*this.pageWidth,a.y=0,c.x=0,c.y=0,b="tr"):(a.x=-this.pageWidth,a.y=0,c.x=this.pageWidth,c.y=0,b="tl");playFlipSound();this.flippingPage.beginFlip(b);this.timer(b,this.totalFrame,20,c,a,!0)},zoomToPage:function(a){0==this.bookStatu&&(zoomBook.changePageMode(!1),zoomBook.currentIndex=a,zoomBook.showPage.fillContent(zoomBook.currentIndex),
bookType=2,changeShowBook(2),toolBar.changeZoomIcon(!1),setCurrentIndexTextField(zoomBook.currentIndex,zoomBook.doublePage),thumbnail.clearHighLight(),thumbnail.setHighLight(zoomBook.currentIndex))},setVisible:function(a){this.mask.css("display",a?"block":"none")},changePage:function(){var a;0<this.differPageNum?(a=this.previousPage,this.previousPage=this.currentPage,this.currentPage=this.nextPage,this.nextPage=a):(a=this.nextPage,this.nextPage=this.currentPage,this.currentPage=this.previousPage,
this.previousPage=a);this.addSearchHighlight();this.previousPage.sideA.resetSlider();this.currentPage.sideA.playSlider();this.nextPage.sideA.resetSlider()},openShownSlider:function(){var a=getShownPage();this.currentPage.sideA.openSliderOrNot(a);this.currentPage.sideB.openSliderOrNot(a)},inPointInPage:function(a,b,c){return 0<=a.x&&a.x<=b&&0<=a.y&&a.y<=c?!0:!1},getLeft:function(){return this.mask.offset().left},getTop:function(){return this.book.offset().top},getWidth:function(){return this.book.width()},
getHeight:function(){return this.book.height()},getScale:function(){return this.book.scale()},timer:function(a,b,c,d,e,f,g,h){void 0==g&&(g=!1);void 0==h&&(h=!1);flipping=!0;stopFlip=!1;this.flipPoint=Point(0,0);var j=0;Point(0,0);this.intervalID=setInterval(function(){j++;this.flipPoint.x=$.easing.easeOutQuart(null,j,e.x,d.x-e.x,b);this.flipPoint.y=$.easing.easeOutQuart(null,j,e.y,d.y-e.y,b);f&&(this.flipPoint.y=rightToLeft?0.2*Math.sqrt(Math.pow(this.pageWidth,2)-Math.pow(this.flipPoint.x-this.pageWidth,
2)):0.2*Math.sqrt(Math.pow(this.pageWidth,2)-Math.pow(this.flipPoint.x,2)));j==b&&(this.flipPoint=d);if(stopFlip){auto_player.resetTimer();window.clearInterval(this.intervalID);var c=0<=a.indexOf("l"),m=0<=a.indexOf("t");rightToLeft?(this.differPageNum=c?1:-1,this.gotoPageIndex=c?this.currentPageIndex+1:this.currentPageIndex-1,c=Point(c?2*this.pageWidth:0,m?0:this.pageHeight)):(this.differPageNum=c?-1:1,this.gotoPageIndex=c?this.currentPageIndex-1:this.currentPageIndex+1,c=Point(c?this.pageWidth:
-this.pageWidth,m?0:this.pageHeight));this.timer(a,this.totalFrame,20,c,this.flipPoint,!1,!0,!0)}else if(c=1,0>this.flipPoint.x&&!rightToLeft&&(c=Math.min((this.flipPoint.x+this.pageWidth)/this.pageWidth+0.1,1),this.flippingPage.sideB.side.css("opacity",c)),this.flipPoint.x>this.pageWidth&&rightToLeft&&(c=Math.min(Math.abs(this.flipPoint.x-2*this.pageWidth)/this.pageWidth+0.1,1),this.flippingPage.sideB.side.css("opacity",c)),this.flippingPage.flipToPoint(this.flipPoint,1==j),j>=b)if(_rimFlip.isRimFlip||
auto_player.resetTimer(),window.clearInterval(this.intervalID),f||h)this.flippingPage.endFlip(),this.afterGotoPage();else if(g||!_rimFlip.isRimFlip)g?!f&&!h&&(this.bookStatu=0,this.flippingPage.setSideAUp(!0),this.reset_z_index(),this.currentPageIndex!=originTotalPageCount&&this.thickness.showThickness()):this.bookMouseDown=!0}.bind(this),c)},stopTimer:function(){window.clearInterval(this.intervalID)},afterGotoPage:function(){this.currentPageIndex=this.gotoPageIndex;this.changePage();setCurrentIndexTextField(this.currentPageIndex,
!1);window.setTimeout(function(){this.bookStatu=0;resizeBookAfterFlip&&onStageResize();this.currentPageIndex!=originTotalPageCount&&this.thickness.showThickness();this.fillNearPage(this.currentPageIndex);this.reset_z_index();this.flippingPage.resetPage();thumbnail.clearHighLight();thumbnail.setHighLight(this.currentPageIndex);window.location.hash="#p="+this.currentPageIndex;sendvisitinfo(1,this.currentPageIndex)}.bind(this),30)},setGotoPage:function(a){this.differPageNum=a-this.currentPageIndex;this.currentPageIndex>
a?(this.flipToPage=this.flippingPage=this.previousPage,this.fillAnPage(this.flipToPage,a,this.currentPageIndex-1)):(this.flippingPage=this.currentPage,this.flipToPage=this.nextPage,this.fillAnPage(this.flipToPage,a,a),this.flipToPage.page.css({"z-index":4}),this.flippingPage.page.css({"z-index":5}))},fillAnPage:function(a,b,c){a.resetPage();a.sideA.fillImg(b,!1);a.sideB.fillImg(c,!0);a.isHardPage=1==b&&hardPageEnable&&3!=browserType?!0:!1},fillNearPage:function(a){1<a&&this.fillAnPage(this.previousPage,
a-1,a-1);this.fillAnPage(this.currentPage,a,a);a<originTotalPageCount&&this.fillAnPage(this.nextPage,a+1,a+1);this.addHistoryTexts()},reset_z_index:function(){this.previousPage.setZIndex(1);this.currentPage.setZIndex(3);this.nextPage.setZIndex(2)},addHistoryTexts:function(){var a=getShownPage();this.previousPage.sideA.addHistoryTexts(a);this.currentPage.sideA.addHistoryTexts(a);this.nextPage.sideA.addHistoryTexts(a)},addSearch:function(){this.previousPage.addSearch();this.currentPage.addSearch();
this.nextPage.addSearch()},clearSearch:function(){this.previousPage.clearSearch();this.currentPage.clearSearch();this.nextPage.clearSearch()},setSingleBookVisible:function(a){this.mask.css({display:a?"block":"none"});a&&(void 0!=this.currentPage.playSlider?this.currentPage.playSlider():this.currentPage.resetSlider(),this.addHistoryTexts())},gotoAnPoint:function(a){this.gotoPage(a)},onResize:function(a,b){this.maskWidth=Math.sqrt(Math.pow(a,2)+Math.pow(b,2));this.book.css({width:a+"px",height:b+"px"});
this.previousPage.onResize(a,b);this.currentPage.onResize(a,b);this.nextPage.onResize(a,b);this.pageWidth=a;this.pageHeight=b;this.mask.css({width:windowWidth+"px",height:windowHeight+"px"});this.thickness.onResize(20,b);this.thickness.setThicknessPosition(rightToLeft?-14:a-1,0);singleEventRadius=Math.pow(Math.ceil(a/3),2);this.shadow.onResize(a,b,!1)},setBookPosition:function(a,b){this.mask.css({left:a+"px"});this.book.css({left:"0px",top:b+"px"})},addSearchHighlight:function(){this.currentPage.sideA.highlightSearch(this.currentPageIndex)},
clearSearchHighlight:function(){this.currentPage.sideA.clearHighlight()},append:function(a){this.book.append(a)},initEvent:function(){var a=-1,b=void 0,c,d,e=!1,f=this;this.book.bind(_event._down,function(g){a=-1;b=void 0;g=isTouch?g.originalEvent.touches:[g];if(2==g.length){if(2==f.bookStatu){var h;"tl"==f.flippingPage.realCorner?h=rightToLeft?Point(0,0):Point(-f.pageWidth,0):"tr"==f.flippingPage.realCorner?h=rightToLeft?Point(2*f.pageWidth,f.pageHeight):Point(f.pageWidth,0):"bl"==f.flippingPage.realCorner?
h=rightToLeft?Point(0,f.pageHeight):Point(-f.pageWidth,f.pageHeight):"br"==f.flippingPage.realCorner&&(h=rightToLeft?Point(2*f.pageWidth,f.pageHeight):Point(f.pageWidth,f.pageHeight));f.stopTimer();f.timer(f.flippingPage.realCorner,10,20,h,f.flipPoint,!1,!0,!1)}c=globalToBook(!0,g[0].x,g[0].y,!0);d=globalToBook(!0,g[1].x,g[1].y,!0);g=f.isPointInPage(c,f.pageWidth,f.pageHeight);h=f.isPointInPage(d,f.pageWidth,f.pageHeight);e=g&&h;return f.bookMouseDown=!1}if(bookType==BookType.single_book&&0==f.bookStatu){var g=
globalToBook(!0,g[0].pageX,g[0].pageY,!0),j;if(0>g.x||g.x>f.pageWidth||0>g.y||g.y>f.pageHeight)return;if(Math.pow(g.x,2)+Math.pow(g.y,2)<singleEventRadius)if(j="tl",f.isLeft=!0,f.isTop=!0,h=Point(-f.pageWidth,0),rightToLeft){if(h=Point(0,0),f.flippingPage=f.currentPage,f.gotoPageIndex=f.currentPageIndex+1,f.currentPageIndex==originTotalPageCount){_tipsBox.setCaption("This is the last page");_tipsBox.showTipsBox();return}}else{if(f.flippingPage=f.previousPage,f.gotoPageIndex=f.currentPageIndex-1,1==
f.currentPageIndex){_tipsBox.setCaption("This is the first page");_tipsBox.showTipsBox();return}}else if(Math.pow(g.x,2)+Math.pow(f.pageHeight-g.y,2)<singleEventRadius)if(j="bl",f.isLeft=!0,f.isTop=!1,h=Point(-f.pageWidth,f.pageHeight),rightToLeft){if(h=Point(0,f.pageHeight),f.flippingPage=f.currentPage,f.gotoPageIndex=f.currentPageIndex+1,f.currentPageIndex==originTotalPageCount){_tipsBox.setCaption("This is the last page");_tipsBox.showTipsBox();return}}else{if(f.flippingPage=f.previousPage,f.gotoPageIndex=
f.currentPageIndex-1,1==f.currentPageIndex){_tipsBox.setCaption("This is the first page");_tipsBox.showTipsBox();return}}else if(Math.pow(f.pageWidth-g.x,2)+Math.pow(g.y,2)<singleEventRadius)if(j="tr",f.isLeft=!1,f.isTop=!0,h=Point(f.pageWidth,0),rightToLeft){if(h=Point(2*f.pageWidth,0),f.flippingPage=f.previousPage,f.gotoPageIndex=f.currentPageIndex-1,1==f.currentPageIndex){_tipsBox.setCaption("This is the first page");_tipsBox.showTipsBox();return}}else{if(f.flippingPage=f.currentPage,f.gotoPageIndex=
f.currentPageIndex+1,f.currentPageIndex==originTotalPageCount){_tipsBox.setCaption("This is the last page");_tipsBox.showTipsBox();return}}else if(Math.pow(f.pageWidth-g.x,2)+Math.pow(f.pageHeight-g.y,2)<singleEventRadius)if(j="br",f.isLeft=!1,f.isTop=!1,h=Point(f.pageWidth,f.pageHeight),rightToLeft){if(f.gotoPageIndex=f.currentPageIndex-1,h=Point(2*f.pageWidth,f.pageHeight),f.flippingPage=f.previousPage,1==f.currentPageIndex){_tipsBox.setCaption("This is the first page");_tipsBox.showTipsBox();return}}else{if(f.flippingPage=
f.currentPage,f.gotoPageIndex=f.currentPageIndex+1,f.currentPageIndex==originTotalPageCount){_tipsBox.setCaption("This is the last page");_tipsBox.showTipsBox();return}}else return;_rimFlip.removeRimFlip();f.bookStatu=2;f.flippingPage.beginFlip(j);f.timer(j,10,20,g,h,!1,!1)}return!1});this.book.bind(_event._move,function(f){f=isTouch?f.originalEvent.touches:[f];if(2==f.length&&e){var h=singlePageBook,j=globalToBook(!0,f[0].pageX,f[0].pageY,!0),k=globalToBook(!0,f[1].pageX,f[1].pageY);if(15<Math.abs(j.x-
c.x)||15<Math.abs(j.y-c.y)||15<Math.abs(k.x-d.x)||15<Math.abs(k.y-d.y))zoomBook.currentIndex=h.currentPageIndex,zoomBook.showPage.fillContent(zoomBook.currentIndex),bookType=2,changeShowBook(2),$("#zoomImg").attr("src",uiBaseURL+"ZoomOut.png"),$("#btnZoom").attr("title","Zoom Out"),setCurrentIndexTextField(zoomBook.currentIndex,!1),thumbnail.clearHighLight(),thumbnail.setHighLight(zoomBook.currentIndex)}1==bookType&&!0==singlePageBook.bookMouseDown&&(flipPoint=globalToBook(!0,f[0].pageX,f[0].pageY,
!0),singlePageBook.flippingPage.flipToPoint(flipPoint),-1!=a&&(b=flipPoint.x>a?!1:!0),a=flipPoint.x);return isIpad()?!1:!0});this.book.bind(_event._end,function(a){var c=singlePageBook,a=isTouch?a.originalEvent.changedTouches:[a];e=!1;if(c.bookMouseDown){var a=globalToBook(!0,a[0].pageX,a[0].pageY,!0),d=!0,f;if(c.isLeft&&a.x>=c.pageWidth/2||!c.isLeft&&a.x<c.pageWidth/2)d=!1;void 0!=b&&(d=!(c.isLeft^b));d||(rightToLeft?(c.gotoPageIndex=c.isLeft?c.currentPageIndex+1:c.currentPageIndex-1,c.differPageNum=
c.isLeft?1:-1):(c.gotoPageIndex=c.isLeft?c.currentPageIndex-1:c.currentPageIndex+1,c.differPageNum=c.isLeft?-1:1));f=rightToLeft?d?Point(c.isLeft?0:2,c.isTop?0:1):Point(c.isLeft?2:0,c.isTop?0:1):d?Point(c.isLeft?-1:1,c.isTop?0:1):Point(c.isLeft?1:-1,c.isTop?0:1);f=Point(f.x*c.pageWidth,f.y*c.pageHeight);d?c.timer("tr",10,20,f,a,!1,!0,!d):(playFlipSound(),c.timer("tr",20,20,f,a,!1,!0,!d));c.bookMouseDown=!1}else flipping&&2==c.bookStatu&&(stopFlip=!0)})}});var SinglePage=Class({create:function(a){this.book=a;this.page=$("<div style='position: absolute;z-index: 1;'></div>");this.mask=$("<div style='position:absolute;top:0px;left:0px;overflow:hidden;'></div>");this.sidePositionA=$("<div style='position:absolute;top:0px;left:0px;'></div>");this.sidePositionB=$("<div style='position:absolute;top:0px;left:0px;'></div>");this.shadowA=$("<div style='position:absolute;top:0px;left:0px;display: none;'></div>");this.shadowB=$("<div style='position:absolute;top:0px;left:0px; display: none;'></div>");
this.realCorner=this.corner="tr";this.book.append(this.page);this.append(this.shadowA);this.append(this.mask);this.mask.append(this.sidePositionB);this.mask.append(this.sidePositionA);this.sideA=new SingleSide(this.sidePositionA,!0);this.sideB=new SingleSide(this.sidePositionB,!1);this.sideB.append(this.shadowB);this.isHardPage=!1},onResize:function(a,b){this.page.css({width:a+"px",height:b+"px"});this.mask.css({width:this.book.maskWidth+"px",height:this.book.maskWidth+"px"});this.shadowA.css({width:a+
"px",height:b+"px"});this.shadowB.css({width:a+"px",height:b+"px"});this.sidePositionA.css({width:a+"px",height:b+"px"});this.sidePositionB.css({width:a+"px",height:b+"px"});this.sideA.onResize(a,b);this.sideB.onResize(a,b)},beginFlip:function(a){this.realCorner=a;this.corner=0<=a.indexOf("t")?rightToLeft?"tl":"tr":rightToLeft?"bl":"br";this.book.gotoPageIndex==originTotalPageCount&&this.book.thickness.hideThickness()},flipToPoint:function(a,b){void 0==b&&(b=!1);"android"==device.name&&(a.y="tl"==
this.corner||"tr"==this.corner?0:this.book.pageHeight);if(this.isHardPage)this.hardPageFlip(a.x,b);else if(this.isCorner(a.x,a.y))this.resetPage(),0<=this.realCorner.indexOf("l")&&this.css("z-index",1);else{var c=computePoint(this.corner,a.x,a.y,this.book.pageWidth,this.book.pageHeight,this.book.maskWidth,this.shadowB,this.shadowA);angle=c.Angle;df=c.Df;noMovePoint=c.NomovePoint;mv=c.Mv;if(b){this.setSideAUp(!1);this.showShadow();this.book.flippingPage.page.css({"z-index":5});var c=0<=this.corner.indexOf("t"),
d=0<=this.corner.indexOf("l");c?(this.sidePositionB.css({top:"0px",bottom:"auto",left:d?"auto":"0px",right:d?"0px":"auto"}),this.sidePositionA.css({top:"0px",bottom:"auto",left:d?"auto":"0px",right:d?"0px":"auto"})):(this.sidePositionB.css({top:"auto",bottom:"0px",left:d?"auto":"0px",right:d?"0px":"auto"}),this.sidePositionA.css({top:"auto",bottom:"0px",left:d?"auto":"0px",right:d?"0px":"auto"}))}0<=this.corner.indexOf("t")?rightToLeft?(this.rotateElement(this.mask,"100% 0%",translate(-noMovePoint.x+
this.book.pageWidth-this.book.maskWidth+mv.x,-noMovePoint.y+mv.y)+rotate(-angle)),this.rotateElement(this.sidePositionA,"100% 0%",rotate(angle)+translate(noMovePoint.x-mv.x,noMovePoint.y-mv.y)),this.rotateElement(this.sidePositionB,"100% 0%",rotate(angle)+translate(noMovePoint.x+df.x-mv.x,noMovePoint.y+df.y-mv.y)),this.rotateElement(this.sideB.side,"100% 0%",translate(-this.book.pageWidth,0)+rotate(2*(90-angle)))):(this.rotateElement(this.mask,"0% 0%",translate(noMovePoint.x+mv.x,-noMovePoint.y+mv.y)+
rotate(angle)),this.rotateElement(this.sidePositionA,"0% 0%",rotate(-angle)+translate(-noMovePoint.x-mv.x,noMovePoint.y-mv.y)),this.rotateElement(this.sidePositionB,"0% 0%",rotate(-angle)+translate(-noMovePoint.x-mv.x+df.x,noMovePoint.y+df.y-mv.y)),this.rotateElement(this.sideB.side,"0% 0%",translate(0,0)+rotate(2*(angle-90)))):rightToLeft?(this.rotateElement(this.mask,"100% 100%",translate(-noMovePoint.x+this.book.pageWidth-this.book.maskWidth+mv.x,noMovePoint.y+this.book.pageHeight-this.book.maskWidth+
mv.y)+rotate(angle)),this.rotateElement(this.sidePositionA,"100% 100%",rotate(-angle)+translate(noMovePoint.x-mv.x,-noMovePoint.y-mv.y)),this.rotateElement(this.sidePositionB,"100% 100%",rotate(-angle)+translate(noMovePoint.x+df.x-mv.x,-noMovePoint.y-mv.y+df.y)),this.rotateElement(this.sideB.side,"100% 100%",translate(-this.book.pageWidth,-this.book.pageHeight)+rotate(2*(angle-90)))):(this.rotateElement(this.mask,"0% 100%",translate(noMovePoint.x+mv.x,noMovePoint.y+this.book.pageHeight-this.book.maskWidth+
mv.y)+rotate(-angle)),this.rotateElement(this.sidePositionA,"0% 100%",rotate(angle)+translate(-noMovePoint.x-mv.x,-noMovePoint.y-mv.y)),this.rotateElement(this.sidePositionB,"0% 100%",rotate(angle)+translate(-noMovePoint.x+df.x-mv.x,-noMovePoint.y+df.y-mv.y)),this.rotateElement(this.sideB.side,"0% 100%",translate(0,-this.book.pageHeight)+rotate(2*(90-angle))))}},rotateElement:function(a,b,c){a.css({"-webkit-transform-origin":b,"-moz-transform-origin":b,"-ms-transform-origin":b,"-o-transform-origin":b,
"-webkit-transform":c,"-moz-transform":c,"-ms-transform":c,"-o-transform":c})},endFlip:function(){this.setSideAUp(!0);this.hideShadow()},hardPageFlip:function(a,b){var c=a;rightToLeft?(a>2*this.book.pageWidth&&(c=2*this.book.pageWidth),0>a&&(c=0),c=Math.acos((c-this.book.pageWidth)/this.book.pageWidth)):(a>this.book.pageWidth&&(c=this.book.pageWidth),a<-this.book.pageWidth&&(c=-this.book.pageWidth),c=Math.acos(c/this.book.pageWidth));c=180*c/Math.PI;rightToLeft&&(c-=180);b&&(this.sideB.imgFlipOver(!0),
this.css({"-webkit-transform-style":"preserve-3d","-moz-transform-style":"preserve-3d","z-index":120}));var d=rightToLeft?"100% 50%":"0% 50%";this.css({"-moz-perspective-origin":"left center","-webkit-transform-origin":d,"-webkit-transform":"perspective(3000px) rotateY("+-c+"deg)","-moz-perspective-origin":"left center","-moz-transform-origin":d,"-moz-transform":"perspective(3000px) rotateY("+-c+"deg)"});rightToLeft?-90>=c?(this.setSideAUp(!1),this.css({opacity:Math.abs(c+180)/90})):(this.setSideAUp(!0),
this.css({opacity:1})):90<=c?(this.setSideAUp(!1),this.css({opacity:Math.abs(c-180)/90})):(this.setSideAUp(!0),this.css({opacity:1}))},setSideAUp:function(a){this.sidePositionA.css({"z-index":a?2:1});this.sidePositionB.css({"z-index":a?1:2})},showShadow:function(){this.shadowA.css({display:"block"});this.shadowB.css({display:"block"})},hideShadow:function(){this.shadowA.css({display:"none"});this.shadowB.css({display:"none"})},resetPage:function(){this.isHardPage&&(this.css({"-webkit-transform-style":"flat",
"-moz-transform-style":"flat","-webkit-transform":"rotateY(0deg)","-moz-transform":"rotateY(0deg)","-ms-transform":"rotateY(0deg)","-o-transform":"rotateY(0deg)",transform:"rotateY(0deg)",opacity:1}),this.sideA.imgFlipOver(!1),this.sideB.imgFlipOver(!1));this.rotateElement(this.mask,"0% 0%",translate(0,0)+rotate(0));this.rotateElement(this.sideA.side,"0% 0%",translate(0,0)+rotate(0));this.rotateElement(this.sideB.side,"0% 0%",translate(0,0)+rotate(0));this.rotateElement(this.sidePositionA,"0% 0%",
translate(0,0)+rotate(0));this.rotateElement(this.sidePositionB,"0% 0%",translate(0,0)+rotate(0));this.sidePositionA.css({top:"0px",bottom:"auto",left:"0px",right:"auto"});this.sidePositionB.css({top:"0px",bottom:"auto",left:"0px",right:"auto"});this.sideB.side.css({opacity:1});this.sideA.side.css({opacity:1})},isCorner:function(a,b){var c=0;0<=this.realCorner.indexOf("t")&&0==b&&c++;0<=this.realCorner.indexOf("b")&&b==this.book.pageHeight&&c++;0<=this.realCorner.indexOf("l")&&a==-this.book.pageWidth&&
c++;0<=this.realCorner.indexOf("r")&&a==this.book.pageWidth&&c++;return 2<=c},addSearch:function(){this.sideA.initSearch();this.sideB.initSearch()},clearSearch:function(){this.sideA.clearSearch();this.sideB.clearSearch()},playSlider:function(){this.sideA.playSlider();this.sideB.playSlider()},resetSlider:function(){this.sideA.resetSlider();this.sideB.resetSlider()},left:function(){},top:function(){},width:function(){},height:function(){},scale:function(){return 1},setZIndex:function(a){this.page.css("z-index",
a)},append:function(a){this.page.append(a)}});var SingleSide=Class({create:function(a,b){this.father=a;this.isMirrorSide=b;this.pageWidth=400;this.pageHeight=600;this.side=$("<div style='position:absolute;top:0px;left:0px'></div>");this.sideBackground=$("<div style='position:absolute;top:0px;left:0px;background-color:#f5f0f5'></div>");this.sideContent=$("<div style='position:absolute;top:0px;left:0px;'></div>");this.sideImg=$("<img />");this.searchHighlight=$("<div class='kong' id='highlight'></div>");this.sideShadow;rightToLeft?(this.sideShadow=
$("<div class='leftShadow'></div>"),this.sideShadow.css({width:userConfig.leftShadowWidth+"px",opacity:userConfig.leftShadowAlpha})):(this.sideShadow=$("<div class='rightShadow'></div>"),this.sideShadow.css({width:userConfig.rightShadowWidth+"px",opacity:userConfig.rightShadowAlpha}));this.loadingImg=$("<img src='"+uiBaseURL+"progress.gif' style='position: absolute;' />");this.loadingImg.css({left:(this.pageWidth-LOADING_WIDTH)/2+"px",top:(this.pageHeight-LOADING_HEIGHT)/2+"px"});this.MMBackground=
$("<div style='position : absolute; '></div>");this.initMMItems();this.slider=null;this.playSliderAfterLoad=!1;this.searchBackground=$("<div style='position : absolute; '></div>");this.searchArray=[];this.haveSearch=!1;a.append(this.side);this.side.append(this.sideBackground);this.sideBackground.append(this.sideContent);this.side.append(this.searchBackground);this.side.append(this.MMBackground);this.isMirrorSide&&this.sideBackground.append(this.sideShadow);this.imageIndex=-1;this.side.hammer().on("doubletap",
function(){if(bookType==BookType.single_book){singlePageBook.zoomToPage(this.imageIndex);return false}}.bind(this))},onResize:function(a,b){this.pageWidth=a;this.pageHeight=b;this.side.css({width:a+"px",height:b+"px"});this.sideBackground.css({width:a+"px",height:b+"px"});this.sideContent.css({width:a+"px",height:b+"px"});this.sideImg.css({width:a+"px",height:b+"px"});this.searchHighlight.css({width:a+"px",height:b+"px"});this.sideShadow.css({height:b+"px"});this.loadingImg.css({left:(a-32)/2+"px",
top:(b-32)/2+"px"});this.side.css({"-webkit-box-shadow":"0 0 10px rgba(40, 40, 40, 0.5)","-moz-box-shadow":"0 0 10px rgba(40, 40, 40, 0.5)","-o-box-shadow":"0 0 10px rgba(40, 40, 40, 0.5)","-ms-box-shadow":"0 0 10px rgba(40, 40, 40, 0.5)","box-shadow":"0 0 10px rgba(40, 40, 40, 0.5)"});this.onMMResize(a,b)},fillImg:function(a,b){if(this.imageIndex!=a){this.imageIndex=a;null!=this.slider&&(this.slider.destroy(),this.slider=null);this.sideContent.empty();this.MMBackground.empty();this.showLoading();
this.sideImg.attr("src",getPageDir(this.imageIndex,"normal",originTotalPageCount));var c=this;this.sideImg.load(function(){b&&c.sideImg.css({"-webkit-transform":"scaleX(-1)","-moz-transform":"scaleX(-1)","-o-transform":"scaleX(-1)","-ms-transform":"scaleX(-1)",opacity:0.2});c.hideLoading();c.sideContent.append(c.sideImg);c.sideContent.append(c.searchHighlight);c.searchHighlight.css({opacity:0.8});c.clearMM();c.initMM();c.initSlider()})}},imgFlipOver:function(a){a?(this.sideImg.css({"-webkit-transform":"scaleX(-1)",
"-moz-transform":"scaleX(-1)","-o-transform":"scaleX(-1)","-ms-transform":"scaleX(-1)",transform:"scaleX(-1)"}),this.sideShadow.attr("class",rightToLeft?"rightShadow":"leftShadow")):(this.sideImg.css({"-webkit-transform":"scaleX(1)","-moz-transform":"scaleX(1)","-ms-transform":"scaleX(1)","-o-transform":"scaleX(1)",transform:"scaleX(1)"}),this.sideShadow.attr("class",rightToLeft?"leftShadow":"rightShadow"));this.sideShadow.css({left:rightToLeft?"auto":"0px",right:rightToLeft?"0px":"auto"})},showLoading:function(){this.side.append(this.loadingImg)},
hideLoading:function(){this.loadingImg.remove()},clearSearch:function(){this.searchBackground.empty();this.searchArray=[];this.haveSearch=!1},initSearch:function(){this.searchBackground.empty();this.searchArray=[];this.haveSearch=!1;if(!(""==searchWord||0>searchPageArr.indexOf(this.imageIndex)||-1==this.imageIndex))for(var a=0;a<positionForPages[this.imageIndex-1].length;a++){if(0<=positionForPages[this.imageIndex-1][a].word.toLowerCase().indexOf(searchWord.toLowerCase())){var b=searchElement(positionForPages[this.imageIndex-
1][a],this.pageWidth,this.pageHeight);searchArray.push(b);searchBackground.append(b)}0==a&&(haveSearch=!0)}},initMM:function(){this._super();AddNotesByContainers(BookType.single_book,this.imageIndex,this.MMBackground)},addHistoryTexts:function(a){if(!(void 0==a||null==a)){for(var b=!1,c=0;c<a.length;c++)if(a[c]==this.imageIndex){b=!0;break}!0==b&&AddNotesByContainers(BookType.single_book,this.imageIndex,this.MMBackground)}},changeTo0x:function(a){var b=a;"#"!=a.substr(0,1)&&"0x"!=a.substr(0,2)&&(b=
"#"+parseInt(a).toString(16));"0x"==a.substr(0,2)&&(b=a.replace("0x","#"));return b},highlightSearch:function(a){highlightSearchFun(this.searchHighlight,a)},clearHighlight:function(){clearHighlightFun(this.searchHighlight)},append:function(a){this.side.append(a)}}).extend(BookSide);function zoomControlBar(a){this.dir=uiBaseURL;this.bar=$("<div></div>");this.btnZoomUp=$("<div title='Zoom up' id='zu'></div>");this.btnProgressBar=$("<div title='pb' id='pb'></div>");this.btnZoomDown=$("<div title='Zoom down' id='zd'></div>");this.btnZoomOut=$("<div title='Zoom out' id='zo'></div>");this.btnPre=$("<div title='Previous' id='pr'></div>");this.btnNext=$("<div title='Next' id='ne'></div>");this.btnMoveMode=$("<div title = 'Move by mouse position' id='md'></div>");this.moveByMousePosition=
!1;this.width=260;this.height=40;a.append(this.bar);this.bar.append(this.btnZoomUp);this.bar.append(this.btnZoomDown);this.bar.append(this.btnZoomOut);this.bar.append(this.btnPre);this.bar.append(this.btnNext);this.bar.append(this.btnMoveMode);this.btnZoomUp.append($('<img src="'+uiBaseURL+'ZU.png" id = "zu"></img>'));this.btnProgressBar.append($('<img src="'+uiBaseURL+'PB.png" id = "pb"></img>'));this.btnZoomDown.append($('<img src="'+uiBaseURL+'ZD.png" id = "zd"></img>'));this.btnZoomOut.append($('<img src="'+
uiBaseURL+'ZO.png" id = "zo"></img>'));this.btnPre.append($('<img src="'+uiBaseURL+'PR.png" id = "pr"></img>'));this.btnNext.append($('<img src="'+uiBaseURL+'NE.png" id = "ne"></img>'));this.btnMoveMode.append(getImage(toolBarIconsURL[ICON_MOVE_POSITION]));this.bar.css({width:this.width+"px",height:this.height+"px",position:"absolute","z-index":5,"-webkit-border-radius":"5px","-moz-border-radius":"5px","-ms-border-radius":"5px","-o-border-radius":"5px","border-radius":"5px","-webkit-box-shadow":"0px 0px 10px rgba(0, 0, 60, 0.8)",
"-moz-box-shadow":"0px 0px 10px rgba(0, 0, 60, 0.8)","-ms-box-shadow":"0px 0px 10px rgba(0, 0, 60, 0.8)","-o-box-shadow":"0px 0px 10px rgba(0, 0, 60, 0.8)","box-shadow":"0px 0px 10px rgba(0, 0, 60, 0.8)",display:"none","background-color":"#333333",opacity:0.3,"-moz-transition":"all 0.2s ease-in-out","-webkit-transition":"all 0.2s ease-in-out","-o-transition":"all 0.2s ease-in-out","-ms-transition":"all 0.2s ease-in-out",transition:"all 0.2s ease-in-out"});this.btnZoomUp.css({width:"26px",height:"26px",
"border-radius":"5px"});this.btnZoomDown.css({width:"26px",height:"26px","border-radius":"5px"});this.btnZoomOut.css({width:"26px",height:"26px","border-radius":"5px"});this.btnPre.css({width:"26px",height:"26px","border-radius":"5px"});this.btnNext.css({width:"26px",height:"26px","border-radius":"5px"});this.btnMoveMode.css({width:"26px",height:"26px","border-radius":"5px"});this.btnZoomUp.children("img").css({"margin-left":"3px","margin-top":"3px"});this.btnZoomDown.children("img").css({"margin-left":"3px",
"margin-top":"3px"});this.btnZoomOut.children("img").css({"margin-left":"3px","margin-top":"3px"});this.btnPre.children("img").css({"margin-left":"3px","margin-top":"3px"});this.btnNext.children("img").css({"margin-left":"3px","margin-top":"3px"});this.btnMoveMode.children("img").css({"margin-left":"3px","margin-top":"3px"});this.initEvt();this.setButtonsPos()}zoomControlBar.prototype.setPosition=function(a){this.bar.css({left:a+"px",top:toolBar.getTopHeight()+5+"px"})};
zoomControlBar.prototype.setVisible=function(a){this.bar.css({display:a?"block":"none"});if(!0==a&&(this.bar.css({opacity:0.3}),void 0==this.changeColor&&(this.changeColor=!1),!this.changeColor))this.initColor(bookConfig.iconColor),this.changeColor=!0};zoomControlBar.prototype.setChildIndex=function(a){this.bar.css({"z-index":a})};zoomControlBar.prototype.onResize=function(a,b){this.bar.css({width:a+"px",height:b+"px"})};
zoomControlBar.prototype.initEvt=function(){var a=this;a.bar.bind(_event._enter,function(){a.bar.css({opacity:0.7})});a.bar.bind(_event._down,function(){a.bar.css({opacity:0.7})});a.bar.bind(_event._end,function(){a.bar.css({opacity:0.7})});a.bar.bind(_event._leave,function(){a.bar.css({opacity:0.3})});a.btnZoomUp.bind(_event._end,function(){a.zoomUp()});a.btnZoomDown.bind(_event._end,function(){a.zoomDown()});a.btnZoomOut.bind(_event._end,function(){a.zoomOut()});a.btnPre.bind(_event._end,function(){rightToLeft?
nextPageFun():previousPageFun()});a.btnNext.bind(_event._end,function(){rightToLeft?previousPageFun():nextPageFun()});a.btnMoveMode.bind(_event._end,function(){a.changeMoveMode()});a.btnZoomUp.bind("mouseover",function(){a.btnZoomUp.css({cursor:"pointer"})});a.btnZoomDown.bind("mouseover",function(){a.btnZoomDown.css({cursor:"pointer"})});a.btnZoomOut.bind("mouseover",function(){a.btnZoomOut.css({cursor:"pointer"})});a.btnPre.bind("mouseover",function(){a.btnPre.css({cursor:"pointer"})});a.btnNext.bind("mouseover",
function(){a.btnNext.css({cursor:"pointer"})});a.btnMoveMode.bind("mouseover",function(){a.btnMoveMode.css({cursor:"pointer"})});a.btnZoomUp.mouseEnterShine("#333333","111111","#999999");a.btnZoomDown.mouseEnterShine("#333333","111111","#999999");a.btnZoomOut.mouseEnterShine("#333333","111111","#999999");a.btnPre.mouseEnterShine("#333333","111111","#999999");a.btnNext.mouseEnterShine("#333333","111111","#999999");a.btnMoveMode.mouseEnterShine("#333333","111111","#999999")};
zoomControlBar.prototype.initColor=function(a){this.btnZoomUp.changeButtonColor(a);this.btnZoomDown.changeButtonColor(a);this.btnZoomOut.changeButtonColor(a);this.btnPre.changeButtonColor(a);this.btnNext.changeButtonColor(a);this.btnMoveMode.changeButtonColor(a)};
zoomControlBar.prototype.setButtonsPos=function(){this.btnZoomUp.css({position:"absolute","margin-left":"20px",top:"6px"});this.btnZoomDown.css({position:"absolute","margin-left":"60px",top:"6px"});this.btnZoomOut.css({position:"absolute","margin-left":"100px",top:"6px"});this.btnPre.css({position:"absolute","margin-left":"140px",top:"6px"});this.btnNext.css({position:"absolute","margin-left":"180px",top:"6px"});this.btnMoveMode.css({position:"absolute","margin-left":"220px",top:"6px"})};
zoomControlBar.prototype.zoomUp=function(){2==bookType&&zoomBook.zoom(1)};zoomControlBar.prototype.zoomDown=function(){2==bookType&&zoomBook.zoom(-0.5)};
zoomControlBar.prototype.changeMoveMode=function(){!0==this.moveByMousePosition?(this.moveByMousePosition=!1,this.btnMoveMode.empty().append(getImage(toolBarIconsURL[ICON_MOVE_POSITION])).attr("title","Move by mouse position")):(this.moveByMousePosition=!0,this.btnMoveMode.empty().append(getImage(toolBarIconsURL[ICON_MOVE_DRAG])).attr("title","Move by mouse drag"));this.btnMoveMode.children("img").css({"margin-left":"3px","margin-top":"3px"});this.btnMoveMode.changeButtonColor(bookConfig.iconColor)};
zoomControlBar.prototype.zoomOut=function(){windowWidth<windowHeight?(bookType=1,changeShowBook(1),setCurrentIndexTextField($(singlePageBook).data().currentPageIndex),$(singlePageBook).data().gotoPage(zoomBook.currentIndex)):(bookType=0,changeShowBook(0),setCurrentIndexTextField(flipBook.currentPageIndex,!0),flipBook.gotoPage(zoomBook.currentIndex));thumbnail.clearHighLight();thumbnail.setHighLight(zoomBook.currentIndex);zoomBook.noZoom();toolBar.changeZoomIcon(!0)};function zoomSide(a){this.side=$("<div></div>");this.sideContent=$("<div class='sideContent' style= 'overflow: hidden'></div>");this.sideImg=$("<img style='position: absolute;' />");this.MMBackground=$("<div style='position:absolute;z-index:6;'></div>");this.loadingImg=$("<img src='"+uiBaseURL+"progress.gif' style='position: absolute;'>");this.width=zoomPageWidth;this.height=zoomPageHeight;this.fitH=this.fitW=0;this.tmpImg=$("<img style='position: absolute;z-index:-1;' />");this.searchHighlight=$("<div class='kong' id='highlight'></div>");
a.append(this.side);this.side.append(this.sideContent);this.imageIndex=-1;this.toScale=1;this.origin="0% 0%";this.translateY=this.translateX=this.y=this.x=0;this.firstEnter=this.isZomming=!1;this.sideTop=toolBar.getTopHeight()+5;this.side.css({width:this.width+"px",height:this.height+"px",top:this.sideTop+"px",position:"absolute",border:"1px solid rgba(200, 200, 200, 0.6)","-webkit-box-shadow":"10px 5px 15px rgba(40, 40, 40, 0.6)","-moz-box-shadow":"10px 5px 15px rgba(40, 40, 40, 0.6)","-o-box-shadow":"10px 5px 15px rgba(40, 40, 40, 0.6)",
"-ms-box-shadow":"10px 5px 15px rgba(40, 40, 40, 0.6)","box-shadow":"10px 5px 15px rgba(40, 40, 40, 0.6)"});this.sideContent.css({width:this.width+"px",height:this.height+"px"});this.searchHighlight.css({width:this.width+"px",height:this.height+"px"});this.sideImg.css({width:this.width+"px",height:this.height+"px"});this.MMBackground.css({width:this.width+"px",height:this.height+"px"});this.loadingImg.css({left:(this.width-LOADING_WIDTH)/2+"px",top:(this.height-LOADING_HEIGHT)/2+"px"});this.initMMItems();
this.slider=null;this.playSliderAfterLoad=!1;this.initEvent();this.onWinResize(windowWidth-leftMargin-rightMargin,windowHeight-topMargin-bottomMargin-40,!0);this.father=a;this.inertiaTimer=-1}zoomSide.prototype.destroy=function(){this.side.empty();this.side.remove()};zoomSide.prototype.hideMM=function(){this.MMBackground.css({display:"none"})};zoomSide.prototype.showMM=function(){this.MMBackground.css({display:"block"})};zoomSide.prototype.setCSS=function(a){this.side.css(a)};
zoomSide.prototype.onResize2=function(a){this.toScale=a/this.width;a=getTransform(this.side[0]);this.zoomObj(this.side,this.origin," scale("+this.toScale+")",a.x,a.y)};zoomSide.prototype.setScale=function(a){this.toScale=a};zoomSide.prototype.getScale=function(){return this.toScale};
zoomSide.prototype.onResize=function(a,b,c){a=getPageWidthHeight(a,b,zoomPageWidth,zoomPageHeight);this.width=a.x;this.height=a.y;this.side.css({width:this.width+"px",height:this.height+"px"});this.sideContent.css({width:this.width+"px",height:this.height+"px"});this.sideImg.css({width:this.width+"px",height:this.height+"px"});this.searchHighlight.css({width:this.width+"px",height:this.height+"px"});this.onMMResize(this.width,this.height);c&&this.tmpImg.css({width:this.width+"px",height:this.height+
"px",top:this.sideTop+"px"});this.setLoadingPosition()};zoomSide.prototype.getSide=function(){return this.side};
zoomSide.prototype.fillContent=function(a){a=parseInt(a);if(a!=this.imageIndex)if(this.imageIndex=a,null!=this.slider&&(this.slider.destroy(),this.slider=null),this.sideContent.css({background:"white"}),this.sideContent.empty(),this.MMBackground.empty(),this.showLoading(),a>originTotalPageCount||1>a)this.side.css({display:"none"}),this.sideContent.css({background:"transparent"}),this.hideLoading();else{this.side.css({display:"block"});this.sideContent.css({background:"white"});var b=this;this.sideImg.load(function(){b.hideLoading();
b.sideImg.css({display:"block"});b.tmpImg.attr("src",getPageDir(a,"large"));try{b.sideContent.append(b.sideImg);b.sideContent.append(b.tmpImg);b.sideContent.append(b.MMBackground);b.sideContent.append(b.searchHighlight)}catch(c){}b.searchHighlight.css({opacity:0.8});b.clearMM();b.initMM();b.initSlider()});this.sideImg.attr("src",getPageDir(a,"large"))}};zoomSide.prototype.setPosition=function(a,b){this.side.css({left:a+"px",top:b+"px"})};zoomSide.prototype.setChildIndex=function(a){this.side.css({"z-index":a})};
zoomSide.prototype.setVisible=function(a){this.side.css({display:a?"block":"none"})};
zoomSide.prototype.resetSize=function(){this.tmpImg.css({display:"none"});var a=this.width*this.toScale>=zoomPageWidth,b=a?zoomPageWidth:this.width*this.toScale,c=a?zoomPageHeight:this.height*this.toScale,d=getTransform(this.side[0]),e=this.width==zoomPageWidth&&b<zoomPageWidth||this.width!=zoomPageWidth;this.toScale=a?this.width*this.toScale/zoomPageWidth:1;var a=bookConfig.minZoomWidth,f=bookConfig.minZoomHeight;if(void 0!=a&&void 0!=f&&0<a&&0<f){b/c>a/f?f=a*c/b:a=f*b/c;var g=Math.min(0,b-a),h=
Math.min(0,c-f),b=Math.max(b,a),c=Math.max(c,f);d.x+=g/2;d.y+=h/2}this.zoomObj(this.side,"0% 0%","scale("+this.toScale+")",d.x,d.y);this.width=b;this.height=c;this.translateX=d.x;this.translateY=d.y;e&&this.tmpImg.css({width:this.width+"px",height:this.height+"px"});this.zoomObj(this.tmpImg,"0% 0%","scale("+this.toScale+")",d.x,d.y);this.tmpImg.css({display:"block"});if(e)this.onResize(b,c);this.addHistoryTexts();zoomBook.bookMap.refreshArea()};
zoomSide.prototype.enterSide=function(){for(var a=0;a<this.youtubeArray.length;a++)this.youtubeArray[a].getPlayEvt(),this.youtubeArray[a].getStopEvt(),this.youtubeArray[a].show();for(a=0;a<this.flashSwfArray.length;a++)this.flashSwfArray[a].show();for(a=0;a<this.buttonArray.length;a++)this.buttonArray[a].show();for(a=0;a<this.videoArray.length;a++)this.videoArray[a].getPlayEvt()==PageEditor.PlayEvt.EVT_PLAY&&this.videoArray[a].playVideo(),this.videoArray[a].getPlayEvt()==PageEditor.PlayEvt.EVT_STOP&&
this.videoArray[a].pauseVideo();for(a=0;a<this.audioArray.length;a++)this.audioArray[a].getPlayEvt()==PageEditor.PlayEvt.EVT_PLAY&&this.audioArray[a].play()};
zoomSide.prototype.leaveSide=function(){for(var a=0;a<this.youtubeArray.length;a++)this.youtubeArray[a].getPlayEvt(),this.youtubeArray[a].getStopEvt(),this.youtubeArray[a].hide();for(a=0;a<this.flashSwfArray.length;a++)this.flashSwfArray[a].hide();for(a=0;a<this.buttonArray.length;a++)this.buttonArray[a].hide();for(a=0;a<this.videoArray.length;a++)this.videoArray[a].getStopEvt()==PageEditor.PlayEvt.EVT_PLAY&&this.videoArray[a].playVideo(),this.videoArray[a].getStopEvt()==PageEditor.PlayEvt.EVT_STOP&&
this.videoArray[a].pauseVideo();for(a=0;a<this.audioArray.length;a++)this.audioArray[a].pause();this.searchHighlight.css({"background-image":""});this.resetSlider()};
zoomSide.prototype.zoom=function(a){if(!0==this.isZomming)return!1;var b=bookConfig.minZoomWidth,c=this.side.width()*this.toScale,d=this.side.height()*this.toScale,a=this.toScale+a,e=this.side.width()*a;if(1>a){if(c<=b)return;e<b&&(a=b/this.side.width())}e=this.side.width()*a;b=this.side.height()*a;origTrans=getTransform(this.side[0]);var f=Point(this.side.offset().left,this.side.offset().top);this.animateZoom(a,(c-e)*((windowWidth/2-f.x)/c)+origTrans.x,(d-b)*((windowHeight/2-f.y)/d)+origTrans.y,
300,"linear")};zoomSide.prototype.noZoom=function(){this.toScale=this.fitW/this.width;this.zoomObj(this.side,"0% 0%","scale("+this.toScale+")",0,0);this.zoomObj(this.tmpImg,"0% 0%","scale("+this.toScale+")",0,0)};zoomSide.prototype.forceReset=function(a){this.width=this.fitW;this.height=this.fitH;this.toScale=1;void 0==a&&(a=getTransform(this.side[0]));this.forceResize(a)};
zoomSide.prototype.forceMax=function(){var a=(this.width*this.toScale-zoomPageWidth)/2;this.width=zoomPageWidth;this.height=zoomPageHeight;var b=getTransform(this.side[0]);b.x+=a;this.forceResize(b)};zoomSide.prototype.animateMax=function(){var a=Math.min(windowWidth,zoomPageWidth);this.animateZoom(a/this.width,(this.width-a)/2,0,300,"linear")};zoomSide.prototype.animateFit=function(){this.animateZoom(this.fitW/this.width,0,0,300,"linear")};
zoomSide.prototype.forceResize=function(a){this.side.css({width:this.width+"px",height:this.height+"px"});this.sideContent.css({width:this.width+"px",height:this.height+"px"});this.sideImg.css({width:this.width+"px",height:this.height+"px"});this.searchHighlight.css({width:this.width+"px",height:this.height+"px"});this.onMMResize(this.width,this.height);this.tmpImg.css({width:this.width+"px",height:this.height+"px"});this.toScale=1;this.zoomObj(this.side,"0% 0%","scale("+this.toScale+")",a.x,a.y);
this.zoomObj(this.tmpImg,"0% 0%","scale("+this.toScale+")",a.x,a.y);this.translateX=a.x;this.translateY=a.y};zoomSide.prototype.getScaleFromFit=function(){return this.width*this.toScale/this.fitW};zoomSide.prototype.getCenterTransform=function(){return Point((this.fitW-this.width*this.toScale)/2,0)};zoomSide.prototype.zoomToMax=function(){var a=zoomPageWidth/this.width;this.animateZoom(a,(this.width*this.toScale-this.width*a)/2+this.translateX,0,200)};
zoomSide.prototype.zoomToFit=function(){this.animateZoom(this.getScaleFromFit(),0,0,200)};zoomSide.prototype.zoomObj=function(a,b,c,d,e){d||(d=0);e||(e=0);d=translate(d,e);a.css({"-webkit-transform-origin":b,"-moz-transform-origin":b,"-ms-transform-origin":b,"-o-transform-origin":b,"-webkit-transform":d+c,"-moz-transform":d+c,"-ms-transform":d+c,"-o-transform":d+c})};zoomSide.prototype.setTranslate=function(a,b,c){b=translate(b,c);a.css({"-webkit-transform":b,"-moz-transform":b,"-o-transform":b,"-ms-transform":b})};
zoomSide.prototype.setXY=function(a,b){this.x=a;this.y=b};var originPoint22,inteval;zoomSide.prototype.animateTranslate=function(a,b,c){a||(a=0);b||(b=0);c||(c=25);var d=getTransform(this.side[0]),e=this;$(d).animate({x:a,y:b},{duration:c,easing:"easeOutSine",complete:function(){e.zoomObj(e.side,e.origin," scale("+e.toScale+")",d.x,d.y);e.zoomObj(e.tmpImg,e.origin," scale("+e.toScale+")",d.x,d.y)}})};
zoomSide.prototype.animateZoom=function(a,b,c,d,e){if(!0!=this.isZomming){this.isZomming=!0;a||(a=this.toScale);b||(b=0);c||(c=0);d||(d=25);void 0==e&&(e="easeOutSine");var f=getTransform(this.side[0]),g={scale:this.toScale,x:f.x,y:f.y},h=this;if("linear"==e)var j=0,k=a-g.scale,m=b-g.x,l=c-g.y,n=window.setInterval(function(){j++;var d=g.scale+k*j/10,e=g.x+m*j/10,f=g.y+l*j/10;if(j==10){d=a;e=b;f=c}h.tmpImg.css({display:"none"});h.zoomObj(h.side,h.origin," scale("+d+")",e,f);h.zoomObj(h.tmpImg,h.origin,
" scale("+d+")",e,f);h.tmpImg.css({display:"block"});if(h.onZoomTimer!=void 0)h.onZoomTimer(e,f,h.width*d);if(j==10){window.clearInterval(n);h.toScale=a;h.resetSize();h.isZomming=false;if(h.onZoomTimerEnd!=void 0)h.onZoomTimerEnd()}},Math.floor(d/10));else $(g).animate({scale:a,x:b,y:c},{duration:d,easing:e,step:function(){h.tmpImg.css({display:"none"});h.zoomObj(h.side,h.origin," scale("+g.scale+")",g.x,g.y);h.zoomObj(h.tmpImg,h.origin," scale("+g.scale+")",g.x,g.y);h.tmpImg.css({display:"block"});
if(h.onZoomTimer!=void 0)h.onZoomTimer(g.x,g.y,h.width*g.scale)},complete:function(){h.toScale=a;h.resetSize();h.isZomming=false;if(h.onZoomTimerEnd!=void 0)h.onZoomTimerEnd()}})}};zoomSide.prototype.onWinResize=function(a,b,c){var d=getPageWidthHeight(a,b,zoomPageWidth,zoomPageHeight);this.fitW=d.x;this.fitH=d.y;if(c)this.onResize(a,b,!0)};zoomSide.prototype.showLoading=function(){this.setLoadingPosition();this._super()};
zoomSide.prototype.setLoadingPosition=function(){var a=(this.width-LOADING_WIDTH)/2,b=(this.height-LOADING_HEIGHT)/2,c=this.side.offset().top,d=getTransform(this.side[0]),c=c+d.y;c+b*this.toScale>windowHeight-2*LOADING_HEIGHT&&(b-=c+b*this.toScale-windowHeight+5*LOADING_HEIGHT);this.loadingImg.css({left:a+"px",top:b+"px"})};
zoomSide.prototype.translate=function(a,b){this.tmpImg.css({display:"none"});this.zoomObj(this.side,this.origin," scale("+this.toScale+")",a,b);this.zoomObj(this.tmpImg,this.origin," scale("+this.toScale+")",a,b);this.tmpImg.css({display:"block"})};zoomSide.prototype.isFit=function(){return this.toScale==this.fitW/this.width};
zoomSide.prototype.animateBack=function(a){var b=getTransform(this.side[0]),c={x:b.x,y:b.y,scale:this.toScale},d=this.fitW/this.width,e=this;e.tmpImg.css({display:"none"});$(c).animate({x:0,y:0,scale:d},{duration:200,step:function(){e.zoomObj(e.side,e.origin," scale("+c.scale+")",c.x,c.y);e.zoomObj(e.tmpImg,e.origin," scale("+c.scale+")",c.x,c.y)},complete:function(){e.toScale=d;e.tmpImg.css({display:"block"});a()}})};
zoomSide.prototype.showPage=function(){var a=this.imageIndex;a>originTotalPageCount||1>a?(this.side.css({display:"none"}),this.sideContent.css({background:"transparent"})):(this.side.css({display:"block"}),this.sideContent.css({background:"white"}))};zoomSide.prototype.hidePage=function(){this.side.css({display:"none"})};zoomSide.prototype.getWidth=function(){return this.width*this.toScale};zoomSide.prototype.getHeight=function(){return this.height*this.toScale};zoomSide.prototype.getScale=function(){return this.toScale};
zoomSide.prototype.left=function(){return this.side.offset().left};zoomSide.prototype.top=function(){return this.side.offset().top};zoomSide.prototype.setZooming=function(a){this.isZomming=a};
zoomSide.prototype.initEvent=function(){var a=this,b=Point(0,0),c=Point(0,0),d=Point(0,0),e=!1,f=!1,g=null,h=!1,j,k=0,m=0,l;this.side.bind(_event._down,function(k){if(bookType==BookType.zoom_book){if(!0==a.isZomming||!0==zoomBook.isFlipping)return!1;j=a.toScale;var l=a.side[0];try{l.setCapture?l.setCapture():window.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP)}catch(m){}-1!=a.inertiaTimer&&(window.clearInterval(a.inertiaTimer),a.inertiaTimer=-1);k=isTouch?k.originalEvent.touches:[k];l=getTransform(a.side[0]);
a.translateX=l.x;a.translateY=l.y;1==k.length?(e=!0,f=!1,b=Point(k[0].pageX,k[0].pageY),g=Point(a.side.position().left,a.side.position().top)):2==k.length&&(e=!1,f=!0,b=Point(k[0].pageX,k[0].pageY),d=Point(k[1].pageX,k[1].pageY),c=Point((k[0].pageX+k[1].pageX)/2,(k[0].pageY+k[1].pageY)/2),g=Point(a.side.offset().left,a.side.offset().top));h=!1;stopEvent(k[0])}});this.side.bind(_event._move,function(o){if(bookType==BookType.zoom_book){o=isTouch?o.originalEvent.touches:[o];zoomBook.bookMap.refreshArea();
e?a.side.css({cursor:"move"}):a.side.css({cursor:""});if(e){var n=1*(o[0].pageX-b.x)+a.translateX,q=1*(o[0].pageY-b.y)+a.translateY,s=(new Date).getTime(),v=Math.sqrt(Math.pow(n-k,2)+Math.pow(q-m,2)),t=0;100>s-l&&0<s-l&&(t=v/(s-l),Math.min(300*t,300),v=Math.asin((k-n)/v),Math.cos(v),Math.sin(v));a.zoomObj(a.side,a.origin," scale("+a.toScale+")",n,q);a.zoomObj(a.tmpImg,a.origin," scale("+a.toScale+")",n,q);k=n;m=q;l=s}else if(f)q=Point(o[0].pageX,o[0].pageY),s=Point(o[1].pageX,o[1].pageY),n=Math.sqrt(Math.pow(b.x-
d.x,2)+Math.pow(b.y-d.y,2)),q=Math.sqrt(Math.pow(q.x-s.x,2)+Math.pow(q.y-s.y,2)),a.toScale=Math.max(q/n*j,0.5),q=(c.x-g.x)/j,n=(c.y-g.y)/j,a.side.width(),a.side.height(),q=(j-a.toScale)*a.side.width()*(q/a.side.width()),s=(j-a.toScale)*a.side.height()*(n/a.side.height()),n=a.translateX+q,q=a.translateY+s,a.zoomObj(a.side,a.origin," scale("+a.toScale+")",n,q),a.zoomObj(a.tmpImg,a.origin," scale("+a.toScale+")",n,q),h=!0,k=n,m=q;else if(!isPad()){if(!0==a.isZomming||!1==zoomBook.controlBar.moveByMousePosition)return!1;
var r=toolBar.getTopHeight()-20,q=windowHeight-toolBar.getBottomHeight()-20,n=windowWidth-0,q=q-r,t=a.getWidth(),s=a.getHeight(),u=o[0].pageX,v=o[0].pageY,w=t*((u-0)/n),r=s*((v-r)/q),B=getTransform(a.side[0]),n=t>n?Math.min(u-w-a.x,0):B.x,q=s>q?Math.min(v-r-a.y,0):B.y;!0==a.firstEnter?(a.firstEnter=!1,a.animateZoom(a.toScale,n,q,150,"linear")):(a.zoomObj(a.side,a.origin," scale("+a.toScale+")",n,q),a.zoomObj(a.tmpImg,a.origin," scale("+a.toScale+")",n,q))}stopEvent(o[0])}});var n=function(){if(bookType==
BookType.zoom_book){a.side.css({cursor:""});a.translateX=k;a.translateY=m;var b=a.side[0];try{b.releaseCapture?b.releaseCapture():window.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP)}catch(c){}h&&(a.resetSize(),a.width<5*a.fitW/6&&!0==f&&(toolBar.btnZoom.trigger(_event._end),toolBar.btnZoom.trigger(_event._leave)));h=f=e=!1;!1==isTouchDevice()&&(a.firstEnter=!0)}};this.side.bind(_event._end,n);this.side.bind(_event._leave,n);this.side.bind(_event._enter,function(){!1==isTouchDevice()&&(a.firstEnter=
!0);return!1});isTouch&&(this.side.hammer().on("swipeleft",function(){if(!0==zoomBook.isFlipping)return!1;2==bookType&&(rightToLeft?previousPageFun():nextPageFun())}),this.side.hammer().on("swiperight",function(){if(!0==zoomBook.isFlipping)return!1;2==bookType&&(rightToLeft?nextPageFun():previousPageFun())}));this.side.hammer().on("doubletap",function(){if(zoomBook.isFlipping==true||this.isZomming==true||bookType!=BookType.zoom_book)return false;a.animateFit();window.setTimeout(function(){if(bookType!=
BookType.zoom_book)return false;toolBar.btnZoom.trigger(_event._end);toolBar.btnZoom.trigger(_event._leave)},300);return false});2==browserType&&(_event._mousewheel="DOMMouseScroll");isIE()&&(_event._mousewheel="mousewheel");this.side.bind(_event._mousewheel,function(b){if(bookType!=BookType.zoom_book||a.isZomming==true||zoomBook.isFlipping==true)return false;var c=b.originalEvent,d=Math.max(-1,Math.min(1,c.wheelDelta||-c.detail)),e=-0.5*a.toScale;d>0&&(e=1*a.toScale);var d=a.toScale,e=d+e,f=Point(c.pageX,
c.pageY),g=Point(a.side.offset().left,a.side.offset().top),c=getTransform(a.side[0]),h=(f.x-g.x)/d,f=(f.y-g.y)/d;a.side.width();a.side.height();h=(d-e)*a.side.width()*(h/a.side.width());d=(d-e)*a.side.height()*(f/a.side.height());a.animateZoom(e,h+c.x,d+c.y,400,"linear");stopEvent(b);return false});this.side.speed(this.inertiaMove.bind(this))};
zoomSide.prototype.inertiaMove=function(a,b){if(!0!=this.isZomming){var c;c=120*windowWidth/1600;if(a<-c)rightToLeft?previousPageFun():nextPageFun();else if(a>c)rightToLeft?nextPageFun():previousPageFun();else{var d=a,e=b,f=a/20,g=b/20,h=0,j=window.setInterval(function(){if(!0==this.isZomming)window.clearInterval(j);else{var a=getTransform(this.side[0]);d-=f;e-=g;a.x+=d;a.y+=e;this.zoomObj(this.side,this.origin," scale("+this.toScale+")",a.x,a.y);this.zoomObj(this.tmpImg,this.origin," scale("+this.toScale+
")",a.x,a.y);if(20==++h){window.clearInterval(j);var b=this.getWidth(),a=this.x+a.x;a>windowWidth&&(rightToLeft?nextPageFun():previousPageFun());a<-b&&(rightToLeft?previousPageFun():nextPageFun())}}}.bind(this),20);this.inertiaTimer=j}}};zoomSide.prototype.moveUp=function(){this.inertiaMove(0,-50)};zoomSide.prototype.moveDown=function(){this.inertiaMove(0,50)};
zoomSide.prototype.moveLeft=function(){var a=getTransform(this.side[0]),b=this.getWidth();this.x+a.x<windowWidth-b?rightToLeft?previousPageFun():nextPageFun():this.inertiaMove(-20,0)};zoomSide.prototype.moveRight=function(){var a=getTransform(this.side[0]);this.getWidth();0<this.x+a.x?rightToLeft?nextPageFun():previousPageFun():this.inertiaMove(20,0)};zoomSide.prototype.initMM=function(){this._super();AddNotesByContainers(BookType.zoom_book,this.imageIndex,this.MMBackground)};
zoomSide.prototype.addHistoryTexts=function(){AddNotesByContainers(BookType.zoom_book,this.imageIndex,this.MMBackground)};zoomSide.prototype.highlightSearch=function(a){highlightSearchFun(this.searchHighlight,a)};zoomSide.prototype.clearHighlight=function(){clearHighlightFun(this.searchHighlight)};zoomSide.extend(BookSide);
function DoubleZoomSide(a,b){zoomSide.call(this,a);this.isLeft=b;this.brother=null;!0==this.isLeft?this.side.css({"border-left":"1px solid rgba(200, 200, 200, 0.6)","border-right":"0px solid rgba(200, 200, 200, 0.6)","border-top":"1px solid rgba(200, 200, 200, 0.6)","border-bottom":"1px solid rgba(200, 200, 200, 0.6)"}):this.side.css({"border-left":"0px solid rgba(200, 200, 200, 0.6)","border-right":"1px solid rgba(200, 200, 200, 0.6)","border-top":"1px solid rgba(200, 200, 200, 0.6)","border-bottom":"1px solid rgba(200, 200, 200, 0.6)"});
var c=parseBool(bookConfig.addPaperCoil);this.isLeft?(this.midShadow=$("<div class='leftShadow'></div>"),this.midShadow.css({width:userConfig.leftShadowWidth+"px",opacity:userConfig.leftShadowAlpha}),c&&(this.midCoil=$("<div class='leftPaperCoil'></div>"))):(this.midShadow=$("<div class='rightShadow'></div>"),this.midShadow.css({width:userConfig.rightShadowWidth+"px",opacity:userConfig.rightShadowAlpha}),c&&(this.midCoil=$("<div class='rightPaperCoil'></div>")));this.side.append(this.midShadow);this.midShadow.css("z-index",
5);this.midCoil&&(this.side.append(this.midCoil),this.midCoil.css("z-index",5));this.bookCenter=parseBool(bookConfig.retainBookCenter);this.fingerDown=!1}DoubleZoomSide.prototype.setBrother=function(a){this.brother=a};DoubleZoomSide.prototype.refreshPosition=function(a,b,c){a=this.isLeft?a-c:a+c;this.toScale=c/=this.width;this.zoomObj(this.side,this.origin," scale("+this.toScale+")",a,b);this.zoomObj(this.tmpImg,this.origin," scale("+this.toScale+")",a,b)};
DoubleZoomSide.prototype.onResize=function(a,b,c){var d=getPageWidthHeight(a,b,zoomPageWidth,zoomPageHeight);this.width=d.x;this.height=d.y;this.side.css({width:this.width+"px",height:this.height+"px"});this.sideContent.css({width:this.width+"px",height:this.height+"px"});this.sideImg.css({width:this.width+"px",height:this.height+"px"});this.searchHighlight.css({width:this.width+"px",height:this.height+"px"});this.onMMResize(this.width,this.height);c&&this.tmpImg.css({width:this.width+"px",height:this.height+
"px",top:this.sideTop+"px"});this.setLoadingPosition();try{var e=getTransform(this.side[0]);this.brother.refreshPosition(e.x,e.y,this.getWidth())}catch(f){}try{a/=450,this.midShadow.css({height:b+"px",width:Math.floor(this.isLeft?a*userConfig.leftShadowWidth:a*userConfig.rightShadowWidth)+"px"}),this.midCoil&&this.midCoil.css({height:b+"px"})}catch(g){}};
DoubleZoomSide.prototype.noZoom=function(){this.toScale=this.fitW/this.width;this.isLeft?(this.zoomObj(this.side,"0% 0%","scale("+this.toScale+")",0,0),this.zoomObj(this.tmpImg,"0% 0%","scale("+this.toScale+")",0,0)):(this.zoomObj(this.side,"0% 0%","scale("+this.toScale+")",this.fitW,0),this.zoomObj(this.tmpImg,"0% 0%","scale("+this.toScale+")",this.fitW,0))};
DoubleZoomSide.prototype.forceReset=function(a){this.width=this.fitW;this.height=this.fitH;this.toScale=1;void 0==a&&(a=getTransform(this.side[0]));if(!0==this.bookCenter&&(1>=this.imageIndex&&(a.x-=this.fitW/2),this.imageIndex>=totalPageCount))a.x+=this.fitW/2;this.forceResize(a)};
DoubleZoomSide.prototype.forceMax=function(){var a=(this.width*this.toScale-zoomPageWidth)/2;this.width=zoomPageWidth;this.height=zoomPageHeight;var b=getTransform(this.side[0]);b.x+=2*a;!0==this.bookCenter?this.isLeft?0==this.imageIndex?b.x-=zoomPageWidth/2:this.imageIndex==totalPageCount&&(b.x+=zoomPageWidth/2):b.x=1==this.imageIndex?b.x+zoomPageWidth/2:this.imageIndex>totalPageCount?b.x+3*zoomPageWidth/2:b.x+zoomPageWidth:this.isLeft||(b.x+=zoomPageWidth);this.forceResize(b)};
DoubleZoomSide.prototype.animateMax=function(){var a=Math.min(windowWidth,zoomPageWidth),b=a/this.width,a=(this.width-a)/2,a=2*a;!0==this.bookCenter?this.isLeft?0==this.imageIndex?a-=zoomPageWidth/2:this.imageIndex==totalPageCount&&(a+=zoomPageWidth/2):a=1==this.imageIndex?a+zoomPageWidth/2:this.imageIndex>totalPageCount?a+3*zoomPageWidth/2:a+zoomPageWidth:this.isLeft||(a+=zoomPageWidth);this.animateZoom(b,a,0,300,"linear")};
DoubleZoomSide.prototype.animateFit=function(){var a=this.fitW/this.width,b=0;this.isLeft||(b+=this.fitW);!0==this.bookCenter&&(1>=this.imageIndex&&(b-=this.fitW/2),this.imageIndex>=totalPageCount&&(b+=this.fitW/2));this.animateZoom(a,b,0,300,"linear")};
DoubleZoomSide.prototype.animateBack=function(){var a=getTransform(this.side[0]),b={x:a.x,y:a.y,scale:this.toScale},c=this.fitW/this.width,a=this.isLeft?0:this.fitW;!0==this.bookCenter&&(1>=this.imageIndex&&(a-=this.fitW/2),this.imageIndex>=totalPageCount&&(a+=this.fitW/2));var d=this;d.tmpImg.css({display:"none"});$(b).animate({x:a,y:0,scale:c},{duration:200,step:function(){d.zoomObj(d.side,d.origin," scale("+b.scale+")",b.x,b.y);d.zoomObj(d.tmpImg,d.origin," scale("+b.scale+")",b.x,b.y)},complete:function(){d.toScale=
c;d.tmpImg.css({display:"block"});callBack()}})};DoubleZoomSide.prototype.onZoomTimer=function(a,b,c){this.brother.refreshPosition(a,b,c);!1==this.brother.isZomming&&(this.brother.isZomming=!0)};DoubleZoomSide.prototype.onZoomTimerEnd=function(){this.brother.resetSize();this.brother.isZomming=!1};DoubleZoomSide.prototype.getCenterTransform=function(){return Point(this.fitW-this.width*this.toScale,0)};
DoubleZoomSide.prototype.initEvent=function(){var a=this,b=Point(0,0),c=Point(0,0),d=Point(0,0),e=!1,f=!1,g=null,h=!1,j,k=0,m=0,l;this.side.bind(_event._down,function(k){if(bookType==BookType.zoom_book){if(!0==a.isZomming||!0==zoomBook.isFlipping)return!1;j=a.toScale;var l=a.side[0];try{l.setCapture?l.setCapture():window.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP)}catch(m){}!0==a.isLeft&&(a.fingerDown=!0);-1!=a.inertiaTimer&&(window.clearInterval(a.inertiaTimer),a.inertiaTimer=-1);k=isTouch?k.originalEvent.touches:
[k];l=getTransform(a.side[0]);a.translateX=l.x;a.translateY=l.y;1==k.length?(e=!0,f=!1,b=Point(k[0].pageX,k[0].pageY),g=Point(a.side.position().left,a.side.position().top)):2==k.length&&(e=!1,f=!0,b=Point(k[0].pageX,k[0].pageY),d=Point(k[1].pageX,k[1].pageY),c=Point((k[0].pageX+k[1].pageX)/2,(k[0].pageY+k[1].pageY)/2),g=Point(a.side.offset().left,a.side.offset().top));h=!1;stopEvent(k[0])}});this.side.bind(_event._move,function(o){if(!(bookType!=BookType.zoom_book||!0==a.brother.fingerDown))if(o=
isTouch?o.originalEvent.touches:[o],zoomBook.bookMap.refreshArea(),e?a.side.css({cursor:"move"}):a.side.css({cursor:""}),e){var n=1*(o[0].pageX-b.x)+a.translateX,q=1*(o[0].pageY-b.y)+a.translateY,s=(new Date).getTime(),v=Math.sqrt(Math.pow(n-k,2)+Math.pow(q-m,2)),t=0;100>s-l&&0<s-l&&(t=v/(s-l),Math.min(300*t,300),v=Math.asin((k-n)/v),Math.cos(v),Math.sin(v));a.zoomObj(a.side,a.origin," scale("+a.toScale+")",n,q);a.zoomObj(a.tmpImg,a.origin," scale("+a.toScale+")",n,q);a.brother.refreshPosition(n,
q,a.getWidth());k=n;m=q;l=s}else if(f)n=Point(o[0].pageX,o[0].pageY),s=Point(o[1].pageX,o[1].pageY),q=Math.sqrt(Math.pow(b.x-d.x,2)+Math.pow(b.y-d.y,2)),n=Math.sqrt(Math.pow(n.x-s.x,2)+Math.pow(n.y-s.y,2)),a.toScale=Math.max(n/q*j,0.5),q=(c.x-g.x)/j,n=(c.y-g.y)/j,a.side.width(),a.side.height(),q=(j-a.toScale)*a.side.width()*(q/a.side.width()),s=(j-a.toScale)*a.side.height()*(n/a.side.height()),n=a.translateX+q,q=a.translateY+s,a.zoomObj(a.side,a.origin," scale("+a.toScale+")",n,q),a.zoomObj(a.tmpImg,
a.origin," scale("+a.toScale+")",n,q),a.brother.refreshPosition(n,q,a.getWidth()),h=!0,k=n,m=q;else if(!isPad()&&!(!0==a.isZomming||!1==zoomBook.controlBar.moveByMousePosition)&&1<=a.imgIndex&&a.imgIndex<=totalPageCount){var r=toolBar.getTopHeight()-20,q=windowHeight-toolBar.getBottomHeight()-20,n=windowWidth-0,q=q-r,v=a.getWidth(),s=a.getHeight();!0==a.bookCenter?1<a.imgIndex&&a.imgIndex<totalPageCount&&(v*=2):v*=2;var t=o[0].pageX,o=o[0].pageY,u=(o-r)/q,r=Math.round(v*((t-0)/n)),u=Math.round(s*
u),w=getTransform(a.side[0]);v>n?(n=t-r-a.x,!0==a.bookCenter?1<a.imgIndex&&a.imgIndex<totalPageCount&&(a.isLeft||(n+=a.getWidth())):a.isLeft||(n+=a.getWidth())):n=w.x;q=s>q?o-u-a.y:w.y;a.zoomObj(a.side,a.origin," scale("+a.toScale+")",n,q);a.zoomObj(a.tmpImg,a.origin," scale("+a.toScale+")",n,q);a.brother.refreshPosition(n,q,a.getWidth())}});var n=function(){if(bookType==BookType.zoom_book){a.side.css({cursor:""});a.translateX=k;a.translateY=m;var b=a.side[0];try{b.releaseCapture?b.releaseCapture():
window.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP)}catch(c){}h&&(a.resetSize(),a.brother.resetSize(),a.width<5*a.fitW/6&&!0==f&&(toolBar.btnZoom.trigger(_event._end),toolBar.btnZoom.trigger(_event._leave)));!0==a.isLeft&&(a.fingerDown=f);h=f=e=!1;!1==isTouchDevice()&&(a.firstEnter=!0)}};this.side.bind(_event._end,n);this.side.bind(_event._leave,n);this.side.bind(_event._enter,function(){!1==isTouchDevice()&&(a.firstEnter=!0);return!1});this.side.hammer().on("doubletap",function(){if(!0==zoomBook.isFlipping||
!0==this.isZomming||bookType!=BookType.zoom_book)return!1;a.animateFit();window.setTimeout(function(){if(bookType!=BookType.zoom_book)return!1;toolBar.btnZoom.trigger(_event._end);toolBar.btnZoom.trigger(_event._leave)},300);return!1});2==browserType&&(_event._mousewheel="DOMMouseScroll");isIE()&&(_event._mousewheel="mousewheel");this.side.bind(_event._mousewheel,function(b){if(bookType!=BookType.zoom_book||a.isZomming==true||zoomBook.isFlipping==true)return false;var c=b.originalEvent,d=Math.max(-1,
Math.min(1,c.wheelDelta||-c.detail)),e=-0.5*a.toScale;d>0&&(e=1*a.toScale);var d=a.toScale,e=d+e,f=Point(c.pageX,c.pageY),g=Point(a.side.offset().left,a.side.offset().top),c=getTransform(a.side[0]),h=(f.x-g.x)/d,f=(f.y-g.y)/d;a.side.width();a.side.height();h=(d-e)*a.side.width()*(h/a.side.width());d=(d-e)*a.side.height()*(f/a.side.height());a.animateZoom(e,h+c.x,d+c.y,400,"linear");stopEvent(b);return false});this.side.speed(this.inertiaMove.bind(this))};
DoubleZoomSide.prototype.inertiaMove=function(a,b){if(!0!=this.isZomming){var c;c=120*windowWidth/1600;if(a<-c)rightToLeft?previousPageFun():nextPageFun();else if(a>c)rightToLeft?nextPageFun():previousPageFun();else{var d=a,e=b,f=a/20,g=b/20,h=0;window.clearInterval(this.inertiaTimer);this.inertiaTimer=window.setInterval(function(){if(!0==this.isZomming)window.clearInterval(this.inertiaTimer);else{var a=getTransform(this.side[0]);d-=f;e-=g;a.x+=d;a.y+=e;this.zoomObj(this.side,this.origin," scale("+
this.toScale+")",a.x,a.y);this.zoomObj(this.tmpImg,this.origin," scale("+this.toScale+")",a.x,a.y);this.brother.refreshPosition(a.x,a.y,this.getWidth());if(20==++h){window.clearInterval(this.inertiaTimer);var b=this.getWidth(),a=this.x+a.x;if(this.isLeft&&a>windowWidth||!this.isLeft&&a>windowWidth+b)rightToLeft?nextPageFun():previousPageFun();if(this.isLeft&&a<-2*b||!this.isLeft&&a<-b)rightToLeft?previousPageFun():nextPageFun()}}}.bind(this),20)}}};
zoomSide.prototype.moveLeft=function(){var a=getTransform(this.side[0]),b=this.getWidth(),a=this.x+a.x;this.isLeft&&a<windowWidth-2*b||!this.isLeft&&a<windowWidth-b?rightToLeft?previousPageFun():nextPageFun():this.inertiaMove(-20,0)};zoomSide.prototype.moveRight=function(){var a=getTransform(this.side[0]),b=this.getWidth(),a=this.x+a.x;this.isLeft&&0<a||!this.isLeft&&a>b?rightToLeft?nextPageFun():previousPageFun():this.inertiaMove(20,0)};DoubleZoomSide.extend(zoomSide);function initZoomBook(a){this.doublePage=!0;this.bookContainer=$("<div style='left:0px;right:0px;top:0px;bottom:0px;position:absolute;display:none;'></div>");this.book=$("<div id='zoomBook'></div>");!1==this.doublePage?(this.prePage=new zoomSide(this.book),this.nextPage=new zoomSide(this.book),this.showPage=new zoomSide(this.book)):(this.prePage=new DoubleZoomPage(this.book),this.nextPage=new DoubleZoomPage(this.book),this.showPage=new DoubleZoomPage(this.book));this.width=zoomPageWidth;this.height=
zoomPageHeight;this.prePage.setChildIndex(1);this.showPage.setChildIndex(3);this.nextPage.setChildIndex(2);this.diffPageCount=0;this.currentIndex=1;this.showingPage=this.flipPage=null;this.isFlipping=!1;this.bookMap=new ZoomSideMap(this);isTouch?this.initEvent():(this.controlBar=new zoomControlBar(this.bookContainer),this.controlBar.setPosition((windowWidth-this.controlBar.width)/2,20));a.append(this.bookContainer);this.bookContainer.append(this.book);this.book.css({width:this.width+"px",height:this.height+
"px",position:"absolute"});this.fillNear(1)}initZoomBook.prototype.movePageUp=function(){this.showPage.moveUp()};initZoomBook.prototype.movePageDown=function(){this.showPage.moveDown()};initZoomBook.prototype.movePageLeft=function(){this.showPage.moveLeft()};initZoomBook.prototype.movePageRight=function(){this.showPage.moveRight()};
initZoomBook.prototype.changePageMode=function(a){this.doublePage!=a&&(this.doublePage=a,this.prePage.destroy(),this.showPage.destroy(),this.nextPage.destroy(),!1==this.doublePage?(this.prePage=new zoomSide(this.book),this.nextPage=new zoomSide(this.book),this.showPage=new zoomSide(this.book)):(this.prePage=new DoubleZoomPage(this.book),this.nextPage=new DoubleZoomPage(this.book),this.showPage=new DoubleZoomPage(this.book)),this.prePage.setChildIndex(1),this.showPage.setChildIndex(3),this.nextPage.setChildIndex(2),
this.onResize(windowWidth,windowHeight),this.addHistoryTexts())};
initZoomBook.prototype.onResize=function(a,b){var c=getPageWidthHeight(a,b,zoomPageWidth,zoomPageHeight);this.width=c.x;this.height=c.y;!1==this.doublePage?this.book.css({width:this.width+"px",height:this.height+"px",left:(a-this.width)/2+leftMargin+"px",top:(b-this.height)/2+topMargin+"px"}):this.book.css({width:2*this.width+"px",height:this.height+"px",left:(a-2*this.width)/2+leftMargin+"px",top:(b-this.height)/2+topMargin+"px"});this.prePage.onWinResize(a,b,!0);this.showPage.onWinResize(a,b);this.nextPage.onWinResize(a,
b,!0);this.controlBar&&this.controlBar.setPosition((windowWidth-this.controlBar.width)/2,20);!1==this.doublePage?(this.prePage.setXY((a-this.width)/2+leftMargin,(b-this.height)/2+topMargin),this.showPage.setXY((a-this.width)/2+leftMargin,(b-this.height)/2+topMargin),this.nextPage.setXY((a-this.width)/2+leftMargin,(b-this.height)/2+topMargin),!1==rightToLeft?(this.prePage.translate(-(a-this.width)/2-this.prePage.getWidth()-leftMargin-10,0),this.nextPage.translate((a-this.width)/2+this.width+rightMargin+
10,0)):(this.nextPage.translate(-(a-this.width)/2-this.prePage.getWidth()-leftMargin-10,0),this.prePage.translate((a-this.width)/2+this.width+rightMargin+10,0))):(this.prePage.setXY((a-2*this.width)/2+leftMargin,(b-this.height)/2+topMargin),this.showPage.setXY((a-2*this.width)/2+leftMargin,(b-this.height)/2+topMargin),this.nextPage.setXY((a-2*this.width)/2+leftMargin,(b-this.height)/2+topMargin),!1==rightToLeft?(this.prePage.translate(-(a-2*this.width)/2-this.prePage.getWidth()-leftMargin-10,0),this.nextPage.translate((a-
2*this.width)/2+2*this.width+rightMargin+10,0)):(this.nextPage.translate(-(a-2*this.width)/2-this.prePage.getWidth()-leftMargin-10,0),this.prePage.translate((a-2*this.width)/2+2*this.width+rightMargin+10,0)));this.bookMap.resize(a,b)};initZoomBook.prototype.setTranslate=function(a,b,c){b=translate(b,c);a.css({"-webkit-transform":b,"-moz-transform":b,"-o-transform":b,"-ms-transform":b})};
initZoomBook.prototype.gotoPage=function(a){this.prePage.clearHighlight();this.nextPage.clearHighlight();if(this.currentIndex==a||1>a||a>originTotalPageCount||this.isFlipping){if(1>a||a>originTotalPageCount)_tipsBox.setCaption(1>a?"This is the first page":"This is the last page"),_tipsBox.showTipsBox()}else{this.isFlipping=!0;this.diffPageCount=a-this.currentIndex;var b=0,c=0,d=this.showPage,e=void 0,f=this,g;g=!1==this.doublePage?Point(0,(windowWidth-this.width)/2+10+this.width):Point(0,(windowWidth-
2*this.width)/2+10+2*this.width);var h=d.getCenterTransform();this.currentIndex>a?(e=this.prePage,!1==rightToLeft?(b=g.y+rightMargin,c=-g.y-leftMargin):(b=-g.y-leftMargin,c=g.y+rightMargin)):(e=this.nextPage,!1==rightToLeft?(b=-g.y-leftMargin,c=g.y+rightMargin):(b=g.y+rightMargin,c=-g.y-leftMargin));tragetToLeft=h.x;e.fillContent(a);void 0!=e.adjustTarget&&(tragetToLeft=e.adjustTarget(tragetToLeft,d.getWidth()));(function(){d.setZooming(true);e.setZooming(true);var g=getTransform(d.side[0]);e.forceReset();
var h=d.getScaleFromFit(),m=d.getScale(),l=d.getScale()/h,n=30,o=bookConfig.flippingTime*1E3;o!=void 0&&o>0&&(n=o/20);var p=0,q=window.setInterval(function(){var o=Point(0,0),v=Point(0,0);o.x=$.easing.swing(null,p,g.x,b-g.x,n);o.y=$.easing.swing(null,p,g.y,-g.y,n);v.x=$.easing.swing(null,p,c,tragetToLeft-c,n);var t=1,r=1,t=$.easing.swing(null,p,m,l-m,n),r=$.easing.swing(null,p,1,h-1,n);p++;d.setScale(t);d.translate(o.x,o.y);e.setScale(r);e.translate(v.x,v.y);if(p>=n){window.clearInterval(q);window.setTimeout(function(){d.setZooming(false);
e.setZooming(false);d.resetSize();e.resetSize();f.showPage.noZoom();auto_player.resetTimer();f.changePage();f.endFlip(a);f.isFlipping=false;f.bookMap.fillContent(f.currentIndex)},20)}},20)})()}};initZoomBook.prototype.changePage=function(){var a=null;0<this.diffPageCount?(a=this.showPage,this.showPage=this.nextPage,this.nextPage=this.prePage):(a=this.nextPage,this.nextPage=this.showPage,this.showPage=this.prePage);this.prePage=a;this.prePage.resetSlider();this.showPage.playSlider();this.nextPage.resetSlider()};
initZoomBook.prototype.addSearchHighlight=function(){this.showPage.highlightSearch(this.currentIndex)};initZoomBook.prototype.clearSearchHighlight=function(){this.showPage.clearHighlight()};
initZoomBook.prototype.endFlip=function(a){this.currentIndex=a;this.fillNear(a);setCurrentIndexTextField(this.currentIndex,this.doublePage);window.location.hash="#p="+this.currentIndex;sendvisitinfo(1,this.currentIndex);thumbnail.clearHighLight();thumbnail.setHighLight(this.currentIndex);!1==this.doublePage?!1==rightToLeft?(this.prePage.translate(-(windowWidth-this.width)/2-this.width-10-leftMargin,0),this.nextPage.translate((windowWidth-this.width)/2+this.width+10+rightMargin,0)):(this.nextPage.translate(-(windowWidth-
this.width)/2-this.width-10-leftMargin,0),this.prePage.translate((windowWidth-this.width)/2+this.width+10+rightMargin,0)):!1==rightToLeft?(this.prePage.translate(-(windowWidth-2*this.width)/2-2*this.width-10-leftMargin,0),this.nextPage.translate((windowWidth-2*this.width)/2+2*this.width+10+rightMargin,0)):(this.nextPage.translate(-(windowWidth-2*this.width)/2-2*this.width-10-leftMargin,0),this.prePage.translate((windowWidth-2*this.width)/2+2*this.width+10+rightMargin,0));this.prePage.leaveSide();
this.showPage.enterSide();this.nextPage.leaveSide();this.addSearchHighlight()};initZoomBook.prototype.setVisible=function(a){this.bookContainer.css({display:a?"block":"none"});!0==a?this.bookMap.show():this.bookMap.hide();isTouch||this.controlBar.setVisible(a)};initZoomBook.prototype.setPosition=function(a,b){this.book.css({left:a+"px",top:b+"px"})};
initZoomBook.prototype.fillNear=function(a){!1==this.doublePage?(1<a&&this.prePage.fillContent(a-1),this.showPage.fillContent(a),a<originTotalPageCount&&this.nextPage.fillContent(a+1)):(this.prePage.fillContent(a-2),this.showPage.fillContent(a),this.nextPage.fillContent(a+2));this.addHistoryTexts()};initZoomBook.prototype.addHistoryTexts=function(){var a=getShownPage();this.prePage.addHistoryTexts(a);this.nextPage.addHistoryTexts(a);this.showPage.addHistoryTexts(a)};
initZoomBook.prototype.initEvent=function(){};
initZoomBook.prototype.initMouseEvt=function(){var a=this,b=Point(0,0),c=!1,d=null;this.book.bind(_event._down,function(e){if(bookType==BookType.zoom_book)return c=!0,b.x=e.pageX,b.y=e.pageY,d={x:a.book.offset().left,y:a.book.offset().top},!1});this.book.bind(_event._end,function(){bookType==BookType.zoom_book&&(c=!1)});this.book.bind(_event._move,function(e){bookType==BookType.zoom_book&&c&&bookType==BookType.zoom_book&&a.book.css({left:e.pageX-b.x+d.x+"px",top:e.pageY-b.y+d.y+"px"})});this.book.bind("mouseleave",
function(){})};
initZoomBook.prototype.initTouchEvt=function(){var a=this,b=Point(0,0),c=Point(0,0),d=!1,e=!1,f=null,g;this.book.bind(_event._down,function(g){if(bookType==BookType.zoom_book){var j=a.book[0];j.setCapture?j.setCapture():window.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP);g=isTouch?g.originalEvent.touches:[g];g=g.originalEvent.touches;1==g.length?(d=!0,e=!1,b.x=g[0].pageX,b.y=g[0].pageY,f={x:a.book.offset().left,y:a.book.offset().top}):2==g.length&&(a.showPage.hideMM(),e=!0,d=!1,b.x=g[0].pageX,b.y=
g[0].pageY,c.x=g[1].pageX,c.y=g[1].pageY,f={x:g[0].pageX,y:g[0].pageY,left:0,top:0,width:a.book.width(),height:a.book.height()},a.prePage.setVisible(!1),a.nextPage.setVisible(!1))}});this.book.bind(_event._end,function(){if(bookType==BookType.zoom_book){var b=a.book[0];b.releaseCapture?b.releaseCapture():window.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP);e=d=!1;a.prePage.setVisible(!0);a.nextPage.setVisible(!0);a.showPage.showMM()}});this.book.bind(_event._move,function(h){if(bookType==BookType.zoom_book){h=
h.originalEvent.touches;if(d)a.book.css({left:h[0].pageX-b.x+f.x+"px",top:h[0].pageY-b.y+f.y+"px"});else if(e){var j=Point(h[0].pageX,h[0].pageY),k=Point(h[1].pageX,h[1].pageY),h=Math.sqrt(Math.pow(c.x-b.x,2)+Math.pow(c.y-b.y,2)),j=Math.sqrt(Math.pow(k.x-j.x,2)+Math.pow(k.y-j.y,2));g=Math.max((f.width+2*(j-h))/f.width,1);a.showPage.sideImg.css({"-webkit-transform-origin":b.x+"px "+b.y+"px","-webkit-transform":"scale("+g+")"})}return!1}})};initZoomBook.prototype.zoom=function(a){this.showPage.zoom(a)};
initZoomBook.prototype.noZoom=function(){this.showPage.noZoom()};initZoomBook.prototype.getLeft=function(){return this.showPage.left()};initZoomBook.prototype.getTop=function(){return this.showPage.top()};initZoomBook.prototype.getHeight=function(){return this.showPage.getHeight()};initZoomBook.prototype.getWidth=function(){return this.showPage.getWidth()};initZoomBook.prototype.getScale=function(){return this.showPage.getScale()};initZoomBook.prototype.getCurrentPageIndex=function(){return this.currentIndex};
initZoomBook.prototype.show=function(){debug("zoom book show.");this.setVisible(!0);this.prePage.showPage();this.nextPage.showPage();this.showPage.showPage();this.addSearchHighlight(this.currentIndex);this.bookMap.fillContent(this.currentIndex);this.showPage.playSlider();this.showPage.addHistoryTexts();this.nextPage.addHistoryTexts();this.prePage.addHistoryTexts()};initZoomBook.prototype.hide=function(){debug("zoom book hide.");this.setVisible(!1);this.showPage.resetSlider()};
function ZoomSideMap(a){var b=this;this.book=a;this.top=this.left=0;this.defaultWidth=72;this.defaultHeight=108;this.width=this.defaultWidth;this.height=this.defaultHeight;this.shownWidth=windowWidth;this.shownHeight=windowHeight;this.divThumb=$("<div id='thumb_bg'></div>");this.imgThumb=$("<img id='thumb_img'></img>");this.imgThumb2=$("<img id='thumb_img2'></img>");this.divCursor=$("<div id='thumb_cursor'></div>");this.divThumb.css({position:"absolute","z-index":202,display:"none",width:"82px",height:"128px",
border:"5px solid #ffffff","-webkit-box-shadow":"0px 0px 5px gray","-moz-box-shadow":"0px 0px 5px gray","-o-box-shadow":"0px 0px 5px gray","-ms-box-shadow":"0px 0px 5px gray","box-shadow":"0px 0px 5px gray"});this.imgThumb.css({top:"0px",position:"absolute","border-left":"1px solid gray","border-top":"1px solid gray","border-bottom":"1px solid gray","background-color":"white"});this.imgThumb2.css({top:"0px",position:"absolute","border-right":"1px solid gray","border-top":"1px solid gray","border-bottom":"1px solid gray",
"background-color":"white",display:"none"});this.divCursor.css({position:"absolute",border:"2px solid green"});this.imgThumb.load(this.onImageLoad.bind(this));this.imgThumb2.load(function(){ZoomSideMap.prototype.onImageLoad2.apply(b,arguments)});bookContainer.append(this.divThumb);this.divThumb.append(this.imgThumb);this.divThumb.append(this.imgThumb2);this.divThumb.append(this.divCursor);this.doublePage=this.mouseDown=!1;this.initAreaEvent()}
ZoomSideMap.prototype={show:function(){this.resetPosition();this.refreshArea();this.divThumb.css({display:"block"})},hide:function(){this.divThumb.css({display:"none"})},resetPosition:function(){var a=this.width;!0==this.book.doublePage&&!0==this.doublePage&&(a*=2);var a=this.shownWidth-a-20-bookConfig.rightMargin,b=toolBar.getTopHeight()+10+bookConfig.topMargin;this.divThumb.css({left:a,top:b})},resize:function(a,b){this.shownWidth=a;this.shownHeight=b;this.resetPosition()},fillContent:function(a){a=
parseInt(a);if(!0==this.book.doublePage){var b;0==a%2?(b=a,a+=1):b=a-1;if(!0==rightToLeft){var c=b;b=a;a=c}c=getPageDir(b,"thumb");this.imgThumb.attr("src",c);this.imgThumb2.attr("src",getPageDir(a,"thumb"));this.imgThumb2.css({display:"block"});this.imgThumb.css({"border-right":"0px solid gray"});this.imgThumb2.css({"border-left":"0px solid gray"});this.imgThumb.css({display:"block"});this.imgThumb2.css({display:"block"});this.doublePage=!0;0==b&&(this.imgThumb.css({display:"none"}),this.imgThumb2.css({"border-left":"1px solid gray"}),
this.doublePage=!1);a>totalPageCount&&(this.imgThumb2.css({display:"none"}),this.imgThumb.css({"border-right":"1px solid gray"}),this.doublePage=!1)}else this.doublePage=!1,c=getPageDir(a,"thumb"),this.imgThumb.attr("src",c),this.imgThumb2.css({display:"none"}),this.imgThumb.css({"border-right":"1px solid gray"})},onImageLoad:function(){var a=this.imgThumb[0];this.imageWidth=a.naturalWidth;this.imageHeight=a.naturalHeight;"none"!=this.imgThumb.css("display")&&(this.imageWidth/this.imageHeight<this.defaultWidth/
this.defaultHeight?(this.width=this.defaultWidth,this.height=this.imageHeight*this.defaultWidth/this.imageWidth):(this.height=this.defaultHeight,this.width=this.imageWidth*this.defaultHeight/this.imageHeight));!0==this.book.doublePage&&!0==this.doublePage?this.divThumb.css({width:2*this.width+2+"px",height:this.height+2+"px"}):this.divThumb.css({width:this.width+2+"px",height:this.height+2+"px"});this.imgThumb.css({left:"0px",width:this.width+"px",height:this.height+"px"});this.divCursor.css({cursor:"",
"background-color":"RGBA(250,240,185,0.5)"});this.resetPosition();this.refreshArea()},onImageLoad2:function(){var a=this.imgThumb2[0];this.imageWidth=a.naturalWidth;this.imageHeight=a.naturalHeight;"none"!=this.imgThumb2.css("display")&&(this.imageWidth/this.imageHeight<this.defaultWidth/this.defaultHeight?(this.width=this.defaultWidth,this.height=this.imageHeight*this.defaultWidth/this.imageWidth):(this.height=this.defaultHeight,this.width=this.imageWidth*this.defaultHeight/this.imageHeight));!0==
this.book.doublePage&&!0==this.doublePage?(this.divThumb.css({width:2*this.width+2+"px",height:this.height+2+"px"}),this.imgThumb2.css({left:this.width+"px",width:this.width+"px",height:this.height+"px"})):(this.divThumb.css({width:this.width+2+"px",height:this.height+2+"px"}),"none"==this.imgThumb.css("display")&&this.imgThumb2.css({left:"0px",width:this.width+"px",height:this.height+"px"}));this.divCursor.css({cursor:"","background-color":"RGBA(250,240,185,0.5)"});this.resetPosition();this.refreshArea()},
setArea:function(a){this.divCursor.css({left:a.left,top:a.top,width:a.width,height:a.height})},getArea:function(){var a=this.divCursor.css("left"),a=""==a?0:parseInt(a.replace("px","")),b=this.divCursor.css("top"),b=""==b?0:parseInt(b.replace("px","")),c=this.divCursor.css("width"),c=""==c?0:parseInt(c.replace("px","")),d=this.divCursor.css("height"),d=""==d?0:parseInt(d,replace("px",""));return{left:a,top:b,width:c,height:d}},refreshArea:function(){var a=this.book.showPage,b=a.getWidth(),c=a.getHeight(),
d=getBookPoint(a.side),e=this.getBookPosition();!0==this.book.doublePage&&!1==this.doublePage&&(b/=2);"none"==this.imgThumb.css("display")&&(d.x+=a.getWidth()/2);var a=-(e.left+d.x),f=-(e.top+d.y),d=f/c,e=(a+this.shownWidth)/b,c=(f+this.shownHeight)/c,b=Math.max(0,a/b),d=Math.max(0,d),e=Math.min(1,e),c=Math.min(1,c),a=this.width;!0==this.book.doublePage&&!0==this.doublePage&&(a*=2);this.setArea({left:b*a,top:d*this.height,width:(e-b)*a,height:(c-d)*this.height})},getBookPosition:function(){var a=
this.book.book.css("left"),a=parseInt(a.replace("px","")),b=this.book.book.css("top"),b=parseInt(b.replace("px",""));return{left:a,top:b}},initAreaEvent:function(){var a=this,b,c,d,e,f=1,g=1,h=null;this.divCursor.bind(_event._down,function(j){j=isTouch?j.originalEvent.touches:[j];if(!(1<j.length)){a.mouseDown=!0;h=a.book.showPage;var k=getBookPoint(h.side);b=k.x;c=k.y;d=j[0].pageX;e=j[0].pageY;j=a.width;!0==a.book.doublePage&&(j*=2);f=h.getWidth()/j;g=h.getHeight()/a.height;a.divCursor.css({"background-color":"RGBA(245,225,135,0.8)"})}});
this.divCursor.bind(_event._move,function(j){j=isTouch?j.originalEvent.touches:[j];1<j.length||(a.mouseDown?(a.divCursor.css({cursor:"move"}),h.translate(b-(j[0].pageX-d)*f,c-(j[0].pageY-e)*g),a.refreshArea()):a.divCursor.css({cursor:""}))});this.divCursor.bind(_event._end,function(){a.mouseDown=!1;a.divCursor.css({cursor:"","background-color":"RGBA(250,240,185,0.5)"})});this.divCursor.bind(_event._leave,function(){a.mouseDown=!1;a.divCursor.css({cursor:"","background-color":"RGBA(250,240,185,0.5)"})})}};
function DoubleZoomPage(a){this.leftSide=new DoubleZoomSide(a,!0);this.rightSide=new DoubleZoomSide(a,!1);this.leftSide.setBrother(this.rightSide);this.rightSide.setBrother(this.leftSide);this.side=this.leftSide.side;this.bookCenter=parseBool(bookConfig.retainBookCenter)}
DoubleZoomPage.prototype={left:function(){return this.leftSide.left()},top:function(){return this.leftSide.top()},setXY:function(a,b){this.leftSide.setXY(a,b);this.rightSide.setXY(a,b);var c=getTransform(this.leftSide.side[0]);this.rightSide.refreshPosition(c.x,c.y,this.leftSide.getWidth())},getWidth:function(){return this.leftSide.getWidth()+this.rightSide.getWidth()},getHeight:function(){return this.leftSide.getHeight()},getScale:function(){return this.leftSide.getScale()},setChildIndex:function(a){this.leftSide.setChildIndex(a);
this.rightSide.setChildIndex(a)},showPage:function(){this.leftSide.showPage();this.rightSide.showPage()},hidePage:function(){this.leftSide.hidePage();this.rightSide.hidePage()},showMM:function(){this.leftSide.showMM();this.rightSide.showMM()},playSlider:function(){this.leftSide.playSlider();this.rightSide.playSlider()},addHistoryTexts:function(){var a=getShownPage();this.leftSide.addHistoryTexts(a);this.rightSide.addHistoryTexts(a)},resetSlider:function(){this.leftSide.resetSlider();this.rightSide.resetSlider()},
onWinResize:function(a,b){this.leftSide.onWinResize(a,b);this.rightSide.onWinResize(a,b)},isFit:function(){return this.leftSide.isFit()},translate:function(a,b){this.leftSide.translate(a,b);this.rightSide.translate(a+this.leftSide.getWidth(),b)},forceReset:function(a){this.leftSide.forceReset(a);this.rightSide.forceReset(a)},animateMax:function(){var a=getTransform(this.leftSide.side[0]);this.rightSide.refreshPosition(a.x,a.y,this.leftSide.getWidth());this.leftSide.animateMax()},noZoom:function(){this.leftSide.noZoom();
this.rightSide.noZoom()},fillContent:function(a){var a=parseInt(a),b;0==a%2?(b=a,a+=1):b=a-1;if(!0==rightToLeft){var c=b;b=a;a=c}this.leftSide.fillContent(b);this.rightSide.fillContent(a)},highlightSearch:function(){this.leftSide.highlightSearch();this.rightSide.highlightSearch()},clearHighlight:function(){this.leftSide.clearHighlight();this.rightSide.clearHighlight()},getCenterTransform:function(){return this.leftSide.getCenterTransform()},setZooming:function(a){this.leftSide.setZooming(a);this.leftSide.setZooming(a)},
getScaleFromFit:function(){return this.leftSide.getScaleFromFit()},resetSize:function(){this.leftSide.resetSize();this.rightSide.resetSize()},setScale:function(a){this.leftSide.setScale(a);this.rightSide.setScale(a)},getScale:function(){return this.leftSide.toScale},destroy:function(){this.leftSide.destroy();this.rightSide.destroy()},zoom:function(a){this.leftSide.zoom(a);this.rightSide.zoom(a)},adjustTarget:function(a,b){return!this.bookCenter?a:1==this.rightSide.imgIndex?a-b/4:this.leftSide.imgIndex==
totalPageCount?a+b/4:a},leaveSide:function(){this.leftSide.leaveSide();this.rightSide.leaveSide()},enterSide:function(){this.leftSide.enterSide();this.rightSide.enterSide()},moveUp:function(){this.leftSide.moveUp()},moveDown:function(){this.leftSide.moveDown()},moveLeft:function(){this.leftSide.moveLeft()},moveRight:function(){this.leftSide.moveRight()}};function slideSide(a){this.side=$("<div></div>");this.sideContent=$("<div class='sideContent' style= 'overflow: hidden'></div>");this.sideImg=$("<img style='position: absolute;' />");this.MMBackground=$("<div style='position:absolute;z-index:3;'></div>");this.loadingImg=$("<img src='"+uiBaseURL+"progress.gif' style='position: absolute;'>");this.width=zoomPageWidth;this.height=zoomPageHeight;this.fitH=this.fitW=0;this.tmpImg=$("<img style='position: absolute;z-index:-1;' />");this.searchHighlight=
$("<div class='kong' id='highlight'></div>");a.append(this.side);this.side.append(this.sideContent);this.imageIndex=-1;this.toScale=1;this.origin="0% 0%";this.translateY=this.translateX=this.y=this.x=0;this.isZomming=!1;this.sideTop=0;this.side.css({width:this.width+"px",height:this.height+"px",top:this.sideTop+"px",position:"absolute","border-width":"0px"});this.sideContent.css({width:this.width+"px",height:this.height+"px",background:"#ffffff"});this.searchHighlight.css({width:this.width+"px",height:this.height+
"px"});this.sideImg.css({width:this.width+"px",height:this.height+"px"});this.MMBackground.css({width:this.width+"px",height:this.height+"px"});this.loadingImg.css({left:(this.width-10)/2+"px",top:(this.height-10)/2+"px"});this.initMMItems();this.slider=null;this.playSliderAfterLoad=!1;this.onWinResize(windowWidth-leftMargin-rightMargin,windowHeight-topMargin-bottomMargin-40,!0);this.father=a}slideSide.prototype.hideMM=function(){this.MMBackground.css({display:"none"})};
slideSide.prototype.showMM=function(){this.MMBackground.css({display:"block"})};slideSide.prototype.setCSS=function(a){this.side.css(a)};slideSide.prototype.onResize2=function(a){this.toScale=a/this.width;a=getPoint(this.side);this.zoomObj(this.side,this.origin,this.toScale,a.x,a.y)};
slideSide.prototype.onResize=function(a,b,c){this.toScale=1;a=getPageWidthHeight(a,b,zoomPageWidth,zoomPageHeight);this.width=a.x*this.toScale;this.height=a.y*this.toScale;this.side.css({width:this.width+"px",height:this.height+"px"});this.sideContent.css({width:this.width+"px",height:this.height+"px"});this.sideImg.css({width:this.width+"px",height:this.height+"px"});this.searchHighlight.css({width:this.width+"px",height:this.height+"px"});this.onMMResize(this.width,this.height);this.loadingImg.css({left:(this.width-
10)/2+"px",top:(this.height-10)/2+"px"});c&&this.tmpImg.css({width:this.width+"px",height:this.height+"px",top:this.sideTop+"px"});this.setTranslate(0,0)};slideSide.prototype.getSide=function(){return this.side};
slideSide.prototype.fillContent=function(a){this.imageIndex=a;var b=this;this.sideContent.empty();a<=originTotalPageCount&&1<=a?(b.showLoading(),this.sideContent.css({background:"#ffffff"})):(b.hideLoading(),this.sideContent.css({background:"transparent"}));a>originTotalPageCount+1||0>a||this.sideImg.load(function(){b.tmpImg.attr("src",getPageDir(a,"thumb",originTotalPageCount));b.sideContent.append(b.sideImg);b.sideContent.append(b.tmpImg)}).attr("src",getPageDir(a,"thumb",originTotalPageCount))};
slideSide.prototype.fillTemp=function(a){if(a!=this.imageIndex){this.imageIndex=a;var b=this;a<=originTotalPageCount&&1<=a?this.sideContent.css({background:"#ffffff"}):this.sideContent.css({background:"transparent"});this.sideContent.empty();a>originTotalPageCount+1||0>a||this.sideImg.load(function(){b.tmpImg.attr("src",getPageDir(a,"thumb",originTotalPageCount));b.sideContent.append(b.sideImg);b.sideContent.append(b.tmpImg)}).attr("src",getPageDir(a,"thumb",originTotalPageCount))}};
slideSide.prototype.changeContent=function(a){this.imageIndex=a;var b=this;a<=originTotalPageCount&&1<=a?this.sideContent.css({background:"#ffffff"}):this.sideContent.css({background:"transparent"});this.hideLoading();(a>originTotalPageCount||1>a)&&this.hideLoading();a>originTotalPageCount+1||0>a||(null!=this.slider&&(this.slider.destroy(),this.slider=null),this.sideImg.load(function(){b.hideLoading();b.tmpImg.attr("src",getPageDir(a,"normal",originTotalPageCount));b.sideContent.append(b.sideImg);
b.sideContent.append(b.tmpImg);b.sideContent.append(b.MMBackground);b.sideContent.append(b.searchHighlight);b.searchHighlight.css({opacity:0.8});b.clearMM();b.initMM();b.initSlider()}).attr("src",getPageDir(a,"normal",originTotalPageCount)))};slideSide.prototype.setPosition=function(a,b){this.side.css({left:a+"px",top:b+"px"})};slideSide.prototype.setChildIndex=function(a){this.side.css({"z-index":a})};slideSide.prototype.setVisible=function(a){this.side.css({display:a?"block":"none"})};
slideSide.prototype.resetSize=function(){this.tmpImg.css({display:"none"});var a=this.width*this.toScale>=zoomPageWidth,b=a?zoomPageWidth:this.width*this.toScale,c=a?zoomPageHeight:this.height*this.toScale,d=getPoint(this.side),e=this.width==zoomPageWidth&&b<zoomPageWidth||this.width!=zoomPageWidth;this.toScale=a?this.width*this.toScale/zoomPageWidth:1;var a=slideBook.minZoomWidth,f=slideBook.minZoomHeight;if(void 0!=a&&void 0!=f&&0<a&&0<f){b/c>a/f?f=a*c/b:a=f*b/c;var g=Math.min(0,b-a),h=Math.min(0,
c-f),b=Math.max(b,a),c=Math.max(c,f);d.x+=g/2;d.y+=h/2}this.zoomObj(this.side,"0% 0%",this.toScale,d.x,d.y);this.width=b;this.height=c;this.translateX=d.x;this.translateY=d.y;e&&this.tmpImg.css({width:this.width+"px",height:this.height+"px"});this.zoomObj(this.tmpImg,"0% 0%",this.toScale,d.x,d.y);this.tmpImg.css({display:"block"});if(e)this.onResize(b,c)};
slideSide.prototype.zoom=function(a,b){if(!0==this.isZomming)return!1;var c=slideBook.minZoomWidth,d=slideBook.minZoomHeight,e=slideBook.largeZoomWidth,f=c*this.toScale,g=d*this.toScale,h=this.toScale+a,j=c*h;if(1>h){if(f<=c)return;j<c&&(h=c/c)}1<h&&j>e&&(h=e/c);var j=c*h,c=d*h,d=(f-j)/2+this.translateX,e=(g-c)/2+this.translateY,e=Point(this.side.offset().left,this.side.offset().top),k=getPoint(this.side);slideBook.toScale=h;slideBook.containtWidth=Math.min(slideBook.width*h,slideBook.stageWidth);
slideBook.containtHeight=Math.min(slideBook.height*h,slideBook.stageHeight);d=(f-j)*((windowWidth/2-e.x)/f)+k.x;e=(g-c)*((windowHeight/2-e.y)/g)+k.y;e=Math.max(slideBook.getHeight()-this.height*h,e);e=Math.min(e,0);d=Math.max(slideBook.getWidth()-this.width*h,d);d=Math.min(d,0);1==b&&(d=j,e=0);-1==b&&(d=-j,e=0);this.animateZoom(h,d,e,300)};
slideSide.prototype.zoomToScale=function(a,b){var c=this;if(!0==this.isZomming)return!1;var d=slideBook.minZoomWidth,e=slideBook.minZoomHeight,f=slideBook.largeZoomWidth,g=d*this.toScale,h=e*this.toScale,e=this.toScale+a,j=d*newScale;if(1>newScale){if(g<=d)return;j<d&&(newScale=d/d)}1<newScale&&j>f&&(newScale=f/d);var j=d*newScale,d=e*newScale,e=(g-j)/2+this.translateX,f=(h-d)/2+this.translateY,f=Point(c.side.offset().left,c.side.offset().top),k=getPoint(c.side);slideBook.toScale=newScale;c.toScale=
newScale;slideBook.containtWidth=Math.min(slideBook.width*newScale,slideBook.stageWidth);slideBook.containtHeight=Math.min(slideBook.height*newScale,slideBook.stageHeight);e=(g-j)*((windowWidth/2-f.x)/g)+k.x;f=(h-d)*((windowHeight/2-f.y)/h)+k.y;f=Math.max(slideBook.getHeight()-c.getHeight(),f);f=Math.min(f,0);e=Math.max(slideBook.getWidth()-c.getWidth(),e);e=Math.min(e,0);1==b&&(e=j,f=0);-1==b&&(e=-j,f=0);!0!=this.isZomming&&(this.isZomming=!0,newScale||(newScale=this.toScale),e||(e=0),f||(f=0),getPoint(this.side),
c=this,c.tmpImg.css({display:"none"}),c.zoomObj(c.side,c.origin,newScale,e,f),c.zoomObj(c.tmpImg,c.origin,newScale,e,f),c.tmpImg.css({display:"block"}),c.toScale=newScale,slideBook.toScale=newScale,slideBook.containtWidth=Math.min(slideBook.width*newScale,slideBook.stageWidth),slideBook.containtHeight=Math.min(slideBook.height*newScale,slideBook.stageHeight),slideBook.book.css({width:slideBook.containtWidth+"px",height:slideBook.containtHeight+"px",left:(slideBook.stageWidth-slideBook.containtWidth)/
2+leftMargin+"px",top:(slideBook.stageHeight-slideBook.containtHeight)/2+topMargin+toolBar.getTopHeight()+"px"}),slideBook.leftButton.css({width:"30px",height:slideBook.containtHeight-10+"px",left:Math.max(0,(slideBook.stageWidth-slideBook.containtWidth)/2+leftMargin-30)+"px",top:(slideBook.stageHeight-slideBook.containtHeight)/2+topMargin+toolBar.getTopHeight()+5+"px"}),slideBook.rightButton.css({width:"30px",height:slideBook.containtHeight-10+"px",left:Math.min(windowWidth-30,(slideBook.stageWidth+
slideBook.containtWidth)/2+leftMargin)+"px",top:(slideBook.stageHeight-slideBook.containtHeight)/2+topMargin+toolBar.getTopHeight()+5+"px"}),slideBook.leftImg.css({left:"7px",top:(slideBook.containtHeight-10-16)/2+"px"}),slideBook.rightImg.css({left:"7px",top:(slideBook.containtHeight-10-16)/2+"px"}),slideBook.scrollButtonTran(101*(newScale-slideBook.minZoomWidth/slideBook.width)*slideBook.width/(slideBook.largeZoomWidth-slideBook.minZoomWidth)),c.isZomming=!1)};
slideSide.prototype.noZoom=function(){this.toScale=this.fitW/this.width;this.zoomObj(this.side,"0% 0%",this.toScale,0,0);this.zoomObj(this.tmpImg,"0% 0%",this.toScale,0,0)};slideSide.prototype.forceReset=function(a){this.toScale=slideBook.getWidth()/this.getWidth();this.width=slideBook.getWidth();this.height=this.width*this.fitH/this.fitW;void 0==a&&(a=getPoint(this.side));this.forceResize(a)};
slideSide.prototype.forceMax=function(){var a=(this.width*this.toScale-zoomPageWidth)/2;this.width=zoomPageWidth;this.height=zoomPageHeight;var b=getPoint(this.side);b.x+=a;this.forceResize(b)};slideSide.prototype.animateMax=function(){this.animateZoom(zoomPageWidth/this.width,(this.width-zoomPageWidth)/2,0,300)};slideSide.prototype.animateFit=function(){this.animateZoom(this.fitW/this.width,0,0,300)};
slideSide.prototype.forceResize=function(a){this.side.css({width:this.width+"px",height:this.height+"px"});this.sideContent.css({width:this.width+"px",height:this.height+"px"});this.sideImg.css({width:this.width+"px",height:this.height+"px"});this.searchHighlight.css({width:this.width+"px",height:this.height+"px"});this.MMBackground.css({width:this.width+"px",height:this.height+"px"});this.onMMResize(this.width,this.height);this.tmpImg.css({width:this.width+"px",height:this.height+"px"});this.setTranslate(a.x,
a.y);this.translateX=a.x;this.translateY=a.y};slideSide.prototype.getScaleFromFit=function(){return this.width*this.toScale/this.fitW};slideSide.prototype.getCenterTransform=function(){return Point((this.fitW-this.width*this.toScale)/2,0)};slideSide.prototype.zoomToMax=function(){var a=zoomPageWidth/this.width;this.animateZoom(a,(this.width*this.toScale-this.width*a)/2+this.translateX,0,200)};slideSide.prototype.zoomToFit=function(){this.animateZoom(this.getScaleFromFit(),0,0,200)};
slideSide.prototype.zoomObj=function(a,b,c,d,e){if(!0!=a.isZomming){a.isZomming=!0;d||(d=0);e||(e=0);translate(d,e);var f=scaleTran(c),g=Math.cos(0)*c,h=-1*Math.sin(0)*c,c=Math.sin(0)*c;a.transform(d,e);!0==isBelowIE9()?a.css({filter:"progid:DXImageTransform.Microsoft.Matrix(M11="+g+",M12="+h+",M21="+c+",M22="+g+",SizingMethod='auto expand')"}):a.css({"-webkit-transform-origin":b,"-moz-transform-origin":b,"-ms-transform-origin":b,"-o-transform-origin":b,"-webkit-transform":f,"-moz-transform":f,"-ms-transform":f,
"-o-transform":f});a.isZomming=!1}};
slideSide.prototype.setTranslate=function(a,b,c){translate(b,c);parseFloat(this.toScale);Math.cos(0);Math.sin(0);Math.sin(0);this.side.transform(b,c);this.tmpImg.transform(b,c);isBelowIE9()||(this.side.css({"-webkit-transform":"scale("+this.toScale+")","-moz-transform":"scale("+this.toScale+")","-ms-transform":"scale("+this.toScale+")","-o-transform":"scale("+this.toScale+")"}),this.tmpImg.css({"-webkit-transform":"scale("+this.toScale+")","-moz-transform":"scale("+this.toScale+")","-ms-transform":"scale("+
this.toScale+")","-o-transform":"scale("+this.toScale+")"}))};slideSide.prototype.setXY=function(a,b){this.x=a;this.y=b};slideSide.prototype.animateTranslate=function(a,b,c){a||(a=0);b||(b=0);c||(c=25);var d=getPoint(this.side),e=this;$(d).animate({x:a,y:b},{duration:c,easing:"easeOutSine",complete:function(){e.setTranslate(d.x,d.y)}})};
slideSide.prototype.animateZoom=function(a,b,c,d){if(!0!=this.isZomming){this.isZomming=!0;a||(a=this.toScale);b||(b=0);c||(c=0);d||(d=25);var e=getPoint(this.side),f={scale:this.toScale,x:e.x,y:e.y,w:Math.min(slideBook.width*this.toScale,slideBook.stageWidth),h:Math.min(slideBook.height*this.toScale,slideBook.stageHeight),l:101*(this.toScale-slideBook.minZoomWidth/slideBook.width)*slideBook.width/(slideBook.largeZoomWidth-slideBook.minZoomWidth)},g=this;slideBook.containtWidth=Math.min(slideBook.width*
a,slideBook.stageWidth);slideBook.containtHeight=Math.min(slideBook.height*a,slideBook.stageHeight);e=101*(a-slideBook.minZoomWidth/slideBook.width)*slideBook.width/(slideBook.largeZoomWidth-slideBook.minZoomWidth);$(f).animate({scale:a,x:b,y:c,w:slideBook.containtWidth,h:slideBook.containtHeight,l:e},{duration:d,easing:"easeOutSine",step:function(){g.tmpImg.css({display:"none"});g.zoomObj(g.side,g.origin,f.scale,f.x,f.y);g.zoomObj(g.tmpImg,g.origin,f.scale,f.x,f.y);slideBook.book.css({width:f.w+
"px",height:f.h+"px",left:(slideBook.stageWidth-f.w)/2+leftMargin+"px",top:(slideBook.stageHeight-f.h)/2+topMargin+toolBar.getTopHeight()+"px"});slideBook.leftButton.css({width:"30px",height:f.h-10+"px",left:Math.max(0,(slideBook.stageWidth-f.w)/2+leftMargin-30)+"px",top:(slideBook.stageHeight-f.h)/2+topMargin+toolBar.getTopHeight()+5+"px"});slideBook.rightButton.css({width:"30px",height:f.h-10+"px",left:Math.min(windowWidth-30,(slideBook.stageWidth+f.w)/2+leftMargin)+"px",top:(slideBook.stageHeight-
f.h)/2+topMargin+toolBar.getTopHeight()+5+"px"});slideBook.leftImg.css({left:"7px",top:(f.h-10-16)/2+"px"});slideBook.rightImg.css({left:"7px",top:(f.h-10-16)/2+"px"});slideBook.scrollButtonTran(f.l);g.tmpImg.css({display:"block"})},complete:function(){g.toScale=a;slideBook.toScale=a;slideBook.containtWidth=Math.min(slideBook.width*a,slideBook.stageWidth);slideBook.containtHeight=Math.min(slideBook.height*a,slideBook.stageHeight);slideBook.book.css({width:slideBook.containtWidth+"px",height:slideBook.containtHeight+
"px",left:(slideBook.stageWidth-slideBook.containtWidth)/2+leftMargin+"px",top:(slideBook.stageHeight-slideBook.containtHeight)/2+topMargin+toolBar.getTopHeight()+"px"});slideBook.leftButton.css({width:"30px",height:slideBook.containtHeight-10+"px",left:Math.max(0,(slideBook.stageWidth-slideBook.containtWidth)/2+leftMargin-30)+"px",top:(slideBook.stageHeight-slideBook.containtHeight)/2+topMargin+toolBar.getTopHeight()+5+"px"});slideBook.rightButton.css({width:"30px",height:slideBook.containtHeight-
10+"px",left:Math.min(windowWidth-30,(slideBook.stageWidth+slideBook.containtWidth)/2+leftMargin)+"px",top:(slideBook.stageHeight-slideBook.containtHeight)/2+topMargin+toolBar.getTopHeight()+5+"px"});slideBook.leftImg.css({left:"7px",top:(slideBook.containtHeight-10-16)/2+"px"});slideBook.rightImg.css({left:"7px",top:(slideBook.containtHeight-10-16)/2+"px"});slideBook.scrollButtonTran((a-slideBook.minZoomWidth/slideBook.width)*101*slideBook.width/(slideBook.largeZoomWidth-slideBook.minZoomWidth));
g.isZomming=false}})}};slideSide.prototype.onWinResize=function(a,b,c){this.toScale=1;var d=getPageWidthHeight(a,b,zoomPageWidth,zoomPageHeight);this.fitW=d.x;this.fitH=d.y;if(c)this.onResize(a,b,!0)};slideSide.prototype.translate=function(a,b){this.tmpImg.css({display:"none"});this.zoomObj(this.side,this.origin,this.toScale,a,b);this.zoomObj(this.tmpImg,this.origin,this.toScale,a,b);this.tmpImg.css({display:"block"})};slideSide.prototype.isFit=function(){return this.toScale==this.fitW/this.width};
slideSide.prototype.animateBack=function(a){var b=getPoint(this.side),c={x:b.x,y:b.y,scale:this.toScale},d=this.fitW/this.width,e=this;e.tmpImg.css({display:"none"});$(c).animate({x:0,y:0,scale:d},{duration:200,step:function(){e.zoomObj(e.side,e.origin,c.scale,c.x,c.y);e.zoomObj(e.tmpImg,e.origin,c.scale,c.x,c.y)},complete:function(){e.toScale=d;e.tmpImg.css({display:"block"});a()}})};slideSide.prototype.showPage=function(){this.side.css({display:"block"})};slideSide.prototype.hidePage=function(){this.side.css({display:"none"})};
slideSide.prototype.getWidth=function(){return this.width*this.toScale};slideSide.prototype.getHeight=function(){return this.height*this.toScale};
slideSide.prototype.initEvent=function(){var a=this,b=Point(0,0),c=Point(0,0),d=Point(0,0),e=!1,f=!1,g=null,h=!1,j,k=0,m=0,l=!1;this.side.bind(_event._down,function(k){if(bookType==BookType.slide_book){if(!0==a.isZomming||!0==slideBook.isFlipping)return!1;slideBook.isMove=!1;j=a.toScale;var k=isTouch?k.originalEvent.touches:[k],o=getPoint(a.side);a.translateX=o.x;a.translateY=o.y;slideBook.initTranslate();1==k.length?(e=!0,f=!1,b=Point(k[0].pageX,k[0].pageY),g=Point(a.side.position().left,a.side.position().top)):
2==k.length&&(e=!1,f=!0,b=Point(k[0].pageX,k[0].pageY),d=Point(k[1].pageX,k[1].pageY),c=Point((k[0].pageX+k[1].pageX)/2,(k[0].pageY+k[1].pageY)/2),g=Point(a.side.offset().left,a.side.offset().top));h=l=!1;stopEvent(k[0])}});3==browserType&&(_event._mousewheel="DOMMouseScroll");isIE()&&(_event._mousewheel="mousewheel");this.side.bind("mousewheel",function(b){if(bookType!=BookType.slide_book||slideBook.isFlipping==true)return false;var b=b.originalEvent,c=Math.max(-1,Math.min(1,b.wheelDelta||-b.detail)),
b=getPoint(a.side),d=-20;c>0&&(d=20);c=b.y+d;c=Math.min(c*Math.min(Math.abs(c),Math.abs(slideBook.getHeight()-a.getHeight()))/Math.abs(c),0);a.zoomObj(a.side,a.origin,a.toScale,b.x,c);a.zoomObj(a.tmpImg,a.origin,a.toScale,b.x,c);return l=false});this.side.bind(_event._move,function(l){if(bookType==BookType.slide_book){l=isTouch?l.originalEvent.touches:[l];e?a.side.css({cursor:"move"}):a.side.css({cursor:""});slideBook.isMove=true;if(e){var o=l[0].pageX-b.x+a.translateX,p=l[0].pageY-b.y+a.translateY;
(new Date).getTime();p=Math.min(p*Math.min(Math.abs(p),Math.abs(slideBook.getHeight()-a.getHeight()))/Math.abs(p),0);if(slideBook.getWidth()+5<a.getWidth()){p=Math.max(slideBook.getHeight()-a.getHeight(),p);p=Math.min(p,0);o=Math.max(slideBook.getWidth()-a.getWidth(),o);o=Math.min(o,0);a.zoomObj(a.side,a.origin,a.toScale,o,p);a.zoomObj(a.tmpImg,a.origin,a.toScale,o,p);k=o;m=p;a.zoomToMove=true;a.gotoNextPage=false;a.gotoPrePage=false}else{a.zoomToMove=false;slideBook.translateMove(l[0].pageX-b.x,
p);if(b.x-l[0].pageX>slideBook.width*a.toScale/4){a.gotoNextPage=true;a.gotoPrePage=false}else if(b.x-l[0].pageX<=-slideBook.width*a.toScale/4){a.gotoNextPage=false;a.gotoPrePage=true}else{a.gotoNextPage=false;a.gotoPrePage=false}}k=o;m=p}else if(f){var o=Point(l[0].pageX,l[0].pageY),p=Point(l[1].pageX,l[1].pageY),q=Math.sqrt(Math.pow(b.x-d.x,2)+Math.pow(b.y-d.y,2)),o=Math.sqrt(Math.pow(o.x-p.x,2)+Math.pow(o.y-p.y,2));scale=Math.max(o/q*j,0.5);q=slideBook.minZoomWidth*scale;if(scale<1&&q<slideBook.minZoomWidth){scale=
slideBook.minZoomWidth/slideBook.minZoomWidth;q=slideBook.minZoomWidth}if(scale>1&&q>slideBook.largeZoomWidth){scale=slideBook.largeZoomWidth/slideBook.minZoomWidth;q=slideBook.largeZoomWidth}slideBook.showPage.toScale=scale;slideBook.prePage.toScale=scale;slideBook.nextPage.toScale=scale;slideBook.toScale=scale;slideBook.containtWidth=Math.min(slideBook.width*scale,slideBook.stageWidth);slideBook.containtHeight=Math.min(slideBook.height*scale,slideBook.stageHeight);o=(c.x-g.x)/j;p=(c.y-g.y)/j;a.side.width();
a.side.height();p=(j-a.toScale)*slideBook.minZoomHeight*(p/slideBook.minZoomHeight);o=a.translateX+(j-a.toScale)*slideBook.minZoomWidth*(o/slideBook.minZoomWidth)+(slideBook.containtWidth-Math.min(slideBook.width*j,slideBook.stageWidth))/2;p=a.translateY+p+(slideBook.containtHeight-Math.min(slideBook.height*j,slideBook.stageHeight))/2;p=Math.max(slideBook.getHeight()-a.getHeight(),p);p=Math.min(p,0);o=Math.max(slideBook.getWidth()-a.getWidth(),o);o=Math.min(o,0);slideBook.showPage.zoomObj(slideBook.showPage.side,
slideBook.showPage.origin,a.toScale,o,p);slideBook.showPage.zoomObj(slideBook.showPage.tmpImg,slideBook.showPage.origin,a.toScale,o,p);slideBook.prePage.zoomObj(slideBook.prePage.side,slideBook.prePage.origin,a.toScale,-q,0);slideBook.prePage.zoomObj(slideBook.prePage.tmpImg,slideBook.prePage.origin,a.toScale,-q,0);slideBook.nextPage.zoomObj(slideBook.nextPage.side,slideBook.nextPage.origin,a.toScale,q,0);slideBook.nextPage.zoomObj(slideBook.nextPage.tmpImg,slideBook.nextPage.origin,a.toScale,q,0);
slideBook.book.css({width:slideBook.containtWidth+"px",height:slideBook.containtHeight+"px",left:(slideBook.stageWidth-slideBook.containtWidth)/2+leftMargin+"px",top:(slideBook.stageHeight-slideBook.containtHeight)/2+topMargin+toolBar.getTopHeight()+"px"});slideBook.leftButton.css({width:"30px",height:slideBook.containtHeight-10+"px",left:Math.max(0,(slideBook.stageWidth-slideBook.containtWidth)/2+leftMargin-30)+"px",top:(slideBook.stageHeight-slideBook.containtHeight)/2+topMargin+toolBar.getTopHeight()+
5+"px"});slideBook.rightButton.css({width:"30px",height:slideBook.containtHeight-10+"px",left:Math.min(windowWidth-30,(slideBook.stageWidth+slideBook.containtWidth)/2+leftMargin)+"px",top:(slideBook.stageHeight-slideBook.containtHeight)/2+topMargin+toolBar.getTopHeight()+5+"px"});slideBook.leftImg.css({left:"7px",top:(slideBook.containtHeight-10-16)/2+"px"});slideBook.rightImg.css({left:"7px",top:(slideBook.containtHeight-10-16)/2+"px"});o=(scale-slideBook.minZoomWidth/slideBook.width)*101*slideBook.width/
(slideBook.largeZoomWidth-slideBook.minZoomWidth);slideBook.scrollButtonTran(o);h=true;k=o;m=p;stopEvent(l[0])}}});this.side.bind(_event._end,function(){if(bookType==BookType.slide_book){if(a.isZomming==true||slideBook.isFlipping==true||l==true)return false;a.side.css({cursor:""});a.translateX=k;var b=m,b=Math.max(slideBook.getHeight()-a.getHeight(),b),b=Math.min(b,0);a.translateY=b;try{a.gotoNextPage==true?slideBook.gotoPage(parseInt(slideBook.currentIndex)+1):a.gotoPrePage==true?slideBook.gotoPage(parseInt(slideBook.currentIndex)-
1):a.zoomToMove==false&&h==false&&slideBook.translateToOrigin(a.translateY);a.gotoNextPage=false;a.gotoPrePage=false;l=true}catch(c){}h=f=e=false}});this.side.bind(_event._leave,function(){if(bookType==BookType.slide_book){if(a.isZomming==true||slideBook.isFlipping==true||l==true)return false;a.side.css({cursor:""});a.translateX=k;var b=m,b=Math.max(slideBook.getHeight()-a.getHeight(),b),b=Math.min(b,0);a.translateY=b;try{a.gotoNextPage==true?slideBook.gotoPage(parseInt(slideBook.currentIndex)+1):
a.gotoPrePage==true?slideBook.gotoPage(parseInt(slideBook.currentIndex)-1):a.zoomToMove==false&&h==false&&slideBook.translateToOrigin(a.translateY);a.gotoNextPage=false;a.gotoPrePage=false;l=true}catch(c){}h=f=e=false}});this.side.hammer().on("doubletap",function(){if(slideBook.isFlipping==true||this.isZomming==true||bookType!=BookType.slide_book)return false;h=true;var b=1,b=a.width*a.toScale/zoomPageWidth;a.side.offset();a.side.offset();if(b<0.75){b=zoomPageWidth/a.width;slideBook.zoomToScale(b-
slideBook.toScale)}else slideBook.zoomToScale(1-slideBook.toScale)})};slideSide.prototype.highlightSearch=function(a){highlightSearchFun(this.searchHighlight,a)};slideSide.prototype.clearHighlight=function(){clearHighlightFun(this.searchHighlight)};slideSide.prototype.addHistoryTexts=function(){AddNotesByContainers(BookType.slide_book,this.imageIndex,this.MMBackground)};slideSide.extend(BookSide);function initSlideBook(a){this.create(a);this.bookContainer.append(this.scrollBox);this.prePage=new slidePage(this.bookPage);this.nextPage=new slidePage(this.bookPage);this.showPage=new slidePage(this.bookPage);this.prePage.setChildIndex(1);this.showPage.setChildIndex(3);this.nextPage.setChildIndex(2);this.fillNear(1)}
initSlideBook.prototype.create=function(a){this.bookContainer=$("<div style='left:0px;right:0px;top:0px;bottom:0px;position:absolute;display:none;'></div>");this.book=$("<div></div>");this.bookPage=$("<div></div>");this.leftButton=$("<div></div>");this.rightButton=$("<div></div>");this.firstButton=$("<div></div>");this.lastButton=$("<div></div>");this.scrollBox=$("<div></div>");this.scrollBar=$("<div></div>");this.scrollButton=$("<div></div>");this.width=zoomPageWidth;this.height=zoomPageHeight;this.diffPageCount=
0;this.currentIndex=1;this.showingPage=this.flipPage=null;this.isMove=this.isFlipping=!1;this.minZoomHeight=this.minZoomWidth=500;this.largeZoomWidth=3*zoomPageWidth;this.largeZoomHeight=3*zoomPageHeight;a.append(this.bookContainer);this.bookContainer.append(this.book);this.bookContainer.append(this.leftButton);this.bookContainer.append(this.rightButton);this.bookContainer.append(this.firstButton);this.bookContainer.append(this.lastButton);this.leftImg=$('<img src="'+uiBaseURL+'slide_leftButton.png"></img>');
this.rightImg=$('<img src="'+uiBaseURL+'slide_rightButton.png"></img>');this.firstImg=$('<img src="'+uiBaseURL+'slide_firstButton.png"></img>');this.lastImg=$('<img src="'+uiBaseURL+'slide_lastButton.png"></img>');this.scrollWidth=234;this.moveByPoints=!1;this.zoomUp=$("<div></div>").attr("title","zoomUp");this.zoomDown=$("<div></div>").attr("title","zoomDown");this.zoomUp.append($('<img src="'+uiBaseURL+"ZU.png\" style='margin-top:3px;margin-left:3px;'></img>"));this.zoomDown.append($('<img src="'+
uiBaseURL+"ZD.png\" style='margin-top:3px;margin-left:3px;'></img>"));this.moveMode=$("<div></div>").attr("title","Move by mouse position");this.moveMode.append($('<img src="'+uiBaseURL+"moveByPos.png\" style='margin-top:3px;margin-left:3px;'></img>"));this.leftButton.append(this.leftImg);this.rightButton.append(this.rightImg);this.firstButton.append(this.firstImg);this.lastButton.append(this.lastImg);this.scrollBox.append($(this.zoomUp));this.scrollBox.append($(this.zoomDown));this.scrollBox.append($(this.moveMode));
this.scrollBox.append($(this.scrollBar));this.scrollBox.append($(this.scrollButton));this.book.append(this.bookPage);this.book.attr("class","slider view-read");this.leftButton.css({position:"absolute","z-index":"10","border-top":"1px solid #ffffff","border-radius":"0px 0px 0px 10px","-webkit-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","-moz-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","-o-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","-ms-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)",
"box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)",opacity:"0.5",background:"#888888"});this.rightButton.css({position:"absolute","z-index":"10","border-top":"1px solid #ffffff","-webkit-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","-moz-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","-o-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","-ms-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","border-radius":"0px 0px 10px 0px",opacity:"0.5",background:"#888888"});
this.firstButton.css({position:"absolute","z-index":"10","border-bottom":"1px solid #000000","-webkit-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","-moz-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","-o-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","-ms-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","border-radius":"10px 0px 0px 0px",opacity:"0.5",background:"#888888"});this.lastButton.css({position:"absolute","z-index":"10","-webkit-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)",
"-moz-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","-o-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","-ms-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","border-bottom":"1px solid #000000","border-radius":"0px 10px 0px 0px",opacity:"0.5",background:"#888888"});this.leftImg.css({position:"absolute"});this.rightImg.css({position:"absolute"});this.firstImg.css({position:"absolute"});this.lastImg.css({position:"absolute"});this.scrollBox.css({"-webkit-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)",
"-moz-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","-o-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","-ms-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)",width:this.scrollWidth+"px",height:"35px",position:"absolute","z-index":"11",background:"#333333",opacity:"0.3"});this.scrollBar.css({width:"126px",height:"5px",left:"37px",top:"15px",position:"absolute",background:"#ffffff",opacity:"0.5"});this.scrollButton.css({width:"25px",height:"25px",
left:"37px",top:"5px",position:"absolute","border-radius":"3px",background:"#ffffff"});this.zoomUp.css({width:"25px",height:"25px",position:"absolute",right:"29px",top:"5px"});this.zoomDown.css({width:"25px",height:"25px",position:"absolute",left:"2px",top:"5px"});this.moveMode.css({width:"25px",height:"25px",position:"absolute",right:"2px",top:"5px"});this.toScale=1;this.initEvent();void 0!=leftRightButton&&null!=leftRightButton&&leftRightButton.setShow(!1)};
initSlideBook.prototype.setButtonProperty=function(){this.leftButtonHeight=this.containtHeight-60;this.firstButtonHeight=49;this.firstButtonWidth=this.leftButtonWidth=30};
initSlideBook.prototype.resizeButton=function(){this.book.css({width:this.containtWidth+"px",height:this.containtHeight+"px",left:(this.stageWidth-this.containtWidth)/2+leftMargin+"px",top:(this.stageHeight-this.containtHeight)/2+topMargin+toolBar.getTopHeight()+"px"});this.leftButton.css({width:this.leftButtonWidth+"px",height:this.leftButtonHeight+"px",left:Math.max(0,(this.stageWidth-this.containtWidth)/2+leftMargin-this.leftButtonWidth)+"px",top:(this.stageHeight-this.firstButtonHeight-this.leftButtonHeight)/
2+topMargin+toolBar.getTopHeight()+this.firstButtonHeight+1+"px"});this.rightButton.css({width:this.leftButtonWidth+"px",height:this.leftButtonHeight+"px",left:Math.min(windowWidth-this.leftButtonWidth,(this.stageWidth+this.containtWidth)/2+leftMargin)+"px",top:(this.stageHeight-this.firstButtonHeight-this.leftButtonHeight)/2+topMargin+toolBar.getTopHeight()+this.firstButtonHeight+1+"px"});this.firstButton.css({width:this.firstButtonWidth+"px",height:this.firstButtonHeight+"px",left:Math.max(0,(this.stageWidth-
this.containtWidth)/2+leftMargin-this.firstButtonWidth)+"px",top:(this.stageHeight-this.firstButtonHeight-this.leftButtonHeight)/2+topMargin+toolBar.getTopHeight()+"px"});this.lastButton.css({width:this.firstButtonWidth+"px",height:this.firstButtonHeight+"px",left:Math.min(windowWidth-this.firstButtonWidth,(this.stageWidth+this.containtWidth)/2+leftMargin)+"px",top:(this.stageHeight-this.firstButtonHeight-this.leftButtonHeight)/2+topMargin+toolBar.getTopHeight()+"px"});this.firstImg.css({left:"7px",
top:(this.firstButtonHeight-16)/2+"px",position:"absolute"});this.lastImg.css({left:"7px",top:(this.firstButtonHeight-16)/2+"px",position:"absolute"});this.leftImg.css({left:"7px",top:(this.leftButtonHeight-16)/2+"px"});this.rightImg.css({left:"7px",top:(this.leftButtonHeight-16)/2+"px"})};
initSlideBook.prototype.changeMoveMode=function(){!0==this.moveByPoints?(this.moveByPoints=!1,this.moveMode.empty().append(getImage(toolBarIconsURL[ICON_MOVE_POSITION])).attr("title","Move by mouse position")):(this.moveByPoints=!0,this.moveMode.empty().append(getImage(toolBarIconsURL[ICON_MOVE_DRAG])).attr("title","Move by mouse drag"));this.moveMode.children("img").css({"margin-left":"3px","margin-top":"3px"})};initSlideBook.prototype.getCurrentPageIndex=function(){return this.currentIndex};
initSlideBook.prototype.onResize=function(a,b){this.toScale=1;this.stageWidth=a;this.stageHeight=b;var c=getPageWidthHeight(a/2,b,zoomPageWidth,zoomPageHeight);this.width=2*c.x;this.height=c.y;this.minZoomWidth=2*c.x;this.minZoomHeight=c.y;this.containtWidth=Math.min(this.width*this.toScale,this.stageWidth);this.containtHeight=Math.min(this.height*this.toScale,this.stageHeight);this.setButtonProperty();this.resizeButton();this.scrollBox.css({left:(windowWidth-this.scrollWidth)/2+"px",bottom:toolBar.getBottomHeight()+
10+"px"});this.prePage.onWinResize(this.containtWidth,this.containtHeight,!0);this.showPage.onWinResize(this.containtWidth,this.containtHeight,!0);this.nextPage.onWinResize(this.containtWidth,this.containtHeight,!0);parseBool(bookConfig.RightToLeft)?(this.nextPage.setTranslate(-this.nextPage.getWidth(),0),this.prePage.setTranslate(this.width*this.toScale,0)):(this.prePage.setTranslate(-this.prePage.getWidth(),0),this.nextPage.setTranslate(this.width*this.toScale,0));this.scrollButton.transform(0,
0)};initSlideBook.prototype.setTranslate=function(a,b,c){a.transform(b,c)};
initSlideBook.prototype.gotoPage=function(a){var b=this;this.prePage.clearHighlight();this.nextPage.clearHighlight();0==a&&(a=1);if(this.currentIndex==a||1>a||a>originTotalPageCount||this.isFlipping){var c=1>a?"This is the first page":"This is the last page";if(1>a||a>originTotalPageCount)b.translateToOrigin(0),_tipsBox.setCaption(c),_tipsBox.showTipsBox()}else{this.isFlipping=!0;this.diffPageCount=a-this.currentIndex;var d=0,e=this.showPage,f=void 0,b=this,c=parseBool(bookConfig.RightToLeft)?Point(0,
-e.getWidth()):Point(0,e.getWidth());centerP=Point(0,0);this.currentIndex>a?(f=this.prePage,d=c.y):(f=this.nextPage,d=-c.y);tragetToLeft=centerP.x;f.fillTemp(a);(function(){var c=getPoint(e.side),h=getPoint(f.side);e.getScaleFromFit();var j=30,k=bookConfig.flippingTime*1E3;k!=void 0&&k>0&&(j=k/20);var j=5,m=0,l=window.setInterval(function(){var k=Point(0,0),o=Point(0,0);k.x=$.easing.swing(null,m,c.x,d-c.x,j);o.x=$.easing.swing(null,m,h.x,tragetToLeft-h.x,j);m++;e.setTranslate(k.x,k.y);f.setTranslate(o.x,
o.y);if(m>j){window.clearInterval(l);window.setTimeout(function(){auto_player.resetTimer();b.changePage();b.endFlip(a);b.isFlipping=false},20)}},20)})()}};initSlideBook.prototype.changePage=function(){var a=null;0<this.diffPageCount?(a=this.showPage,this.showPage=this.nextPage,this.nextPage=this.prePage):(a=this.nextPage,this.nextPage=this.showPage,this.showPage=this.prePage);this.prePage=a};initSlideBook.prototype.addSearchHighlight=function(){this.showPage.highlightSearch(this.currentIndex)};
initSlideBook.prototype.clearSearchHighlight=function(){this.showPage.clearHighlight()};
initSlideBook.prototype.endFlip=function(a){a=2*parseInt(a/2);0==a&&(a=1);this.currentIndex=a;this.fillNear(a);setCurrentIndexTextField(this.currentIndex,!1);window.location.hash="#p="+this.currentIndex;sendvisitinfo(1,this.currentIndex);thumbnail.clearHighLight();thumbnail.setHighLight(this.currentIndex);parseBool(bookConfig.RightToLeft)?(this.nextPage.setTranslate(-this.nextPage.getWidth(),0),this.prePage.setTranslate(this.width*this.toScale,0)):(this.prePage.setTranslate(-this.prePage.getWidth(),
0),this.nextPage.setTranslate(this.width*this.toScale,0));this.addSearchHighlight()};initSlideBook.prototype.setVisible=function(a){this.bookContainer.css({display:a?"block":"none"})};initSlideBook.prototype.setPosition=function(a,b){this.book.css({left:a+"px",top:b+"px"})};
initSlideBook.prototype.fillNear=function(a){a=2*parseInt(a/2);0<=a&&this.prePage.fillContent(a-2);this.showPage.changeContent(a);a<=originTotalPageCount&&this.nextPage.fillContent(a+2);this.prePage.resetSlider();this.showPage.playSlider();this.nextPage.resetSlider();this.addHistoryTexts()};
initSlideBook.prototype.initEvent=function(){function a(a){a=isTouch?a.originalEvent.touches:[a];a=Math.max(a[0].pageX-d.x+c.translateX,0);a=Math.min(a,101);c.scrollButton.transform(a,0);c.zoomToScale(c.minZoomWidth/c.width+a*(c.largeZoomWidth-c.minZoomWidth)/(101*c.width)-c.toScale);c.isZoomming=!0}function b(){$("*").unbind(_event._move,a);$("*").unbind(_event._end,b);e=!1;c.isZoomming=!1}var c=this,d=Point(0,0),e=!1;$(this.scrollButton).bind(_event._enter,function(){$(c.scrollButton).css({cursor:"pointer"});
c.scrollButton.css({background:"#aaaaaa"})});$(this.scrollButton).bind(_event._down,function(f){f=isTouch?f.originalEvent.touches:[f];d=Point(f[0].pageX,f[0].pageY);f=getPoint(c.scrollButton);c.translateX=f.x;e=!0;try{$("*").bind(_event._end,b),$("*").bind(_event._move,a)}catch(h){}});$(this.scrollButton).bind(_event._move,function(a){a=isTouch?a.originalEvent.touches:[a];if(e){var b=Math.max(a[0].pageX-d.x+c.translateX,0),b=Math.min(b,101);c.scrollButton.transform(b,0);c.zoomToScale(c.minZoomWidth/
c.width+b*(c.largeZoomWidth-c.minZoomWidth)/(101*c.width)-c.toScale)}stopEvent(a)});$(this.scrollButton).bind(_event._end,function(a){e=!1;var b=getPoint(c.scrollButton);if(void 0==b||null==b)b=Point(0,0);c.zoomToScale(c.minZoomWidth/c.width+b.x*(c.largeZoomWidth-c.minZoomWidth)/(101*c.width)-c.toScale);stopEvent(a)});var f;this.scrollBar.bind(_event._enter,function(){c.scrollBar.css("cursor","pointer")});this.scrollBar.bind(_event._down,function(a){a=isTouch?a.originalEvent.touches:[a];f=Point(a[0].pageX,
a[0].pageY);a=Math.max(f.x-parseInt(c.scrollBox.css("left"))-37-12,0);a=Math.min(a,101);c.zoomToScale(c.minZoomWidth/c.width+a*(c.largeZoomWidth-c.minZoomWidth)/(101*c.width)-c.toScale)});this.scrollBar.bind(_event._end,function(){});this.scrollBox.bind(_event._enter,function(){c.scrollBox.animate({opacity:"0.9"},500)});this.scrollBox.bind(_event._leave,function(){c.scrollBox.animate({opacity:"0.3"},500)});this.leftButton.bind(_event._enter,function(){c.leftButton.css({background:"#000000"})});this.rightButton.bind(_event._enter,
function(){c.rightButton.css({background:"#000000"})});this.leftButton.bind(_event._leave,function(){c.leftButton.css({background:"#888888"})});this.rightButton.bind(_event._leave,function(){c.rightButton.css({background:"#888888"})});this.leftButton.bind(_event._end,function(){c.leftButton.css({background:"#888888"})});this.rightButton.bind(_event._end,function(){c.rightButton.css({background:"#888888"})});this.leftButton.bind(_event._end,function(){parseBool(bookConfig.RightToLeft)?c.gotoPage(2*
parseInt(c.currentIndex/2)+2):c.gotoPage(2*parseInt(c.currentIndex/2)-2)});this.rightButton.bind(_event._end,function(){parseBool(bookConfig.RightToLeft)?c.gotoPage(2*parseInt(c.currentIndex/2)-2):c.gotoPage(2*parseInt(c.currentIndex/2)+2)});this.leftButton.bind(_event._over,function(){c.leftButton.css({cursor:"pointer"})});this.rightButton.bind(_event._over,function(){c.rightButton.css({cursor:"pointer"})});this.firstButton.bind(_event._over,function(){c.firstButton.css({cursor:"pointer"})});this.lastButton.bind(_event._over,
function(){c.lastButton.css({cursor:"pointer"})});this.firstButton.bind(_event._enter,function(){c.firstButton.css({background:"#000000"})});this.lastButton.bind(_event._enter,function(){c.lastButton.css({background:"#000000"})});this.firstButton.bind(_event._leave,function(){c.firstButton.css({background:"#888888"})});this.lastButton.bind(_event._leave,function(){c.lastButton.css({background:"#888888"})});this.firstButton.bind(_event._end,function(){c.firstButton.css({background:"#888888"})});this.lastButton.bind(_event._end,
function(){c.lastButton.css({background:"#888888"})});this.firstButton.bind(_event._end,function(){c.gotoPage(0)});this.lastButton.bind(_event._end,function(){c.gotoPage(originTotalPageCount)});$(this.zoomUp).bind(_event._enter,function(){$(c.zoomUp).css({cursor:"pointer"});$(c.zoomUp).css({background:"#555555"})});$(this.zoomDown).bind(_event._enter,function(){$(c.zoomDown).css({cursor:"pointer"});$(c.zoomDown).css({background:"#555555"})});$(this.zoomUp).bind(_event._down,function(){c.zoomAnimate(0.5)});
$(this.moveMode).bind(_event._enter,function(){$(c.moveMode).css({cursor:"pointer"});$(c.moveMode).css({background:"#555555"})});$(this.zoomDown).bind(_event._down,function(){c.zoomAnimate(-0.5)});$(this.zoomUp).bind(_event._leave,function(){$(c.zoomUp).css({background:""})});$(this.zoomDown).bind(_event._leave,function(){$(c.zoomDown).css({background:""})});$(this.moveMode).bind(_event._leave,function(){$(c.moveMode).css({background:""})});this.moveMode.bind(_event._end,function(){c.changeMoveMode()})};
initSlideBook.prototype.translateToOrigin=function(a){this.isFlipping=!0;this.showPage.setTranslate(0,a,100);parseBool(bookConfig.RightToLeft)?(this.prePage.setTranslate(this.containtWidth,0,100),this.nextPage.setTranslate(-this.containtWidth,0,100)):(this.nextPage.setTranslate(this.containtWidth,0,100),this.prePage.setTranslate(-this.containtWidth,0,100));this.isFlipping=!1};
initSlideBook.prototype.initTranslate=function(){var a=getPoint(this.showPage.side),b=getPoint(this.prePage.side),c=getPoint(this.nextPage.side);this.tran=Point(a.x,a.y);this.pretran=Point(b.x,b.y);this.nexttran=Point(c.x,c.y)};initSlideBook.prototype.translateMove=function(a,b){this.showPage.setTranslate(a+this.tran.x,b);this.prePage.setTranslate(a+this.pretran.x,0);this.nextPage.setTranslate(a+this.nexttran.x,0)};
initSlideBook.prototype.initMouseEvt=function(){var a=this,b=Point(0,0),c=!1,d=null;this.book.bind(_event._down,function(e){if(bookType==BookType.slide_book)return c=!0,b.x=e.pageX,b.y=e.pageY,d={x:a.book.offset().left,y:a.book.offset().top},!1});this.book.bind(_event._end,function(){bookType==BookType.slide_book&&(c=!1)});this.book.bind(_event._move,function(e){bookType==BookType.slide_book&&c&&bookType==BookType.slide_book&&a.book.css({left:e.pageX-b.x+d.x+"px",top:e.pageY-b.y+d.y+"px"})});this.book.bind("mouseleave",
function(){})};initSlideBook.prototype.initTouchEvt=function(){};initSlideBook.prototype.zoomAnimate=function(a){this.showPage.zoom(a,0);parseBool(bookConfig.RightToLeft)?(this.prePage.zoom(a,1),this.nextPage.zoom(a,-1)):(this.prePage.zoom(a,-1),this.nextPage.zoom(a,1))};
initSlideBook.prototype.zoomToScale=function(a){this.showPage.zoomToScale(a,0);parseBool(bookConfig.RightToLeft)?(this.prePage.zoomToScale(a,1),this.nextPage.zoomToScale(a,-1)):(this.prePage.zoomToScale(a,-1),this.nextPage.zoomToScale(a,1))};initSlideBook.prototype.scrollButtonTran=function(a){a=Math.max(a,0);a=Math.min(a,101);this.scrollButton.transform(a,0)};initSlideBook.prototype.noZoom=function(){this.showPage.noZoom()};initSlideBook.prototype.getLeft=function(){return this.showPage.side.offset().left};
initSlideBook.prototype.getTop=function(){return this.showPage.side.offset().top};initSlideBook.prototype.getWidth=function(){return this.showPage.getWidth()};initSlideBook.prototype.getHeight=function(){return this.showPage.getHeight()};initSlideBook.prototype.getScale=function(){return this.showPage.getScale()};initSlideBook.prototype.bookWidth=function(){return this.containtWidth};initSlideBook.prototype.bookHeight=function(){return this.containtHeight};
initSlideBook.prototype.show=function(){debug("slide book show.");this.setVisible(!0);this.prePage.showPage();this.nextPage.showPage();this.showPage.hidePage();var a=this;window.setTimeout(function(){a.showPage.showPage();a.addSearchHighlight(this.currentIndex);a.showPage.playSlider()},500);void 0!=leftRightButton&&null!=leftRightButton&&leftRightButton.setShow(!1);this.addHistoryTexts()};initSlideBook.prototype.addHistoryTexts=function(){this.showPage.addHistoryTexts()};
initSlideBook.prototype.hide=function(){debug("slide book hide.");this.setVisible(!1);hideLeftRightButton()&&leftRightButton.setShow(!0);this.showPage.resetSlider()};
var CatalogBook=Class({create:function(a){this._super(a);this.prePage=new CatalogPage(this.bookPage);this.nextPage=new CatalogPage(this.bookPage);this.showPage=new CatalogPage(this.bookPage);this.prePage.setChildIndex(1);this.showPage.setChildIndex(3);this.nextPage.setChildIndex(2);this.bookMap=new ZoomSideMap(this);this.bookMap.resetPosition=function(){this.divThumb.css({right:20,bottom:20})};this.controlBar=new ControlBar;this.fillNear(1);this.doublePage=!0;this.zoomOut()},zoomOut:function(){this.book.removeClass();
this.book.attr("class","slider view-read");this.book.css({border:"1px solid #ffffff"});this.leftButton.show();this.rightButton.show();this.firstButton.show();this.lastButton.show();this.bookMap.hide();this.controlBar.hide();bookType==BookType.catalog_book&&toolBar.show();void 0!=catalogBook&&this.showPage.zoomOut()},zoomIn:function(){this.book.removeClass();this.book.attr("class","slider view-zoom");this.book.css({border:""});this.prePage.setVisible(!1);this.nextPage.setVisible(!1);this.leftButton.hide();
this.rightButton.hide();this.firstButton.hide();this.lastButton.hide();this.bookMap.show();this.controlBar.show();bookType==BookType.catalog_book&&toolBar.hide();bookType==BookType.catalog_book&&thumbnail.hideBox();void 0!=catalogBook&&this.showPage.zoomIn()},gotoPage:function(a){this.showPage.zoomed&&this.zoomOut();this.showPage.isZomming||this._super(a)},onResize:function(a,b){this._super(a,b);this.moveWidth=this.stageWidth;this.moveHeight=this.stageHeight;this.zoomOut();this.bookMap.resize(windowWidth,
windowHeight)},fillNear:function(a){this._super(a);this.bookMap.fillContent(a)},setButtonProperty:function(){this.leftButtonHeight=90;this.firstButtonHeight=49;this.firstButtonWidth=this.leftButtonWidth=30}}).extend(initSlideBook);
function ControlBar(){this.background=$("<div></div>");this.leftbar=$("<div></div>");this.topbar=$("<div></div>");this.rightbar=$("<div></div>");this.bottombar=$("<div></div>");this.leftbutton=$("<div></div>");this.topbutton=$("<div></div>");this.rightbutton=$("<div></div>");this.bottombutton=$("<div></div>");this.controlBack=$("<img src='"+uiBaseURL+"controlButton.png'/>");this.lightColor="#aaaaaa";this.dullColor="#555555";this.background.css({width:65,height:65,left:20,top:20,"z-index":202,display:"none",
position:"absolute"});this.controlBack.css({width:65,height:65,position:"absolute","z-index":2});this.leftbar.css({width:15,height:15,left:15,top:25,background:this.dullColor,position:"absolute","z-index":1});this.topbar.css({width:15,height:15,left:25,top:15,background:this.dullColor,position:"absolute","z-index":1});this.rightbar.css({width:15,height:15,right:15,top:25,background:this.dullColor,position:"absolute","z-index":1});this.bottombar.css({width:15,height:15,left:25,bottom:15,background:this.dullColor,
position:"absolute","z-index":1});this.leftbutton.css({width:15,height:15,left:15,top:25,position:"absolute","z-index":3});this.topbutton.css({width:15,height:15,left:25,top:15,position:"absolute","z-index":3});this.rightbutton.css({width:15,height:15,right:15,top:25,position:"absolute","z-index":3});this.bottombutton.css({width:15,height:15,left:25,bottom:15,position:"absolute","z-index":3});bookContainer.append(this.background);this.background.append(this.leftbar);this.background.append(this.topbar);
this.background.append(this.rightbar);this.background.append(this.bottombar);this.background.append(this.leftbutton);this.background.append(this.topbutton);this.background.append(this.rightbutton);this.background.append(this.bottombutton);this.background.append(this.controlBack);this.initEvent()}
ControlBar.prototype={show:function(){this.background.show()},hide:function(){this.background.hide()},setDullOrLight:function(a,b,c,d){a?this.leftbar.css({background:this.lightColor}):this.leftbar.css({background:this.dullColor});b?this.topbar.css({background:this.lightColor}):this.topbar.css({background:this.dullColor});c?this.rightbar.css({background:this.lightColor}):this.rightbar.css({background:this.dullColor});d?this.bottombar.css({background:this.lightColor}):this.bottombar.css({background:this.dullColor})},
initEvent:function(){var a=this;this.leftbutton.bind(_event._end,function(){BookInfo.getBook().showPage.inertiaMove(50,0)});this.rightbutton.bind(_event._end,function(){BookInfo.getBook().showPage.inertiaMove(-50,0)});this.topbutton.bind(_event._end,function(){BookInfo.getBook().showPage.inertiaMove(0,50)});this.bottombutton.bind(_event._end,function(){BookInfo.getBook().showPage.inertiaMove(0,-50)});this.leftbutton.bind(_event._over,function(){a.leftbutton.css({cursor:"pointer"})});this.rightbutton.bind(_event._over,
function(){a.rightbutton.css({cursor:"pointer"})});this.topbutton.bind(_event._over,function(){a.topbutton.css({cursor:"pointer"})});this.bottombutton.bind(_event._over,function(){a.bottombutton.css({cursor:"pointer"})})}};function initSingleSlideBook(a){this.create(a);this.bookContainer.append(this.scrollBox);this.prePage=new singleSlideSide(this.bookPage);this.nextPage=new singleSlideSide(this.bookPage);this.showPage=new singleSlideSide(this.bookPage);this.prePage.setChildIndex(1);this.showPage.setChildIndex(3);this.nextPage.setChildIndex(2);this.fillNear(1)}
initSingleSlideBook.prototype.create=function(a){this.bookContainer=$("<div style='left:0px;right:0px;top:0px;bottom:0px;position:absolute;display:none;'></div>");this.book=$("<div></div>");this.bookPage=$("<div></div>");this.leftButton=$("<div></div>");this.rightButton=$("<div></div>");this.firstButton=$("<div></div>");this.lastButton=$("<div></div>");this.scrollBox=$("<div></div>");this.scrollBar=$("<div></div>");this.scrollButton=$("<div></div>");this.width=zoomPageWidth;this.height=zoomPageHeight;
this.diffPageCount=0;this.currentIndex=1;this.showingPage=this.flipPage=null;this.isMove=this.isFlipping=!1;this.minZoomHeight=this.minZoomWidth=500;this.largeZoomWidth=2.5*zoomPageWidth;this.largeZoomHeight=2.5*zoomPageHeight;this.scrollWidth=234;this.moveByPoints=!1;a.append(this.bookContainer);this.bookContainer.append(this.book);this.bookContainer.append(this.leftButton);this.bookContainer.append(this.rightButton);this.bookContainer.append(this.firstButton);this.bookContainer.append(this.lastButton);
this.leftImg=$('<img src="'+uiBaseURL+'slide_leftButton.png"></img>');this.rightImg=$('<img src="'+uiBaseURL+'slide_rightButton.png"></img>');this.firstImg=$('<img src="'+uiBaseURL+'slide_firstButton.png"></img>');this.lastImg=$('<img src="'+uiBaseURL+'slide_lastButton.png"></img>');this.zoomUp=$("<div></div>").attr("title","zoomUp");this.zoomUp.append($('<img src="'+uiBaseURL+"ZU.png\" style='margin-top:3px;margin-left:3px;'></img>"));this.zoomDown=$("<div></div>").attr("title","zoomDown");this.zoomDown.append($('<img src="'+
uiBaseURL+"ZD.png\" style='margin-top:3px;margin-left:3px;'></img>"));this.moveMode=$("<div></div>").attr("title","Move by mouse position");this.moveMode.append($('<img src="'+uiBaseURL+"moveByPos.png\" style='margin-top:3px;margin-left:3px;'></img>"));this.leftButton.append(this.leftImg);this.rightButton.append(this.rightImg);this.firstButton.append(this.firstImg);this.lastButton.append(this.lastImg);this.scrollBox.append($(this.zoomUp));this.scrollBox.append($(this.zoomDown));this.scrollBox.append($(this.moveMode));
this.scrollBox.append($(this.scrollBar));this.scrollBox.append($(this.scrollButton));this.book.append(this.bookPage);this.book.attr("class","slider view-read");this.leftButton.css({position:"absolute",position:"absolute","-webkit-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","-moz-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","-o-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","-ms-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","z-index":"10",
"border-radius":"0px 0px 0px 10px","border-top":"1px solid #ffffff",opacity:"0.5",background:"#888888"});this.rightButton.css({position:"absolute","z-index":"10","border-top":"1px solid #ffffff",position:"absolute","-webkit-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","-moz-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","-o-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","-ms-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","border-radius":"0px 0px 10px 0px",
opacity:"0.5",background:"#888888"});this.firstButton.css({position:"absolute","z-index":"10",position:"absolute","-webkit-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","-moz-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","-o-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","-ms-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","border-bottom":"1px solid #000000","border-radius":"10px 0px 0px 0px",opacity:"0.5",background:"#888888"});this.lastButton.css({position:"absolute",
"z-index":"10",position:"absolute","-webkit-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","-moz-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","-o-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","-ms-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","border-radius":"0px 10px 0px 0px","border-bottom":"1px solid #000000",opacity:"0.5",background:"#888888"});this.leftImg.css({position:"absolute"});this.rightImg.css({position:"absolute"});this.firstImg.css({position:"absolute"});
this.lastImg.css({position:"absolute"});this.scrollBox.css({"-webkit-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","-moz-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","-o-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","-ms-box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)","box-shadow":"0px 0px 10px rgba(40, 40, 40, 0.8)",width:this.scrollWidth+"px",height:"35px",position:"absolute","z-index":"11",background:"#333333",opacity:"0.3"});this.scrollBar.css({width:"126px",height:"5px",left:"37px",
top:"15px",position:"absolute",background:"#ffffff",opacity:"0.5"});this.scrollButton.css({width:"25px",height:"25px",left:"37px",top:"5px",position:"absolute","border-radius":"3px",background:"#ffffff"});this.zoomUp.css({width:"25px",height:"25px",position:"absolute",right:"29px",top:"5px"});this.zoomDown.css({width:"25px",height:"25px",position:"absolute",left:"2px",top:"5px"});this.moveMode.css({width:"25px",height:"25px",position:"absolute",right:"2px",top:"5px"});this.toScale=1;this.initEvent();
void 0!=leftRightButton&&null!=leftRightButton&&leftRightButton.setShow(!1)};initSingleSlideBook.prototype.setButtonProperty=function(){this.leftButtonHeight=this.containtHeight-60;this.firstButtonHeight=49;this.firstButtonWidth=this.leftButtonWidth=30};
initSingleSlideBook.prototype.resizeButton=function(){this.book.css({width:this.containtWidth+"px",height:this.containtHeight+"px",left:(this.stageWidth-this.containtWidth)/2+leftMargin+"px",top:(this.stageHeight-this.containtHeight)/2+topMargin+toolBar.getTopHeight()+"px"});this.leftButton.css({width:this.leftButtonWidth+"px",height:this.leftButtonHeight+"px",left:Math.max(0,(this.stageWidth-this.containtWidth)/2+leftMargin-this.leftButtonWidth)+"px",top:(this.stageHeight-this.firstButtonHeight-
this.leftButtonHeight)/2+topMargin+toolBar.getTopHeight()+this.firstButtonHeight+1+"px"});this.rightButton.css({width:this.leftButtonWidth+"px",height:this.leftButtonHeight+"px",left:Math.min(windowWidth-this.leftButtonWidth,(this.stageWidth+this.containtWidth)/2+leftMargin)+"px",top:(this.stageHeight-this.firstButtonHeight-this.leftButtonHeight)/2+topMargin+toolBar.getTopHeight()+this.firstButtonHeight+1+"px"});this.firstButton.css({width:this.firstButtonWidth+"px",height:this.firstButtonHeight+
"px",left:Math.max(0,(this.stageWidth-this.containtWidth)/2+leftMargin-this.firstButtonWidth)+"px",top:(this.stageHeight-this.firstButtonHeight-this.leftButtonHeight)/2+topMargin+toolBar.getTopHeight()+"px"});this.lastButton.css({width:this.firstButtonWidth+"px",height:this.firstButtonHeight+"px",left:Math.min(windowWidth-this.firstButtonWidth,(this.stageWidth+this.containtWidth)/2+leftMargin)+"px",top:(this.stageHeight-this.firstButtonHeight-this.leftButtonHeight)/2+topMargin+toolBar.getTopHeight()+
"px"});this.firstImg.css({left:"7px",top:(this.firstButtonHeight-16)/2+"px",position:"absolute"});this.lastImg.css({left:"7px",top:(this.firstButtonHeight-16)/2+"px",position:"absolute"});this.leftImg.css({left:"7px",top:(this.leftButtonHeight-16)/2+"px"});this.rightImg.css({left:"7px",top:(this.leftButtonHeight-16)/2+"px"})};
initSingleSlideBook.prototype.changeMoveMode=function(){!0==this.moveByPoints?(this.moveByPoints=!1,this.moveMode.empty().append(getImage(toolBarIconsURL[ICON_MOVE_POSITION])).attr("title","Move by mouse position")):(this.moveByPoints=!0,this.moveMode.empty().append(getImage(toolBarIconsURL[ICON_MOVE_DRAG])).attr("title","Move by mouse drag"));this.moveMode.children("img").css({"margin-left":"3px","margin-top":"3px"})};initSingleSlideBook.prototype.getLeft=function(){return this.showPage.side.offset().left};
initSingleSlideBook.prototype.getTop=function(){return this.showPage.side.offset().top};initSingleSlideBook.prototype.getWidth=function(){return this.showPage.getWidth()};initSingleSlideBook.prototype.getHeight=function(){return this.showPage.getHeight()};initSingleSlideBook.prototype.getScale=function(){return this.showPage.getScale()};
initSingleSlideBook.prototype.onResize=function(a,b){this.toScale=1;this.stageWidth=a;this.stageHeight=b;var c=getPageWidthHeight(a,b,zoomPageWidth,zoomPageHeight);this.width=c.x;this.height=c.y;this.minZoomWidth=c.x;this.minZoomHeight=c.y;this.largeZoomWidth=1.5*zoomPageWidth;this.largeZoomHeight=1.5*zoomPageHeight;this.containtWidth=Math.min(this.width*this.toScale,this.stageWidth);this.containtHeight=Math.min(this.height*this.toScale,this.stageHeight);this.setButtonProperty();this.resizeButton();
this.scrollBox.css({left:(windowWidth-this.scrollWidth)/2+"px",bottom:toolBar.getBottomHeight()+10+"px"});this.prePage.onWinResize(this.containtWidth,this.containtHeight,!0);this.showPage.onWinResize(this.containtWidth,this.containtHeight,!0);this.nextPage.onWinResize(this.containtWidth,this.containtHeight,!0);parseBool(bookConfig.RightToLeft)?(this.nextPage.setTranslate(-this.nextPage.getWidth(),0),this.prePage.setTranslate(this.width*this.toScale,0)):(this.prePage.setTranslate(-this.prePage.getWidth(),
0),this.nextPage.setTranslate(this.width*this.toScale,0));this.scrollButton.transform(0,0)};initSingleSlideBook.prototype.setTranslate=function(a,b,c){a.transform(b,c)};
initSingleSlideBook.prototype.gotoPage=function(a){var b=this;this.prePage.clearHighlight();this.nextPage.clearHighlight();if(this.currentIndex==a||1>a||a>originTotalPageCount||this.isFlipping){var c=1>a?"This is the first page":"This is the last page";if(1>a||a>originTotalPageCount)b.translateToOrigin(0),_tipsBox.setCaption(c),_tipsBox.showTipsBox()}else{this.isFlipping=!0;this.diffPageCount=a-this.currentIndex;var d=0,e=this.showPage,f=void 0,b=this,c=parseBool(bookConfig.RightToLeft)?Point(0,-this.width*
this.toScale):Point(0,this.width*this.toScale);centerP=Point(0,0);this.currentIndex>a?(f=this.prePage,d=c.y):(f=this.nextPage,d=-c.y);tragetToLeft=centerP.x;f.fillTemp(a);(function(){var c=getPoint(e.side),h=getPoint(f.side);e.getScaleFromFit();var j=30,k=bookConfig.flippingTime*1E3;k!=void 0&&k>0&&(j=k/20);var m=0,l=window.setInterval(function(){var k=Point(0,0),o=Point(0,0);k.x=$.easing.swing(null,m,c.x,d-c.x,j);o.x=$.easing.swing(null,m,h.x,tragetToLeft-h.x,j);m++;e.setTranslate(k.x,k.y);f.setTranslate(o.x,
o.y);if(m>j){window.clearInterval(l);window.setTimeout(function(){auto_player.resetTimer();b.changePage();b.endFlip(a);b.isFlipping=false},20)}},20)})()}};initSingleSlideBook.prototype.changePage=function(){var a=null;0<this.diffPageCount?(a=this.showPage,this.showPage=this.nextPage,this.nextPage=this.prePage):(a=this.nextPage,this.nextPage=this.showPage,this.showPage=this.prePage);this.prePage=a};initSingleSlideBook.prototype.addSearchHighlight=function(){this.showPage.highlightSearch(this.currentIndex)};
initSingleSlideBook.prototype.clearSearchHighlight=function(){this.showPage.clearHighlight()};
initSingleSlideBook.prototype.endFlip=function(a){this.currentIndex=a;this.fillNear(a);setCurrentIndexTextField(this.currentIndex,!1);window.location.hash="#p="+this.currentIndex;sendvisitinfo(1,this.currentIndex);thumbnail.clearHighLight();thumbnail.setHighLight(this.currentIndex);parseBool(bookConfig.RightToLeft)?(this.nextPage.setTranslate(-this.nextPage.getWidth(),0),this.prePage.setTranslate(this.width*this.toScale,0)):(this.prePage.setTranslate(-this.prePage.getWidth(),0),this.nextPage.setTranslate(this.width*
this.toScale,0));this.addSearchHighlight()};initSingleSlideBook.prototype.setVisible=function(a){this.bookContainer.css({display:a?"block":"none"})};initSingleSlideBook.prototype.setPosition=function(a,b){this.book.css({left:a+"px",top:b+"px"})};
initSingleSlideBook.prototype.fillNear=function(a){1<=a&&this.prePage.fillContent(a-1);this.showPage.changeContent(a);a<=originTotalPageCount&&this.nextPage.fillContent(a+1);this.prePage.resetSlider();this.showPage.playSlider();this.nextPage.resetSlider();this.addHistoryTexts()};initSingleSlideBook.prototype.addHistoryTexts=function(){this.showPage.addHistoryTexts()};
initSingleSlideBook.prototype.initEvent=function(){function a(a){a=isTouch?a.originalEvent.touches:[a];a=Math.max(a[0].pageX-d.x+c.translateX,0);a=Math.min(a,101);c.scrollButton.transform(a,0);c.zoomToScale(c.minZoomWidth/c.width+a*(c.largeZoomWidth-c.minZoomWidth)/(101*c.width)-c.toScale);c.isZoomming=!0}function b(){$("*").unbind(_event._move,a);$("*").unbind(_event._end,b);e=!1;c.isZoomming=!1}var c=this,d=Point(0,0),e=!1;$(this.scrollButton).bind(_event._enter,function(){$(c.scrollButton).css({cursor:"pointer"});
c.scrollButton.css({background:"#aaaaaa"})});$(this.scrollButton).bind(_event._down,function(f){f=isTouch?f.originalEvent.touches:[f];d=Point(f[0].pageX,f[0].pageY);f=getPoint(c.scrollButton);c.translateX=f.x;e=!0;try{$("*").bind(_event._end,b),$("*").bind(_event._move,a)}catch(h){}});$(this.scrollButton).bind(_event._move,function(a){a=isTouch?a.originalEvent.touches:[a];e&&(a=Math.max(a[0].pageX-d.x+c.translateX,0),a=Math.min(a,101),c.scrollButton.transform(a,0),c.zoomToScale(c.minZoomWidth/c.width+
a*(c.largeZoomWidth-c.minZoomWidth)/(101*c.width)-c.toScale))});$(this.scrollButton).bind(_event._end,function(a){e=!1;var b=getPoint(c.scrollButton);if(void 0==b||null==b)b=Point(0,0);c.zoomToScale(c.minZoomWidth/c.width+b.x*(c.largeZoomWidth-c.minZoomWidth)/(101*c.width)-c.toScale);stopEvent(a)});var f;this.scrollBar.bind(_event._enter,function(){c.scrollBar.css("cursor","pointer")});this.scrollBar.bind(_event._down,function(a){a=isTouch?a.originalEvent.touches:[a];f=Point(a[0].pageX,a[0].pageY);
a=Math.max(f.x-parseInt(c.scrollBox.css("left"))-37-12,0);a=Math.min(a,101);c.zoomToScale(c.minZoomWidth/c.width+a*(c.largeZoomWidth-c.minZoomWidth)/(101*c.width)-c.toScale)});this.scrollBar.bind(_event._end,function(){});this.scrollBox.bind(_event._enter,function(){c.scrollBox.animate({opacity:"0.9"},500)});this.scrollBox.bind(_event._leave,function(){c.scrollBox.animate({opacity:"0.3"},500)});this.leftButton.bind(_event._enter,function(){c.leftButton.css({background:"#000000"})});this.rightButton.bind(_event._enter,
function(){c.rightButton.css({background:"#000000"})});this.leftButton.bind(_event._leave,function(){c.leftButton.css({background:"#888888"})});this.rightButton.bind(_event._leave,function(){c.rightButton.css({background:"#888888"})});this.leftButton.bind(_event._end,function(){c.leftButton.css({background:"#888888"})});this.rightButton.bind(_event._end,function(){c.rightButton.css({background:"#888888"})});this.leftButton.bind(_event._down,function(){parseBool(bookConfig.RightToLeft)?nextPageFun():
previousPageFun()});this.rightButton.bind(_event._down,function(){parseBool(bookConfig.RightToLeft)?previousPageFun():nextPageFun()});this.firstButton.bind(_event._enter,function(){c.firstButton.css({background:"#000000"})});this.lastButton.bind(_event._enter,function(){c.lastButton.css({background:"#000000"})});this.firstButton.bind(_event._leave,function(){c.firstButton.css({background:"#888888"})});this.lastButton.bind(_event._leave,function(){c.lastButton.css({background:"#888888"})});this.firstButton.bind(_event._end,
function(){c.firstButton.css({background:"#888888"})});this.lastButton.bind(_event._end,function(){c.lastButton.css({background:"#888888"})});this.firstButton.bind(_event._down,function(){c.gotoPage(1)});this.lastButton.bind(_event._down,function(){c.gotoPage(originTotalPageCount)});$(this.zoomUp).bind(_event._enter,function(){$(c.zoomUp).css({cursor:"pointer"});$(c.zoomUp).css({background:"#555555"})});$(this.zoomDown).bind(_event._enter,function(){$(c.zoomDown).css({cursor:"pointer"});$(c.zoomDown).css({background:"#555555"})});
$(this.moveMode).bind(_event._enter,function(){$(c.moveMode).css({cursor:"pointer"});$(c.moveMode).css({background:"#555555"})});$(this.zoomUp).bind(_event._down,function(){c.zoomAnimate(0.5)});$(this.zoomDown).bind(_event._down,function(){c.zoomAnimate(-0.5)});$(this.zoomUp).bind(_event._leave,function(){$(c.zoomUp).css({background:""})});$(this.zoomDown).bind(_event._leave,function(){$(c.zoomDown).css({background:""})});$(this.moveMode).bind(_event._leave,function(){$(c.moveMode).css({background:""})});
this.moveMode.bind(_event._end,function(){c.changeMoveMode()})};initSingleSlideBook.prototype.translateToOrigin=function(a){this.showPage.setTranslate(0,a,100);parseBool(bookConfig.RightToLeft)?(this.nextPage.setTranslate(-this.containtWidth,0,100),this.prePage.setTranslate(this.containtWidth,0,100)):(this.nextPage.setTranslate(this.containtWidth,0,100),this.prePage.setTranslate(-this.containtWidth,0,100))};
initSingleSlideBook.prototype.initTranslate=function(){var a=getPoint(this.showPage.side),b=getPoint(this.prePage.side),c=getPoint(this.nextPage.side);this.tran=Point(a.x,a.y);this.pretran=Point(b.x,b.y);this.nexttran=Point(c.x,c.y)};initSingleSlideBook.prototype.translateMove=function(a,b){this.showPage.setTranslate(a+this.tran.x,b);this.prePage.setTranslate(a+this.pretran.x,0);this.nextPage.setTranslate(a+this.nexttran.x,0)};
initSingleSlideBook.prototype.initMouseEvt=function(){var a=this,b=Point(0,0),c=!1,d=null;this.book.bind(_event._down,function(e){if(bookType==BookType.slide_book)return c=!0,b.x=e.pageX,b.y=e.pageY,d={x:a.book.offset().left,y:a.book.offset().top},!1});this.book.bind(_event._end,function(){bookType==BookType.slide_book&&(c=!1)});this.book.bind(_event._move,function(e){bookType==BookType.slide_book&&c&&bookType==BookType.slide_book&&a.book.css({left:e.pageX-b.x+d.x+"px",top:e.pageY-b.y+d.y+"px"})});
this.book.bind("mouseleave",function(){})};initSingleSlideBook.prototype.initTouchEvt=function(){};initSingleSlideBook.prototype.zoomAnimate=function(a){this.showPage.zoom(a,0);parseBool(bookConfig.RightToLeft)?(this.prePage.zoom(a,1),this.nextPage.zoom(a,-1)):(this.prePage.zoom(a,-1),this.nextPage.zoom(a,1))};
initSingleSlideBook.prototype.zoomToScale=function(a){this.showPage.zoomToScale(a,0);parseBool(bookConfig.RightToLeft)?(this.prePage.zoomToScale(a,1),this.nextPage.zoomToScale(a,-1)):(this.prePage.zoomToScale(a,-1),this.nextPage.zoomToScale(a,1))};initSingleSlideBook.prototype.scrollButtonTran=function(a){a=Math.max(a,0);a=Math.min(a,101);this.scrollButton.transform(a,0)};initSingleSlideBook.prototype.noZoom=function(){this.showPage.noZoom()};initSingleSlideBook.prototype.bookWidth=function(){return this.containtWidth};
initSingleSlideBook.prototype.bookHeight=function(){return this.containtHeight};initSingleSlideBook.prototype.show=function(){debug("single slide book show.");this.setVisible(!0);this.prePage.showPage();this.nextPage.showPage();this.showPage.hidePage();var a=this;window.setTimeout(function(){a.showPage.showPage();a.addSearchHighlight(this.currentIndex);a.showPage.playSlider()},500);void 0!=leftRightButton&&null!=leftRightButton&&leftRightButton.setShow(!1)};
initSingleSlideBook.prototype.hide=function(){debug("single slide book hide.");this.setVisible(!1);hideLeftRightButton()&&leftRightButton.setShow(!0);this.showPage.resetSlider()};
var SingleCatalogBook=Class({create:function(a){this._super(a);this.prePage=new SingleCatalogSide(this.bookPage);this.nextPage=new SingleCatalogSide(this.bookPage);this.showPage=new SingleCatalogSide(this.bookPage);this.prePage.setChildIndex(1);this.showPage.setChildIndex(3);this.nextPage.setChildIndex(2);this.bookMap=new ZoomSideMap(this);this.bookMap.resetPosition=function(){this.divThumb.css({right:20,bottom:20})};this.controlBar=new ControlBar;this.fillNear(1);this.doublePage=!1;this.zoomOut()},
zoomOut:function(){this.book.removeClass();this.book.attr("class","slider view-read");this.book.css({border:"1px solid #ffffff"});this.leftButton.show();this.rightButton.show();this.firstButton.show();this.lastButton.show();this.bookMap.hide();this.controlBar.hide();bookType==BookType.singleCatalog_book&&toolBar.show();void 0!=singleCatalogBook&&this.showPage.zoomOut()},zoomIn:function(){this.book.removeClass();this.book.attr("class","slider view-zoom");this.book.css({border:""});this.prePage.setVisible(!1);
this.nextPage.setVisible(!1);this.leftButton.hide();this.rightButton.hide();this.firstButton.hide();this.lastButton.hide();this.bookMap.show();this.controlBar.show();bookType==BookType.singleCatalog_book&&toolBar.hide();bookType==BookType.singleCatalog_book&&thumbnail.hideBox();void 0!=singleCatalogBook&&this.showPage.zoomIn()},gotoPage:function(a){this.showPage.zoomed&&this.zoomOut();this.showPage.isZomming||this._super(a)},onResize:function(a,b){this._super(a,b);this.moveWidth=this.stageWidth;this.moveHeight=
this.stageHeight;this.zoomOut();this.bookMap.resize(windowWidth,windowHeight)},fillNear:function(a){this._super(a);this.bookMap.fillContent(a)},setButtonProperty:function(){this.leftButtonHeight=90;this.firstButtonHeight=49;this.firstButtonWidth=this.leftButtonWidth=30}}).extend(initSingleSlideBook);function singleSlideSide(a,b){this.create(a,b)}
singleSlideSide.prototype.create=function(a,b){this.side=$("<div></div>");this.sideContent=$("<div id='"+b+"' class='sideContent' style= 'overflow: hidden'></div>");this.sideImg=$("<img style='position: absolute;' />");this.MMBackground=$("<div style='position:absolute;z-index:3;'></div>");this.loadingImg=$("<img src='"+uiBaseURL+"progress.gif' style='position: absolute;'>");this.width=zoomPageWidth;this.height=zoomPageHeight;this.fitH=this.fitW=0;this.id=b;this.largeZoomWidth=1.5*zoomPageWidth;this.largeZoomHeight=
1.5*zoomPageHeight;this.tmpImg=$("<img style='position: absolute;z-index:-1;' />");this.searchHighlight=$("<div class='kong' id='highlight'></div>");a.append(this.side);this.side.append(this.sideContent);this.imageIndex=-1;this.toScale=1;this.origin="0% 0%";this.translateY=this.translateX=this.y=this.x=0;this.isZomming=!1;this.sideTop=0;this.side.css({width:this.width+"px",height:this.height+"px",top:this.sideTop+"px",position:"absolute","border-width":"0px"});this.sideContent.css({width:this.width+
"px",height:this.height+"px",background:"#ffffff"});this.searchHighlight.css({width:this.width+"px",height:this.height+"px"});this.sideImg.css({width:this.width+"px",height:this.height+"px"});this.MMBackground.css({width:this.width+"px",height:this.height+"px"});this.loadingImg.css({left:(this.width-10)/2+"px",top:(this.height-10)/2+"px"});this.initMMItems();this.slider=null;this.playSliderAfterLoad=!1;this.initEvent();this.onWinResize(windowWidth-leftMargin-rightMargin,windowHeight-topMargin-bottomMargin-
40,!0);this.father=a};singleSlideSide.prototype.hideMM=function(){this.MMBackground.css({display:"none"})};singleSlideSide.prototype.showMM=function(){this.MMBackground.css({display:"block"})};singleSlideSide.prototype.setCSS=function(a){this.side.css(a)};singleSlideSide.prototype.onResize2=function(a){this.toScale=a/this.width;a=getPoint(this.side);this.zoomObj(this.side,this.origin,this.toScale,a.x,a.y)};
singleSlideSide.prototype.onResize=function(a,b,c){this.toScale=1;a=getPageWidthHeight(a,b,zoomPageWidth,zoomPageHeight);this.width=a.x*this.toScale;this.height=a.y*this.toScale;this.side.css({width:this.width+"px",height:this.height+"px"});this.sideContent.css({width:this.width+"px",height:this.height+"px"});this.sideImg.css({width:this.width+"px",height:this.height+"px"});this.searchHighlight.css({width:this.width+"px",height:this.height+"px"});this.MMBackground.css({width:this.width+"px",height:this.height+
"px"});this.onMMResize(this.width,this.height);this.loadingImg.css({left:(this.width-10)/2+"px",top:(this.height-10)/2+"px"});c&&this.tmpImg.css({width:this.width+"px",height:this.height+"px",top:this.sideTop+"px"});this.setTranslate(0,0)};singleSlideSide.prototype.getSide=function(){return this.side};
singleSlideSide.prototype.fillContent=function(a){this.imageIndex=a;var b=this;this.sideContent.empty();a<=originTotalPageCount&&1<=a?(b.showLoading(),this.sideContent.css({background:"#ffffff"})):(b.hideLoading(),this.sideContent.css({background:"transparent"}));a>originTotalPageCount+1||0>a||this.sideImg.load(function(){b.tmpImg.attr("src",getPageDir(a,"thumb",originTotalPageCount));b.sideContent.append(b.sideImg);b.sideContent.append(b.tmpImg)}).attr("src",getPageDir(a,"thumb",originTotalPageCount))};
singleSlideSide.prototype.fillTemp=function(a){if(a!=this.imageIndex){this.imageIndex=a;var b=this;this.sideContent.empty();a<=originTotalPageCount&&1<=a?this.sideContent.css({background:"#ffffff"}):this.sideContent.css({background:"transparent"});a>originTotalPageCount+1||0>a||this.sideImg.load(function(){b.tmpImg.attr("src",getPageDir(a,"thumb",originTotalPageCount));b.sideContent.append(b.sideImg);b.sideContent.append(b.tmpImg)}).attr("src",getPageDir(a,"thumb",originTotalPageCount))}};
singleSlideSide.prototype.changeContent=function(a){this.imageIndex=a;var b=this;a<=originTotalPageCount&&1<=a?this.sideContent.css({background:"#ffffff"}):(b.hideLoading(),this.sideContent.css({background:"transparent"}));(a>originTotalPageCount||1>a)&&this.hideLoading();a>originTotalPageCount+1||0>a||(null!=this.slider&&(this.slider.destroy(),this.slider=null),this.sideImg.load(function(){b.hideLoading();b.tmpImg.attr("src",getPageDir(a,"normal",originTotalPageCount));b.sideContent.append(b.sideImg);
b.sideContent.append(b.tmpImg);b.sideContent.append(b.MMBackground);b.sideContent.append(b.searchHighlight);b.searchHighlight.css({opacity:0.8});b.clearMM();b.initMM();b.initSlider()}).attr("src",getPageDir(a,"normal",originTotalPageCount)))};singleSlideSide.prototype.setPosition=function(a,b){this.side.css({left:a+"px",top:b+"px"})};singleSlideSide.prototype.setChildIndex=function(a){this.side.css({"z-index":a})};singleSlideSide.prototype.setVisible=function(a){this.side.css({display:a?"block":"none"})};
singleSlideSide.prototype.resetSize=function(){this.tmpImg.css({display:"none"});var a=this.width*this.toScale>=zoomPageWidth,b=a?zoomPageWidth:this.width*this.toScale,c=a?zoomPageHeight:this.height*this.toScale,d=getPoint(this.side),e=this.width==zoomPageWidth&&b<zoomPageWidth||this.width!=zoomPageWidth;this.toScale=a?this.width*this.toScale/zoomPageWidth:1;var a=singleSlideBook.minZoomWidth,f=singleSlideBook.minZoomHeight;if(void 0!=a&&void 0!=f&&0<a&&0<f){b/c>a/f?f=a*c/b:a=f*b/c;var g=Math.min(0,
b-a),h=Math.min(0,c-f),b=Math.max(b,a),c=Math.max(c,f);d.x+=g/2;d.y+=h/2}this.zoomObj(this.side,"0% 0%",this.toScale,d.x,d.y);this.width=b;this.height=c;this.translateX=d.x;this.translateY=d.y;e&&this.tmpImg.css({width:this.width+"px",height:this.height+"px"});this.zoomObj(this.tmpImg,"0% 0%",this.toScale,d.x,d.y);this.tmpImg.css({display:"block"});if(e)this.onResize(b,c)};
singleSlideSide.prototype.zoom=function(a,b){if(!0==this.isZomming)return!1;var c=this.width*this.toScale,d=this.height*this.toScale,e=this.getNewScale(a),f=this.width*e,g=this.height*e,h=Math.min(this.width*e,this.getStageSize()[0]),j=Math.min(this.height*e,this.getStageSize()[1]),k=this.getTran(f,g,d,c,e)[0],c=this.getTran(f,g,d,c,e)[1],c=Math.max(j-this.height*e,c),c=Math.min(c,0),k=Math.max(h-this.width*e,k),k=Math.min(k,0);1==b&&(k=f,c=0);-1==b&&(k=-f,c=0);this.animateZoom(e,k,c,300)};
singleSlideSide.prototype.getTran=function(a,b,c,d){var e=Point(this.side.offset().left,this.side.offset().top),f=getPoint(this.side);return[(d-a)*((windowWidth/2-e.x)/d)+f.x,(c-b)*((windowHeight/2-e.y)/c)+f.y]};singleSlideSide.prototype.getStageSize=function(){return void 0!=singleSlideBook?[singleSlideBook.stageWidth,singleSlideBook.stageHeight]:[0,0]};
singleSlideSide.prototype.zoomToScale=function(a,b){if(!0==this.isZomming)return!1;this.isZomming=!0;var c=this.width*this.toScale,d=this.height*this.toScale,e=this.getNewScale(a),f=this.width*e,g=this.height*e,h=Math.min(this.width*e,this.getStageSize()[0]),j=Math.min(this.height*e,this.getStageSize()[1]),k=this.getTran(f,g,d,c,e)[0],c=this.getTran(f,g,d,c,e)[1],c=Math.max(j-this.height*e,c),c=Math.min(c,0),k=Math.max(h-this.width*e,k),k=Math.min(k,0);1==b&&(k=f,c=0);-1==b&&(k=-f,c=0);this.zoomObj(this.side,
this.origin,e,k,c);this.toScale=e;this.setStageSize(this.width*e,this.height*e,101*(e-1)*this.width/(this.largeZoomWidth-this.width),e);this.isZomming=!1};singleSlideSide.prototype.getNewScale=function(a){var a=this.toScale+a,b=this.width*a;1>a&&b<this.width&&(a=1);1<a&&b>this.largeZoomWidth&&(a=this.largeZoomWidth/this.width);return a};
singleSlideSide.prototype.noZoom=function(){this.toScale=this.fitW/this.width;this.zoomObj(this.side,"0% 0%","scale("+this.toScale+")",0,0);this.zoomObj(this.tmpImg,"0% 0%","scale("+this.toScale+")",0,0)};singleSlideSide.prototype.forceReset=function(a){this.toScale=singleSlideBook.bookWidth()/this.getWidth();this.width=singleSlideBook.bookWidth();this.height=this.width*this.fitH/this.fitW;void 0==a&&(a=getPoint(this.side));this.forceResize(a)};
singleSlideSide.prototype.forceMax=function(){var a=(this.width*this.toScale-zoomPageWidth)/2;this.width=zoomPageWidth;this.height=zoomPageHeight;var b=getPoint(this.side);b.x+=a;this.forceResize(b)};singleSlideSide.prototype.animateMax=function(){this.animateZoom(zoomPageWidth/this.width,(this.width-zoomPageWidth)/2,0,300)};singleSlideSide.prototype.animateFit=function(){this.animateZoom(this.fitW/this.width,0,0,300)};
singleSlideSide.prototype.forceResize=function(a){this.side.css({width:this.width+"px",height:this.height+"px"});this.sideContent.css({width:this.width+"px",height:this.height+"px"});this.sideImg.css({width:this.width+"px",height:this.height+"px"});this.searchHighlight.css({width:this.width+"px",height:this.height+"px"});this.MMBackground.css({width:this.width+"px",height:this.height+"px"});this.onMMResize(this.width,this.height);this.tmpImg.css({width:this.width+"px",height:this.height+"px"});this.zoomObj(this.side,
"0% 0%",this.toScale,a.x,a.y);this.zoomObj(this.tmpImg,"0% 0%",this.toScale,a.x,a.y);this.translateX=a.x;this.translateY=a.y};singleSlideSide.prototype.getScaleFromFit=function(){return this.width*this.toScale/this.fitW};singleSlideSide.prototype.getCenterTransform=function(){return Point((this.fitW-this.width*this.toScale)/2,0)};singleSlideSide.prototype.zoomToMax=function(){var a=zoomPageWidth/this.width;this.animateZoom(a,(this.width*this.toScale-this.width*a)/2+this.translateX,0,200)};
singleSlideSide.prototype.zoomToFit=function(){this.animateZoom(this.getScaleFromFit(),0,0,200)};
singleSlideSide.prototype.zoomObj=function(a,b,c,d,e){if(!0!=a.isZomming){a.isZomming=!0;d||(d=0);e||(e=0);translate(d,e);var f=scaleTran(c),g=Math.cos(0)*c,h=-1*Math.sin(0)*c,c=Math.sin(0)*c;a.transform(d,e);!0==isBelowIE9()?a.css({filter:"progid:DXImageTransform.Microsoft.Matrix(M11="+g+",M12="+h+",M21="+c+",M22="+g+",SizingMethod='auto expand')"}):a.css({"-webkit-transform-origin":b,"-moz-transform-origin":b,"-ms-transform-origin":b,"-o-transform-origin":b,"-webkit-transform":f,"-moz-transform":f,
"-ms-transform":f,"-o-transform":f});a.isZomming=!1}};singleSlideSide.prototype.setTranslate=function(a,b){translate(a,b);parseFloat(this.toScale);Math.cos(0);Math.sin(0);Math.sin(0);this.side.transform(a,b);this.tmpImg.transform(a,b)};singleSlideSide.prototype.setXY=function(a,b){this.x=a;this.y=b};
singleSlideSide.prototype.animateTranslate=function(a,b,c){a||(a=0);b||(b=0);c||(c=25);var d=getPoint(this.side),e=this;$(d).animate({x:a,y:b},{duration:c,easing:"easeOutSine",complete:function(){e.setTranslate(d.x,d.y)}})};
singleSlideSide.prototype.animateZoom=function(a,b,c,d){if(!0!=this.isZomming){this.isZomming=!0;a||(a=this.toScale);b||(b=0);c||(c=0);d||(d=25);var e=getPoint(this.side),f={scale:this.toScale,x:e.x,y:e.y,w:Math.min(this.width*this.toScale,this.getStageSize()[0]),h:Math.min(this.height*this.toScale,this.getStageSize()[1]),l:101*(this.toScale-1)*this.width/(this.largeZoomWidth-this.width)},g=this,e=Math.min(this.width*a,this.getStageSize()[0]),h=Math.min(this.height*a,this.getStageSize()[1]),j=101*
(a-1)*this.width/(this.largeZoomWidth-this.width);$(f).animate({scale:a,x:b,y:c,w:e,h:h,l:j},{duration:d,easing:"easeOutSine",step:function(){g.zoomObj(g.side,g.origin,f.scale,f.x,f.y);g.setStageSize(f.w,f.h,f.l,f.scale)},complete:function(){g.toScale=a;g.zoomObj(g.side,g.origin,a,b,c);g.setStageSize(g.width*a,g.height*a,j,a);g.isZomming=false}})}};
singleSlideSide.prototype.setStageSize=function(a,b,c,d){singleSlideBook.toScale=d;singleSlideBook.containtWidth=Math.min(a,singleSlideBook.stageWidth);singleSlideBook.containtHeight=Math.min(b,singleSlideBook.stageHeight);singleSlideBook.resizeButton();singleSlideBook.scrollButtonTran(c)};singleSlideSide.prototype.onWinResize=function(a,b,c){this.toScale=1;var d=getPageWidthHeight(a,b,zoomPageWidth,zoomPageHeight);this.fitW=d.x;this.fitH=d.y;if(c)this.onResize(a,b,!0)};
singleSlideSide.prototype.translate=function(a,b){b=Math.max(singleSlideBook.bookHeight()-this.getHeight(),b);b=Math.min(b,0);a=Math.max(singleSlideBook.bookHeight()-this.getHeight(),a);a=Math.min(a,0);this.setTranslate(a,b)};singleSlideSide.prototype.isFit=function(){return this.toScale==this.fitW/this.width};
singleSlideSide.prototype.animateBack=function(a){var b=getPoint(this.side),c={x:b.x,y:b.y,scale:this.toScale},d=this.fitW/this.width,e=this;e.tmpImg.css({display:"none"});$(c).animate({x:0,y:0,scale:d},{duration:200,step:function(){e.zoomObj(e.side,e.origin,c.scale,c.x,c.y);e.zoomObj(e.tmpImg,e.origin,c.scale,c.x,c.y)},complete:function(){e.toScale=d;e.tmpImg.css({display:"block"});a()}})};singleSlideSide.prototype.showPage=function(){this.side.css({display:"block"})};
singleSlideSide.prototype.hidePage=function(){this.side.css({display:"none"})};singleSlideSide.prototype.getWidth=function(){return this.width*this.toScale};singleSlideSide.prototype.getHeight=function(){return this.height*this.toScale};singleSlideSide.prototype.getScale=function(){return this.toScale};
singleSlideSide.prototype.initEvent=function(){var a=this,b=Point(0,0),c=Point(0,0),d=Point(0,0);Point(0,0);var e=!1,f=!1,g=!1,h=null,j=!1,k,m=0,l=0,n=!1;this.side.bind("mouseenter",function(b){if(cursor&&bookType==BookType.singleSlide_book){if(!0==a.isZomming||!0==singleSlideBook.isFlipping)return!1;var c=getPoint(a.side);a.moveX=c.x;a.moveY=c.y;e=!0;Point(b.pageX,b.pageY)}});this.side.bind(_event._down,function(l){if(cursor&&bookType==BookType.singleSlide_book){if(!0==a.isZomming||!0==singleSlideBook.isFlipping)return!1;
singleSlideBook.isMove=!1;k=a.toScale;var l=isTouch?l.originalEvent.touches:[l],m=getPoint(a.side);a.translateX=m.x;a.translateY=m.y;singleSlideBook.initTranslate();1==l.length?(f=!0,g=!1,b=Point(l[0].pageX,l[0].pageY),h=Point(a.side.position().left,a.side.position().top)):2==l.length&&(f=!1,g=!0,b=Point(l[0].pageX,l[0].pageY),d=Point(l[1].pageX,l[1].pageY),c=Point((l[0].pageX+l[1].pageX)/2,(l[0].pageY+l[1].pageY)/2),h=Point(a.side.offset().left,a.side.offset().top));j=e=n=!1;stopEvent(l[0])}});3==
browserType&&(_event._mousewheel="DOMMouseScroll");isIE()&&(_event._mousewheel="mousewheel");this.side.bind(_event._mousewheel,function(b){if(cursor){if(bookType!=BookType.singleSlide_book||singleSlideBook.isFlipping==true)return false;b=b.originalEvent;b=Math.max(-1,Math.min(1,b.wheelDelta||-b.detail));getPoint(a.side);var c=-0.25;b>0&&(c=0.25);singleSlideBook.zoomAnimate(c);return n=false}});this.side.bind(_event._move,function(o){if(cursor&&bookType==BookType.singleSlide_book){if(singleSlideBook.isFlipping==
true||a.isZomming==true)return false;o=isTouch?o.originalEvent.touches:[o];f?a.side.css({cursor:"move"}):a.side.css({cursor:""});singleSlideBook.isMove=true;if(f){e=false;var n=o[0].pageX-b.x+a.translateX,q=o[0].pageY-b.y+a.translateY;(new Date).getTime();q=Math.min(q*Math.min(Math.abs(q),Math.abs(singleSlideBook.bookHeight()-a.getHeight()))/Math.abs(q),0);if(singleSlideBook.bookWidth()+5<a.getWidth()){q=Math.max(singleSlideBook.bookHeight()-a.getHeight(),q);q=Math.min(q,0);n=Math.max(singleSlideBook.bookWidth()-
a.getWidth(),n);n=Math.min(n,0);a.zoomObj(a.side,a.origin,a.toScale,n,q);a.zoomObj(a.tmpImg,a.origin,a.toScale,n,q);m=n;l=q;a.zoomToMove=true;a.gotoNextPage=false;a.gotoPrePage=false}else{a.zoomToMove=false;singleSlideBook.translateMove(o[0].pageX-b.x,q);if(b.x-o[0].pageX>singleSlideBook.width*a.toScale/4)if(parseBool(bookConfig.RightToLeft)){a.gotoNextPage=false;a.gotoPrePage=true}else{a.gotoNextPage=true;a.gotoPrePage=false}else if(b.x-o[0].pageX<=-singleSlideBook.width*a.toScale/4)if(parseBool(bookConfig.RightToLeft)){a.gotoNextPage=
true;a.gotoPrePage=false}else{a.gotoNextPage=false;a.gotoPrePage=true}else{a.gotoNextPage=false;a.gotoPrePage=false}}m=n;l=q}else if(g){e=false;var n=Point(o[0].pageX,o[0].pageY),q=Point(o[1].pageX,o[1].pageY),s=Math.sqrt(Math.pow(b.x-d.x,2)+Math.pow(b.y-d.y,2)),n=Math.sqrt(Math.pow(n.x-q.x,2)+Math.pow(n.y-q.y,2));scale=Math.max(n/s*k,0.5);s=singleSlideBook.minZoomWidth*scale;if(scale<1&&s<singleSlideBook.minZoomWidth){scale=singleSlideBook.minZoomWidth/singleSlideBook.minZoomWidth;s=singleSlideBook.minZoomWidth}if(scale>
1&&s>singleSlideBook.largeZoomWidth){scale=singleSlideBook.largeZoomWidth/singleSlideBook.minZoomWidth;s=singleSlideBook.largeZoomWidth}singleSlideBook.showPage.toScale=scale;singleSlideBook.prePage.toScale=scale;singleSlideBook.nextPage.toScale=scale;singleSlideBook.toScale=scale;singleSlideBook.containtWidth=Math.min(singleSlideBook.width*scale,singleSlideBook.stageWidth);singleSlideBook.containtHeight=Math.min(singleSlideBook.height*scale,singleSlideBook.stageHeight);q=(c.x-h.x)/k;n=(c.y-h.y)/
k;a.side.width();a.side.height();var q=(k-a.toScale)*a.side.width()*(q/singleSlideBook.minZoomWidth),v=(k-a.toScale)*a.side.height()*(n/singleSlideBook.minZoomHeight),n=a.translateX+q+(singleSlideBook.containtWidth-Math.min(singleSlideBook.width*k,singleSlideBook.stageWidth))/2,q=a.translateY+v+(singleSlideBook.containtHeight-Math.min(singleSlideBook.height*k,singleSlideBook.stageHeight))/2,q=Math.max(singleSlideBook.bookHeight()-a.getHeight(),q),q=Math.min(q,0),n=Math.max(singleSlideBook.bookWidth()-
a.getWidth(),n),n=Math.min(n,0);singleSlideBook.showPage.zoomObj(singleSlideBook.showPage.side,singleSlideBook.showPage.origin,a.toScale,n,q);singleSlideBook.showPage.zoomObj(singleSlideBook.showPage.tmpImg,singleSlideBook.showPage.origin,a.toScale,n,q);singleSlideBook.prePage.zoomObj(singleSlideBook.prePage.side,singleSlideBook.prePage.origin,a.toScale,-s,0);singleSlideBook.prePage.zoomObj(singleSlideBook.prePage.tmpImg,singleSlideBook.prePage.origin,a.toScale,-s,0);singleSlideBook.nextPage.zoomObj(singleSlideBook.nextPage.side,
singleSlideBook.nextPage.origin,a.toScale,s,0);singleSlideBook.nextPage.zoomObj(singleSlideBook.nextPage.tmpImg,singleSlideBook.nextPage.origin,a.toScale,s,0);singleSlideBook.resizeButton();n=(scale-singleSlideBook.minZoomWidth/singleSlideBook.width)*101*singleSlideBook.width/(singleSlideBook.largeZoomWidth-singleSlideBook.minZoomWidth);singleSlideBook.scrollButtonTran(n);j=true;m=n;l=q;stopEvent(o[0])}else if(e&&singleSlideBook.isZoomming!=true&&singleSlideBook.moveByPoints){n=Math.max(o[0].pageX-
parseInt(singleSlideBook.book.css("left"))-singleSlideBook.bookWidth()/4,0)*(singleSlideBook.bookWidth()-a.getWidth())*2/singleSlideBook.bookWidth();q=Math.max(o[0].pageY-parseInt(singleSlideBook.book.css("top"))-singleSlideBook.bookHeight()/4,0)*(singleSlideBook.bookHeight()-a.getHeight())*2/singleSlideBook.bookHeight();(new Date).getTime();q=Math.max(singleSlideBook.bookHeight()-a.getHeight(),q);q=Math.min(q,0);n=Math.max(singleSlideBook.bookWidth()-a.getWidth(),n);n=Math.min(n,0);a.animateTranslate(n,
q,30);m=n;l=q;a.gotoNextPage=false;a.gotoPrePage=false}}});this.side.bind(_event._end,function(){if(cursor&&bookType==BookType.singleSlide_book){if(a.isZomming==true||singleSlideBook.isFlipping==true||n==true)return false;a.side.css({cursor:""});a.translateX=m;var b=l,b=Math.max(singleSlideBook.bookHeight()-a.getHeight(),b),b=Math.min(b,0);a.translateY=b;try{a.gotoNextPage==true?singleSlideBook.gotoPage(parseInt(singleSlideBook.currentIndex)+1):a.gotoPrePage==true?singleSlideBook.gotoPage(parseInt(singleSlideBook.currentIndex)-
1):a.zoomToMove==false&&j==false&&singleSlideBook.translateToOrigin(a.translateY);a.gotoNextPage=false;a.gotoPrePage=false;n=true}catch(c){}f=false;e=true;j=g=false}});this.side.bind(_event._leave,function(){if(cursor&&bookType==BookType.singleSlide_book){if(a.isZomming==true||singleSlideBook.isFlipping==true||n==true)return false;a.side.css({cursor:""});a.translateX=m;var b=l,b=Math.max(singleSlideBook.bookHeight()-a.getHeight(),b),b=Math.min(b,0);a.translateY=b;try{a.gotoNextPage==true?singleSlideBook.gotoPage(parseInt(singleSlideBook.currentIndex)+
1):a.gotoPrePage==true?singleSlideBook.gotoPage(parseInt(singleSlideBook.currentIndex)-1):a.zoomToMove==false&&j==false&&singleSlideBook.translateToOrigin(a.translateY);a.gotoNextPage=false;a.gotoPrePage=false;n=true}catch(c){}f=false;e=true;j=g=false}});this.side.hammer().on("doubletap",function(){if(cursor){if(singleSlideBook.isFlipping==true||this.isZomming==true||bookType!=BookType.singleSlide_book)return false;j=true;var b=1,b=a.width*a.toScale/zoomPageWidth;a.side.offset();a.side.offset();if(b<
0.75){b=zoomPageWidth/a.width;singleSlideBook.zoomToScale(b-singleSlideBook.toScale)}else singleSlideBook.zoomToScale(1-singleSlideBook.toScale)}})};singleSlideSide.prototype.highlightSearch=function(a){highlightSearchFun(this.searchHighlight,a)};singleSlideSide.prototype.clearHighlight=function(){clearHighlightFun(this.searchHighlight)};singleSlideSide.prototype.addHistoryTexts=function(){AddNotesByContainers(BookType.singleSlide_book,this.imageIndex,this.MMBackground)};singleSlideSide.extend(BookSide);
var SingleCatalogSide=Class({create:function(a){this._super(a);this.zoomed=!1},initEvent:function(){var a=this,b,c,d,e=0,f=0,g,h,j;this.side.bind(_event._over,function(){cursor&&bookType==BookType.singleCatalog_book&&(a.zoomed?a.side.css({cursor:"url("+uiBaseURL+"catalog_zoomout.png),auto"}):a.side.css({cursor:"url("+uiBaseURL+"catalog_zoomin.png),auto"}))});this.side.bind(_event._down,function(e){if(!(!cursor||bookType!=BookType.singleCatalog_book||singleCatalogBook.isFlipping||!0==a.isZomming)){e=
isTouch?e.originalEvent.touches:[e];a.pointX=e[0].pageX;a.pointY=e[0].pageY;var f=getPoint(a.side);a.translateX=f.x;a.translateY=f.y;1==e.length?(j=!1,g=!0,h=!1,b=Point(e[0].pageX,e[0].pageY),Point(a.side.position().left,a.side.position().top)):2==e.length&&(g=!1,h=!0,b=Point(e[0].pageX,e[0].pageY),c=Point(e[1].pageX,e[1].pageY),d=Point((e[0].pageX+e[1].pageX)/2,(e[0].pageY+e[1].pageY)/2),Point(a.side.offset().left,a.side.offset().top),a.pointX=d.x,a.pointY=d.y);singleCatalogBook.initTranslate()}});
this.side.bind(_event._move,function(d){if(!(!cursor||bookType!=BookType.singleCatalog_book||singleCatalogBook.isFlipping||!0==a.isZomming)){getPoint(a.side);singleCatalogBook.bookMap.refreshArea();d=isTouch?d.originalEvent.touches:[d];g?a.side.css({cursor:"url("+uiBaseURL+"catalog_drag.png),auto"}):a.zoomed?a.side.css({cursor:"url("+uiBaseURL+"catalog_zoomout.png),auto"}):a.side.css({cursor:"url("+uiBaseURL+"catalog_zoomin.png),auto"});if(g){var m=d[0].pageX-b.x+a.translateX,l=d[0].pageY-b.y+a.translateY,
l=Math.max(singleCatalogBook.bookHeight()-a.getHeight(),l),l=Math.min(l,0);!0!=a.zoomed?(singleCatalogBook.translateMove(d[0].pageX-b.x,l),b.x-d[0].pageX>singleCatalogBook.width*a.toScale/4?parseBool(bookConfig.RightToLeft)?(a.gotoNextPage=!1,a.gotoPrePage=!0):(a.gotoNextPage=!0,a.gotoPrePage=!1):b.x-d[0].pageX<=-singleCatalogBook.width*a.toScale/4?parseBool(bookConfig.RightToLeft)?(a.gotoNextPage=!0,a.gotoPrePage=!1):(a.gotoNextPage=!1,a.gotoPrePage=!0):(a.gotoNextPage=!1,a.gotoPrePage=!1),e=m,f=
l):(m=Math.max(singleCatalogBook.bookWidth()-a.getWidth(),m),m=Math.min(m,0),a.setPositionBar(m,l),a.setTranslate(m,l));j=1<=Math.abs(d[0].pageX-b.x)||Math.abs(1<=d[0].pageY-b.y)?!0:!1}else h&&(!0==a.zoomed&&(m=Math.sqrt(Math.pow(b.x-c.x,2)+Math.pow(b.y-c.y,2)),d=Math.sqrt(Math.pow(d[0].pageX-d[1].pageX,2)+Math.pow(d[0].pageY-d[1].pageY,2)),d=Math.max(d/m*a.toScale,a.largeZoomWidth/a.width),a.zoomToScale(d-a.toScale,0)),j=!0);a.isMoving=!0}});this.side.bind(_event._end,function(){if(!(!cursor||bookType!=
BookType.singleCatalog_book||singleCatalogBook.isFlipping||!0==a.isZomming)){if(j){if(!0!=a.zoomed&&g){a.translateX=e;var b=f,b=Math.max(singleCatalogBook.bookHeight()-a.getHeight(),b),b=Math.min(b,0);a.translateY=b;try{!0==a.gotoNextPage?singleCatalogBook.gotoPage(parseInt(singleCatalogBook.currentIndex)+1):!0==a.gotoPrePage?singleCatalogBook.gotoPage(parseInt(singleCatalogBook.currentIndex)-1):singleCatalogBook.translateToOrigin(a.translateY),a.gotoNextPage=!1,a.gotoPrePage=!1}catch(c){}}}else auto_player.isPlaying()&&
(auto_player.stop(),toolBar.changeAutoPlayIcon()),a.zoomed=!a.zoomed,a.zoomed?singleCatalogBook.zoomIn():singleCatalogBook.zoomOut();h=g=a.isMoving=!1}});3==browserType&&(_event._mousewheel="DOMMouseScroll");isIE()&&(_event._mousewheel="mousewheel");this.side.bind(_event._mousewheel,function(b){if(!(!cursor||bookType!=BookType.singleCatalog_book||singleCatalogBook.isFlipping||a.zoomed!=true)){singleCatalogBook.bookMap.refreshArea();var b=b.originalEvent,c=Math.max(-1,Math.min(1,b.wheelDelta||-b.detail)),
b=getPoint(a.side),d=-100;c>0&&(d=100);c=b.y+d;c=Math.max(singleCatalogBook.bookHeight()-a.getHeight(),c);c=Math.min(c,0);a.setPositionBar(b.x,c);a.setTranslate(b.x,c)}});this.side.speed(this.inertiaMove.bind(this))},inertiaMove:function(a,b){if(cursor&&bookType==BookType.singleCatalog_book&&!singleCatalogBook.isFlipping){var c=a,d=b,e=a/8,f=b/8,g=0,h=window.setInterval(function(){var a=getPoint(this.side);c-=e;d-=f;a.x+=c;a.y+=d;a.y=Math.max(singleCatalogBook.bookHeight()-this.getHeight(),a.y);a.y=
Math.min(a.y,0);a.x=Math.max(singleCatalogBook.bookWidth()-this.getWidth(),a.x);a.x=Math.min(a.x,0);this.translate(a.x,a.y);8==++g&&window.clearInterval(h)}.bind(this),20);this.inertiaTimer=h}},zoomIn:function(){var a=singleCatalogBook.largeZoomWidth/this.width-this.toScale;singleCatalogBook.stageWidth=windowWidth;singleCatalogBook.stageHeight=windowHeight;this.zoom(a,0);this.zoomed=!0},zoomOut:function(){var a=this.width/singleCatalogBook.largeZoomWidth-this.toScale;singleCatalogBook.stageWidth=
singleCatalogBook.moveWidth;singleCatalogBook.stageHeight=singleCatalogBook.moveHeight;this.zoom(a,0);this.zoomed=!1},getStageSize:function(){return void 0!=singleCatalogBook?[singleCatalogBook.stageWidth,singleCatalogBook.stageHeight]:[0,0]},setStageSize:function(a,b,c,d){singleCatalogBook.toScale=d;singleCatalogBook.containtWidth=Math.min(a,singleCatalogBook.stageWidth);singleCatalogBook.containtHeight=Math.min(b,singleCatalogBook.stageHeight);singleCatalogBook.resizeButton();singleCatalogBook.scrollButtonTran(c)},
getNewScale:function(a){var a=this.toScale+a,b=this.width*a;1>a&&b<this.width&&(a=1);return a},getTran:function(a,b,c,d,e){a=this.toScale;b=Point(this.side.offset().left,this.side.offset().top);getPoint(this.side);return[b.x+(a-e)*this.width*((this.pointX-b.x)/a/this.width),b.y+(a-e)*this.height*((this.pointY-b.y)/a/this.height)]},setPositionBar:function(a,b){var c=0==a?!0:!1,d=0==b?!0:!1,e=a==singleCatalogBook.bookWidth()-this.getWidth()?!0:!1,f=b==singleCatalogBook.bookHeight()-this.getHeight()?
!0:!1;singleCatalogBook.controlBar.setDullOrLight(c,d,e,f)},translate:function(a,b){b=Math.max(singleCatalogBook.bookHeight()-this.getHeight(),b);b=Math.min(b,0);a=Math.max(singleCatalogBook.bookWidth()-this.getWidth(),a);a=Math.min(a,0);this.setTranslate(a,b);singleCatalogBook.bookMap.refreshArea();this.setPositionBar(a,b)},animateZoom:function(a,b,c,d){if(!0!=this.isZomming){this.isZomming=!0;a||(a=this.toScale);b||(b=0);c||(c=0);d||(d=25);var e=getPoint(this.side),f={scale:this.toScale,x:e.x,y:e.y,
w:Math.min(this.width*this.toScale,this.getStageSize()[0]),h:Math.min(this.height*this.toScale,this.getStageSize()[1]),l:101*(this.toScale-1)*this.width/(this.largeZoomWidth-this.width)},g=this,e=Math.min(this.width*a,this.getStageSize()[0]),h=Math.min(this.height*a,this.getStageSize()[1]),j=101*(a-1)*this.width/(this.largeZoomWidth-this.width);$(f).animate({scale:a,x:b,y:c,w:e,h:h,l:j},{duration:d,easing:"easeOutSine",step:function(){g.zoomObj(g.side,g.origin,f.scale,f.x,f.y);g.setStageSize(f.w,
f.h,f.l,f.scale)},complete:function(){g.toScale=a;g.zoomObj(g.side,g.origin,a,b,c);g.setStageSize(g.width*a,g.height*a,j,a);g.isZomming=false;if(singleCatalogBook.showPage.zoomed!=true){singleCatalogBook.prePage.setVisible(true);singleCatalogBook.nextPage.setVisible(true)}}})}}}).extend(singleSlideSide);function slidePage(a){this.create(a)}
slidePage.prototype.create=function(a){this.side=$("<div></div>");this.leftPage=$("<div></div>");this.rightPage=$("<div></div>");this.leftSide=new slideSide(this.leftPage);this.rightSide=new slideSide(this.rightPage);this.width=zoomPageWidth;this.height=zoomPageHeight;this.fitH=this.fitW=0;this.largeZoomWidth=3*zoomPageWidth;this.largeZoomHeight=3*zoomPageHeight;a.append(this.side);this.side.append(this.leftPage);this.side.append(this.rightPage);this.imageIndex=-1;this.leftSide.imageIndex=-1;this.rightSide.imageIndex=
-1;this.toScale=1;this.leftSide.toScale=1;this.rightSide.toScale=1;this.origin="0% 0%";this.translateY=this.translateX=this.y=this.x=0;this.toolbarShow=this.isZomming=!1;this.sideTop=0;this.side.css({width:this.width+"px",height:this.height+"px",top:this.sideTop+"px",position:"absolute","border-width":"0px"});this.leftPage.css({width:this.width/2+"px",height:this.height+"px",top:this.sideTop+"px",position:"absolute"});this.rightPage.css({width:this.width/2+"px",height:this.height+"px",top:this.sideTop+
"px",left:this.width/2+"px",position:"absolute"});this.initEvent();this.onWinResize(windowWidth-leftMargin-rightMargin,windowHeight-topMargin-bottomMargin-40,!0);this.father=a};slidePage.prototype.hideMM=function(){this.leftSide.hideMM();this.rightSide.hideMM()};slidePage.prototype.showMM=function(){this.leftSide.showMM();this.rightSide.showMM()};slidePage.prototype.playSlider=function(){this.leftSide.playSlider();this.rightSide.playSlider()};
slidePage.prototype.resetSlider=function(){this.leftSide.resetSlider();this.rightSide.resetSlider()};slidePage.prototype.setCSS=function(a){this.leftSide.setCSS(a);this.rightSide.setCSS(a)};slidePage.prototype.onResize2=function(a,b){this.leftPage.css({width:a/2+"px",height:b+"px"});this.rightPage.css({width:a/2+"px",height:b+"px",left:a/2+"px"});this.toScale=a/this.width;var c=getPoint(this.side);this.zoomObj(this.side,this.origin,this.toScale,c.x,c.y)};
slidePage.prototype.onResize=function(a,b,c){this.toScale=1;this.leftSide.toScale=1;this.rightSide.toScale=1;a=getPageWidthHeightByWidth(a/2,b,zoomPageWidth,zoomPageHeight);this.width=2*a.x*this.toScale;this.height=a.y*this.toScale;this.side.css({width:this.width+"px",height:this.height+"px"});this.zoomObj(this.side,this.origin,this.toScale,0,0);this.leftPage.css({width:this.width/2+"px",height:this.height+"px"});this.rightPage.css({width:this.width/2+"px",height:this.height+"px",left:this.width/
2+"px"});this.setPageXYByIndex(2*parseInt(this.leftSide.imageIndex/2));this.leftSide.onResize(this.width/2,this.height,c);this.rightSide.onResize(this.width/2,this.height,c)};slidePage.prototype.getSide=function(){return this.side};slidePage.prototype.fillContent=function(a){a=2*parseInt(a/2);parseBool(bookConfig.RightToLeft)?(this.leftSide.fillContent(a+1),this.rightSide.fillContent(a)):(this.leftSide.fillContent(a),this.rightSide.fillContent(a+1));this.setPageXYByIndex(a)};
slidePage.prototype.fillTemp=function(a){a=2*parseInt(a/2);parseBool(bookConfig.RightToLeft)?(this.leftSide.fillTemp(a+1),this.rightSide.fillTemp(a)):(this.leftSide.fillTemp(a),this.rightSide.fillTemp(a+1));this.setPageXYByIndex(a)};slidePage.prototype.changeContent=function(a){a=2*parseInt(a/2);parseBool(bookConfig.RightToLeft)?(this.leftSide.changeContent(a+1),this.rightSide.changeContent(a)):(this.leftSide.changeContent(a),this.rightSide.changeContent(a+1));this.setPageXYByIndex(a)};
slidePage.prototype.setPageXYByIndex=function(a){parseBool(bookConfig.RightToLeft)?(0==a?this.leftPage.css({left:this.width/4+"px"}):this.leftPage.css({left:"0px"}),a==totalPageCount?this.rightPage.css({left:this.width/4+"px"}):this.rightPage.css({left:this.width/2+"px"})):(0==a?this.rightPage.css({left:this.width/4+"px"}):this.rightPage.css({left:this.width/2+"px"}),a==totalPageCount?this.leftPage.css({left:this.width/4+"px"}):this.leftPage.css({left:"0px"}))};
slidePage.prototype.setPosition=function(a,b){this.side.css({left:a+"px",top:b+"px"})};slidePage.prototype.setChildIndex=function(a){this.side.css({"z-index":a})};slidePage.prototype.setVisible=function(a){this.side.css({display:a?"block":"none"})};slidePage.prototype.resetSize=function(){};
slidePage.prototype.zoom=function(a,b){if(!0==this.isZomming)return!1;var c=this.width*this.toScale,d=this.height*this.toScale,e=this.getNewScale(a),f=this.width*e,g=this.height*e,h=Math.min(this.width*e,this.getStageSize()[0]),j=Math.min(this.height*e,this.getStageSize()[1]),k=this.getTran(f,g,d,c,e)[0],c=this.getTran(f,g,d,c,e)[1],c=Math.max(j-this.height*e,c),c=Math.min(c,0),k=Math.max(h-this.width*e,k),k=Math.min(k,0);1==b&&(k=f,c=0);-1==b&&(k=-f,c=0);this.animateZoom(e,k,c,300)};
slidePage.prototype.getTran=function(a,b,c,d){var e=Point(this.side.offset().left,this.side.offset().top),f=getPoint(this.side);return[(d-a)*((windowWidth/2-e.x)/d)+f.x,(c-b)*((windowHeight/2-e.y)/c)+f.y]};slidePage.prototype.getStageSize=function(){return void 0!=slideBook?[slideBook.stageWidth,slideBook.stageHeight]:[0,0]};
slidePage.prototype.zoomToScale=function(a,b){if(!0==this.isZomming)return!1;this.isZomming=!0;var c=this.width*this.toScale,d=this.height*this.toScale,e=this.getNewScale(a),f=this.width*e,g=this.height*e,h=Math.min(this.width*e,this.getStageSize()[0]),j=Math.min(this.height*e,this.getStageSize()[1]),k=this.getTran(f,g,d,c,e)[0],c=this.getTran(f,g,d,c,e)[1],c=Math.max(j-this.height*e,c),c=Math.min(c,0),k=Math.max(h-this.width*e,k),k=Math.min(k,0);1==b&&(k=f,c=0);-1==b&&(k=-f,c=0);this.zoomObj(this.side,
this.origin,e,k,c);this.toScale=e;this.setStageSize(this.width*e,this.height*e,101*(e-1)*this.width/(this.largeZoomWidth-this.width),e);this.isZomming=!1};slidePage.prototype.getNewScale=function(a){var a=this.toScale+a,b=this.width*a;1>a&&b<this.width&&(a=1);1<a&&b>this.largeZoomWidth&&(a=this.largeZoomWidth/this.width);return a};slidePage.prototype.noZoom=function(){this.toScale=this.fitW/this.width;this.zoomObj(this.side,"0% 0%",this.toScale,0,0)};
slidePage.prototype.forceReset=function(a){this.toScale=slideBook.bookWidth()/this.getWidth();this.width=slideBook.bookWidth();this.height=this.width*this.fitH/this.fitW;void 0==a&&(a=getPoint(this.side));this.forceResize(a)};slidePage.prototype.forceMax=function(){var a=(this.width*this.toScale-zoomPageWidth)/2;this.width=zoomPageWidth;this.height=zoomPageHeight;var b=getPoint(this.side);b.x+=a;this.forceResize(b)};
slidePage.prototype.animateMax=function(){this.animateZoom(zoomPageWidth/this.width,(this.width-zoomPageWidth)/2,0,300)};slidePage.prototype.animateFit=function(){this.animateZoom(this.fitW/this.width,0,0,300)};slidePage.prototype.forceResize=function(a){this.side.css({width:this.width+"px",height:this.height+"px"});this.leftSide.forceResize(Point(0,0));this.rightSide.forceResize(Point(0,0));this.toScale=1;this.zoomObj(this.side,"0% 0%",this.toScale,a.x,a.y);this.translateX=a.x;this.translateY=a.y};
slidePage.prototype.getScaleFromFit=function(){return this.width*this.toScale/this.fitW};slidePage.prototype.getCenterTransform=function(){return Point((this.fitW-this.width*this.toScale)/2,0)};slidePage.prototype.zoomToMax=function(){var a=zoomPageWidth/this.width;this.animateZoom(a,(this.width*this.toScale-this.width*a)/2+this.translateX,0,200)};slidePage.prototype.zoomToFit=function(){this.animateZoom(this.getScaleFromFit(),0,0,200)};
slidePage.prototype.zoomObj=function(a,b,c,d,e){if(!0!=a.isZomming){a.isZomming=!0;d||(d=0);e||(e=0);translate(d,e);var f=scaleTran(c),g=Math.cos(0)*c,h=-1*Math.sin(0)*c,c=Math.sin(0)*c;a.transform(d,e);!0==isBelowIE9()?a.css({filter:"progid:DXImageTransform.Microsoft.Matrix(M11="+g+",M12="+h+",M21="+c+",M22="+g+",SizingMethod='auto expand')"}):a.css({"-webkit-transform-origin":b,"-moz-transform-origin":b,"-ms-transform-origin":b,"-o-transform-origin":b,"-webkit-transform":f,"-moz-transform":f,"-ms-transform":f,
"-o-transform":f});a.isZomming=!1}};slidePage.prototype.setTranslate=function(a,b){translate(a,b);parseFloat(this.toScale);Math.cos(0);Math.sin(0);Math.sin(0);this.side.transform(a,b)};slidePage.prototype.setXY=function(a,b){this.x=a;this.y=b};
slidePage.prototype.animateTranslate=function(a,b,c){if(!(!0==this.isZomming||!0==slideBook.isFlipping)){a||(a=0);b||(b=0);c||(c=25);var d=getPoint(this.side),e=this;$(d).animate({x:a,y:b},{duration:c,easing:"easeOutSine",complete:function(){e.setTranslate(d.x,d.y)}})}};
slidePage.prototype.animateZoom=function(a,b,c,d){if(!0!=this.isZomming){this.isZomming=!0;a||(a=this.toScale);b||(b=0);c||(c=0);d||(d=25);var e=getPoint(this.side),f={scale:this.toScale,x:e.x,y:e.y,w:Math.min(this.width*this.toScale,this.getStageSize()[0]),h:Math.min(this.height*this.toScale,this.getStageSize()[1]),l:101*(this.toScale-1)*this.width/(this.largeZoomWidth-this.width)},g=this,e=Math.min(this.width*a,this.getStageSize()[0]),h=Math.min(this.height*a,this.getStageSize()[1]),j=101*(a-1)*
this.width/(this.largeZoomWidth-this.width);$(f).animate({scale:a,x:b,y:c,w:e,h:h,l:j},{duration:d,easing:"easeOutSine",step:function(){g.zoomObj(g.side,g.origin,f.scale,f.x,f.y);g.setStageSize(f.w,f.h,f.l,f.scale)},complete:function(){g.toScale=a;g.zoomObj(g.side,g.origin,a,b,c);g.setStageSize(g.width*a,g.height*a,j,a);g.isZomming=false}})}};
slidePage.prototype.setStageSize=function(a,b,c,d){slideBook.toScale=d;slideBook.containtWidth=Math.min(a,slideBook.stageWidth);slideBook.containtHeight=Math.min(b,slideBook.stageHeight);slideBook.resizeButton();slideBook.scrollButtonTran(c)};slidePage.prototype.onWinResize=function(a,b,c){this.toScale=1;var d=getPageWidthHeight(a,b,zoomPageWidth,zoomPageHeight);this.fitW=d.x;this.fitH=d.y;if(c)this.onResize(a,b,!0)};slidePage.prototype.showLoading=function(){this.side.append(this.loadingImg)};
slidePage.prototype.hideLoading=function(){this.loadingImg.remove();this.side.css({background:""})};slidePage.prototype.translate=function(a,b){b=Math.max(slideBook.bookHeight()-this.getHeight(),b);b=Math.min(b,0);a=Math.max(slideBook.bookHeight()-this.getHeight(),a);a=Math.min(a,0);this.setTranslate(a,b)};slidePage.prototype.isFit=function(){return this.toScale==this.fitW/this.width};
slidePage.prototype.animateBack=function(a){var b=getPoint(this.side),c={x:b.x,y:b.y,scale:this.toScale},d=this.fitW/this.width,e=this;$(c).animate({x:0,y:0,scale:d},{duration:200,step:function(){e.zoomObj(e.side,e.origin,c.scale,c.x,c.y)},complete:function(){e.toScale=d;a()}})};slidePage.prototype.showPage=function(){this.side.css({display:"block"})};slidePage.prototype.hidePage=function(){this.side.css({display:"none"})};slidePage.prototype.getWidth=function(){return this.width*this.toScale};
slidePage.prototype.getHeight=function(){return this.height*this.toScale};slidePage.prototype.getScale=function(){return this.toScale};
slidePage.prototype.initEvent=function(){var a=this,b=Point(0,0);Point(0,0);var c=Point(0,0),d=Point(0,0),e=!1,f=!1,g=!1,h=null,j=!1,k,m=0,l=0,n=!1;this.side.bind("mouseover",function(b){if(cursor&&bookType==BookType.slide_book){if(!0==a.isZomming||!0==slideBook.isFlipping)return!1;var c=getPoint(a.side);a.moveX=c.x;a.moveY=c.y;f=!0;Point(b.pageX,b.pageY)}});this.side.bind(_event._down,function(l){if(cursor&&bookType==BookType.slide_book){if(!0==a.isZomming||!0==slideBook.isFlipping)return!1;slideBook.isMove=
!1;k=a.toScale;var l=isTouch?l.originalEvent.touches:[l],m=getPoint(a.side);a.translateX=m.x;a.translateY=m.y;slideBook.initTranslate();1==l.length?(e=!0,g=!1,b=Point(l[0].pageX,l[0].pageY),h=Point(a.side.position().left,a.side.position().top)):2==l.length&&(e=!1,g=!0,b=Point(l[0].pageX,l[0].pageY),d=Point(l[1].pageX,l[1].pageY),c=Point((l[0].pageX+l[1].pageX)/2,(l[0].pageY+l[1].pageY)/2),h=Point(a.side.offset().left,a.side.offset().top));j=n=f=!1;stopEvent(l[0])}});3==browserType&&(_event._mousewheel=
"DOMMouseScroll");isIE()&&(_event._mousewheel="mousewheel");this.side.bind(_event._mousewheel,function(b){if(cursor){if(bookType!=BookType.slide_book||slideBook.isFlipping==true)return false;var c=b.originalEvent,c=Math.max(-1,Math.min(1,c.wheelDelta||-c.detail));getPoint(a.side);var d=-0.25;c>0&&(d=0.25);b=isTouch?b.originalEvent.touches:[b];a.pointX=b[0].pageX;a.pointY=b[0].pageY;slideBook.zoomAnimate(d);return n=false}});this.side.bind(_event._move,function(n){if(cursor&&bookType==BookType.slide_book){if(slideBook.isFlipping==
true||a.isZomming==true)return false;n=isTouch?n.originalEvent.touches:[n];e?a.side.css({cursor:"move"}):a.side.css({cursor:""});slideBook.isMove=true;if(e){f=false;var p=n[0].pageX-b.x+a.translateX,q=n[0].pageY-b.y+a.translateY;(new Date).getTime();q=Math.min(q*Math.min(Math.abs(q),Math.abs(slideBook.bookHeight()-a.getHeight()))/Math.abs(q),0);if(slideBook.bookWidth()+5<a.getWidth()){q=Math.max(slideBook.bookHeight()-a.getHeight(),q);q=Math.min(q,0);p=Math.max(slideBook.bookWidth()-a.getWidth(),
p);p=Math.min(p,0);a.zoomObj(a.side,a.origin,a.toScale,p,q);m=p;l=q;a.zoomToMove=true;a.gotoNextPage=false;a.gotoPrePage=false}else if(f!=true){a.zoomToMove=false;slideBook.translateMove(n[0].pageX-b.x,q);if(b.x-n[0].pageX>slideBook.width*a.toScale/4)if(parseBool(bookConfig.RightToLeft)){a.gotoNextPage=false;a.gotoPrePage=true}else{a.gotoNextPage=true;a.gotoPrePage=false}else if(b.x-n[0].pageX<=-slideBook.width*a.toScale/4)if(parseBool(bookConfig.RightToLeft)){a.gotoNextPage=true;a.gotoPrePage=false}else{a.gotoNextPage=
false;a.gotoPrePage=true}else{a.gotoNextPage=false;a.gotoPrePage=false}}m=p;l=q}else if(g){f=false;var s=Point(n[0].pageX,n[0].pageY),q=Point(n[1].pageX,n[1].pageY),p=Math.sqrt(Math.pow(b.x-d.x,2)+Math.pow(b.y-d.y,2)),s=Math.sqrt(Math.pow(s.x-q.x,2)+Math.pow(s.y-q.y,2));scale=Math.max(s/p*k,0.5);s=a.side.width()*scale;if(scale<1&&s<slideBook.minZoomWidth){scale=slideBook.minZoomWidth/slideBook.minZoomWidth;s=slideBook.minZoomWidth}if(scale>1&&s>slideBook.largeZoomWidth){scale=slideBook.largeZoomWidth/
slideBook.minZoomWidth;s=slideBook.largeZoomWidth}slideBook.showPage.toScale=scale;slideBook.prePage.toScale=scale;slideBook.nextPage.toScale=scale;slideBook.toScale=scale;slideBook.containtWidth=Math.min(slideBook.width*scale,slideBook.stageWidth);slideBook.containtHeight=Math.min(slideBook.height*scale,slideBook.stageHeight);q=(k-a.toScale)*slideBook.minZoomHeight*((c.y-h.y)/k/slideBook.minZoomHeight);p=a.translateX+(k-a.toScale)*slideBook.minZoomWidth*((c.x-h.x)/k/slideBook.minZoomWidth)+(slideBook.containtWidth-
Math.min(slideBook.width*k,slideBook.stageWidth))/2;q=a.translateY+q+(slideBook.containtHeight-Math.min(slideBook.height*k,slideBook.stageHeight))/2;q=Math.max(slideBook.bookHeight()-a.getHeight(),q);q=Math.min(q,0);p=Math.max(slideBook.bookWidth()-a.getWidth(),p);p=Math.min(p,0);slideBook.showPage.zoomObj(slideBook.showPage.side,slideBook.showPage.origin,a.toScale,p,q);slideBook.prePage.zoomObj(slideBook.prePage.side,slideBook.prePage.origin,a.toScale,-s,0);slideBook.nextPage.zoomObj(slideBook.nextPage.side,
slideBook.nextPage.origin,a.toScale,s,0);slideBook.resizeButton();p=(scale-slideBook.minZoomWidth/slideBook.width)*101*slideBook.width/(slideBook.largeZoomWidth-slideBook.minZoomWidth);slideBook.scrollButtonTran(p);j=true;m=p;l=q;stopEvent(n[0])}else if(f==true&&slideBook.isZoomming!=true&&slideBook.moveByPoints){p=Math.max(n[0].pageX-parseInt(slideBook.book.css("left"))-slideBook.bookWidth()/6,0)*(slideBook.bookWidth()-a.getWidth())*3/slideBook.bookWidth();q=Math.max(n[0].pageY-parseInt(slideBook.book.css("top"))-
slideBook.bookHeight()/6,0)*(slideBook.bookHeight()-a.getHeight())*3/slideBook.bookHeight();(new Date).getTime();q=Math.max(slideBook.bookHeight()-a.getHeight(),q);q=Math.min(q,0);p=Math.max(slideBook.bookWidth()-a.getWidth(),p);p=Math.min(p,0);a.animateTranslate(p,q,30);m=p;l=q;a.gotoNextPage=false;a.gotoPrePage=false}}});this.side.bind(_event._end,function(){if(cursor&&bookType==BookType.slide_book){if(a.isZomming==true||slideBook.isFlipping==true||n==true)return false;a.side.css({cursor:""});a.translateX=
m;var b=l,b=Math.max(slideBook.bookHeight()-a.getHeight(),b),b=Math.min(b,0);a.translateY=b;try{a.gotoNextPage==true?slideBook.gotoPage(parseInt(slideBook.currentIndex/2)*2+2):a.gotoPrePage==true?slideBook.gotoPage(parseInt(slideBook.currentIndex/2)*2-2):a.zoomToMove==false&&j==false&&slideBook.translateToOrigin(a.translateY);a.gotoNextPage=false;a.gotoPrePage=false;n=true}catch(c){}e=false;f=true;j=g=false}});this.side.bind(_event._leave,function(){if(cursor&&bookType==BookType.slide_book){if(a.isZomming==
true||slideBook.isFlipping==true||n==true)return false;a.side.css({cursor:""});a.translateX=m;var b=l,b=Math.max(slideBook.bookHeight()-a.getHeight(),b),b=Math.min(b,0);a.translateY=b;try{a.gotoNextPage==true?slideBook.gotoPage(parseInt(slideBook.currentIndex/2)*2+2):a.gotoPrePage==true?slideBook.gotoPage(parseInt(slideBook.currentIndex/2)*2-2):a.zoomToMove==false&&j==false&&slideBook.translateToOrigin(a.translateY);a.gotoNextPage=false;a.gotoPrePage=false;n=true}catch(c){}e=false;f=true;j=g=false}});
this.side.hammer().on("doubletap",function(){if(cursor){if(slideBook.isFlipping==true||this.isZomming==true||bookType!=BookType.slide_book)return false;j=true;var b=1,b=a.width*a.toScale/zoomPageWidth;a.side.offset();a.side.offset();if(b<0.75){b=zoomPageWidth/a.width;slideBook.zoomToScale(b-slideBook.toScale)}else slideBook.zoomToScale(1-slideBook.toScale)}})};slidePage.prototype.initMM=function(){this.leftSide.initMM();this.rightSide.initMM()};
slidePage.prototype.MMResize=function(a,b){this.leftSide.MMResize(a,b);this.rightSide.MMResize(a,b)};slidePage.prototype.addHistoryTexts=function(){this.leftSide.addHistoryTexts;this.rightSide.addHistoryTexts};slidePage.prototype.highlightSearch=function(a){this.leftSide.highlightSearch(a);this.rightSide.highlightSearch(a)};slidePage.prototype.clearHighlight=function(){this.leftSide.clearHighlight();this.rightSide.clearHighlight()};
var CatalogPage=Class({create:function(a){this._super(a);this.zoomed=!1},initEvent:function(){var a=this,b,c,d,e=0,f=0,g,h,j;this.side.bind(_event._over,function(){cursor&&bookType==BookType.catalog_book&&(a.zoomed?a.side.css({cursor:"url("+uiBaseURL+"catalog_zoomout.png),auto"}):a.side.css({cursor:"url("+uiBaseURL+"catalog_zoomin.png),auto"}))});this.side.bind(_event._down,function(e){if(!(!cursor||bookType!=BookType.catalog_book||catalogBook.isFlipping||!0==a.isZomming)){e=isTouch?e.originalEvent.touches:
[e];a.pointX=e[0].pageX;a.pointY=e[0].pageY;var f=getPoint(a.side);a.translateX=f.x;a.translateY=f.y;1==e.length?(j=!1,g=!0,h=!1,b=Point(e[0].pageX,e[0].pageY),Point(a.side.position().left,a.side.position().top)):2==e.length&&(g=!1,h=!0,b=Point(e[0].pageX,e[0].pageY),c=Point(e[1].pageX,e[1].pageY),d=Point((e[0].pageX+e[1].pageX)/2,(e[0].pageY+e[1].pageY)/2),Point(a.side.offset().left,a.side.offset().top),a.pointX=d.x,a.pointY=d.y);catalogBook.initTranslate()}});this.side.bind(_event._move,function(d){if(!(!cursor||
bookType!=BookType.catalog_book||catalogBook.isFlipping||!0==a.isZomming)){getPoint(a.side);catalogBook.bookMap.refreshArea();d=isTouch?d.originalEvent.touches:[d];g?a.side.css({cursor:"url("+uiBaseURL+"catalog_drag.png),auto"}):a.zoomed?a.side.css({cursor:"url("+uiBaseURL+"catalog_zoomout.png),auto"}):a.side.css({cursor:"url("+uiBaseURL+"catalog_zoomin.png),auto"});if(g){var m=d[0].pageX-b.x+a.translateX,l=d[0].pageY-b.y+a.translateY,l=Math.max(catalogBook.bookHeight()-a.getHeight(),l),l=Math.min(l,
0);!0!=a.zoomed?(catalogBook.translateMove(d[0].pageX-b.x,l),b.x-d[0].pageX>catalogBook.width*a.toScale/4?parseBool(bookConfig.RightToLeft)?(a.gotoNextPage=!1,a.gotoPrePage=!0):(a.gotoNextPage=!0,a.gotoPrePage=!1):b.x-d[0].pageX<=-slideBook.width*a.toScale/4?parseBool(bookConfig.RightToLeft)?(a.gotoNextPage=!0,a.gotoPrePage=!1):(a.gotoNextPage=!1,a.gotoPrePage=!0):(a.gotoNextPage=!1,a.gotoPrePage=!1),e=m,f=l):(m=Math.max(catalogBook.bookWidth()-a.getWidth(),m),m=Math.min(m,0),a.setPositionBar(m,l),
a.setTranslate(m,l));j=1<=Math.abs(d[0].pageX-b.x)||Math.abs(1<=d[0].pageY-b.y)?!0:!1}else h&&(!0==a.zoomed&&(m=Math.sqrt(Math.pow(b.x-c.x,2)+Math.pow(b.y-c.y,2)),d=Math.sqrt(Math.pow(d[0].pageX-d[1].pageX,2)+Math.pow(d[0].pageY-d[1].pageY,2)),d=Math.max(d/m*a.toScale,a.largeZoomWidth/a.width),a.zoomToScale(d-a.toScale,0)),j=!0);a.isMoving=!0}});this.side.bind(_event._end,function(){if(!(!cursor||bookType!=BookType.catalog_book||catalogBook.isFlipping||!0==a.isZomming)){if(j){if(!0!=a.zoomed&&g){a.translateX=
e;var b=f,b=Math.max(catalogBook.bookHeight()-a.getHeight(),b),b=Math.min(b,0);a.translateY=b;try{!0==a.gotoNextPage?catalogBook.gotoPage(2*parseInt(catalogBook.currentIndex/2)+2):!0==a.gotoPrePage?catalogBook.gotoPage(2*parseInt(catalogBook.currentIndex/2)-2):catalogBook.translateToOrigin(a.translateY),a.gotoNextPage=!1,a.gotoPrePage=!1}catch(c){}}}else auto_player.isPlaying()&&(auto_player.stop(),toolBar.changeAutoPlayIcon()),a.zoomed=!a.zoomed,a.zoomed?catalogBook.zoomIn():catalogBook.zoomOut();
h=g=a.isMoving=!1}});3==browserType&&(_event._mousewheel="DOMMouseScroll");isIE()&&(_event._mousewheel="mousewheel");this.side.bind(_event._mousewheel,function(b){if(!(!cursor||bookType!=BookType.catalog_book||catalogBook.isFlipping||a.zoomed!=true)){catalogBook.bookMap.refreshArea();var b=b.originalEvent,c=Math.max(-1,Math.min(1,b.wheelDelta||-b.detail)),b=getPoint(a.side),d=-100;c>0&&(d=100);c=b.y+d;c=Math.max(catalogBook.bookHeight()-a.getHeight(),c);c=Math.min(c,0);a.setPositionBar(b.x,c);a.setTranslate(b.x,
c)}});this.side.speed(this.inertiaMove.bind(this))},inertiaMove:function(a,b){if(cursor&&bookType==BookType.catalog_book&&!catalogBook.isFlipping){var c=a,d=b,e=a/8,f=b/8,g=0,h=window.setInterval(function(){if(!0==this.isZomming)window.clearInterval(h);else{var a=getPoint(this.side);c-=e;d-=f;a.x+=c;a.y+=d;a.y=Math.max(catalogBook.bookHeight()-this.getHeight(),a.y);a.y=Math.min(a.y,0);a.x=Math.max(catalogBook.bookWidth()-this.getWidth(),a.x);a.x=Math.min(a.x,0);this.translate(a.x,a.y);8==++g&&window.clearInterval(h)}}.bind(this),
20);this.inertiaTimer=h}},zoomIn:function(){var a=catalogBook.largeZoomWidth/this.width-this.toScale;catalogBook.stageWidth=windowWidth;catalogBook.stageHeight=windowHeight;this.zoom(a,0);this.zoomed=!0},zoomOut:function(){var a=this.width/catalogBook.largeZoomWidth-this.toScale;catalogBook.stageWidth=catalogBook.moveWidth;catalogBook.stageHeight=catalogBook.moveHeight;this.zoom(a,0);this.zoomed=!1},getStageSize:function(){return void 0!=catalogBook?[catalogBook.stageWidth,catalogBook.stageHeight]:
[0,0]},setStageSize:function(a,b,c,d){catalogBook.toScale=d;catalogBook.containtWidth=Math.min(a,catalogBook.stageWidth);catalogBook.containtHeight=Math.min(b,catalogBook.stageHeight);catalogBook.resizeButton();catalogBook.scrollButtonTran(c)},getNewScale:function(a){var a=this.toScale+a,b=this.width*a;1>a&&b<this.width&&(a=1);return a},getTran:function(a,b,c,d,e){a=this.toScale;b=Point(this.side.offset().left,this.side.offset().top);getPoint(this.side);return[b.x+(a-e)*this.width*((this.pointX-b.x)/
a/this.width),b.y+(a-e)*this.height*((this.pointY-b.y)/a/this.height)]},setPositionBar:function(a,b){var c=0==a?!0:!1,d=0==b?!0:!1,e=a==catalogBook.bookWidth()-this.getWidth()?!0:!1,f=b==catalogBook.bookHeight()-this.getHeight()?!0:!1;catalogBook.controlBar.setDullOrLight(c,d,e,f)},translate:function(a,b){b=Math.max(catalogBook.bookHeight()-this.getHeight(),b);b=Math.min(b,0);a=Math.max(catalogBook.bookWidth()-this.getWidth(),a);a=Math.min(a,0);this.setTranslate(a,b);catalogBook.bookMap.refreshArea();
this.setPositionBar(a,b)},animateZoom:function(a,b,c,d){if(!0!=this.isZomming){this.isZomming=!0;a||(a=this.toScale);b||(b=0);c||(c=0);d||(d=25);var e=getPoint(this.side),f={scale:this.toScale,x:e.x,y:e.y,w:Math.min(this.width*this.toScale,this.getStageSize()[0]),h:Math.min(this.height*this.toScale,this.getStageSize()[1]),l:101*(this.toScale-1)*this.width/(this.largeZoomWidth-this.width)},g=this,e=Math.min(this.width*a,this.getStageSize()[0]),h=Math.min(this.height*a,this.getStageSize()[1]),j=101*
(a-1)*this.width/(this.largeZoomWidth-this.width);$(f).animate({scale:a,x:b,y:c,w:e,h:h,l:j},{duration:d,easing:"easeOutSine",step:function(){g.zoomObj(g.side,g.origin,f.scale,f.x,f.y);g.setStageSize(f.w,f.h,f.l,f.scale)},complete:function(){g.toScale=a;g.zoomObj(g.side,g.origin,a,b,c);g.setStageSize(g.width*a,g.height*a,j,a);g.isZomming=false;if(catalogBook.showPage.zoomed!=true){catalogBook.prePage.setVisible(true);catalogBook.nextPage.setVisible(true)}}})}}}).extend(slidePage);function initPhoneBook(a){this.bookContainer=$("<div style='left:0px;right:0px;top:0px;bottom:0px;position:absolute;display:none;'></div>");this.book=$("<div></div>");this.bookPage=$("<div></div>");this.prePage=new phonePage(this.bookPage);this.nextPage=new phonePage(this.bookPage);this.showPage=new phonePage(this.bookPage);this.preButton=$("<div></div>");this.nextButton=$("<div></div>");this.firstButton=$("<div></div>");this.lastButton=$("<div></div>");this.width=windowWidth;this.height=windowHeight;
this.prePage.setChildIndex(1);this.showPage.setChildIndex(3);this.nextPage.setChildIndex(2);this.diffPageCount=0;this.currentIndex=1;this.showingPage=this.flipPage=null;this.isFlipping=!1;this.minZoomWidth=windowWidth;this.largeScale=Math.max(1,2.5*zoomPageWidth/windowWidth);this.largeZoomWidth=windowWidth*this.largeScale;a.append(this.bookContainer);this.bookContainer.append(this.book);this.bookContainer.append(this.preButton);this.bookContainer.append(this.nextButton);this.bookContainer.append(this.firstButton);
this.bookContainer.append(this.lastButton);this.preImg=$('<img src="'+uiBaseURL+'slide_leftButton.png"></img>');this.nextImg=$('<img src="'+uiBaseURL+'slide_rightButton.png"></img>');this.firstImg=$('<img src="'+uiBaseURL+'slide_firstButton.png"></img>');this.lastImg=$('<img src="'+uiBaseURL+'slide_lastButton.png"></img>');this.preButton.append(this.preImg);this.nextButton.append(this.nextImg);this.firstButton.append(this.firstImg);this.lastButton.append(this.lastImg);this.preButton.css({display:"none"});
this.nextButton.css({display:"none"});this.firstButton.css({display:"none"});this.lastButton.css({display:"none"});this.book.append(this.bookPage);this.book.css({width:this.width+"px",height:this.height+"px",position:"absolute",overflow:"hidden","z-index":"9"});this.preButton.css({width:"30px",height:"59px",left:"0px",top:(windowHeight-90)/2+"px",background:"#888888","z-index":"10","border-bottom":"1px solid #000000","border-radius":"5px 5px 0px 0px",position:"absolute",opacity:"0.5"});this.nextButton.css({width:"30px",
height:"59px",left:windowWidth-30+"px",top:(windowHeight-90)/2+"px",background:"#888888","z-index":"10","border-bottom":"1px solid #000000","border-radius":"5px 5px 0px 0px",position:"absolute",opacity:"0.5"});this.firstButton.css({width:"30px",height:"30px",left:"0px",top:(windowHeight-90)/2+60+"px",background:"#888888","z-index":"10","border-top":"1px solid #ffffff","border-radius":"0px 0px 5px 5px",position:"absolute",opacity:"0.5"});this.lastButton.css({width:"30px",height:"30px",left:windowWidth-
30+"px",top:(windowHeight-90)/2+60+"px",background:"#888888","border-top":"1px solid #ffffff","z-index":"10","border-radius":"0px 0px 5px 5px",position:"absolute",opacity:"0.5"});this.firstImg.css({left:"7px",top:"7px",position:"absolute"});this.lastImg.css({left:"7px",top:"7px",position:"absolute"});this.preImg.css({left:"7px",top:"22px",position:"absolute"});this.nextImg.css({left:"7px",top:"22px",position:"absolute"});this.fillNear(1);this.pageIndexLabel=new label("1/"+totalPageCount,this.bookContainer);
this.pageIndexLabel.setLabelPosition(10,10,["left","bottom"]);this.pageIndexLabel.setCSS({"padding-left":"5px","padding-right":"5px",height:"25px","line-height":"25px",vertical:"middle","text-align":"center","border-radius":"3px","z-index":"10",background:"#333333"});this.pageIndexLabel.setFont(10,"#edaa1d");this.toScale=1;this.initEvent();void 0!=leftRightButton&&null!=leftRightButton&&leftRightButton.setShow(!1)}initPhoneBook.prototype.getCurrentPageIndex=function(){return this.currentIndex};
initPhoneBook.prototype.setShow=function(a){this.pageIndexLabel.setCSS({display:a?"block":"none"});this.preButton.css({display:!a?"block":"none"});this.nextButton.css({display:!a?"block":"none"});this.firstButton.css({display:!a?"block":"none"});this.lastButton.css({display:!a?"block":"none"})};
initPhoneBook.prototype.onResize=function(){this.toScale=1;this.stageWidth=windowWidth;this.stageHeight=windowHeight;var a=getPageWidthHeightByWidth(this.stageWidth/2,this.stageHeight,zoomPageWidth,zoomPageHeight);this.width=2*a.x;this.height=a.y;this.minZoomWidth=2*a.x;this.minZoomHeight=a.y;this.largeZoomWidth=this.width*this.largeScale;this.largeZoomHeight=this.height*this.largeScale;this.containtWidth=Math.min(this.width*this.toScale,this.stageWidth);this.containtHeight=Math.min(this.height*this.toScale,
this.stageHeight);this.book.css({width:this.containtWidth+"px",height:this.containtHeight+"px",left:(this.stageWidth-this.containtWidth)/2+"px",top:(this.stageHeight-this.containtHeight)/2+"px"});this.preButton.css({left:"0px",top:(windowHeight-90)/2+"px"});this.nextButton.css({left:windowWidth-30+"px",top:(windowHeight-90)/2+"px"});this.firstButton.css({left:"0px",top:(windowHeight-90)/2+60+"px"});this.lastButton.css({left:windowWidth-30+"px",top:(windowHeight-90)/2+60+"px"});this.prePage.onWinResize(this.containtWidth,
this.containtHeight,!0);this.showPage.onWinResize(this.containtWidth,this.containtHeight,!0);this.nextPage.onWinResize(this.containtWidth,this.containtHeight,!0);this.prePage.translate(-this.prePage.getWidth(),0);this.nextPage.translate(this.containtWidth,0);this.pageIndexLabel.setLabelPosition(10,10,["left","bottom"])};initPhoneBook.prototype.setTranslate=function(a,b,c){b=translate(b,c);a.css({"-webkit-transform":b,"-moz-transform":b,"-o-transform":b,"-ms-transform":b})};
initPhoneBook.prototype.gotoPage=function(a){var b=this;this.prePage.clearHighlight();this.nextPage.clearHighlight();0==a&&(a=1);if(this.currentIndex==a||1>a||a>originTotalPageCount||this.isFlipping){var c=1>a?"This is the first page":"This is the last page";if(1>a||a>originTotalPageCount)b.translateToOrigin(0),_tipsBox.setCaption(c),_tipsBox.showTipsBox()}else{this.isFlipping=!0;this.diffPageCount=a-this.currentIndex;var d=0,e=this.showPage,f=void 0,b=this,c=Point(0,e.getWidth());centerP=Point(0,
0);this.currentIndex>a?(f=this.prePage,d=c.y):(f=this.nextPage,d=-c.y);tragetToLeft=centerP.x;f.fillTemp(a);window.setTimeout(function(){var c=getTransform(e.side[0]),h=getTransform(f.side[0]);f.forceReset();var j=30,k=bookConfig.flippingTime*1E3;k!=void 0&&k>0&&(j=4);var m=0,l=window.setInterval(function(){var k=Point(0,0),o=Point(0,0);k.x=$.easing.swing(null,m,c.x,d-c.x,j);o.x=$.easing.swing(null,m,h.x,tragetToLeft-h.x,j);m++;e.translate(k.x,k.y);f.translate(o.x,o.y);if(m>j){window.clearInterval(l);
window.setTimeout(function(){b.showPage.noZoom();auto_player.resetTimer();b.changePage();b.endFlip(a);b.isFlipping=false},20)}},20)},100)}};initPhoneBook.prototype.changePage=function(){var a=null;0<this.diffPageCount?(a=this.showPage,this.showPage=this.nextPage,this.nextPage=this.prePage):(a=this.nextPage,this.nextPage=this.showPage,this.showPage=this.prePage);this.prePage=a};initPhoneBook.prototype.addSearchHighlight=function(){this.showPage.highlightSearch(this.currentIndex)};
initPhoneBook.prototype.clearSearchHighlight=function(){this.showPage.clearHighlight()};
initPhoneBook.prototype.endFlip=function(a){a=2*parseInt(a/2);0==a&&(a=1);this.currentIndex=a;this.fillNear(a);setCurrentIndexTextField(this.currentIndex,!1);window.location.hash="#p="+this.currentIndex;sendvisitinfo(1,this.currentIndex);thumbnail.clearHighLight();thumbnail.setHighLight(this.currentIndex);this.prePage.translate(-this.prePage.getWidth(),0);this.nextPage.translate(this.containtWidth,0);this.pageIndexLabel.setCaption((1==a||a==originTotalPageCount?this.currentIndex:this.currentIndex+
"-"+(this.currentIndex+1))+"/"+totalPageCount);this.addSearchHighlight()};initPhoneBook.prototype.setVisible=function(a){this.bookContainer.css({display:a?"block":"none"})};initPhoneBook.prototype.setPosition=function(a,b){this.book.css({left:a+"px",top:b+"px"})};
initPhoneBook.prototype.fillNear=function(a){a=2*parseInt(a/2);0<=a&&this.prePage.fillContent(a-2);this.showPage.changeContent(a);a<=originTotalPageCount&&this.nextPage.fillContent(a+2);this.prePage.resetSlider();this.showPage.playSlider();this.nextPage.resetSlider()};
initPhoneBook.prototype.initEvent=function(){var a=this;Point(0,0);this.preButton.bind(_event._end,function(){a.gotoPage(a.currentIndex-2)});this.nextButton.bind(_event._end,function(){a.gotoPage(a.currentIndex+2)});this.preButton.bind(_event._enter,function(){a.preButton.css({background:"#000000"})});this.nextButton.bind(_event._enter,function(){a.nextButton.css({background:"#000000"})});this.preButton.bind(_event._leave,function(){a.preButton.css({background:"#888888"})});this.nextButton.bind(_event._leave,
function(){a.nextButton.css({background:"#888888"})});this.preButton.bind(_event._end,function(){a.preButton.css({background:"#888888"})});this.nextButton.bind(_event._end,function(){a.nextButton.css({background:"#888888"})});this.firstButton.bind(_event._enter,function(){a.firstButton.css({background:"#000000"})});this.lastButton.bind(_event._enter,function(){a.lastButton.css({background:"#000000"})});this.firstButton.bind(_event._leave,function(){a.firstButton.css({background:"#888888"})});this.lastButton.bind(_event._leave,
function(){a.lastButton.css({background:"#888888"})});this.firstButton.bind(_event._end,function(){a.firstButton.css({background:"#888888"})});this.lastButton.bind(_event._end,function(){a.lastButton.css({background:"#888888"})});this.firstButton.bind(_event._down,function(){a.gotoPage(1)});this.lastButton.bind(_event._down,function(){a.gotoPage(originTotalPageCount)})};
initPhoneBook.prototype.translateToOrigin=function(a){this.showPage.animateZoom(this.toScale,0,a,300);this.nextPage.animateZoom(this.toScale,this.containtWidth,0,300);this.prePage.animateZoom(this.toScale,-this.containtWidth,0,300)};initPhoneBook.prototype.initTranslate=function(){var a=getTransform(this.showPage.side[0]),b=getTransform(this.prePage.side[0]),c=getTransform(this.nextPage.side[0]);this.tran=Point(a.x,a.y);this.pretran=Point(b.x,b.y);this.nexttran=Point(c.x,c.y)};
initPhoneBook.prototype.translateMove=function(a,b){this.showPage.setTranslate(this.showPage.side,a+this.tran.x,b);this.prePage.setTranslate(this.prePage.side,a+this.pretran.x,0);this.nextPage.setTranslate(this.nextPage.side,a+this.nexttran.x,0)};initPhoneBook.prototype.zoom=function(a){this.showPage.zoom(a,0)};initPhoneBook.prototype.zoom=function(a){this.showPage.zoom(a,0)};initPhoneBook.prototype.zoomToScale=function(a){this.showPage.zoomToScale(a,0)};initPhoneBook.prototype.noZoom=function(){this.showPage.noZoom()};
initPhoneBook.prototype.getLeft=function(){return this.book.offset().left};initPhoneBook.prototype.getTop=function(){return this.book.offset().top};initPhoneBook.prototype.getWidth=function(){return this.containtWidth};initPhoneBook.prototype.getHeight=function(){return this.containtHeight};initPhoneBook.prototype.getScale=function(){return 1};
initPhoneBook.prototype.show=function(){debug("phone book show.");this.setVisible(!0);this.prePage.showPage();this.nextPage.showPage();this.showPage.showPage();var a=this;window.setTimeout(function(){a.showPage.showPage();a.addSearchHighlight(this.currentIndex);a.showPage.playSlider()},500);void 0!=leftRightButton&&null!=leftRightButton&&leftRightButton.setShow(!1)};
initPhoneBook.prototype.hide=function(){debug("phone book hide.");this.setVisible(!1);hideLeftRightButton()&&leftRightButton.setShow(!0);this.showPage.resetSlider()};function phoneSide(a){this.side=$("<div></div>");this.sideContent=$("<div class='sideContent' style= 'overflow: hidden'></div>");this.sideImg=$("<img style='position: absolute;' />");this.MMbg=$("<div style='position:absolute;z-index:3;'></div>");this.loadingImg=$("<img src='"+uiBaseURL+"progress.gif' style='position: absolute;'>");this.width=zoomPageWidth;this.height=zoomPageHeight;this.fitH=this.fitW=0;this.tmpImg=$("<img style='position: absolute;z-index:-1;' />");this.searchHighlight=$("<div class='kong' id='highlight'></div>");
a.append(this.side);this.side.append(this.sideContent);this.imgIndex=-1;this.toScale=1;this.origin="0% 0%";this.translateY=this.translateX=this.y=this.x=0;this.toolbarShow=this.isZomming=!1;this.sideTop=0;this.side.css({width:this.width+"px",height:this.height+"px",top:this.sideTop+"px",position:"absolute","border-width":"0px"});this.sideContent.css({width:this.width+"px",height:this.height+"px",background:"transparent"});this.searchHighlight.css({width:this.width+"px",height:this.height+"px"});this.sideImg.css({width:this.width+
"px",height:this.height+"px"});this.MMbg.css({width:this.width+"px",height:this.height+"px"});this.loadingImg.css({left:this.width/2-10+"px",top:this.height/2-10+"px"});this.linkArray=[];this.youtubeArray=[];this.videoArray=[];this.audioArray=[];this.imageArray=[];this.buttonArray=[];this.flashShowArray=[];this.flashSwfArray=[];this.lineArray=[];this.arrowArray=[];this.roundArray=[];this.reArray=[];this.textArray=[];this.areaArray=[];this.calloutArray=[];this.atextArray=[];this.startextArray=[];this.aminArray=
[];this.atimageArray=[];this.alimageArray=[];this.slideShowArray=[];this.efftextArray=[];this.soundArray=[];this.bannerArray=[];this.carouselArray=[];this.dynshowArray=[];this.jumpArray=[];this.rotate3DArray=[];this.vimeoArray=[];this.slider=null;this.playSliderAfterLoad=!1;this.onWinResize(windowWidth-leftMargin-rightMargin,windowHeight-topMargin-bottomMargin-40,!0);this.father=a}phoneSide.prototype.hideMM=function(){this.MMbg.css({display:"none"})};phoneSide.prototype.showMM=function(){this.MMbg.css({display:"block"})};
phoneSide.prototype.setCSS=function(a){this.side.css(a)};phoneSide.prototype.onResize2=function(a){this.toScale=a/this.width;a=getTransform(this.side[0]);this.zoomObj(this.side,this.origin," scale("+this.toScale+")",a.x,a.y)};
phoneSide.prototype.onResize=function(a,b,c){this.toScale=1;a=getPageWidthHeightByWidth(a,b,zoomPageWidth,zoomPageHeight);this.width=a.x*this.toScale;this.height=a.y*this.toScale;this.side.css({width:this.width+"px",height:this.height+"px"});this.sideContent.css({width:this.width+"px",height:this.height+"px"});this.sideImg.css({width:this.width+"px",height:this.height+"px"});this.searchHighlight.css({width:this.width+"px",height:this.height+"px"});this.MMbg.css({width:this.width+"px",height:this.height+
"px"});this.MMResize(this.width,this.height);c&&this.tmpImg.css({width:this.width+"px",height:this.height+"px",top:this.sideTop+"px"});this.loadingImg.css({left:this.width/2-10+"px",top:this.height/2-10+"px"})};phoneSide.prototype.getSide=function(){return this.side};
phoneSide.prototype.fillContent=function(a){this.imgIndex=a;var b=this;this.sideContent.empty();a>originTotalPageCount+3||-2>a||(this.sideImg.attr("src",getPageDir(a,"thumb",originTotalPageCount)),this.sideImg.load(function(){b.tmpImg.attr("src",getPageDir(a,"thumb",originTotalPageCount));b.sideContent.append(b.sideImg);b.sideContent.append(b.tmpImg)}))};
phoneSide.prototype.fillTemp=function(a){if(a!=this.imgIndex){this.imgIndex=a;var b=this;this.sideContent.empty();a>originTotalPageCount+3||-2>a||(this.sideImg.attr("src",getPageDir(a,"thumb",originTotalPageCount)),this.sideImg.load(function(){b.tmpImg.attr("src",getPageDir(a,"thumb",originTotalPageCount));b.sideContent.append(b.sideImg);b.sideContent.append(b.tmpImg)}))}};
phoneSide.prototype.changeContent=function(a){this.imgIndex=a;var b=this;a>originTotalPageCount+3||-2>a||(null!=this.slider&&(this.slider.destroy(),this.slider=null),this.sideImg.attr("src",getPageDir(a,"normal",originTotalPageCount)),this.sideImg.load(function(){b.hideLoading();b.tmpImg.attr("src",getPageDir(a,"normal",originTotalPageCount));b.sideContent.append(b.sideImg);b.sideContent.append(b.tmpImg);b.sideContent.append(b.MMbg);b.sideContent.append(b.searchHighlight);b.searchHighlight.css({opacity:0.8});
pageEditor!=void 0&&b.initMM()}))};phoneSide.prototype.setPosition=function(a,b){this.side.css({left:a+"px",top:b+"px"})};phoneSide.prototype.setChildIndex=function(a){this.side.css({"z-index":a})};phoneSide.prototype.setVisible=function(a){this.side.css({display:a?"block":"none"})};
phoneSide.prototype.resetSize=function(){this.tmpImg.css({display:"none"});var a=this.width*this.toScale>=zoomPageWidth,b=a?zoomPageWidth:this.width*this.toScale,c=a?zoomPageHeight:this.height*this.toScale,d=getTransform(this.side[0]),e=this.width==zoomPageWidth&&b<zoomPageWidth||this.width!=zoomPageWidth;this.toScale=a?this.width*this.toScale/zoomPageWidth:1;var a=phoneBook.minZoomWidth,f=phoneBook.minZoomHeight;if(void 0!=a&&void 0!=f&&0<a&&0<f){b/c>a/f?f=a*c/b:a=f*b/c;var g=Math.min(0,b-a),h=Math.min(0,
c-f),b=Math.max(b,a),c=Math.max(c,f);d.x+=g/2;d.y+=h/2}this.zoomObj(this.side,"0% 0%","scale("+this.toScale+")",d.x,d.y);this.width=b;this.height=c;this.translateX=d.x;this.translateY=d.y;e&&this.tmpImg.css({width:this.width+"px",height:this.height+"px"});this.zoomObj(this.tmpImg,"0% 0%","scale("+this.toScale+")",d.x,d.y);this.tmpImg.css({display:"block"});if(e)this.onResize(b,c)};
phoneSide.prototype.zoom=function(a,b){if(!0==this.isZomming)return!1;var c=phoneBook.minZoomWidth,d=phoneBook.largeZoomWidth,e=this.side.width()*this.toScale;this.side.height();var f=this.toScale+a,g=this.side.width()*f;if(1>f){if(e<=c)return;g<c&&(f=c/this.side.width())}1<f&&g>d&&(f=d/this.side.width());g=this.side.width()*f;this.side.height();c=(e-g)/2+this.translateX;0==b&&(c=0);1==b&&(c=g);-1==b&&(c=-g);this.animateZoom(f,c,0,300)};
phoneSide.prototype.zoomToScale=function(a,b){if(!0==this.isZomming)return!1;var c=phoneBook.minZoomWidth,d=phoneBook.largeZoomWidth,e=this.side.width()*this.toScale;this.side.height();var f=this.toScale+a,g=this.side.width()*f;if(1>f){if(e<=c)return;g<c&&(f=c/this.side.width())}1<f&&g>d&&(f=d/this.side.width());g=this.side.width()*f;this.side.height();c=(e-g)/2+this.translateX;0==b&&(c=0);1==b&&(c=g);-1==b&&(c=-g);!0!=this.isZomming&&(this.isZomming=!0,f||(f=this.toScale),c||(c=0),getTransform(this.side[0]),
this.tmpImg.css({display:"none"}),this.zoomObj(this.side,this.origin," scale("+f+")",c,0),this.zoomObj(this.tmpImg,this.origin," scale("+f+")",c,0),this.tmpImg.css({display:"block"}),this.toScale=f,phoneBook.toScale=f,phoneBook.containtWidth=Math.min(phoneBook.width*f,phoneBook.stageWidth),phoneBook.containtHeight=Math.min(phoneBook.height*f,phoneBook.stageHeight),phoneBook.book.css({width:phoneBook.containtWidth+"px",height:phoneBook.containtHeight+"px",left:(phoneBook.stageWidth-phoneBook.containtWidth)/
2+"px",top:(phoneBook.stageHeight-phoneBook.containtHeight)/2+"px"}),this.isZomming=!1)};phoneSide.prototype.noZoom=function(){this.toScale=this.fitW/this.width;this.zoomObj(this.side,"0% 0%","scale("+this.toScale+")",0,0);this.zoomObj(this.tmpImg,"0% 0%","scale("+this.toScale+")",0,0)};phoneSide.prototype.forceReset=function(a){this.width=this.fitW;this.height=this.fitH;this.toScale=1;void 0==a&&(a=getTransform(this.side[0]));this.forceResize(a)};
phoneSide.prototype.forceMax=function(){var a=(this.width*this.toScale-zoomPageWidth)/2;this.width=zoomPageWidth;this.height=zoomPageHeight;var b=getTransform(this.side[0]);b.x+=a;this.forceResize(b)};phoneSide.prototype.animateMax=function(){this.animateZoom(zoomPageWidth/this.width,(this.width-zoomPageWidth)/2,0,300)};phoneSide.prototype.animateFit=function(){this.animateZoom(this.fitW/this.width,0,0,300)};
phoneSide.prototype.forceResize=function(a){this.side.css({width:this.width+"px",height:this.height+"px"});this.sideContent.css({width:this.width+"px",height:this.height+"px"});this.sideImg.css({width:this.width+"px",height:this.height+"px"});this.searchHighlight.css({width:this.width+"px",height:this.height+"px"});this.MMbg.css({width:this.width+"px",height:this.height+"px"});this.MMResize(this.width,this.height);this.tmpImg.css({width:this.width+"px",height:this.height+"px"});this.loadingImg.css({left:this.width/
2-10+"px",top:this.height/2-10+"px"});this.toScale=1;this.zoomObj(this.side,"0% 0%","scale("+this.toScale+")",a.x,a.y);this.zoomObj(this.tmpImg,"0% 0%","scale("+this.toScale+")",a.x,a.y);this.translateX=a.x;this.translateY=a.y};phoneSide.prototype.getScaleFromFit=function(){return this.width*this.toScale/this.fitW};phoneSide.prototype.getCenterTransform=function(){return Point((this.fitW-this.width*this.toScale)/2,0)};
phoneSide.prototype.zoomToMax=function(){var a=zoomPageWidth/this.width;this.animateZoom(a,(this.width*this.toScale-this.width*a)/2+this.translateX,0,200)};phoneSide.prototype.zoomToFit=function(){this.animateZoom(this.getScaleFromFit(),0,0,200)};
phoneSide.prototype.zoomObj=function(a,b,c,d,e){d||(d=0);e||(e=0);d=translate(d,e);a.css({"-webkit-transform-origin":b,"-moz-transform-origin":b,"-ms-transform-origin":b,"-o-transform-origin":b,"-webkit-transform":d+c,"-moz-transform":d+c,"-ms-transform":d+c,"-o-transform":d+c})};phoneSide.prototype.setTranslate=function(a,b,c){b=translate(b,c);a.css({"-webkit-transform":b,"-moz-transform":b,"-o-transform":b,"-ms-transform":b})};phoneSide.prototype.setXY=function(a,b){this.x=a;this.y=b};
phoneSide.prototype.animateTranslate=function(a,b,c){a||(a=0);b||(b=0);c||(c=25);var d=getTransform(this.side[0]),e=this;$(d).animate({x:a,y:b},{duration:c,easing:"easeOutSine",complete:function(){e.zoomObj(e.side,e.origin," scale("+e.toScale+")",d.x,d.y);e.zoomObj(e.tmpImg,e.origin," scale("+e.toScale+")",d.x,d.y)}})};
phoneSide.prototype.animateZoom=function(a,b,c,d){if(!0!=this.isZomming){this.isZomming=!0;a||(a=this.toScale);b||(b=0);c||(c=0);d||(d=25);var e=getTransform(this.side[0]),f={scale:this.toScale,x:e.x,y:e.y},g=this;$(f).animate({scale:a,x:b,y:c},{duration:d,easing:"easeOutSine",step:function(){g.tmpImg.css({display:"none"});g.zoomObj(g.side,g.origin," scale("+f.scale+")",b,c);g.zoomObj(g.tmpImg,g.origin," scale("+f.scale+")",b,c);g.tmpImg.css({display:"block"})},complete:function(){g.toScale=a;phoneBook.toScale=
a;phoneBook.containtWidth=Math.min(phoneBook.width*a,phoneBook.stageWidth);phoneBook.containtHeight=Math.min(phoneBook.height*a,phoneBook.stageHeight);phoneBook.book.css({width:phoneBook.containtWidth+"px",height:phoneBook.containtHeight+"px",left:(phoneBook.stageWidth-phoneBook.containtWidth)/2+"px",top:(phoneBook.stageHeight-phoneBook.containtHeight)/2+"px"});g.isZomming=false}})}};
phoneSide.prototype.onWinResize=function(a,b,c){this.toScale=1;var d=getPageWidthHeightByWidth(a,b,zoomPageWidth,zoomPageHeight);this.fitW=d.x;this.fitH=d.y;if(c)this.onResize(a,b,!0)};phoneSide.prototype.showLoading=function(){this.side.append(this.loadingImg)};phoneSide.prototype.hideLoading=function(){this.loadingImg.remove()};
phoneSide.prototype.translate=function(a,b){this.tmpImg.css({display:"none"});this.zoomObj(this.side,this.origin," scale("+this.toScale+")",a,b);this.zoomObj(this.tmpImg,this.origin," scale("+this.toScale+")",a,b);this.tmpImg.css({display:"block"})};phoneSide.prototype.isFit=function(){return this.toScale==this.fitW/this.width};
phoneSide.prototype.animateBack=function(a){var b=getTransform(this.side[0]),c={x:b.x,y:b.y,scale:this.toScale},d=this.fitW/this.width,e=this;e.tmpImg.css({display:"none"});$(c).animate({x:0,y:0,scale:d},{duration:200,step:function(){e.zoomObj(e.side,e.origin," scale("+c.scale+")",c.x,c.y);e.zoomObj(e.tmpImg,e.origin," scale("+c.scale+")",c.x,c.y)},complete:function(){e.toScale=d;e.tmpImg.css({display:"block"});a()}})};phoneSide.prototype.showPage=function(){this.side.css({display:"block"})};
phoneSide.prototype.hidePage=function(){this.side.css({display:"none"})};phoneSide.prototype.getWidth=function(){return this.width*this.toScale};phoneSide.prototype.getHeight=function(){return this.height*this.toScale};
phoneSide.prototype.initMM=function(){this.MMbg.empty();this.linkArray=[];this.youtubeArray=[];this.videoArray=[];this.audioArray=[];this.imageArray=[];this.buttonArray=[];this.flashShowArray=[];this.flashSwfArray=[];this.lineArray=[];this.arrowArray=[];this.roundArray=[];this.reArray=[];this.textArray=[];this.areaArray=[];this.calloutArray=[];this.atextArray=[];this.startextArray=[];this.aminArray=[];this.atimageArray=[];this.alimageArray=[];this.slideShowArray=[];this.efftextArray=[];this.soundArray=
[];this.bannerArray=[];this.carouselArray=[];this.dynshowArray=[];this.jumpArray=[];this.rotate3DArray=[];this.vimeoArray=[];var a=sliderJS[this.imgIndex-1];void 0!=a&&(this.slider=window.hiSliderFactory({container:this.MMbg,slide:a,initialWidth:this.width,initialHeight:this.height}),this.slider.resize(this.width,this.height),!0==this.playSliderAfterLoad&&(debug("[phone side] this.playSliderAfterLoad == true"),this.playSlider()));if(!(0>=this.imgIndex||pageEditor.length<this.imgIndex||null==pageEditor[this.imgIndex-
1][0]))for(a=0;a<pageEditor[this.imgIndex-1].length;a++){var b=pageEditor[this.imgIndex-1][a];if(void 0!=b)if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_LINK){var c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,downColor:b.downColor,downAlpha:b.downAlpha,overColor:b.overColor,overAlpha:b.overAlpha,outColor:b.outColor,outAlpha:b.outAlpha,action:b.action};this.linkArray.push(new initLink(this.MMbg,c,this.width,this.height))}else if(pageEditor[this.imgIndex-
1][a].annotype==PageEditor.AnnoType.ANNO_YOUTUBE||pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_YOUTUBE1||pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_YOUTUBE2||pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_YOUTUBE3||pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_YOUTUBE4)c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,id:b.videoId,moviePlayTriggerEvt:b.moviePlayTriggerEvt,
movieStopTriggerEvt:b.movieStopTriggerEvt},pageEditor[this.imgIndex-1][a].annotype!=PageEditor.AnnoType.ANNO_YOUTUBE&&(c.id=b.videoID),youtubeObj=new initYoutube(this.MMbg,c,this.width,this.height),this.youtubeArray.push(youtubeObj);else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_VIMEO||pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_VIMEO2)c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,id:b.videoID,moviePlayTriggerEvt:b.moviePlayTriggerEvt,
movieStopTriggerEvt:b.movieStopTriggerEvt},vimeoObj=new initVimeo(this.MMbg,c,this.width,this.height),this.vimeoArray.push(vimeoObj);else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_VIDEO)c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,src:b.url,previewSrc:b.previewUrl,moviePlayTriggerEvt:b.PlayTriggerEvt,movieStopTriggerEvt:b.StopTriggerEvt},c=new initVideo(this.MMbg,c,this.width,this.height,"round"),this.videoArray.push(c);
else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_AUDIO)c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,src:b.soundURL,soundPlayTriggerEvt:b.soundPlayTriggerEvt,soundStopTriggerEvt:b.soundStopTriggerEvt},c=new initAudio(this.MMbg,c,this.width,this.height),this.audioArray.push(c);else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_IMAGE)c=pageEditor[this.imgIndex-1][a],c={width:c.location.width,height:c.location.height,
x:c.location.x,y:c.location.y,alpha:c.alpha,src:c.url,action:c.action,mouseOver:c.mouseOverEffect},this.imageArray.push(new initImage(this.MMbg,c,this.width,this.height));else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_BUTTON)c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,src:b.url,action:b.action,buttonCaption:b.buttonCaption,captionY:b.captionY,HRate:b.HRate,Format:b.Format},this.buttonArray.push(new initButton(this.MMbg,
c,this.width,this.height));else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_SWF)c=pageEditor[this.imgIndex-1][a],c={width:c.location.width,height:c.location.height,x:c.location.x,y:c.location.y,alpha:c.alpha,src:c.swfURL,shadow:c.shadow},swfObj=new initFlashSwf(this.MMbg,c,this.width,this.height),this.flashSwfArray.push(swfObj);else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_FLASHSHOW)c=pageEditor[this.imgIndex-1][a],c={width:c.location.width,height:c.location.height,
x:c.location.x,y:c.location.y,alpha:c.alpha,photo:c.Images,repeatPlay:c.isRepeat},flashObj=new initFlashShow(this.MMbg,c,this.width,this.height),this.flashShowArray.push(flashObj);else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_LINE)c={StartX:b.lineStartPX,StartY:b.lineStartPY,EndX:b.lineEndPX,EndY:b.lineEndPY,x:b.location.x,y:b.location.y,width:b.location.width,height:b.location.height,lineAlpha:b.lineAlpha,alpha:b.alpha,lineWidth:b.lineWidth,lineType:b.lineType,dotWidth:b.dotWidth,
color:b.color,sh:b.shadow.hasDropShadow,sx:b.shadow.shadowBlurX,sy:b.shadow.shadowBlurY,se:b.shadow.shadowDistance,sr:b.shadow.shadowColor},this.lineArray.push(new initLine(this.MMbg,c,this.width,this.height,this.imgIndex+a));else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_ARROW)c={StartX:b.lineStartPX,StartY:b.lineStartPY,EndX:b.lineEndPX,EndY:b.lineEndPY,x:b.location.x,y:b.location.y,width:b.location.width,height:b.location.height,alpha:b.alpha,lineWidth:b.lineWidth,lineType:b.lineType,
dotWidth:b.dotWidth,color:b.color,sh:b.shadow.hasDropShadow,sx:b.shadow.shadowBlurX,sy:b.shadow.shadowBlurY,se:b.shadow.shadowDistance,arrowType:b.arrowType,sr:b.shadow.shadowColor},this.arrowArray.push(new initArrow(this.MMbg,c,this.width,this.height,this.imgIndex+a));else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_ROUND)c={x:b.location.x,y:b.location.y,width:b.location.width,height:b.location.height,alpha:b.alpha,fillStyle:b.fillStyle,color:b.color,ColorA:b.gradientColorA,
ColorB:b.gradientColorB,angle:b.angle,spalpha:b.spalpha,borderWidth:b.borderWidth,borderColor:b.borderColor,borderAlpha:b.borderAlpha,sh:b.shadow.hasDropShadow,sx:b.shadow.shadowBlurX,sy:b.shadow.shadowBlurY,se:b.shadow.shadowDistance,sr:b.shadow.shadowColor,action:b.action},this.roundArray.push(new initRound(this.MMbg,c,this.width,this.height,this.imgIndex+a));else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_RECTANGLE)c={x:b.location.x,y:b.location.y,width:b.location.width,
height:b.location.height,alpha:b.alpha,fillStyle:b.fillStyle,color:b.color,ColorA:b.gradientColorA,ColorB:b.gradientColorB,angle:b.angle,spalpha:b.spalpha,borderWidth:b.borderWidth,borderColor:b.borderColor,borderAlpha:b.borderAlpha,sh:b.shadow.hasDropShadow,sx:b.shadow.shadowBlurX,sy:b.shadow.shadowBlurY,se:b.shadow.shadowDistance,sr:b.shadow.shadowColor,round:parseBool(b.round),roundWidth:Math.max(parseInt(b.ellipseWidth),parseInt(b.ellipseHeight)),action:b.action},this.reArray.push(new initRe(this.MMbg,
c,this.width,this.height,this.imgIndex+a));else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_TEXT)c={x:b.location.x,y:b.location.y,width:b.location.width,height:b.location.height,alpha:b.alpha,textStr:b.textStr,lineH:b.lineHeightRation,fontName:b.formats.defaultFormat.fontName,fontSize:b.formats.defaultFormat.fontSize,color:b.formats.defaultFormat.color,tbold:b.formats.defaultFormat.bold,italic:b.formats.defaultFormat.italic,bgalpha:b.background.alpha,fillBg:b.background.fillBg,
bgcolor:b.background.color,sh:b.shadow.hasDropShadow,sx:b.shadow.shadowBlurX,sy:b.shadow.shadowBlurY,se:b.shadow.shadowDistance,sr:b.shadow.shadowColor,action:b.action},this.textArray.push(new initText(this.MMbg,c,this.width,this.height,this.imgIndex+a));else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_AREA)c={x:b.location.x,y:b.location.y,width:b.location.width,height:b.location.height,alpha:b.alpha,color:b.color,rounds:b.round,ellipseWidth:b.ellipseWidth,ellipseHeight:b.ellipseHeight,
sh:b.shadow.hasDropShadow,sx:b.shadow.shadowBlurX,sy:b.shadow.shadowBlurY,se:b.shadow.shadowDistance,sr:b.shadow.shadowColor,action:b.action},this.areaArray.push(new initArea(this.MMbg,c,this.width,this.height,this.imgIndex+a));else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_CALLOUT)c={x:b.location.x,y:b.location.y,width:b.location.width,height:b.location.height,alpha:b.alpha,textStr:b.textStr,lineH:b.lineHeightRation,pageH:b.formats.defaultFormat.pageH,fontName:b.formats.defaultFormat.fontName,
fontSize:b.formats.defaultFormat.fontSize,color:b.formats.defaultFormat.color,tbold:b.formats.defaultFormat.bold,italic:b.formats.defaultFormat.italic,bgalpha:b.background.alpha,fillBg:b.background.fillBg,bgcolor:b.background.color,direct:b.hookDirect,cx1:b.hookContr1RatioX,cy1:b.hookContr1RatioY,cx2:b.hookContr2RatioX,cy2:b.hookContr2RatioY,pointx:b.hookContrPointRatioX,pointy:b.hookContrPointRatioY,cornerRadiut:b.cornerRadiut,borderWidth:b.borderWidth,borderColor:b.borderColor,bordreAlpha:b.bordreAlpha,
sh:b.shadow.hasDropShadow,sx:b.shadow.shadowBlurX,sy:b.shadow.shadowBlurY,se:b.shadow.shadowDistance,sr:b.shadow.shadowColor,action:b.action},this.calloutArray.push(new initCallout(this.MMbg,c,this.width,this.height,this.imgIndex+a));else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_ATEXT)c={x:b.location.x,y:b.location.y,width:b.location.width,height:b.location.height,alpha:b.alpha,textStr:b.strText,fontName:b.format.font,fontSize:b.format.size,color:b.format.color,tbold:b.format.bold,
italic:b.format.italic,align:b.format.align,action:b.action,repeat:b.repeat,moveSpeed:b.moveSpeed,sh:b.shadow.hasDropShadow,sx:b.shadow.shadowBlurX,sy:b.shadow.shadowBlurY,se:b.shadow.shadowDistance,sr:b.shadow.shadowColor},this.atextArray.push(new initAText(this.MMbg,c,this.width,this.height,this.imgIndex+a));else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_STARTEXT)c={x:b.location.x,y:b.location.y,width:b.location.width,height:b.location.height,alpha:b.alpha,textStr:b.strText,
fontName:b.format.font,fontSize:b.format.size,color:b.format.color,tbold:b.format.bold,italic:b.format.italic,align:b.format.align,action:b.action,repeat:b.repeat,moveSpeed:b.moveSpeed,lineH:b.HRate,sh:b.shadow.hasDropShadow,sx:b.shadow.shadowBlurX,sy:b.shadow.shadowBlurY,se:b.shadow.shadowDistance,sr:b.shadow.shadowColor},this.startextArray.push(new initStarText(this.MMbg,c,this.width,this.height,this.imgIndex+a));else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_TEXTANIM)c=
{x:b.location.x,y:b.location.y,width:b.location.width,height:b.location.height,alpha:b.alpha,effectType:b.effectType,textStr:b.textStr,fontName:b.formats.defaultFormat.fontName,fontSize:b.formats.defaultFormat.fontSize,color:b.formats.defaultFormat.color,tbold:b.formats.defaultFormat.bold,italic:b.formats.defaultFormat.italic,action:b.action,lineH:b.HRate,sh:b.shadow.hasDropShadow,sx:b.shadow.shadowBlurX,sy:b.shadow.shadowBlurY,se:b.shadow.shadowDistance,sr:b.shadow.shadowColor},this.aminArray.push(new initAminText(this.MMbg,
c,this.width,this.height,this.imgIndex+a));else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_ATIMAGE)c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,src:b.url,action:b.action},atimageObj=new initPngImage(this.MMbg,c,this.width,this.height),this.atimageArray.push(atimageObj);else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_EFFECTTEXT)c={x:b.location.x,y:b.location.y,width:b.location.width,height:b.location.height,
alpha:b.alpha,textStr:b.htmlText,action:b.action,moveSpeed:b.effectStyle,lineH:b.HRate,sh:b.shadow.hasDropShadow,sx:b.shadow.shadowBlurX,sy:b.shadow.shadowBlurY,se:b.shadow.shadowDistance,sr:b.shadow.shadowColor},this.efftextArray.push(new initEffText(this.MMbg,c,this.width,this.height,this.imgIndex+a));else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_ADVANCEDSOUND)c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,src:b.soundList.sound,
skinType:b.skinType,soundPlay:b.soundPlayTriggerEvt},this.soundArray.push(new initSound(this.MMbg,c,this.width,this.height,this.imgIndex+a));else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_CAROUSEL)c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,images:b.Images},this.carouselArray.push(new initCarousel(this.MMbg,c,this.width,this.height,this.imgIndex+a));else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_DYNSHOW)c=
{width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,images:b.Images,borderWidth:b.borderWidth},this.dynshowArray.push(new initDynamicShow(this.MMbg,c,this.width,this.height,this.imgIndex+a));else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_BANNER)c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,action:b.action,banners:b.banners},this.bannerArray.push(new initBanner(this.MMbg,c,this.width,
this.height,this.imgIndex+a));else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_FLIPJUMP)c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,images:b.Images,addBackground:parseBool(b.addBack),addBorder:parseBool(b.addBorder),backgroundColor:b.backgroundColor,backgroundAlpha:b.backgroundColorAlpha,borderColor:b.backgroundBorderColor},this.jumpArray.push(new initFlipJump(this.MMbg,c,this.width,this.height,this.imgIndex+a));else if(pageEditor[this.imgIndex-
1][a].annotype==PageEditor.AnnoType.ANNO_PLUGIN&&pageEditor[this.imgIndex-1][a].className==PLUGIN_ROTATE3D)c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,images:b.componentData.Images,addBackground:parseBool(b.componentData.addBack),addBorder:parseBool(b.componentData.addBorder),backgroundColor:b.componentData.backColor,backgroundAlpha:b.componentData.backAlpha,borderColor:b.componentData.borderColor,sh:parseBool(b.shadow.hasDropShadow),sx:b.shadow.shadowBlurX,
sy:b.shadow.shadowBlurY,se:b.shadow.shadowDistance,sr:b.shadow.shadowColor},this.rotate3DArray.push(new initRotate3D(this.MMbg,c,this.width,this.height,this.imgIndex+a));else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_VIDEO1)c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,src:b.videoURL,previewSrc:b.previewUrl,moviePlayTriggerEvt:b.PlayTriggerEvt,movieStopTriggerEvt:b.StopTriggerEvt},c=new initVideo(this.MMbg,c,this.width,this.height,
"smallblack"),this.videoArray.push(c);else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_VIDEO2)c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,src:b.videoURL,previewSrc:b.previewUrl,moviePlayTriggerEvt:b.PlayTriggerEvt,movieStopTriggerEvt:b.StopTriggerEvt},c=new initVideo(this.MMbg,c,this.width,this.height),this.videoArray.push(c);else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_PLUGIN&&pageEditor[this.imgIndex-
1][a].className==PLUGIN_VIDEO1)c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,src:b.componentData.videoURL,previewSrc:b.previewUrl,moviePlayTriggerEvt:b.PlayTriggerEvt,movieStopTriggerEvt:b.StopTriggerEvt},c=new initVideo(this.MMbg,c,this.width,this.height,"classic"),this.videoArray.push(c);else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_PLUGIN&&pageEditor[this.imgIndex-1][a].className==PLUGIN_VIDEO2)c={width:b.location.width,
height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,src:b.componentData.videoURL,previewSrc:b.previewUrl,moviePlayTriggerEvt:b.PlayTriggerEvt,movieStopTriggerEvt:b.StopTriggerEvt},c=new initVideo(this.MMbg,c,this.width,this.height),this.videoArray.push(c);else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_AUDIO1)c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,src:b.soundList=={}?"":b.soundList.sound,key:"path",
soundPlayTriggerEvt:b.soundPlayTriggerEvt,soundStopTriggerEvt:b.soundStopTriggerEvt},c=new initAudio(this.MMbg,c,this.width,this.height,"advanced"),this.audioArray.push(c);else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_AUDIO2)c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,src:b.data=={}?"":b.data.item,key:"fname",soundPlayTriggerEvt:b.soundPlayTriggerEvt,soundStopTriggerEvt:b.soundStopTriggerEvt},c=new initAudio(this.MMbg,
c,this.width,this.height,"wave"),this.audioArray.push(c);else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_PLUGIN&&pageEditor[this.imgIndex-1][a].className in audioThemeNames){var c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,src:!b.componentData||!b||b.componentData.songs=={}||void 0==b.componentData.songs?{}:b.componentData.songs.song,key:"url",soundPlayTriggerEvt:b.soundPlayTriggerEvt,soundStopTriggerEvt:b.soundStopTriggerEvt},
b=void 0,d=pageEditor[this.imgIndex-1][a].className;"GlassAudioPlayer"==d&&(b="glass");"SimpleAudioPlayer"==d&&(b="simple");"StandardAudioPlayer"==d&&(b="enjoy");"StandardAudioPlayer02"==d&&(b="decent");"StandardAudioPlayer03"==d&&(b="tree");"StandardAudioPlayer04"==d&&(b="christmas");"StandardAudioPlayer05"==d&&(b="turnonoff");"StandardAudioPlayer06"==d&&(b="fade");c=new initAudio(this.MMbg,c,this.width,this.height,b);this.audioArray.push(c)}else pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_ALPHATRANSITIONBANNER?
(c=pageEditor[this.imgIndex-1][a],c={width:c.location.width,height:c.location.height,x:c.location.x,y:c.location.y,alpha:c.alpha,src:c.url,action:c.action,images:c.Images.node},this.alimageArray.push(new initAlphaTransitionBanner(this.MMbg,c,this.width,this.height))):pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_EMBEDDEDSLIDESHOW?(c=pageEditor[this.imgIndex-1][a],c={width:c.location.width,height:c.location.height,x:c.location.x,y:c.location.y,alpha:c.alpha,images:c.Images.Image},
this.slideShowArray.push(new initEmbeddedSlideshow(this.MMbg,c,this.width,this.height))):pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_PRINT&&(c=pageEditor[this.imgIndex-1][a],c={width:c.location.width,height:c.location.height,x:c.location.x,y:c.location.y,alpha:c.alpha,overAlpha:c.overAlpha,borderColor:c.borderColor,overColor:c.overColor,borderWidth:c.barderWidth,printTitle:c.printTitle,printDesc:c.printDesc},this.areaArray.push(new initPrint(this.MMbg,c,this.width,this.height,
this.imgIndex)))}};phoneSide.prototype.playSlider=function(){null!=this.slider?(this.slider.replay(),this.playSliderAfterLoad=!1):this.playSliderAfterLoad=!0};phoneSide.prototype.resetSlider=function(){null!=this.slider&&this.slider.reset();this.playSliderAfterLoad=!1};
phoneSide.prototype.MMResize=function(a,b){for(var c=0;c<this.linkArray.length;c++)this.linkArray[c].onResize(a,b);for(c=0;c<this.youtubeArray.length;c++)this.youtubeArray[c].onResize(a,b);for(c=0;c<this.videoArray.length;c++)this.videoArray[c].onResize(a,b);for(c=0;c<this.audioArray.length;c++)this.audioArray[c].onResize(a,b);for(c=0;c<this.imageArray.length;c++)this.imageArray[c].onResize(a,b);for(c=0;c<this.buttonArray.length;c++)this.buttonArray[c].onResize(a,b);for(c=0;c<this.flashShowArray.length;c++)this.flashShowArray[c].onResize(a,
b);for(c=0;c<this.flashSwfArray.length;c++)this.flashSwfArray[c].onResize(a,b);for(c=0;c<this.lineArray.length;c++)this.lineArray[c].onResize(a,b);for(c=0;c<this.arrowArray.length;c++)this.arrowArray[c].onResize(a,b);for(c=0;c<this.roundArray.length;c++)this.roundArray[c].onResize(a,b);for(c=0;c<this.reArray.length;c++)this.reArray[c].onResize(a,b);for(c=0;c<this.textArray.length;c++)this.textArray[c].onResize(a,b);for(c=0;c<this.areaArray.length;c++)this.areaArray[c].onResize(a,b);for(c=0;c<this.calloutArray.length;c++)this.calloutArray[c].onResize(a,
b);for(c=0;c<this.atextArray.length;c++)this.atextArray[c].onResize(a,b);for(c=0;c<this.startextArray.length;c++)this.startextArray[c].onResize(a,b);for(c=0;c<this.aminArray.length;c++)this.aminArray[c].onResize(a,b);for(c=0;c<this.atimageArray.length;c++)this.atimageArray[c].onResize(a,b);for(c=0;c<this.efftextArray.length;c++)this.efftextArray[c].onResize(a,b);for(c=0;c<this.soundArray.length;c++)this.soundArray[c].onResize(a,b);for(c=0;c<this.bannerArray.length;c++)this.bannerArray[c].onResize(a,
b);for(c=0;c<this.carouselArray.length;c++)this.carouselArray[c].onResize(a,b);for(c=0;c<this.dynshowArray.length;c++)this.dynshowArray[c].onResize(a,b);for(c=0;c<this.jumpArray.length;c++)this.jumpArray[c].onResize(a,b);for(c=0;c<this.rotate3DArray.length;c++)this.rotate3DArray[c].onResize(a,b);for(c=0;c<this.vimeoArray.length;c++)this.vimeoArray[c].onResize(a,b);for(c=0;c<this.slideShowArray.length;c++)this.slideShowArray[c].onResize(a,b);for(c=0;c<this.alimageArray.length;c++)this.alimageArray[c].onResize(a,
b);null!=this.slider&&this.slider.resize(a,b)};phoneSide.prototype.highlightSearch=function(a){highlightSearchFun(this.searchHighlight,a)};phoneSide.prototype.clearHighlight=function(){clearHighlightFun(this.searchHighlight)};
function phonePage(a){this.side=$("<div></div>");this.leftPage=$("<div></div>");this.rightPage=$("<div></div>");this.leftSide=new phoneSide(this.leftPage);this.rightSide=new phoneSide(this.rightPage);this.width=zoomPageWidth;this.height=zoomPageHeight;this.fitH=this.fitW=0;a.append(this.side);this.side.append(this.leftPage);this.side.append(this.rightPage);this.imgIndex=-1;this.leftSide.imgIndex=-1;this.rightSide.imgIndex=-1;this.toScale=1;this.leftSide.toScale=1;this.rightSide.toScale=1;this.origin=
"0% 0%";this.translateY=this.translateX=this.y=this.x=0;this.toolbarShow=this.isZomming=!1;this.sideTop=0;this.side.css({width:this.width+"px",height:this.height+"px",top:this.sideTop+"px",position:"absolute","border-width":"0px"});this.leftPage.css({width:this.width/2+"px",height:this.height+"px",top:this.sideTop+"px",position:"absolute"});this.rightPage.css({width:this.width/2+"px",height:this.height+"px",top:this.sideTop+"px",left:this.width/2+"px",position:"absolute"});this.initEvent();this.onWinResize(windowWidth-
leftMargin-rightMargin,windowHeight-topMargin-bottomMargin-40,!0);this.father=a}phonePage.prototype.hideMM=function(){this.leftSide.hideMM();this.rightSide.hideMM()};phonePage.prototype.showMM=function(){this.leftSide.showMM();this.rightSide.showMM()};phonePage.prototype.playSlider=function(){this.leftSide.playSlider();this.rightSide.playSlider()};phonePage.prototype.resetSlider=function(){this.leftSide.resetSlider();this.rightSide.resetSlider()};
phonePage.prototype.setCSS=function(a){this.leftSide.setCSS(a);this.rightSide.setCSS(a)};phonePage.prototype.onResize2=function(a,b){this.leftPage.css({width:a/2+"px",height:b+"px"});this.rightPage.css({width:a/2+"px",height:b+"px",left:a/2+"px"});this.toScale=a/this.width;var c=getTransform(this.side[0]);this.zoomObj(this.side,this.origin," scale("+this.toScale+")",c.x,c.y)};
phonePage.prototype.onResize=function(a,b,c){this.toScale=1;this.leftSide.toScale=1;this.rightSide.toScale=1;a=getPageWidthHeightByWidth(a/2,b,zoomPageWidth,zoomPageHeight);this.width=2*a.x*this.toScale;this.height=a.y*this.toScale;this.side.css({width:this.width+"px",height:this.height+"px"});this.leftPage.css({width:this.width/2+"px",height:this.height+"px"});this.rightPage.css({width:this.width/2+"px",height:this.height+"px",left:this.width/2+"px"});this.leftSide.onResize(this.width/2,this.height,
c);this.rightSide.onResize(this.width/2,this.height,c)};phonePage.prototype.getSide=function(){return this.side};phonePage.prototype.fillContent=function(a){a=2*parseInt(a/2);parseBool(bookConfig.RightToLeft)?(this.leftSide.fillContent(a+1),this.rightSide.fillContent(a)):(this.leftSide.fillContent(a),this.rightSide.fillContent(a+1))};
phonePage.prototype.fillTemp=function(a){a=2*parseInt(a/2);parseBool(bookConfig.RightToLeft)?(this.leftSide.fillTemp(a+1),this.rightSide.fillTemp(a)):(this.leftSide.fillTemp(a),this.rightSide.fillTemp(a+1))};phonePage.prototype.changeContent=function(a){a=2*parseInt(a/2);parseBool(bookConfig.RightToLeft)?(this.leftSide.changeContent(a+1),this.rightSide.changeContent(a)):(this.leftSide.changeContent(a),this.rightSide.changeContent(a+1))};
phonePage.prototype.setPosition=function(a,b){this.side.css({left:a+"px",top:b+"px"})};phonePage.prototype.setChildIndex=function(a){this.side.css({"z-index":a})};phonePage.prototype.setVisible=function(a){this.side.css({display:a?"block":"none"})};phonePage.prototype.resetSize=function(){};
phonePage.prototype.zoom=function(a,b){if(!0==this.isZomming)return!1;var c=phoneBook.minZoomWidth,d=phoneBook.largeZoomWidth,e=this.side.width()*this.toScale;this.side.height();var f=this.toScale+a,g=this.side.width()*f;if(1>f){if(e<=c)return;g<c&&(f=c/this.side.width())}1<f&&g>d&&(f=d/this.side.width());g=this.side.width()*f;this.side.height();c=(e-g)/2+this.translateX;0==b&&(c=0);1==b&&(c=g);-1==b&&(c=-g);this.animateZoom(f,c,0,300)};
phonePage.prototype.zoomToScale=function(a,b){if(!0==this.isZomming)return!1;var c=phoneBook.minZoomWidth,d=phoneBook.largeZoomWidth,e=this.side.width()*this.toScale;this.side.height();var f=this.toScale+a,g=this.side.width()*f;if(1>f){if(e<=c)return;g<c&&(f=c/this.side.width())}1<f&&g>d&&(f=d/this.side.width());g=this.side.width()*f;this.side.height();c=(e-g)/2+this.translateX;0==b&&(c=0);1==b&&(c=g);-1==b&&(c=-g);!0!=this.isZomming&&(this.isZomming=!0,f||(f=this.toScale),c||(c=0),getTransform(this.side[0]),
this.zoomObj(this.side,this.origin," scale("+f+")",c,0),this.toScale=f,phoneBook.toScale=f,phoneBook.containtWidth=Math.min(phoneBook.width*f,phoneBook.stageWidth),phoneBook.containtHeight=Math.min(phoneBook.height*f,phoneBook.stageHeight),phoneBook.book.css({width:phoneBook.containtWidth+"px",height:phoneBook.containtHeight+"px",left:(phoneBook.stageWidth-phoneBook.containtWidth)/2+"px",top:(phoneBook.stageHeight-phoneBook.containtHeight)/2+"px"}),this.isZomming=!1)};
phonePage.prototype.noZoom=function(){this.toScale=this.fitW/this.width;this.zoomObj(this.side,"0% 0%","scale("+this.toScale+")",0,0)};phonePage.prototype.forceReset=function(a){this.width=this.fitW;this.height=this.fitH;this.toScale=1;void 0==a&&(a=getTransform(this.side[0]));this.forceResize(a)};phonePage.prototype.forceMax=function(){var a=(this.width*this.toScale-zoomPageWidth)/2;this.width=zoomPageWidth;this.height=zoomPageHeight;var b=getTransform(this.side[0]);b.x+=a;this.forceResize(b)};
phonePage.prototype.animateMax=function(){this.animateZoom(zoomPageWidth/this.width,(this.width-zoomPageWidth)/2,0,300)};phonePage.prototype.animateFit=function(){this.animateZoom(this.fitW/this.width,0,0,300)};
phonePage.prototype.forceResize=function(a){this.side.css({width:this.width+"px",height:this.height+"px"});this.leftSide.forceResize(Point(0,0));this.rightSide.forceResize(Point(0,0));this.toScale=1;this.zoomObj(this.side,"0% 0%","scale("+this.toScale+")",a.x,a.y);this.translateX=a.x;this.translateY=a.y};phonePage.prototype.getScaleFromFit=function(){return this.width*this.toScale/this.fitW};phonePage.prototype.getCenterTransform=function(){return Point((this.fitW-this.width*this.toScale)/2,0)};
phonePage.prototype.zoomToMax=function(){var a=zoomPageWidth/this.width;this.animateZoom(a,(this.width*this.toScale-this.width*a)/2+this.translateX,0,200)};phonePage.prototype.zoomToFit=function(){this.animateZoom(this.getScaleFromFit(),0,0,200)};
phonePage.prototype.zoomObj=function(a,b,c,d,e){d||(d=0);e||(e=0);d=translate(d,e);a.css({"-webkit-transform-origin":b,"-moz-transform-origin":b,"-ms-transform-origin":b,"-o-transform-origin":b,"-webkit-transform":d+c,"-moz-transform":d+c,"-ms-transform":d+c,"-o-transform":d+c})};phonePage.prototype.setTranslate=function(a,b,c){b=translate(b,c);a.css({"-webkit-transform":b,"-moz-transform":b,"-o-transform":b,"-ms-transform":b})};phonePage.prototype.setXY=function(a,b){this.x=a;this.y=b};
phonePage.prototype.animateTranslate=function(a,b,c){a||(a=0);b||(b=0);c||(c=25);var d=getTransform(this.side[0]),e=this;$(d).animate({x:a,y:b},{duration:c,easing:"easeOutSine",complete:function(){e.zoomObj(e.side,e.origin," scale("+e.toScale+")",d.x,d.y)}})};
phonePage.prototype.animateZoom=function(a,b,c,d){if(!0!=this.isZomming){this.isZomming=!0;a||(a=this.toScale);b||(b=0);c||(c=0);d||(d=25);var e=getTransform(this.side[0]),f={scale:this.toScale,x:e.x,y:e.y},g=this;$(f).animate({scale:a,x:b,y:c},{duration:d,easing:"easeOutSine",step:function(){g.zoomObj(g.side,g.origin," scale("+f.scale+")",b,c)},complete:function(){g.toScale=a;phoneBook.toScale=a;phoneBook.containtWidth=Math.min(phoneBook.width*a,phoneBook.stageWidth);phoneBook.containtHeight=Math.min(phoneBook.height*
a,phoneBook.stageHeight);phoneBook.book.css({width:phoneBook.containtWidth+"px",height:phoneBook.containtHeight+"px",left:(phoneBook.stageWidth-phoneBook.containtWidth)/2+"px",top:(phoneBook.stageHeight-phoneBook.containtHeight)/2+"px"});g.isZomming=false}})}};phonePage.prototype.onWinResize=function(a,b,c){this.toScale=1;var d=getPageWidthHeightByWidth(a/2,b,zoomPageWidth,zoomPageHeight);this.fitW=2*d.x;this.fitH=d.y;if(c)this.onResize(a,b,!0)};phonePage.prototype.showLoading=function(){this.side.append(this.loadingImg)};
phonePage.prototype.hideLoading=function(){this.loadingImg.remove()};phonePage.prototype.translate=function(a,b){this.zoomObj(this.side,this.origin," scale("+this.toScale+")",a,b)};phonePage.prototype.isFit=function(){return this.toScale==this.fitW/this.width};
phonePage.prototype.animateBack=function(a){var b=getTransform(this.side[0]),c={x:b.x,y:b.y,scale:this.toScale},d=this.fitW/this.width,e=this;e.tmpImg.css({display:"none"});$(c).animate({x:0,y:0,scale:d},{duration:200,step:function(){e.zoomObj(e.side,e.origin," scale("+c.scale+")",c.x,c.y)},complete:function(){e.toScale=d;a()}})};phonePage.prototype.showPage=function(){this.side.css({display:"block"})};phonePage.prototype.hidePage=function(){this.side.css({display:"none"})};
phonePage.prototype.getWidth=function(){return this.width*this.toScale};phonePage.prototype.getHeight=function(){return this.height*this.toScale};
phonePage.prototype.initEvent=function(){var a=this,b=Point(0,0),c=Point(0,0),d=Point(0,0),e=!1,f=!1,g=null,h=!1,j,k=0,m=0,l=!1;this.side.bind(_event._down,function(k){if(bookType==BookType.phone_book){if(!0==a.isZomming||!0==phoneBook.isFlipping)return!1;j=a.toScale;l=!1;var k=isTouch?k.originalEvent.touches:[k],m=getTransform(a.side[0]);a.translateX=m.x;a.translateY=m.y;phoneBook.initTranslate();1==k.length?(e=!0,f=!1,b=Point(k[0].pageX,k[0].pageY),g=Point(a.side.position().left,a.side.position().top)):
2==k.length&&(e=!1,f=!0,b=Point(k[0].pageX,k[0].pageY),d=Point(k[1].pageX,k[1].pageY),c=Point((k[0].pageX+k[1].pageX)/2,(k[0].pageY+k[1].pageY)/2),g=Point(a.side.offset().left,a.side.offset().top));h=!1;stopEvent(k[0])}});3==browserType&&(_event._mousewheel="DOMMouseScroll");isIE()&&(_event._mousewheel="mousewheel");this.side.bind(_event._mousewheel,function(b){if(bookType!=BookType.phone_book||phoneBook.isFlipping==true)return false;b=b.originalEvent;b=Math.max(-1,Math.min(1,b.wheelDelta||-b.detail));
getTransform(a.side[0]);var c=-0.25;b>0&&(c=0.25);phoneBook.zoom(c);return false});this.side.bind(_event._move,function(n){if(bookType==BookType.phone_book){n=isTouch?n.originalEvent.touches:[n];if(a.isZomming==true||phoneBook.isFlipping==true||l==true)return false;e?a.side.css({cursor:"move"}):a.side.css({cursor:""});if(e){var o=n[0].pageX-b.x+a.translateX,p=n[0].pageY-b.y+a.translateY;(new Date).getTime();p=Math.max(phoneBook.getHeight()-a.getHeight(),p);p=Math.min(p,0);if(phoneBook.getWidth()+
5<a.getWidth()){o=Math.max(phoneBook.getWidth()-a.getWidth(),o);o=Math.min(o,0);a.zoomObj(a.side,a.origin," scale("+a.toScale+")",o,p);k=o;m=p;a.zoomToMove=true;a.gotoNextPage=false;a.gotoPrePage=false}else{a.zoomToMove=false;phoneBook.translateMove(n[0].pageX-b.x,p);if(b.x-n[0].pageX>windowWidth/8){a.gotoNextPage=true;a.gotoPrePage=false}else if(b.x-n[0].pageX<=-windowWidth/8){a.gotoNextPage=false;a.gotoPrePage=true}else{a.gotoNextPage=false;a.gotoPrePage=false}}k=o;m=p;h=false;stopEvent(n[0])}else if(f){var p=
Point(n[0].pageX,n[0].pageY),q=Point(n[1].pageX,n[1].pageY),o=Math.sqrt(Math.pow(b.x-d.x,2)+Math.pow(b.y-d.y,2)),p=Math.sqrt(Math.pow(p.x-q.x,2)+Math.pow(p.y-q.y,2));scale=Math.max(p/o*j,0.5);o=a.side.width()*scale;scale<1&&o<phoneBook.minZoomWidth&&(scale=phoneBook.minZoomWidth/a.side.width());scale>1&&o>phoneBook.largeZoomWidth&&(scale=phoneBook.largeZoomWidth/a.side.width());phoneBook.showPage.toScale=scale;p=(c.x-g.x)/j;o=(c.y-g.y)/j;a.side.width();a.side.height();p=(j-a.toScale)*a.side.width()*
(p/a.side.width());q=(j-a.toScale)*a.side.height()*(o/a.side.height());o=a.translateX+p;p=a.translateY+q;phoneBook.toScale=scale;phoneBook.containtWidth=Math.min(phoneBook.width*scale,phoneBook.stageWidth);phoneBook.containtHeight=Math.min(phoneBook.height*scale,phoneBook.stageHeight);p=Math.max(phoneBook.getHeight()-a.side.height()*scale,p);p=Math.min(p,0);o=Math.max(phoneBook.getWidth()-a.side.width()*scale,o);o=Math.min(o,0);phoneBook.showPage.zoomObj(phoneBook.showPage.side,phoneBook.showPage.origin,
" scale("+a.toScale+")",o,p);phoneBook.book.css({width:phoneBook.containtWidth+"px",height:phoneBook.containtHeight+"px",left:(phoneBook.stageWidth-phoneBook.containtWidth)/2+"px",top:(phoneBook.stageHeight-phoneBook.containtHeight)/2+"px"});h=true;a.isZomming==true;stopEvent(n[0])}}});this.side.bind(_event._end,function(){if(bookType==BookType.phone_book){if(a.isZomming==true||phoneBook.isFlipping==true||l==true)return false;a.side.css({cursor:""});a.translateX=k;var b=m,b=Math.max(phoneBook.getHeight()-
a.getHeight(),b),b=Math.min(b,0);a.translateY=b;try{a.gotoNextPage==true?phoneBook.gotoPage(parseInt(phoneBook.currentIndex)+2):a.gotoPrePage==true?phoneBook.gotoPage(parseInt(phoneBook.currentIndex)-2):a.zoomToMove==false&&h==false&&phoneBook.translateToOrigin(a.translateY);a.gotoNextPage=false;a.gotoPrePage=false;l=true}catch(c){}h=f=e=false}});this.side.bind(_event._leave,function(b){if(bookType==BookType.phone_book){if(a.isZomming==true||phoneBook.isFlipping==true||l==true)return false;try{a.gotoNextPage==
true?phoneBook.gotoPage(parseInt(phoneBook.currentIndex)+2):a.gotoPrePage==true?phoneBook.gotoPage(parseInt(phoneBook.currentIndex)-2):a.zoomToMove==false&&h==false&&phoneBook.translateToOrigin(a.translateY);a.gotoNextPage=false;a.gotoPrePage=false;l=true}catch(c){}stopEvent(b[0])}});this.side.hammer().on("doubletap",function(){if(phoneBook.isFlipping==true||this.isZomming==true||bookType!=BookType.phone_book)return false})};phonePage.prototype.initMM=function(){this.leftSide.initMM();this.rightSide.initMM()};
phonePage.prototype.MMResize=function(a,b){this.leftSide.MMResize(a,b);this.rightSide.MMResize(a,b)};phonePage.prototype.highlightSearch=function(a){this.leftSide.highlightSearch(a);this.rightSide.highlightSearch(a)};phonePage.prototype.clearHighlight=function(){this.leftSide.clearHighlight();this.rightSide.clearHighlight()};function initSinglePhoneBook(a){this.bookContainer=$("<div style='left:0px;right:0px;top:0px;bottom:0px;position:absolute;display:none;'></div>");this.book=$("<div></div>");this.bookPage=$("<div></div>");this.prePage=new singlePhoneSide(this.bookPage);this.nextPage=new singlePhoneSide(this.bookPage);this.showPage=new singlePhoneSide(this.bookPage);this.preButton=$("<div></div>");this.nextButton=$("<div></div>");this.firstButton=$("<div></div>");this.lastButton=$("<div></div>");this.width=windowWidth;
this.height=windowHeight;this.prePage.setChildIndex(1);this.showPage.setChildIndex(3);this.nextPage.setChildIndex(2);this.diffPageCount=0;this.currentIndex=1;this.showingPage=this.flipPage=null;this.isFlipping=!1;this.minZoomWidth=windowWidth;this.largeScale=Math.max(1,2.5*zoomPageWidth/windowWidth);this.largeZoomWidth=windowWidth*this.largeScale;a.append(this.bookContainer);this.bookContainer.append(this.book);this.bookContainer.append(this.preButton);this.bookContainer.append(this.nextButton);this.bookContainer.append(this.firstButton);
this.bookContainer.append(this.lastButton);this.preImg=$('<img src="'+uiBaseURL+'slide_leftButton.png"></img>');this.nextImg=$('<img src="'+uiBaseURL+'slide_rightButton.png"></img>');this.firstImg=$('<img src="'+uiBaseURL+'slide_firstButton.png"></img>');this.lastImg=$('<img src="'+uiBaseURL+'slide_lastButton.png"></img>');this.preButton.append(this.preImg);this.nextButton.append(this.nextImg);this.firstButton.append(this.firstImg);this.lastButton.append(this.lastImg);this.preButton.css({display:"none"});
this.nextButton.css({display:"none"});this.firstButton.css({display:"none"});this.lastButton.css({display:"none"});this.book.append(this.bookPage);this.book.css({width:this.width+"px",height:this.height+"px",position:"absolute",overflow:"hidden","z-index":"9"});this.preButton.css({width:"30px",height:"59px",left:"0px",top:(windowHeight-90)/2+"px",background:"#888888","z-index":"10","border-bottom":"1px solid #000000","border-radius":"5px 5px 0px 0px",position:"absolute",opacity:"0.5"});this.nextButton.css({width:"30px",
height:"59px",left:windowWidth-30+"px",top:(windowHeight-90)/2+"px",background:"#888888","z-index":"10","border-bottom":"1px solid #000000","border-radius":"5px 5px 0px 0px",position:"absolute",opacity:"0.5"});this.firstButton.css({width:"30px",height:"30px",left:"0px",top:(windowHeight-90)/2+60+"px",background:"#888888","z-index":"10","border-top":"1px solid #ffffff","border-radius":"0px 0px 5px 5px",position:"absolute",opacity:"0.5"});this.lastButton.css({width:"30px",height:"30px",left:windowWidth-
30+"px",top:(windowHeight-90)/2+60+"px",background:"#888888","border-top":"1px solid #ffffff","z-index":"10","border-radius":"0px 0px 5px 5px",position:"absolute",opacity:"0.5"});this.firstImg.css({left:"7px",top:"7px",position:"absolute"});this.lastImg.css({left:"7px",top:"7px",position:"absolute"});this.preImg.css({left:"7px",top:"22px",position:"absolute"});this.nextImg.css({left:"7px",top:"22px",position:"absolute"});this.fillNear(1);this.pageIndexLabel=new label("1/"+totalPageCount,this.bookContainer);
this.pageIndexLabel.setLabelPosition(10,10,["left","bottom"]);this.pageIndexLabel.setCSS({"padding-left":"5px","padding-right":"5px",height:"25px","line-height":"25px",vertical:"middle","text-align":"center","border-radius":"3px","z-index":"10",background:"#333333"});this.pageIndexLabel.setFont(10,"#edaa1d");this.toScale=1;this.initEvent();void 0!=leftRightButton&&null!=leftRightButton&&leftRightButton.setShow(!1);void 0!=leftRightButton&&null!=leftRightButton&&leftRightButton.setShow(!1)}
initSinglePhoneBook.prototype.setShow=function(a){this.pageIndexLabel.setCSS({display:a?"block":"none"});this.preButton.css({display:!a?"block":"none"});this.nextButton.css({display:!a?"block":"none"});this.firstButton.css({display:!a?"block":"none"});this.lastButton.css({display:!a?"block":"none"})};
initSinglePhoneBook.prototype.onResize=function(){this.toScale=1;this.stageWidth=windowWidth;this.stageHeight=windowHeight;var a=getPageWidthHeightByWidth(this.stageWidth,this.stageHeight,zoomPageWidth,zoomPageHeight);this.width=a.x;this.height=a.y;this.minZoomWidth=a.x;this.minZoomHeight=a.y;this.largeZoomWidth=this.width*this.largeScale;this.largeZoomHeight=this.height*this.largeScale;this.containtWidth=Math.min(this.width*this.toScale,this.stageWidth);this.containtHeight=Math.min(this.height*this.toScale,
this.stageHeight);this.book.css({width:this.containtWidth+"px",height:this.containtHeight+"px",left:(this.stageWidth-this.containtWidth)/2+"px",top:(this.stageHeight-this.containtHeight)/2+"px"});this.preButton.css({left:"0px",top:(windowHeight-90)/2+"px"});this.nextButton.css({left:windowWidth-30+"px",top:(windowHeight-90)/2+"px"});this.firstButton.css({left:"0px",top:(windowHeight-90)/2+60+"px"});this.lastButton.css({left:windowWidth-30+"px",top:(windowHeight-90)/2+60+"px"});this.prePage.onWinResize(this.containtWidth,
this.containtHeight,!0);this.showPage.onWinResize(this.containtWidth,this.containtHeight,!0);this.nextPage.onWinResize(this.containtWidth,this.containtHeight,!0);this.prePage.translate(-this.prePage.getWidth(),0);this.nextPage.translate(this.containtWidth,0)};initSinglePhoneBook.prototype.setTranslate=function(a,b,c){b=translate(b,c);a.css({"-webkit-transform":b,"-moz-transform":b,"-o-transform":b,"-ms-transform":b})};
initSinglePhoneBook.prototype.gotoPage=function(a){var b=this;this.prePage.clearHighlight();this.nextPage.clearHighlight();if(this.currentIndex==a||1>a||a>originTotalPageCount||this.isFlipping){var c=1>a?"This is the first page":"This is the last page";if(1>a||a>originTotalPageCount)b.translateToOrigin(0),_tipsBox.setCaption(c),_tipsBox.showTipsBox()}else{this.isFlipping=!0;this.diffPageCount=a-this.currentIndex;var d=0,e=this.showPage,f=void 0,b=this,c=Point(0,e.getWidth());centerP=Point(0,0);this.currentIndex>
a?(f=this.prePage,d=c.y):(f=this.nextPage,d=-c.y);tragetToLeft=centerP.x;f.fillTemp(a);(function(){var c=getTransform(e.side[0]),h=getTransform(f.side[0]);f.forceReset();var j=30,k=bookConfig.flippingTime*1E3;k!=void 0&&k>0&&(j=2);var m=0,l=window.setInterval(function(){var k=Point(0,0),o=Point(0,0);k.x=$.easing.swing(null,m,c.x,d-c.x,j);o.x=$.easing.swing(null,m,h.x,tragetToLeft-h.x,j);m++;e.translate(k.x,k.y);f.translate(o.x,o.y);if(m>j){window.clearInterval(l);window.setTimeout(function(){b.showPage.noZoom();
auto_player.resetTimer();b.changePage();b.endFlip(a);b.isFlipping=false},20)}},20)})()}};initSinglePhoneBook.prototype.changePage=function(){var a=null;0<this.diffPageCount?(a=this.showPage,this.showPage=this.nextPage,this.nextPage=this.prePage):(a=this.nextPage,this.nextPage=this.showPage,this.showPage=this.prePage);this.prePage=a};initSinglePhoneBook.prototype.addSearchHighlight=function(){this.showPage.highlightSearch(this.currentIndex)};initSinglePhoneBook.prototype.clearSearchHighlight=function(){this.showPage.clearHighlight()};
initSinglePhoneBook.prototype.endFlip=function(a){this.currentIndex=a;this.fillNear(a);setCurrentIndexTextField(this.currentIndex,!1);window.location.hash="#p="+this.currentIndex;sendvisitinfo(1,this.currentIndex);thumbnail.clearHighLight();thumbnail.setHighLight(this.currentIndex);this.prePage.translate(-this.prePage.getWidth(),0);this.nextPage.translate(this.containtWidth,0);this.pageIndexLabel.setCaption(this.currentIndex+"/"+totalPageCount);this.addSearchHighlight()};
initSinglePhoneBook.prototype.setVisible=function(a){this.bookContainer.css({display:a?"block":"none"})};initSinglePhoneBook.prototype.setPosition=function(a,b){this.book.css({left:a+"px",top:b+"px"})};initSinglePhoneBook.prototype.fillNear=function(a){1<=a&&this.prePage.fillContent(a-1);this.showPage.changeContent(a);a<=originTotalPageCount&&this.nextPage.fillContent(a+1);this.prePage.resetSlider();this.showPage.playSlider();this.nextPage.resetSlider()};
initSinglePhoneBook.prototype.initEvent=function(){var a=this;Point(0,0);this.preButton.bind(_event._end,function(){a.gotoPage(a.currentIndex-1)});this.nextButton.bind(_event._end,function(){a.gotoPage(a.currentIndex+1)});this.preButton.bind(_event._enter,function(){a.preButton.css({background:"#000000"})});this.nextButton.bind(_event._enter,function(){a.nextButton.css({background:"#000000"})});this.preButton.bind(_event._leave,function(){a.preButton.css({background:"#888888"})});this.nextButton.bind(_event._leave,
function(){a.nextButton.css({background:"#888888"})});this.preButton.bind(_event._end,function(){a.preButton.css({background:"#888888"})});this.nextButton.bind(_event._end,function(){a.nextButton.css({background:"#888888"})});this.firstButton.bind(_event._enter,function(){a.firstButton.css({background:"#000000"})});this.lastButton.bind(_event._enter,function(){a.lastButton.css({background:"#000000"})});this.firstButton.bind(_event._leave,function(){a.firstButton.css({background:"#888888"})});this.lastButton.bind(_event._leave,
function(){a.lastButton.css({background:"#888888"})});this.firstButton.bind(_event._end,function(){a.firstButton.css({background:"#888888"})});this.lastButton.bind(_event._end,function(){a.lastButton.css({background:"#888888"})});this.firstButton.bind(_event._down,function(){a.gotoPage(1)});this.lastButton.bind(_event._down,function(){a.gotoPage(originTotalPageCount)})};
initSinglePhoneBook.prototype.translateToOrigin=function(a){this.showPage.animateZoom(this.toScale,0,a,300);this.nextPage.animateZoom(this.toScale,this.containtWidth,0,300);this.prePage.animateZoom(this.toScale,-this.containtWidth,0,300)};initSinglePhoneBook.prototype.initTranslate=function(){var a=getTransform(this.showPage.side[0]),b=getTransform(this.prePage.side[0]),c=getTransform(this.nextPage.side[0]);this.tran=Point(a.x,a.y);this.pretran=Point(b.x,b.y);this.nexttran=Point(c.x,c.y)};
initSinglePhoneBook.prototype.translateMove=function(a,b){this.showPage.setTranslate(this.showPage.side,a+this.tran.x,b);this.showPage.setTranslate(this.showPage.tmpImg,a+this.tran.x,b);this.prePage.setTranslate(this.prePage.side,a+this.pretran.x,0);this.prePage.setTranslate(this.prePage.tmpImg,a+this.pretran.x,0);this.nextPage.setTranslate(this.nextPage.side,a+this.nexttran.x,0);this.nextPage.setTranslate(this.nextPage.tmpImg,a+this.nexttran.x,0)};
initSinglePhoneBook.prototype.zoom=function(a){this.showPage.zoom(a,0)};initSinglePhoneBook.prototype.zoom=function(a){this.showPage.zoom(a,0)};initSinglePhoneBook.prototype.zoomToScale=function(a){this.showPage.zoomToScale(a,0)};initSinglePhoneBook.prototype.noZoom=function(){this.showPage.noZoom()};initSinglePhoneBook.prototype.getLeft=function(){return this.book.offset().left};initSinglePhoneBook.prototype.getTop=function(){return this.book.offset().top};
initSinglePhoneBook.prototype.getWidth=function(){return this.containtWidth};initSinglePhoneBook.prototype.getHeight=function(){return this.containtHeight};initSinglePhoneBook.prototype.getScale=function(){return 1};
initSinglePhoneBook.prototype.show=function(){debug("single phone book show.");this.setVisible(!0);this.prePage.showPage();this.nextPage.showPage();this.showPage.showPage();var a=this;window.setTimeout(function(){a.showPage.showPage();a.addSearchHighlight(this.currentIndex);a.showPage.playSlider()},500);void 0!=leftRightButton&&null!=leftRightButton&&leftRightButton.setShow(!1)};
initSinglePhoneBook.prototype.hide=function(){debug("single phone book hide.");this.setVisible(!1);hideLeftRightButton()&&leftRightButton.setShow(!0);this.showPage.resetSlider()};function singlePhoneSide(a){this.side=$("<div></div>");this.sideContent=$("<div class='sideContent' style= 'overflow: hidden'></div>");this.sideImg=$("<img style='position: absolute;' />");this.MMbg=$("<div style='position:absolute;z-index:3;'></div>");this.loadingImg=$("<img src='"+uiBaseURL+"progress.gif' style='position: absolute;'>");this.width=zoomPageWidth;this.height=zoomPageHeight;this.fitH=this.fitW=0;this.tmpImg=$("<img style='position: absolute;z-index:-1;' />");this.searchHighlight=$("<div class='kong' id='highlight'></div>");
a.append(this.side);this.side.append(this.sideContent);this.imgIndex=-1;this.toScale=1;this.origin="0% 0%";this.translateY=this.translateX=this.y=this.x=0;this.toolbarShow=this.isZomming=!1;this.sideTop=0;this.side.css({width:this.width+"px",height:this.height+"px",top:this.sideTop+"px",position:"absolute"});this.sideContent.css({width:this.width+"px",height:this.height+"px",background:"transparent"});this.searchHighlight.css({width:this.width+"px",height:this.height+"px"});this.sideImg.css({width:this.width+
"px",height:this.height+"px"});this.MMbg.css({width:this.width+"px",height:this.height+"px"});this.loadingImg.css({left:windowWidth/2-10+"px",top:windowHeight/2-10+"px"});this.linkArray=[];this.youtubeArray=[];this.videoArray=[];this.audioArray=[];this.imageArray=[];this.buttonArray=[];this.flashShowArray=[];this.flashSwfArray=[];this.lineArray=[];this.arrowArray=[];this.roundArray=[];this.reArray=[];this.textArray=[];this.areaArray=[];this.calloutArray=[];this.atextArray=[];this.startextArray=[];
this.aminArray=[];this.atimageArray=[];this.alimageArray=[];this.slideShowArray=[];this.efftextArray=[];this.soundArray=[];this.bannerArray=[];this.carouselArray=[];this.dynshowArray=[];this.jumpArray=[];this.rotate3DArray=[];this.vimeoArray=[];this.slider=null;this.playSliderAfterLoad=!1;this.initEvent();this.onWinResize(windowWidth-leftMargin-rightMargin,windowHeight-topMargin-bottomMargin-40,!0);this.father=a}singlePhoneSide.prototype.hideMM=function(){this.MMbg.css({display:"none"})};
singlePhoneSide.prototype.showMM=function(){this.MMbg.css({display:"block"})};singlePhoneSide.prototype.setCSS=function(a){this.side.css(a)};singlePhoneSide.prototype.onResize2=function(a){this.toScale=a/this.width;a=getTransform(this.side[0]);this.zoomObj(this.side,this.origin," scale("+this.toScale+")",a.x,a.y)};
singlePhoneSide.prototype.onResize=function(a,b,c){this.toScale=1;a=getPageWidthHeightByWidth(a,b,zoomPageWidth,zoomPageHeight);this.width=a.x*this.toScale;this.height=a.y*this.toScale;this.side.css({width:this.width+"px",height:this.height+"px"});this.sideContent.css({width:this.width+"px",height:this.height+"px"});this.sideImg.css({width:this.width+"px",height:this.height+"px"});this.searchHighlight.css({width:this.width+"px",height:this.height+"px"});this.MMbg.css({width:this.width+"px",height:this.height+
"px"});this.MMResize(this.width,this.height);c&&this.tmpImg.css({width:this.width+"px",height:this.height+"px",top:this.sideTop+"px"});this.loadingImg.css({left:windowWidth/2-10+"px",top:windowHeight/2-10+"px"})};singlePhoneSide.prototype.getSide=function(){return this.side};
singlePhoneSide.prototype.fillContent=function(a){this.imgIndex=a;var b=this;this.sideContent.empty();a>originTotalPageCount+1||0>a||(this.sideImg.attr("src",getPageDir(a,"thumb",originTotalPageCount)),this.sideImg.load(function(){b.tmpImg.attr("src",getPageDir(a,"thumb",originTotalPageCount));b.sideContent.append(b.sideImg);b.sideContent.append(b.tmpImg)}))};
singlePhoneSide.prototype.fillTemp=function(a){if(a!=this.imgIndex){this.imgIndex=a;var b=this;this.sideContent.empty();a>originTotalPageCount+1||0>a||(this.sideImg.attr("src",getPageDir(a,"thumb",originTotalPageCount)),this.sideImg.load(function(){b.tmpImg.attr("src",getPageDir(a,"thumb",originTotalPageCount));b.sideContent.append(b.sideImg);b.sideContent.append(b.tmpImg)}))}};
singlePhoneSide.prototype.changeContent=function(a){this.imgIndex=a;var b=this;a>originTotalPageCount+1||0>a||(null!=this.slider&&(this.slider.destroy(),this.slider=null),this.sideImg.attr("src",getPageDir(a,"normal",originTotalPageCount)),this.sideImg.load(function(){b.hideLoading();b.tmpImg.attr("src",getPageDir(a,"normal",originTotalPageCount));b.sideContent.append(b.sideImg);b.sideContent.append(b.tmpImg);b.sideContent.append(b.MMbg);b.sideContent.append(b.searchHighlight);b.searchHighlight.css({opacity:0.8});
pageEditor!=void 0&&b.initMM()}))};singlePhoneSide.prototype.setPosition=function(a,b){this.side.css({left:a+"px",top:b+"px"})};singlePhoneSide.prototype.setChildIndex=function(a){this.side.css({"z-index":a})};singlePhoneSide.prototype.setVisible=function(a){this.side.css({display:a?"block":"none"})};
singlePhoneSide.prototype.resetSize=function(){this.tmpImg.css({display:"none"});var a=this.width*this.toScale>=zoomPageWidth,b=a?zoomPageWidth:this.width*this.toScale,c=a?zoomPageHeight:this.height*this.toScale,d=getTransform(this.side[0]),e=this.width==zoomPageWidth&&b<zoomPageWidth||this.width!=zoomPageWidth;this.toScale=a?this.width*this.toScale/zoomPageWidth:1;var a=singlePhoneBook.minZoomWidth,f=singlePhoneBook.minZoomHeight;if(void 0!=a&&void 0!=f&&0<a&&0<f){b/c>a/f?f=a*c/b:a=f*b/c;var g=Math.min(0,
b-a),h=Math.min(0,c-f),b=Math.max(b,a),c=Math.max(c,f);d.x+=g/2;d.y+=h/2}this.zoomObj(this.side,"0% 0%","scale("+this.toScale+")",d.x,d.y);this.width=b;this.height=c;this.translateX=d.x;this.translateY=d.y;e&&this.tmpImg.css({width:this.width+"px",height:this.height+"px"});this.zoomObj(this.tmpImg,"0% 0%","scale("+this.toScale+")",d.x,d.y);this.tmpImg.css({display:"block"});if(e)this.onResize(b,c)};
singlePhoneSide.prototype.zoom=function(a,b){if(!0==this.isZomming)return!1;var c=singlePhoneBook.minZoomWidth,d=singlePhoneBook.largeZoomWidth,e=this.side.width()*this.toScale;this.side.height();var f=this.toScale+a,g=this.side.width()*f;if(1>f){if(e<=c)return;g<c&&(f=c/this.side.width())}1<f&&g>d&&(f=d/this.side.width());g=this.side.width()*f;this.side.height();c=(e-g)/2+this.translateX;0==b&&(c=0);1==b&&(c=g);-1==b&&(c=-g);this.animateZoom(f,c,0,300)};
singlePhoneSide.prototype.zoomToScale=function(a,b){if(!0==this.isZomming)return!1;var c=singlePhoneBook.minZoomWidth,d=singlePhoneBook.largeZoomWidth,e=this.side.width()*this.toScale;this.side.height();var f=this.toScale+a,g=this.side.width()*f;if(1>f){if(e<=c)return;g<c&&(f=c/this.side.width())}1<f&&g>d&&(f=d/this.side.width());g=this.side.width()*f;this.side.height();c=(e-g)/2+this.translateX;0==b&&(c=0);1==b&&(c=g);-1==b&&(c=-g);!0!=this.isZomming&&(this.isZomming=!0,f||(f=this.toScale),c||(c=
0),getTransform(this.side[0]),this.tmpImg.css({display:"none"}),this.zoomObj(this.side,this.origin," scale("+f+")",c,0),this.zoomObj(this.tmpImg,this.origin," scale("+f+")",c,0),this.tmpImg.css({display:"block"}),this.toScale=f,singlePhoneBook.toScale=f,singlePhoneBook.containtWidth=Math.min(singlePhoneBook.width*f,singlePhoneBook.stageWidth),singlePhoneBook.containtHeight=Math.min(singlePhoneBook.height*f,singlePhoneBook.stageHeight),singlePhoneBook.book.css({width:singlePhoneBook.containtWidth+
"px",height:singlePhoneBook.containtHeight+"px",left:(singlePhoneBook.stageWidth-singlePhoneBook.containtWidth)/2+"px",top:(singlePhoneBook.stageHeight-singlePhoneBook.containtHeight)/2+"px"}),this.isZomming=!1)};singlePhoneSide.prototype.noZoom=function(){this.toScale=this.fitW/this.width;this.zoomObj(this.side,"0% 0%","scale("+this.toScale+")",0,0);this.zoomObj(this.tmpImg,"0% 0%","scale("+this.toScale+")",0,0)};
singlePhoneSide.prototype.forceReset=function(a){this.width=this.fitW;this.height=this.fitH;this.toScale=1;void 0==a&&(a=getTransform(this.side[0]));this.forceResize(a)};singlePhoneSide.prototype.forceMax=function(){var a=(this.width*this.toScale-zoomPageWidth)/2;this.width=zoomPageWidth;this.height=zoomPageHeight;var b=getTransform(this.side[0]);b.x+=a;this.forceResize(b)};singlePhoneSide.prototype.animateMax=function(){this.animateZoom(zoomPageWidth/this.width,(this.width-zoomPageWidth)/2,0,300)};
singlePhoneSide.prototype.animateFit=function(){this.animateZoom(this.fitW/this.width,0,0,300)};
singlePhoneSide.prototype.forceResize=function(a){this.side.css({width:this.width+"px",height:this.height+"px"});this.sideContent.css({width:this.width+"px",height:this.height+"px"});this.sideImg.css({width:this.width+"px",height:this.height+"px"});this.searchHighlight.css({width:this.width+"px",height:this.height+"px"});this.MMbg.css({width:this.width+"px",height:this.height+"px"});this.MMResize(this.width,this.height);this.tmpImg.css({width:this.width+"px",height:this.height+"px"});this.toScale=
1;this.zoomObj(this.side,"0% 0%","scale("+this.toScale+")",a.x,a.y);this.zoomObj(this.tmpImg,"0% 0%","scale("+this.toScale+")",a.x,a.y);this.translateX=a.x;this.translateY=a.y};singlePhoneSide.prototype.getScaleFromFit=function(){return this.width*this.toScale/this.fitW};singlePhoneSide.prototype.getCenterTransform=function(){return Point((this.fitW-this.width*this.toScale)/2,0)};
singlePhoneSide.prototype.zoomToMax=function(){var a=zoomPageWidth/this.width;this.animateZoom(a,(this.width*this.toScale-this.width*a)/2+this.translateX,0,200)};singlePhoneSide.prototype.zoomToFit=function(){this.animateZoom(this.getScaleFromFit(),0,0,200)};
singlePhoneSide.prototype.zoomObj=function(a,b,c,d,e){d||(d=0);e||(e=0);d=translate(d,e);a.css({"-webkit-transform-origin":b,"-moz-transform-origin":b,"-ms-transform-origin":b,"-o-transform-origin":b,"-webkit-transform":d+c,"-moz-transform":d+c,"-ms-transform":d+c,"-o-transform":d+c})};singlePhoneSide.prototype.setTranslate=function(a,b,c){b=translate(b,c);a.css({"-webkit-transform":b,"-moz-transform":b,"-o-transform":b,"-ms-transform":b})};
singlePhoneSide.prototype.setXY=function(a,b){this.x=a;this.y=b};singlePhoneSide.prototype.animateTranslate=function(a,b,c){a||(a=0);b||(b=0);c||(c=25);var d=getTransform(this.side[0]),e=this;$(d).animate({x:a,y:b},{duration:c,easing:"easeOutSine",complete:function(){e.zoomObj(e.side,e.origin," scale("+e.toScale+")",d.x,d.y);e.zoomObj(e.tmpImg,e.origin," scale("+e.toScale+")",d.x,d.y)}})};
singlePhoneSide.prototype.animateZoom=function(a,b,c,d){if(!0!=this.isZomming){this.isZomming=!0;a||(a=this.toScale);b||(b=0);c||(c=0);d||(d=25);var e=getTransform(this.side[0]),f={scale:this.toScale,x:e.x,y:e.y},g=this;$(f).animate({scale:a,x:b,y:c},{duration:d,easing:"easeOutSine",step:function(){g.tmpImg.css({display:"none"});g.zoomObj(g.side,g.origin," scale("+f.scale+")",b,c);g.zoomObj(g.tmpImg,g.origin," scale("+f.scale+")",b,c);g.tmpImg.css({display:"block"})},complete:function(){g.toScale=
a;singlePhoneBook.toScale=a;singlePhoneBook.containtWidth=Math.min(singlePhoneBook.width*a,singlePhoneBook.stageWidth);singlePhoneBook.containtHeight=Math.min(singlePhoneBook.height*a,singlePhoneBook.stageHeight);singlePhoneBook.book.css({width:singlePhoneBook.containtWidth+"px",height:singlePhoneBook.containtHeight+"px",left:(singlePhoneBook.stageWidth-singlePhoneBook.containtWidth)/2+"px",top:(singlePhoneBook.stageHeight-singlePhoneBook.containtHeight)/2+"px"});g.isZomming=false}})}};
singlePhoneSide.prototype.onWinResize=function(a,b,c){this.toScale=1;var d=getPageWidthHeightByWidth(a,b,zoomPageWidth,zoomPageHeight);this.fitW=d.x;this.fitH=d.y;if(c)this.onResize(a,b,!0)};singlePhoneSide.prototype.showLoading=function(){this.side.append(this.loadingImg)};singlePhoneSide.prototype.hideLoading=function(){this.loadingImg.remove()};
singlePhoneSide.prototype.translate=function(a,b){this.tmpImg.css({display:"none"});this.zoomObj(this.side,this.origin," scale("+this.toScale+")",a,b);this.zoomObj(this.tmpImg,this.origin," scale("+this.toScale+")",a,b);this.tmpImg.css({display:"block"})};singlePhoneSide.prototype.isFit=function(){return this.toScale==this.fitW/this.width};
singlePhoneSide.prototype.animateBack=function(a){var b=getTransform(this.side[0]),c={x:b.x,y:b.y,scale:this.toScale},d=this.fitW/this.width,e=this;e.tmpImg.css({display:"none"});$(c).animate({x:0,y:0,scale:d},{duration:200,step:function(){e.zoomObj(e.side,e.origin," scale("+c.scale+")",c.x,c.y);e.zoomObj(e.tmpImg,e.origin," scale("+c.scale+")",c.x,c.y)},complete:function(){e.toScale=d;e.tmpImg.css({display:"block"});a()}})};singlePhoneSide.prototype.showPage=function(){this.side.css({display:"block"})};
singlePhoneSide.prototype.hidePage=function(){this.side.css({display:"none"})};singlePhoneSide.prototype.getWidth=function(){return this.width*this.toScale};singlePhoneSide.prototype.getHeight=function(){return this.height*this.toScale};
singlePhoneSide.prototype.initEvent=function(){var a=this,b=Point(0,0),c=Point(0,0),d=Point(0,0),e=!1,f=!1,g=null,h=!1,j,k=0,m=0,l=!1;this.side.bind(_event._down,function(k){if(bookType==BookType.singlePhone_book){if(!0==a.isZomming||!0==singlePhoneBook.isFlipping)return!1;j=a.toScale;l=!1;var k=isTouch?k.originalEvent.touches:[k],m=getTransform(a.side[0]);a.translateX=m.x;a.translateY=m.y;singlePhoneBook.initTranslate();1==k.length?(e=!0,f=!1,b=Point(k[0].pageX,k[0].pageY),g=Point(a.side.position().left,
a.side.position().top)):2==k.length&&(e=!1,f=!0,b=Point(k[0].pageX,k[0].pageY),d=Point(k[1].pageX,k[1].pageY),c=Point((k[0].pageX+k[1].pageX)/2,(k[0].pageY+k[1].pageY)/2),g=Point(a.side.offset().left,a.side.offset().top));h=!1;stopEvent(k[0])}});3==browserType&&(_event._mousewheel="DOMMouseScroll");isIE()&&(_event._mousewheel="mousewheel");this.side.bind(_event._mousewheel,function(b){if(bookType!=BookType.singlePhone_book||singlePhoneBook.isFlipping==true)return false;b=b.originalEvent;b=Math.max(-1,
Math.min(1,b.wheelDelta||-b.detail));getTransform(a.side[0]);var c=-0.25;b>0&&(c=0.25);singlePhoneBook.zoom(c);return false});this.side.bind(_event._move,function(n){if(bookType==BookType.singlePhone_book){n=isTouch?n.originalEvent.touches:[n];if(a.isZomming==true||singlePhoneBook.isFlipping==true||l==true)return false;e?a.side.css({cursor:"move"}):a.side.css({cursor:""});if(e){var o=n[0].pageX-b.x+a.translateX,p=n[0].pageY-b.y+a.translateY;(new Date).getTime();p=Math.max(singlePhoneBook.getHeight()-
a.getHeight(),p);p=Math.min(p,0);if(singlePhoneBook.getWidth()+5<a.getWidth()){o=Math.max(singlePhoneBook.getWidth()-a.getWidth(),o);o=Math.min(o,0);a.zoomObj(a.side,a.origin," scale("+a.toScale+")",o,p);a.zoomObj(a.tmpImg,a.origin," scale("+a.toScale+")",o,p);k=o;m=p;a.zoomToMove=true;a.gotoNextPage=false;a.gotoPrePage=false}else{a.zoomToMove=false;singlePhoneBook.translateMove(n[0].pageX-b.x,p);if(b.x-n[0].pageX>windowWidth/4){a.gotoNextPage=true;a.gotoPrePage=false}else if(b.x-n[0].pageX<=-windowWidth/
4){a.gotoNextPage=false;a.gotoPrePage=true}else{a.gotoNextPage=false;a.gotoPrePage=false}}k=o;m=p;h=false;stopEvent(n[0])}else if(f){var p=Point(n[0].pageX,n[0].pageY),q=Point(n[1].pageX,n[1].pageY),o=Math.sqrt(Math.pow(b.x-d.x,2)+Math.pow(b.y-d.y,2)),p=Math.sqrt(Math.pow(p.x-q.x,2)+Math.pow(p.y-q.y,2));scale=Math.max(p/o*j,0.5);o=a.side.width()*scale;scale<1&&o<singlePhoneBook.minZoomWidth&&(scale=singlePhoneBook.minZoomWidth/a.side.width());scale>1&&o>singlePhoneBook.largeZoomWidth&&(scale=singlePhoneBook.largeZoomWidth/
a.side.width());singlePhoneBook.showPage.toScale=scale;p=(c.x-g.x)/j;o=(c.y-g.y)/j;a.side.width();a.side.height();p=(j-a.toScale)*a.side.width()*(p/a.side.width());q=(j-a.toScale)*a.side.height()*(o/a.side.height());o=a.translateX+p;p=a.translateY+q;singlePhoneBook.toScale=scale;singlePhoneBook.containtWidth=Math.min(singlePhoneBook.width*scale,singlePhoneBook.stageWidth);singlePhoneBook.containtHeight=Math.min(singlePhoneBook.height*scale,singlePhoneBook.stageHeight);p=Math.max(singlePhoneBook.getHeight()-
a.side.height()*scale,p);p=Math.min(p,0);o=Math.max(singlePhoneBook.getWidth()-a.side.width()*scale,o);o=Math.min(o,0);singlePhoneBook.showPage.zoomObj(singlePhoneBook.showPage.side,singlePhoneBook.showPage.origin," scale("+a.toScale+")",o,p);singlePhoneBook.showPage.zoomObj(singlePhoneBook.showPage.tmpImg,singlePhoneBook.showPage.origin," scale("+a.toScale+")",o,p);singlePhoneBook.book.css({width:singlePhoneBook.containtWidth+"px",height:singlePhoneBook.containtHeight+"px",left:(singlePhoneBook.stageWidth-
singlePhoneBook.containtWidth)/2+"px",top:(singlePhoneBook.stageHeight-singlePhoneBook.containtHeight)/2+"px"});h=true;a.isZomming==true;stopEvent(n[0])}}});this.side.bind(_event._end,function(){if(bookType==BookType.singlePhone_book){if(a.isZomming==true||singlePhoneBook.isFlipping==true||l==true)return false;a.side.css({cursor:""});a.translateX=k;var b=m,b=Math.max(singlePhoneBook.getHeight()-a.getHeight(),b),b=Math.min(b,0);a.translateY=b;try{a.gotoNextPage==true?singlePhoneBook.gotoPage(parseInt(singlePhoneBook.currentIndex)+
1):a.gotoPrePage==true?singlePhoneBook.gotoPage(parseInt(singlePhoneBook.currentIndex)-1):a.zoomToMove==false&&h==false&&singlePhoneBook.translateToOrigin(a.translateY);a.gotoNextPage=false;a.gotoPrePage=false;l=true}catch(c){}h=f=e=false}});this.side.bind(_event._leave,function(b){if(bookType==BookType.singlePhone_book){if(a.isZomming==true||singlePhoneBook.isFlipping==true||l==true)return false;try{a.gotoNextPage==true?singlePhoneBook.gotoPage(parseInt(singlePhoneBook.currentIndex)+1):a.gotoPrePage==
true?singlePhoneBook.gotoPage(parseInt(singlePhoneBook.currentIndex)-1):a.zoomToMove==false&&h==false&&singlePhoneBook.translateToOrigin(a.translateY);a.gotoNextPage=false;a.gotoPrePage=false;l=true}catch(c){}stopEvent(b[0])}});this.side.hammer().on("doubletap",function(){if(singlePhoneBook.isFlipping==true||this.isZomming==true||bookType!=BookType.singlePhone_book)return false})};
singlePhoneSide.prototype.initMM=function(){this.MMbg.empty();this.linkArray=[];this.youtubeArray=[];this.videoArray=[];this.audioArray=[];this.imageArray=[];this.buttonArray=[];this.flashShowArray=[];this.flashSwfArray=[];this.lineArray=[];this.arrowArray=[];this.roundArray=[];this.reArray=[];this.textArray=[];this.areaArray=[];this.calloutArray=[];this.atextArray=[];this.startextArray=[];this.aminArray=[];this.atimageArray=[];this.alimageArray=[];this.slideShowArray=[];this.efftextArray=[];this.soundArray=
[];this.bannerArray=[];this.carouselArray=[];this.dynshowArray=[];this.jumpArray=[];this.rotate3DArray=[];this.vimeoArray=[];var a=sliderJS[this.imgIndex-1];void 0!=a&&(this.slider=window.hiSliderFactory({container:this.MMbg,slide:a,initialWidth:this.width,initialHeight:this.height}),this.slider.resize(this.width,this.height),!0==this.playSliderAfterLoad&&(debug("[single phone book] this.playSliderAfterLoad == true"),this.playSlider()));if(!(0>=this.imgIndex||pageEditor.length<this.imgIndex||null==
pageEditor[this.imgIndex-1][0]))for(a=0;a<pageEditor[this.imgIndex-1].length;a++){var b=pageEditor[this.imgIndex-1][a];if(void 0!=b)if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_LINK){var c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,downColor:b.downColor,downAlpha:b.downAlpha,overColor:b.overColor,overAlpha:b.overAlpha,outColor:b.outColor,outAlpha:b.outAlpha,action:b.action};this.linkArray.push(new initLink(this.MMbg,c,this.width,
this.height))}else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_YOUTUBE||pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_YOUTUBE1||pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_YOUTUBE2||pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_YOUTUBE3||pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_YOUTUBE4)c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,id:b.videoId,
moviePlayTriggerEvt:b.moviePlayTriggerEvt,movieStopTriggerEvt:b.movieStopTriggerEvt},pageEditor[this.imgIndex-1][a].annotype!=PageEditor.AnnoType.ANNO_YOUTUBE&&(c.id=b.videoID),youtubeObj=new initYoutube(this.MMbg,c,this.width,this.height),this.youtubeArray.push(youtubeObj);else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_VIMEO||pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_VIMEO2)c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,
alpha:b.alpha,id:b.videoID,moviePlayTriggerEvt:b.moviePlayTriggerEvt,movieStopTriggerEvt:b.movieStopTriggerEvt},vimeoObj=new initVimeo(this.MMbg,c,this.width,this.height),this.vimeoArray.push(vimeoObj);else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_VIDEO)c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,src:b.url,previewSrc:b.previewUrl,moviePlayTriggerEvt:b.PlayTriggerEvt,movieStopTriggerEvt:b.StopTriggerEvt},c=new initVideo(this.MMbg,
c,this.width,this.height,"round"),this.videoArray.push(c);else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_AUDIO)c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,src:b.soundURL,soundPlayTriggerEvt:b.soundPlayTriggerEvt,soundStopTriggerEvt:b.soundStopTriggerEvt},c=new initAudio(this.MMbg,c,this.width,this.height),this.audioArray.push(c);else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_IMAGE)c=pageEditor[this.imgIndex-
1][a],c={width:c.location.width,height:c.location.height,x:c.location.x,y:c.location.y,alpha:c.alpha,src:c.url,action:c.action,mouseOver:c.mouseOverEffect},this.imageArray.push(new initImage(this.MMbg,c,this.width,this.height));else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_BUTTON)c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,src:b.url,action:b.action,buttonCaption:b.buttonCaption,captionY:b.captionY,HRate:b.HRate,Format:b.Format},
this.buttonArray.push(new initButton(this.MMbg,c,this.width,this.height));else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_SWF)c=pageEditor[this.imgIndex-1][a],c={width:c.location.width,height:c.location.height,x:c.location.x,y:c.location.y,alpha:c.alpha,src:c.swfURL,shadow:c.shadow},swfObj=new initFlashSwf(this.MMbg,c,this.width,this.height),this.flashSwfArray.push(swfObj);else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_FLASHSHOW)c=pageEditor[this.imgIndex-
1][a],c={width:c.location.width,height:c.location.height,x:c.location.x,y:c.location.y,alpha:c.alpha,photo:c.Images,repeatPlay:c.isRepeat},flashObj=new initFlashShow(this.MMbg,c,this.width,this.height),this.flashShowArray.push(flashObj);else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_LINE)c={StartX:b.lineStartPX,StartY:b.lineStartPY,EndX:b.lineEndPX,EndY:b.lineEndPY,x:b.location.x,y:b.location.y,width:b.location.width,height:b.location.height,lineAlpha:b.lineAlpha,alpha:b.alpha,
lineWidth:b.lineWidth,lineType:b.lineType,dotWidth:b.dotWidth,color:b.color,sh:b.shadow.hasDropShadow,sx:b.shadow.shadowBlurX,sy:b.shadow.shadowBlurY,se:b.shadow.shadowDistance,sr:b.shadow.shadowColor},this.lineArray.push(new initLine(this.MMbg,c,this.width,this.height,this.imgIndex+a));else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_ARROW)c={StartX:b.lineStartPX,StartY:b.lineStartPY,EndX:b.lineEndPX,EndY:b.lineEndPY,x:b.location.x,y:b.location.y,width:b.location.width,height:b.location.height,
alpha:b.alpha,lineWidth:b.lineWidth,lineType:b.lineType,dotWidth:b.dotWidth,color:b.color,sh:b.shadow.hasDropShadow,sx:b.shadow.shadowBlurX,sy:b.shadow.shadowBlurY,se:b.shadow.shadowDistance,arrowType:b.arrowType,sr:b.shadow.shadowColor},this.arrowArray.push(new initArrow(this.MMbg,c,this.width,this.height,this.imgIndex+a));else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_ROUND)c={x:b.location.x,y:b.location.y,width:b.location.width,height:b.location.height,alpha:b.alpha,
fillStyle:b.fillStyle,color:b.color,ColorA:b.gradientColorA,ColorB:b.gradientColorB,angle:b.angle,spalpha:b.spalpha,borderWidth:b.borderWidth,borderColor:b.borderColor,borderAlpha:b.borderAlpha,sh:b.shadow.hasDropShadow,sx:b.shadow.shadowBlurX,sy:b.shadow.shadowBlurY,se:b.shadow.shadowDistance,sr:b.shadow.shadowColor,action:b.action},this.roundArray.push(new initRound(this.MMbg,c,this.width,this.height,this.imgIndex+a));else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_RECTANGLE)c=
{x:b.location.x,y:b.location.y,width:b.location.width,height:b.location.height,alpha:b.alpha,fillStyle:b.fillStyle,color:b.color,ColorA:b.gradientColorA,ColorB:b.gradientColorB,angle:b.angle,spalpha:b.spalpha,borderWidth:b.borderWidth,borderColor:b.borderColor,borderAlpha:b.borderAlpha,sh:b.shadow.hasDropShadow,sx:b.shadow.shadowBlurX,sy:b.shadow.shadowBlurY,se:b.shadow.shadowDistance,sr:b.shadow.shadowColor,round:parseBool(b.round),roundWidth:Math.max(parseInt(b.ellipseWidth),parseInt(b.ellipseHeight)),
action:b.action},this.reArray.push(new initRe(this.MMbg,c,this.width,this.height,this.imgIndex+a));else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_TEXT)c={x:b.location.x,y:b.location.y,width:b.location.width,height:b.location.height,alpha:b.alpha,textStr:b.textStr,lineH:b.lineHeightRation,fontName:b.formats.defaultFormat.fontName,fontSize:b.formats.defaultFormat.fontSize,color:b.formats.defaultFormat.color,tbold:b.formats.defaultFormat.bold,italic:b.formats.defaultFormat.italic,
bgalpha:b.background.alpha,fillBg:b.background.fillBg,bgcolor:b.background.color,sh:b.shadow.hasDropShadow,sx:b.shadow.shadowBlurX,sy:b.shadow.shadowBlurY,se:b.shadow.shadowDistance,sr:b.shadow.shadowColor,action:b.action},this.textArray.push(new initText(this.MMbg,c,this.width,this.height,this.imgIndex+a));else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_AREA)c={x:b.location.x,y:b.location.y,width:b.location.width,height:b.location.height,alpha:b.alpha,color:b.color,rounds:b.round,
ellipseWidth:b.ellipseWidth,ellipseHeight:b.ellipseHeight,sh:b.shadow.hasDropShadow,sx:b.shadow.shadowBlurX,sy:b.shadow.shadowBlurY,se:b.shadow.shadowDistance,sr:b.shadow.shadowColor,action:b.action},this.areaArray.push(new initArea(this.MMbg,c,this.width,this.height,this.imgIndex+a));else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_CALLOUT)c={x:b.location.x,y:b.location.y,width:b.location.width,height:b.location.height,alpha:b.alpha,textStr:b.textStr,lineH:b.lineHeightRation,
pageH:b.formats.defaultFormat.pageH,fontName:b.formats.defaultFormat.fontName,fontSize:b.formats.defaultFormat.fontSize,color:b.formats.defaultFormat.color,tbold:b.formats.defaultFormat.bold,italic:b.formats.defaultFormat.italic,bgalpha:b.background.alpha,fillBg:b.background.fillBg,bgcolor:b.background.color,direct:b.hookDirect,cx1:b.hookContr1RatioX,cy1:b.hookContr1RatioY,cx2:b.hookContr2RatioX,cy2:b.hookContr2RatioY,pointx:b.hookContrPointRatioX,pointy:b.hookContrPointRatioY,cornerRadiut:b.cornerRadiut,
borderWidth:b.borderWidth,borderColor:b.borderColor,bordreAlpha:b.bordreAlpha,sh:b.shadow.hasDropShadow,sx:b.shadow.shadowBlurX,sy:b.shadow.shadowBlurY,se:b.shadow.shadowDistance,sr:b.shadow.shadowColor,action:b.action},this.calloutArray.push(new initCallout(this.MMbg,c,this.width,this.height,this.imgIndex+a));else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_ATEXT)c={x:b.location.x,y:b.location.y,width:b.location.width,height:b.location.height,alpha:b.alpha,textStr:b.strText,
fontName:b.format.font,fontSize:b.format.size,color:b.format.color,tbold:b.format.bold,italic:b.format.italic,align:b.format.align,action:b.action,repeat:b.repeat,moveSpeed:b.moveSpeed,sh:b.shadow.hasDropShadow,sx:b.shadow.shadowBlurX,sy:b.shadow.shadowBlurY,se:b.shadow.shadowDistance,sr:b.shadow.shadowColor},this.atextArray.push(new initAText(this.MMbg,c,this.width,this.height,this.imgIndex+a));else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_STARTEXT)c={x:b.location.x,y:b.location.y,
width:b.location.width,height:b.location.height,alpha:b.alpha,textStr:b.strText,fontName:b.format.font,fontSize:b.format.size,color:b.format.color,tbold:b.format.bold,italic:b.format.italic,align:b.format.align,action:b.action,repeat:b.repeat,moveSpeed:b.moveSpeed,lineH:b.HRate,sh:b.shadow.hasDropShadow,sx:b.shadow.shadowBlurX,sy:b.shadow.shadowBlurY,se:b.shadow.shadowDistance,sr:b.shadow.shadowColor},this.startextArray.push(new initStarText(this.MMbg,c,this.width,this.height,this.imgIndex+a));else if(pageEditor[this.imgIndex-
1][a].annotype==PageEditor.AnnoType.ANNO_TEXTANIM)c={x:b.location.x,y:b.location.y,width:b.location.width,height:b.location.height,alpha:b.alpha,effectType:b.effectType,textStr:b.textStr,fontName:b.formats.defaultFormat.fontName,fontSize:b.formats.defaultFormat.fontSize,color:b.formats.defaultFormat.color,tbold:b.formats.defaultFormat.bold,italic:b.formats.defaultFormat.italic,action:b.action,lineH:b.HRate,sh:b.shadow.hasDropShadow,sx:b.shadow.shadowBlurX,sy:b.shadow.shadowBlurY,se:b.shadow.shadowDistance,
sr:b.shadow.shadowColor},this.aminArray.push(new initAminText(this.MMbg,c,this.width,this.height,this.imgIndex+a));else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_ATIMAGE)c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,src:b.url,action:b.action},atimageObj=new initPngImage(this.MMbg,c,this.width,this.height),this.atimageArray.push(atimageObj);else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_EFFECTTEXT)c=
{x:b.location.x,y:b.location.y,width:b.location.width,height:b.location.height,alpha:b.alpha,textStr:b.htmlText,action:b.action,moveSpeed:b.effectStyle,lineH:b.HRate,sh:b.shadow.hasDropShadow,sx:b.shadow.shadowBlurX,sy:b.shadow.shadowBlurY,se:b.shadow.shadowDistance,sr:b.shadow.shadowColor},this.efftextArray.push(new initEffText(this.MMbg,c,this.width,this.height,this.imgIndex+a));else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_ADVANCEDSOUND)c={width:b.location.width,height:b.location.height,
x:b.location.x,y:b.location.y,alpha:b.alpha,src:b.soundList.sound,skinType:b.skinType,soundPlay:b.soundPlayTriggerEvt},this.soundArray.push(new initSound(this.MMbg,c,this.width,this.height,this.imgIndex+a));else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_CAROUSEL)c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,images:b.Images},this.carouselArray.push(new initCarousel(this.MMbg,c,this.width,this.height,this.imgIndex+a));else if(pageEditor[this.imgIndex-
1][a].annotype==PageEditor.AnnoType.ANNO_DYNSHOW)c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,images:b.Images,borderWidth:b.borderWidth},this.dynshowArray.push(new initDynamicShow(this.MMbg,c,this.width,this.height,this.imgIndex+a));else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_BANNER)c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,action:b.action,banners:b.banners},this.bannerArray.push(new initBanner(this.MMbg,
c,this.width,this.height,this.imgIndex+a));else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_FLIPJUMP)c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,images:b.Images,addBackground:parseBool(b.addBack),addBorder:parseBool(b.addBorder),backgroundColor:b.backgroundColor,backgroundAlpha:b.backgroundColorAlpha,borderColor:b.backgroundBorderColor},this.jumpArray.push(new initFlipJump(this.MMbg,c,this.width,this.height,this.imgIndex+
a));else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_PLUGIN&&pageEditor[this.imgIndex-1][a].className==PLUGIN_ROTATE3D)c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,images:b.componentData.Images,addBackground:parseBool(b.componentData.addBack),addBorder:parseBool(b.componentData.addBorder),backgroundColor:b.componentData.backColor,backgroundAlpha:b.componentData.backAlpha,borderColor:b.componentData.borderColor,sh:parseBool(b.shadow.hasDropShadow),
sx:b.shadow.shadowBlurX,sy:b.shadow.shadowBlurY,se:b.shadow.shadowDistance,sr:b.shadow.shadowColor},this.rotate3DArray.push(new initRotate3D(this.MMbg,c,this.width,this.height,this.imgIndex+a));else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_VIDEO1)c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,src:b.videoURL,previewSrc:b.previewUrl,moviePlayTriggerEvt:b.PlayTriggerEvt,movieStopTriggerEvt:b.StopTriggerEvt},c=new initVideo(this.MMbg,
c,this.width,this.height,"smallblack"),this.videoArray.push(c);else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_VIDEO2)c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,src:b.videoURL,previewSrc:b.previewUrl,moviePlayTriggerEvt:b.PlayTriggerEvt,movieStopTriggerEvt:b.StopTriggerEvt},c=new initVideo(this.MMbg,c,this.width,this.height),this.videoArray.push(c);else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_PLUGIN&&
pageEditor[this.imgIndex-1][a].className==PLUGIN_VIDEO1)c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,src:b.componentData.videoURL,previewSrc:b.previewUrl,moviePlayTriggerEvt:b.PlayTriggerEvt,movieStopTriggerEvt:b.StopTriggerEvt},c=new initVideo(this.MMbg,c,this.width,this.height,"classic"),this.videoArray.push(c);else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_PLUGIN&&pageEditor[this.imgIndex-1][a].className==PLUGIN_VIDEO2)c=
{width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,src:b.componentData.videoURL,previewSrc:b.previewUrl,moviePlayTriggerEvt:b.PlayTriggerEvt,movieStopTriggerEvt:b.StopTriggerEvt},c=new initVideo(this.MMbg,c,this.width,this.height),this.videoArray.push(c);else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_AUDIO1)c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,src:b.soundList=={}?"":b.soundList.sound,
key:"path",soundPlayTriggerEvt:b.soundPlayTriggerEvt,soundStopTriggerEvt:b.soundStopTriggerEvt},c=new initAudio(this.MMbg,c,this.width,this.height,"advanced"),this.audioArray.push(c);else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_AUDIO2)c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,src:b.data=={}?"":b.data.item,key:"fname",soundPlayTriggerEvt:b.soundPlayTriggerEvt,soundStopTriggerEvt:b.soundStopTriggerEvt},c=new initAudio(this.MMbg,
c,this.width,this.height,"wave"),this.audioArray.push(c);else if(pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_PLUGIN&&pageEditor[this.imgIndex-1][a].className in audioThemeNames){var c={width:b.location.width,height:b.location.height,x:b.location.x,y:b.location.y,alpha:b.alpha,src:!b.componentData||!b||b.componentData.songs=={}||void 0==b.componentData.songs?{}:b.componentData.songs.song,key:"url",soundPlayTriggerEvt:b.soundPlayTriggerEvt,soundStopTriggerEvt:b.soundStopTriggerEvt},
b=void 0,d=pageEditor[this.imgIndex-1][a].className;"GlassAudioPlayer"==d&&(b="glass");"SimpleAudioPlayer"==d&&(b="simple");"StandardAudioPlayer"==d&&(b="enjoy");"StandardAudioPlayer02"==d&&(b="decent");"StandardAudioPlayer03"==d&&(b="tree");"StandardAudioPlayer04"==d&&(b="christmas");"StandardAudioPlayer05"==d&&(b="turnonoff");"StandardAudioPlayer06"==d&&(b="fade");c=new initAudio(this.MMbg,c,this.width,this.height,b);this.audioArray.push(c)}else pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_ALPHATRANSITIONBANNER?
(c=pageEditor[this.imgIndex-1][a],c={width:c.location.width,height:c.location.height,x:c.location.x,y:c.location.y,alpha:c.alpha,src:c.url,action:c.action,images:c.Images.node},this.alimageArray.push(new initAlphaTransitionBanner(this.MMbg,c,this.width,this.height))):pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_EMBEDDEDSLIDESHOW?(c=pageEditor[this.imgIndex-1][a],c={width:c.location.width,height:c.location.height,x:c.location.x,y:c.location.y,alpha:c.alpha,images:c.Images.Image},
this.slideShowArray.push(new initEmbeddedSlideshow(this.MMbg,c,this.width,this.height))):pageEditor[this.imgIndex-1][a].annotype==PageEditor.AnnoType.ANNO_PRINT&&(c=pageEditor[this.imgIndex-1][a],c={width:c.location.width,height:c.location.height,x:c.location.x,y:c.location.y,alpha:c.alpha,overAlpha:c.overAlpha,borderColor:c.borderColor,overColor:c.overColor,borderWidth:c.barderWidth,printTitle:c.printTitle,printDesc:c.printDesc},this.areaArray.push(new initPrint(this.MMbg,c,this.width,this.height,
this.imgIndex)))}};singlePhoneSide.prototype.playSlider=function(){null!=this.slider?(this.slider.replay(),this.playSliderAfterLoad=!1):this.playSliderAfterLoad=!0};singlePhoneSide.prototype.resetSlider=function(){null!=this.slider&&this.slider.reset();this.playSliderAfterLoad=!1};
singlePhoneSide.prototype.MMResize=function(a,b){for(var c=0;c<this.linkArray.length;c++)this.linkArray[c].onResize(a,b);for(c=0;c<this.youtubeArray.length;c++)this.youtubeArray[c].onResize(a,b);for(c=0;c<this.videoArray.length;c++)this.videoArray[c].onResize(a,b);for(c=0;c<this.audioArray.length;c++)this.audioArray[c].onResize(a,b);for(c=0;c<this.imageArray.length;c++)this.imageArray[c].onResize(a,b);for(c=0;c<this.buttonArray.length;c++)this.buttonArray[c].onResize(a,b);for(c=0;c<this.flashShowArray.length;c++)this.flashShowArray[c].onResize(a,
b);for(c=0;c<this.flashSwfArray.length;c++)this.flashSwfArray[c].onResize(a,b);for(c=0;c<this.lineArray.length;c++)this.lineArray[c].onResize(a,b);for(c=0;c<this.arrowArray.length;c++)this.arrowArray[c].onResize(a,b);for(c=0;c<this.roundArray.length;c++)this.roundArray[c].onResize(a,b);for(c=0;c<this.reArray.length;c++)this.reArray[c].onResize(a,b);for(c=0;c<this.textArray.length;c++)this.textArray[c].onResize(a,b);for(c=0;c<this.areaArray.length;c++)this.areaArray[c].onResize(a,b);for(c=0;c<this.calloutArray.length;c++)this.calloutArray[c].onResize(a,
b);for(c=0;c<this.atextArray.length;c++)this.atextArray[c].onResize(a,b);for(c=0;c<this.startextArray.length;c++)this.startextArray[c].onResize(a,b);for(c=0;c<this.aminArray.length;c++)this.aminArray[c].onResize(a,b);for(c=0;c<this.atimageArray.length;c++)this.atimageArray[c].onResize(a,b);for(c=0;c<this.efftextArray.length;c++)this.efftextArray[c].onResize(a,b);for(c=0;c<this.soundArray.length;c++)this.soundArray[c].onResize(a,b);for(c=0;c<this.bannerArray.length;c++)this.bannerArray[c].onResize(a,
b);for(c=0;c<this.carouselArray.length;c++)this.carouselArray[c].onResize(a,b);for(c=0;c<this.dynshowArray.length;c++)this.dynshowArray[c].onResize(a,b);for(c=0;c<this.jumpArray.length;c++)this.jumpArray[c].onResize(a,b);for(c=0;c<this.rotate3DArray.length;c++)this.rotate3DArray[c].onResize(a,b);for(c=0;c<this.vimeoArray.length;c++)this.vimeoArray[c].onResize(a,b);for(c=0;c<this.slideShowArray.length;c++)this.slideShowArray[c].onResize(a,b);for(c=0;c<this.alimageArray.length;c++)this.alimageArray[c].onResize(a,
b);null!=this.slider&&this.slider.resize(a,b)};singlePhoneSide.prototype.highlightSearch=function(a){highlightSearchFun(this.searchHighlight,a)};singlePhoneSide.prototype.clearHighlight=function(){clearHighlightFun(this.searchHighlight)};function autoFlip(){this.autoPlay=getBool("autoPlayAutoStart",!1)&&getBool("AutoPlayButtonVisible",!0);this.Duration=getInt("autoPlayDuration",3);this.loopCount=getInt("autoPlayLoopCount",1);this.loopNum=0;this.autoPlay?this.startTimer():this.timer=-1}autoFlip.prototype.startTimer=function(){var a=this;this.timer=window.setInterval(function(){a.onTimer()},1E3*this.Duration)};autoFlip.prototype.stopTimer=function(){-1!==this.timer&&(window.clearInterval(this.timer),this.timer=-1)};
autoFlip.prototype.resetTimer=function(){this.isPlaying()&&(this.stopTimer(),this.startTimer())};
autoFlip.prototype.onTimer=function(){bookType==BookType.normal_book&&flipBook.currentPageIndex==totalPageCount||bookType==BookType.single_book&&$(singlePageBook).data().currentPageIndex==originTotalPageCount||bookType==BookType.zoom_book&&zoomBook.currentIndex==originTotalPageCount||bookType==BookType.slide_book&&slideBook.currentIndex==originTotalPageCount||bookType==BookType.phone_book&&phoneBook.currentIndex==originTotalPageCount||bookType==BookType.singlePhone_book&&singlePhoneBook.currentIndex==
originTotalPageCount||bookType==BookType.singleSlide_book&&singleSlideBook.currentIndex==originTotalPageCount||bookType==BookType.catalog_book&&catalogBook.currentIndex==originTotalPageCount||bookType==BookType.singleCatalog_book&&singleCatalogBook.currentIndex==originTotalPageCount?(this.loopNum++,-1==this.loopCount||this.loopCount>this.loopNum?firstPageFun():(this.stop(),toolBar.changeButtonColor(bookConfig.iconColor))):nextPageFun()};autoFlip.prototype.start=function(){this.autoPlay=!0;this.startTimer()};
autoFlip.prototype.stop=function(){this.autoPlay=!1;this.stopTimer()};autoFlip.prototype.isPlaying=function(){return this.autoPlay};var initBackground=function(a,b,c,d,e,f,g){var h=$("<div></div>"),j=$("<div></div>"),k=$("<img />"),m=e,l=f,n=function(a,b,c){var d=c*Math.PI/180,c=Math.abs(b*Math.sin(d))+Math.abs(a*Math.cos(d)),a=Math.abs(b*Math.cos(d))+Math.abs(a*Math.sin(d));return Point(c,a)},d=-(d%360);h.css({"background-color":"#1F2232",position:"absolute",left:"0px",top:"0px",width:m+"px",height:l+"px","z-index":-1});j.css({position:"absolute","z-index":0});if(1==browserType)j.css({"background-image":"-webkit-linear-gradient("+
d+"deg, "+b+", "+c+")",width:m+"px",height:l+"px"});else if(2==browserType)j.css({"background-image":"-moz-linear-gradient("+d+"deg, "+b+", "+c+")",width:m+"px",height:l+"px"});else if(4==browserType)j.css({"background-image":"-o-linear-gradient("+d+"deg, "+b+", "+c+")",width:m+"px",height:l+"px"});else if(3==browserType){n(m,l,d);var o=Math.floor(parseInt(-d)/90);0>o&&(o+=4);e=0;0==o%2&&(e=1);var f=b,p=c;1<o&&(o=f,f=p,p=o);j.css({filter:"progid:DXImageTransform.Microsoft.Gradient(GradientType="+
e+", EndColorStr="+p+", StartColorStr="+f+");","background-image":"-ms-linear-gradient("+d+"deg, "+b+", "+c+")",width:m+"px",height:l+"px"})}else j.css({"background-image":"linear-gradient("+d+"deg, "+b+", "+c+")",width:m+"px",height:l+"px"});a.append(h);void 0!=g&&""!=g?(k.attr({src:g}),k.load(function(){h.append(k);k.css({width:m+"px",height:l+"px",position:"absolute","z-index":1})}),k[0].onerror=function(){h.append(j)}):h.append(j);this.onResize=function(a,e){m=a;l=e;h.css({width:a+"px",height:e+
"px"});k.css({width:a+"px",height:e+"px"});if(browserType==3){n(a,e,d);var f=Math.floor(parseInt(-d)/90);f<0&&(f=f+4);var g=0;f%2==0&&(g=1);var r=b,u=c;if(f>1){f=r;r=u;u=f}j.css({filter:"progid:DXImageTransform.Microsoft.Gradient(GradientType="+g+", EndColorStr="+u+", StartColorStr="+r+");","background-image":"-ms-linear-gradient("+d+"deg, "+b+", "+c+")",width:a+"px",height:e+"px"})}else j.css({width:a+"px",height:e+"px"})}};var buttonType=function(){};buttonType.caption_button=0;buttonType.icon_button=1;buttonType.double_button=2;var buttonAlign=function(){};buttonAlign.icon_left=0;buttonAlign.icon_top=1;buttonAlign.icon_right=2;buttonAlign.icon_bottom=3;
function button(a,b,c,d,e){this.background=$("<div style = 'position:relative;'></div>");this.caption="button1";this.iconURL="";this.mainColor="#888888";this.height=this.width=40;this.buttonType=a;this.config=c;this.iconBox=$("<img style = 'position:absolute'></img>");this.needResize=e;this.asImgButton=d;this.create();$(b).append(this.background);$(this.background).asButton()}
button.prototype.create=function(){var a=this;this.background.css({position:"absolute",width:this.width+"px",height:this.height+"px","-webkit-border-radius":"2px","-moz-border-radius":"2px","border-radius":"2px",cursor:"pointer"});void 0!=this.config.mainColor&&(this.mainColor=this.config.mainColor,this.background.css({"-color":this.config.mainColor}));this.buttonType!=buttonType.icon_button&&(this.caption=this.config.caption,this.captionBox=new label(this.caption,this.background),this.setPosition());
if(this.buttonType!=buttonType.caption_button){this.iconURL=this.config.iconURL;var b=new Image;b.src=this.iconURL;b.onload=function(){if(b.complete==true){$(a.iconBox).attr("src",a.iconURL);a.background.append(a.iconBox);a.setPosition();a.asImgButton&&$(a.iconBox).asImageButton()}}}};
button.prototype.setPosition=function(){if(this.buttonType==buttonType.double_button){var a=this.captionBox.getWidth(),b=this.captionBox.getHeight(),c=this.iconBox.width(),d=this.iconBox.height();switch(this.config.align){case buttonAlign.icon_left:this.width=a+c+12;this.height=Math.max(d,b)+6;$(this.iconBox).css({top:(this.height-d)/2+"px",left:"4px"});this.captionBox.setLabelPosition((this.height-b)/2,4,["top","right"]);break;case buttonAlign.icon_top:this.width=Math.max(c,a)+6;this.height=b+d+
8;this.iconBox.css({top:"2px",left:(this.width-c)/2+"px"});this.captionBox.setLabelPosition((this.width-a)/2,2,["left","bottom"]);break;case buttonAlign.icon_right:this.width=a+c+12;this.height=Math.max(d,b)+6;$(this.iconBox).css({top:(this.height-d)/2+"px",right:"4px"});this.captionBox.setLabelPosition((this.height-b)/2,4,["top","left"]);break;case buttonAlign.icon_bottom:this.width=Math.max(c,a)+6,this.height=b+d+8,$(this.iconBox).css({bottom:"2px",left:(this.width-c)/2+"px"}),this.captionBox.setLabelPosition(2,
(this.width-a)/2,["top","left"])}}else this.buttonType==buttonType.caption_button?(this.width=this.captionBox.getWidth()+10,this.height=this.captionBox.getHeight()+10,this.captionBox.setLabelPosition(5,2)):this.buttonType==buttonType.icon_button&&(this.width=$(this.iconBox).width(),this.height=$(this.iconBox).height(),$(this.iconBox).css({top:"0px",left:"0px"}));if(this.needResize)this.onResize(85,50);else $(this.background).css({width:this.width,height:this.height+"px"})};
button.prototype.resize=function(a,b){this.onResize(a,b)};button.prototype.onResize=function(a,b){this.width=a;this.height=b;$(this.background).css({width:a+"px",height:b+"px"});$(this.iconBox).css({position:"absolute",top:"10px",left:"5px"})};button.prototype.getWidth=function(){return this.width};button.prototype.getHeight=function(){return this.height};button.prototype.setCSS=function(a){$(this.background).css(a)};
button.prototype.setButtonPosition=function(a,b,c){void 0==c&&(c=["left","top"]);this.background.css(c[0],a+"px");this.background.css(c[1],b+"px")};button.prototype.setVisible=function(a){$(this.background).css({display:a?"block":"none"})};button.prototype.changeIcon=function(a){this.iconURL=a;$(this.iconBox).attr("src",this.iconURL);!0==this.iconBox[0].colorChanged&&(this.iconBox[0].colorChanged=!1);this.setPosition()};button.prototype.changeCaption=function(a){this.captionBox.setCaption(a);this.setPosition()};
button.prototype.getCaptionWidth=function(){return this.captionBox.getWidth()};button.prototype.setIconPosition=function(a,b){this.iconBox.css({left:a+"px",top:b+"px"})};button.prototype.setColor=function(a){this.mainColor=a;$(this.iconBox).changeButtonColor(a);this.buttonType!=buttonType.icon_button&&(this.captionBox.setFont("12px",a,"Tahoma"),$(this.background).css({"text-shadow":"1px 1px #666666"}))};
button.prototype.onMouseDown=function(a,b){this.background.bind(_event._down,function(c){b.call(a,c);return!1})};button.prototype.onMouseUp=function(a,b){3==browserType?this.background.bind("click",function(c){b.call(a,c);return!1}):this.background.bind(_event._end,function(){b.call(a);return!1})};button.prototype.onMouseOver=function(a,b){this.background.bind(_event._move,function(){b.call(a);return!1})};button.prototype.mouseEnterShine=function(a,b){this.background.mouseEnterShine(a,b)};
button.prototype.mouseEnterJump=function(){this.background.mouseEnterJump()};button.prototype.mouseEnterLight=function(a){var b=this;this.background.css({"border-radius":"5px"});this.background.bind(_event._enter,function(){b.background.css({background:a})});this.background.bind(_event._leave,function(){b.background.css({background:""})})};button.prototype.onMouseOut=function(){};button.prototype.onMouseLeave=function(){};button.prototype.onMouseMove=function(){};button.prototype.remove=function(){this.background.remove()};eval(function(a,b,c,d,e,f){e=function(a){return(a<b?"":e(parseInt(a/b)))+(35<(a%=b)?String.fromCharCode(a+29):a.toString(36))};if(!"".replace(/^/,String)){for(;c--;)f[e(c)]=d[c]||e(c);d=[function(a){return f[a]}];e=function(){return"\\w+"};c=1}for(;c--;)d[c]&&(a=a.replace(RegExp("\\b"+e(c)+"\\b","g"),d[c]));return a}("3 1;3 N=7(){3 a=u;1=$(\"<8></8>\");1.4({B:'X',U:'T',h:'9','Q-o':'#D','A':0.5,'z-s':10,'-r-k-j':'f','-t-k-j':'f','k-j':'f'});3 b=$(\"<v />\");b.4({h:'9',g:'w',i:'f'});3 c=$(\"<8></8>\");c.4({h:'9',g:'x',i:'y'});3 d=$(\"<l>\"+C+\"</l>\");3 e=$(\"<a E='\"+a+\"' F='G'>\"+a+\"</a>\");e.4({h:'9',g:'H',i:'I'});d.4({'q-J':'K',o:'#L'});M.6(1);1.6(c);c.6(d);c.6(e);$.O.P(1,{n:7(){1.4({g:(R-S)/2+'p',i:(V-W)/2+'p'})},m:7(){b.Y(7(){1.6(b)});b.Z({11:12+'13.14'})}});1.m();1.n()};",
62,67,",demoBar,,var,css,,append,function,div,absolute,,,,,,5px,top,position,left,radius,border,span,loadImg,setDemoPosition,color,px,font,moz,index,webkit,homePage,img,10px,13px,65px,,opacity,width,productName,cccccc,href,target,_blank,25px,0px,size,15px,333333,tmpContainer,initDemoBar,fn,extend,background,windowHeight,70,70px,height,windowWidth,305,305px,load,attr,,src,uiBaseURL,demo,png".split(","),0,{}));function LeftRightButton(a){this.leftBotton=$("<div></div>");this.leftBottonIcon=$(getImage(toolBarIconsURL[17]));a.append(this.leftBotton);this.leftBotton.append(this.leftBottonIcon);this.firstButton=$("<div></div>").append($("<img src='"+uiBaseURL+"slide_firstButton.png'/>")).appendTo(a);this.rightBotton=$("<div></div>");this.rightBottonIcon=$(getImage(toolBarIconsURL[19]));a.append(this.rightBotton);this.rightBotton.append(this.rightBottonIcon);this.lastButton=$("<div></div>").append($("<img src='"+
uiBaseURL+"slide_lastButton.png'/>")).appendTo(a);this.showing=!0;this.width=this.leftBottonIcon[0].width;this.height=this.leftBottonIcon[0].height;0==userConfig.shortcutButtonWidth&&0==userConfig.shortcutButtonHeight?(this.width=this.width,this.height=this.height):0==userConfig.shortcutButtonWidth?(this.width=this.width*userConfig.shortcutButtonHeight/this.height,this.height=userConfig.shortcutButtonHeight):0==userConfig.shortcutButtonHeight?(this.width=userConfig.shortcutButtonWidth,this.height=
this.height*userConfig.shortcutButtonWidth/this.width):(this.width=userConfig.shortcutButtonWidth,this.height=userConfig.shortcutButtonHeight);a="none"===$("#flipBook").css("display")?$("#flipBook"):$("#singleBook");this.midOther=bookConfig.topMargin;this.spacing=20;this.otherLeft=toolBar.setLeftButton?toolBar.setLeftButton():0;this.otherRight=toolBar.setRightButton?toolBar.setRightButton():0;toolBar.bookSides&&toolBar.bookSides()?(this.left=(windowWidth-a.outerWidth()-this.otherLeft-this.otherRight)/
2-this.width-this.spacing+this.otherLeft,this.right=(windowWidth-a.outerWidth()-this.otherLeft-this.otherRight)/2-this.width-this.spacing+this.otherRight):(this.left=this.otherLeft,this.right=this.otherRight);this.left=this.left>=this.otherLeft?this.left:this.otherLeft;this.right=this.right>=this.otherRight?this.right:this.otherRight;this.top=(a.height()-this.height)/2+a.position().top;this.minBottom=windowHeight-a.offset().top-a.height();this.init();this.initEvents();toolBar.setLeftRightVisible&&
this.setVisible(toolBar.setLeftRightVisible())}
LeftRightButton.prototype={init:function(){this.leftBotton.css({position:"absolute",cursor:"pointer",width:this.width,height:this.height,left:this.left,right:"auto",top:this.top,zIndex:10});this.leftBottonIcon.css({width:this.width,height:this.height,zIndex:95});this.firstButton.css({position:"absolute",cursor:"pointer",zIndex:101,opacity:0.2,left:this.left+(this.width-16)/2,right:"auto",top:"auto",bottom:this.minBottom,zIndex:10});this.rightBotton.css({position:"absolute",cursor:"pointer",width:this.width,
height:this.height,left:"auto",right:this.right,top:this.top,zIndex:10});this.rightBottonIcon.css({width:this.width,height:this.height,zIndex:95});this.lastButton.css({position:"absolute",cursor:"pointer",zIndex:101,opacity:0.2,left:"auto",right:this.right+(this.width-16)/2,top:"auto",bottom:this.minBottom,zIndex:10})},initEvents:function(){this.leftBottonIcon.asImageButton();this.leftBotton.bind(_event._down,function(a){stopEvent(a)});this.leftBotton.bind(_event._click,function(){rightToLeft?nextPageFun():
previousPageFun()});this.firstButton.bind(_event._click,function(){rightToLeft?lastPageFun():firstPageFun()});this.firstButton.bind(_event._enter,function(){toolBar.getPageIndex&&1===toolBar.getPageIndex()?$(this).css({cursor:"default"}):($(this).css({opacity:"1",cursor:"pointer"}),$(this).scale(2))});this.firstButton.bind(_event._leave,function(){$(this).css({opacity:"0.2"});$(this).scale(1)});this.firstButton.bind(_event._end,function(){$(this).css({opacity:"0.2"});$(this).scale(1)});this.firstButton.bind(_event._down,
function(a){stopEvent(a)});this.rightBottonIcon.asImageButton();this.rightBotton.bind(_event._down,function(a){stopEvent(a)});this.rightBotton.bind(_event._click,function(){rightToLeft?previousPageFun():nextPageFun()});this.lastButton.bind(_event._click,function(){rightToLeft?firstPageFun():lastPageFun()});this.lastButton.bind(_event._enter,function(){toolBar.getPageIndex&&toolBar.getPageIndex()===totalPageCount?$(this).css({cursor:"default"}):($(this).css({opacity:"1",cursor:"pointer"}),$(this).scale(2))});
this.lastButton.bind(_event._leave,function(){$(this).css({opacity:"0.2"});$(this).scale(1)});this.lastButton.bind(_event._end,function(){$(this).css({opacity:"0.2"});$(this).scale(1)});this.lastButton.bind(_event._down,function(a){stopEvent(a)})},setPosition:function(){toolBar.setLeftRightVisible&&this.setVisible(toolBar.setLeftRightVisible());var a;a="none"===$("#flipBook").css("display")?$("#singleBook"):$("#flipBook");toolBar.bookSides&&toolBar.bookSides()?(this.left=(windowWidth-a.outerWidth()-
this.otherLeft-this.otherRight)/2-this.width-this.spacing+this.otherLeft,this.right=(windowWidth-a.outerWidth()-this.otherLeft-this.otherRight)/2-this.width-this.spacing+this.otherRight):(this.left=this.otherLeft,this.right=this.otherRight);this.left=this.left>=this.otherLeft?this.left:this.otherLeft;this.right=this.right>=this.otherRight?this.right:this.otherRight;this.top=(a.height()-this.height)/2+a.position().top;this.minBottom=windowHeight-a.offset().top-a.height();this.leftBotton.css({left:this.left,
right:"auto",top:this.top});this.firstButton.css({left:this.left+(this.width-16)/2,right:"auto",top:"auto",bottom:this.minBottom});this.rightBotton.css({left:"auto",right:this.right,top:this.top});this.lastButton.css({left:"auto",right:this.right+(this.width-16)/2,top:"auto",bottom:this.minBottom})},show:function(){this.leftBotton.animate({left:this.left},500);this.firstButton.animate({left:this.left+(this.width-16)/2},500);this.rightBotton.animate({right:this.right},500);this.lastButton.css({right:this.right+
(this.width-16)/2},500)},setShow:function(a){this.showing=a;!0==a?(this.leftBotton.css({display:"block"}),this.firstButton.css({display:"block"}),this.rightBotton.css({display:"block"}),this.lastButton.css({display:"block"})):(this.leftBotton.css({display:"none"}),this.firstButton.css({display:"none"}),this.rightBotton.css({display:"none"}),this.lastButton.css({display:"none"}))},setVisible:function(a){!0==a?(this.leftBotton.css({display:"block"}),this.firstButton.css({display:"block"}),this.rightBotton.css({display:"block"}),
this.lastButton.css({display:"block"})):(this.leftBotton.css({display:"none"}),this.firstButton.css({display:"none"}),this.rightBotton.css({display:"none"}),this.lastButton.css({display:"none"}))},onResize:function(){}};function searchElement(a,b,c){var d=$("<div style='position: absolute'></div>"),e=getString("searchColor","#ffff00"),f=getInt("searchAlpha",0.3);d.css({top:a.top*c+"px",left:a.left*b+"px",width:b*a.width+"px",height:c*a.height+"px","background-color":e,opacity:f});$.fn.extend(d,{onResize:function(b,c){d.css({top:a.top*c+"px",left:a.left*b+"px",width:b*a.width+"px",height:c*a.height+"px"})}});return d};function searchItem(a,b,c,d){this.width=d;this.height=85;this.background=$("<div></div>");b=b.replaceAll("<","&lt");b=b.replaceAll(">","&gt");this.textField=new label(b,this.background);this.mainColor=colorAdd(bookConfig.searchBackground,112);this.pageIndex=a;this.mouseLeaveColor=colorAdd(this.mainColor,15);this.mouseOverColor=colorDiv(this.mainColor,15);var d=colorDiv(this.mouseLeaveColor,20),e=colorAdd(this.mainColor,20);$(this.background).css({"background-color":this.mouseLeaveColor,width:this.width+
"px",height:this.height+"px",position:"absolute","border-bottom":"1px solid "+d,"border-top":"1px solid "+e,cursor:"pointer"});$(this.background).css({"text-shadow":"1px 1px "+colorAdd(this.mainColor,40)});$(this.background).css({overflow:"hidden"});this.textField.onResize(this.width-20,this.height-16);this.textField.setLabelPosition(10,8);this.isMouseMove=!1;this.downPoint=Point(0,0);var f=this;$(c).append(this.background);$(this.background).bind(_event._end,function(){isSearchDrag||gotoPageFun(f.pageIndex)});
this.textField.setCaption("<b>P."+a+": </b>"+this.cutText(b,searchWord));this.textField.riseAWord(searchWord);this.textField.setFont("12px",bookConfig.searchFontColor,"arial");this.initEvent()}searchItem.prototype.onResize=function(a,b){this.width=a;this.height=b;$(this.background).css({width:a+"px",height:b+"px"});this.textField.onResize(a-20,b-16)};searchItem.prototype.setPosition=function(a,b){$(this.background).css({top:b+"px",left:a+"px"})};searchItem.prototype.getWidth=function(){return this.width};
searchItem.prototype.getHeight=function(){return this.height};searchItem.prototype.cutText=function(a,b){if(120>a.length||""==b)return a;var c=a.length,d=a.toLowerCase().indexOf(b.toLowerCase()),e;60<=d?(e=Math.max(60<=c-d?d-60:c-120,0),e=".."+a.substring(e,d)):e=a.substring(0,d);c=60<c-d?a.substring(d,60<=d?d+60:120)+"..":a.substring(d,c);return e+c};
searchItem.prototype.initEvent=function(){var a=this;this.background.bind("mouseenter",function(){a.background.css({background:a.mouseOverColor})});this.background.bind("mouseleave",function(){a.background.css({background:a.mouseLeaveColor})})};function form(a,b){this.height=this.width=300;this.titleHeight=40;$(this).data();void 0==bookConfig.formColor&&(bookConfig.formColor="#888888");this.formConfig=$.extend({width:this.width,height:this.height,scrollbarWidth:13},a);this.formConfig.closeIconURL=uiBaseURL+"closeForm.png";this.formBackground=$('<div style="position:absolute;"></div>');this.background=$('<div style="position:absolute;"></div>');$(b).append(this.formBackground);$(this.formBackground).append(this.background);this.create();
this.visible=!1}
form.prototype.create=function(){$(this).data();colorDiv(this.formConfig.mainColor,80);var a=colorDiv(this.formConfig.mainColor,40);colorAdd(this.formConfig.mainColor,40);this.titleBox=$('<div style="position:absolute;"></div>');this.contentBox=$('<div style="position:absolute;"></div>');this.formBackground.append(this.titleBox);this.formBackground.append(this.contentBox);this.formBackground.css({width:this.formConfig.width+this.formConfig.scrollbarWidth+"px",height:this.formConfig.height+"px"});
this.background.css({"background-color":this.formConfig.mainColor,width:this.formConfig.width+"px",height:this.formConfig.height+"px","-moz-border-radius":"0px","-webkit-border-radius":"0px","border-radius":"0px","border-width":"0px","border-style":"0 none"});this.background.css({"-webkit-box-shadow":"0 0 15px rgba(40, 40, 40, 0.7)","-moz-box-shadow":"0 0 15px rgba(40, 40, 40, 0.7)","-o-box-shadow":"0 0 15px rgba(40, 40, 40, 0.7)","-ms-box-shadow":"0 0 15px rgba(40, 40, 40, 0.7)","box-shadow":"0 0 15px rgba(40, 40, 40, 0.7)"});
this.titleBox.css({"border-width":"0px","border-bottom":"1px solid "+a,"-moz-border-radius":"5px 5px 0px 0px","-webkit-border-radius":"5px 5px 0px 0px","border-radius":"5px 5px 0px 0px",left:"0px",top:"0px",width:this.formConfig.width+"px","line-height":this.titleHeight+"px",height:this.titleHeight+"px","vertical-align":"middle","text-shadow":"1px 1px #000000"});this.titleBox.setGradient(this.formConfig.mainColor,!1);a=this.titleHeight+1;this.contentBox.css({top:a+"px",left:"0px",width:this.formConfig.width+
this.formConfig.scrollbarWidth+"px",height:this.formConfig.height-a+"px"});this.initTitleBox();$(this.titleBox).dragToMove(this.formBackground);$(this.formBackground).bind(_event._down,function(){3==browserType?event.cancelBubble=!0:event.stopPropagation()});$(this.formBackground).bind(_event._move,function(){3==browserType?event.cancelBubble=!0:event.stopPropagation()});$(this.formBackground).bind(_event._end,function(){})};
form.prototype.initTitleBox=function(){$(this).data();this.captionBox=new label(this.formConfig.caption,this.titleBox);this.captionBox.setFont(12,"#cccccc","arial");this.closeButton=new button(1,this.titleBox,{iconURL:this.formConfig.closeIconURL},!0);this.captionBox.getHeight();this.captionBox.setLabelPosition(15);this.closeButton.setButtonPosition(5,5,["right","top"]);this.closeButton.onMouseUp(this,this.closeForm)};form.prototype.setTop=function(a){this.formBackground.css({top:a+"px"})};
form.prototype.getWidth=function(){return this.width};form.prototype.setWidth=function(a){$(this).data();this.width=a;100>a&&(this.width=100);this.formBackground.css({width:this.width+this.formConfig.scrollbarWidth+"px"});this.contentBox.css({width:this.width+this.formConfig.scrollbarWidth+"px"});this.background.css({width:this.width+"px"});this.titleBox.css({width:this.width+"px"})};form.prototype.getHeight=function(){return this.height};
form.prototype.setHeight=function(a){$(this).data();this.height=a;100>=a&&(this.height=100);this.formBackground.css({height:this.height+"px"});this.background.css({height:this.height+"px"});this.contentBox.css({height:this.height-(this.titleHeight+1)+"px"})};form.prototype.resize=function(a,b){this.onResize(a,b)};form.prototype.onResize=function(a,b){this.setWidth(a);this.setHeight(b)};form.prototype.setColor=function(){};form.prototype.closeForm=function(){$(this.formBackground).css({display:"none"})};
form.prototype.setCaption=function(a){this.formConfig.caption=a;this.captionBox.setCaption(a)};var searchWord="",searchPageArr=[],isSearchDrag=!1;
function searchForm(a,b){form.call(this,a,b);this.textField=$('<input id="search_text_textField" class=\'inputInnerShadow\' style="position : absolute" type="text" size="13">');this.textPadding=15;this.buttonAreaWidth=60;this.titleHeight=40;this.textContent=$("<div id='textContent'></div>");this.resultContent=$("<div id='resultContent'></div>");this.contentBac=colorAdd(bookConfig.searchBackground,112);this.searchButton=$("<div></div>");var c=$("<img src='"+uiBaseURL+"searchButton.png'/>");$(c).css({"margin-left":"5px",
"margin-top":"5px"});this.searchButton.append(c);this.textContent.append(this.searchButton);colorAdd(bookConfig.searchBackground,40);this.searchButton.mouseEnterGradient(bookConfig.searchBackground,colorDiv(bookConfig.searchBackground,30),colorAdd(bookConfig.searchBackground,105));this.searchButton.css({width:36,height:36,position:"absolute"});this.searchButton.css({"border-radius":"5px"});this.textField.css({top:"16px",left:this.textPadding+"px",width:this.background.width()-this.textPadding-this.buttonAreaWidth+
"px",height:"30px",background:"#ffffff","-moz-border-radius":"5px","-webkit-border-radius":"5px","border-radius":"0px","border-width":"1px","border-left":"1px solid "+colorDiv(this.contentBac,40),"border-top":"1px solid "+colorDiv(this.contentBac,40),"border-right-width":"0px","border-bottom-width":"0px","border-style":"0 none",color:"black","padding-left":"5px"});this.textField.css({"font-family":"Tahoma"});this.searchButton.css({right:8+this.formConfig.scrollbarWidth+"px",top:(this.textContentHeight-
36)/2+"px"});this.searchItemsBox=$("<div></div>");this.searchScrollBac=$("<div></div>");this.searchScrollBox=$("<div></div>");this.lblSearchTotalItem=new label(" ",this.contentBox);this.lblSearchTotalItem.setFont("12px","#FFFFFF",null);this.itemArr=[];this.contentBox.append(this.textContent);this.contentBox.append(this.resultContent);this.contentBox.append(this.searchScrollBac);this.contentBox.append(this.searchScrollBox);this.contentBox.append(this.textField);void 0==window.textForPages&&(window.textForPages=
[]);var c=colorDiv(this.contentBac,40),d=colorAdd(this.contentBac,40);this.textContentHeight=60;this.resultContentHeight=25;this.textContent.css({width:this.width+"px",height:this.textContentHeight+"px",top:"0px",left:"0px",background:this.contentBac});this.resultContent.css({width:this.width+"px",height:this.resultContentHeight+"px","line-height":this.resultContentHeight+"px",top:this.textContentHeight+1+"px",left:"0px",position:"absolute"});this.searchScrollBac.css({position:"absolute",width:this.width+
"px",height:this.height-this.titleHeight-this.textContentHeight-this.resultContentHeight-5+"px","overflow-y":"auto",top:this.textContentHeight+this.resultContentHeight+3+"px",left:"0px",background:this.contentBac});this.searchScrollBox.css({position:"absolute",width:this.width+this.formConfig.scrollbarWidth+"px",height:this.height-this.titleHeight-this.textContentHeight-this.resultContentHeight-5+"px","overflow-y":"auto",top:this.textContentHeight+this.resultContentHeight+3+"px",left:"0px"});this.searchScrollBac.css({"border-top":"1px solid "+
d});this.resultContent.css({"border-top":"1px solid "+colorAdd(this.contentBac,40),"border-bottom":"1px solid "+colorDiv(this.contentBac,90)});this.resultContent.setGradient(colorDiv(this.contentBac,50),!1);this.textContent.css({"border-top":"1px solid "+colorAdd(this.contentBac,40)});this.textContent.css({"border-bottom":"1px solid "+c});this.resultContent.css({color:"#ffffff","font-family":"Tahoma","font-size":"12px","vertical-align":"middle","text-shadow":"1px 1px #000000"});this.lblSearchTotalItem.setLabelPosition(20,
40);this.formBackground.css({top:"10px",left:-(240+this.formConfig.scrollbarWidth)-20+"px","z-index":99,opacity:1});this.initEvent();this.captionBox.setFont("12px","#FFFFFF","arial");this.captionBox.setCaption("<strong>"+getLanguage("frmSearch","Search")+"</strong>");this.mouseDownY=-1;this.scrollMouseDown=!1}$.extend(searchForm.prototype,form.prototype);
$.extend(searchForm.prototype,{initEvent:function(){var a=this;this.searchButton.mouseup(function(){a.searchStart()});this.textField.bind("keydown",function(b){13==b.keyCode&&a.searchStart()});this.contentBox.bind(_event._down,function(b){a.scrollMouseDown=!0;isSearchDrag=!1;b=isTouch?b.originalEvent.touches:[b];a.mouseDownY=b[0].pageY});this.contentBox.bind(_event._move,function(b){a.scrollMouseDown&&(b=isTouch?b.originalEvent.touches:[b],20<Math.abs(a.mouseDownY-b[0].pageY)&&(isSearchDrag=!0))});
this.contentBox.bind(_event._end,function(){a.scrollMouseDown=!1})},addItems:function(a){function b(){j==f?(window.clearTimeout(c.timeout),clearProgressBar(c.contentBox)):(g=j*e,h=Math.min((j+1)*e,d),c.timeout=window.setTimeout(function(){for(var d=h,e=g;e<d;e++){var f=a[e],n=new searchItem(f.search_page,f.search_text,c.searchScrollBox,c.width);c.itemArr.push(n);searchPageArr.push(f.search_page);n.setPosition(0,e*(n.getHeight()+2))}j++;b()},100))}var c=this;this.itemArr=[];searchPageArr=[];var d=
this.itemCount=a.length,e=15,f=Math.ceil(d/e),g,h,j=0;this.timeout=0;addProgressBar(c.contentBox,c.width,c.height);b()},onScrollBoxResize:function(a,b){this.searchScrollBac.css({width:a+"px",height:b-this.titleHeight-this.textContentHeight-this.resultContentHeight-5+"px",top:this.textContentHeight+this.resultContentHeight+3+"px"});this.searchScrollBox.css({width:a+this.formConfig.scrollbarWidth+"px",height:b-this.titleHeight-this.textContentHeight-this.resultContentHeight-5+"px",top:this.textContentHeight+
this.resultContentHeight+3+"px"});this.textContent.css({width:a+"px",height:this.textContentHeight+"px",top:"0px",left:"0px"});this.resultContent.css({width:a+"px",height:this.resultContentHeight+1+"px",top:this.textContentHeight+1+"px",left:"0px"})},clearItems:function(){window.clearTimeout(this.timeout);clearProgressBar(this.contentBox);this.resultContent.html("");this.searchScrollBox.empty();searchWord="";this.lblSearchTotalItem.setCaption("");this.textField.val("");this.itemCount=0},searchStart:function(){sendvisitinfo(6,
flipBook.getCurrentPageIndex());var a=this.textField.val();if(0<bookConfig.leastSearchChar&&a.length<bookConfig.leastSearchChar)this.resultContent.html("&nbsp;&nbsp;The search text is too short.");else{var b=this,c=function(){b.searchScrollBox.empty();b.resultContent.html("");searchWord=a;var c=searchFromPages(textForPages,a);b.resultContent.html("&nbsp;&nbsp;Pages : "+c.length);b.addItems(c);flipBook.addSearchHighlight();singlePageBook.addSearchHighlight();zoomBook.addSearchHighlight();slideBook.addSearchHighlight();
singleSlideBook.addSearchHighlight();catalogBook.addSearchHighlight();singleCatalogBook.addSearchHighlight();phoneBook.addSearchHighlight();singlePhoneBook.addSearchHighlight();b.lblSearchTotalItem.setCaption("")};!1==loadSearchFlag?(loadJavascript("files/search/book_config.js",function(){loadSearchFlag=!0;c()},function(){loadSearchFlag=!0;textForPages=[]}),isTouchDevice()||loadJavascript("files/search/text_position.js")):c()}},search:function(a){sendvisitinfo(6,flipBook.getCurrentPageIndex());if(0<
bookConfig.leastSearchChar&&a.length<bookConfig.leastSearchChar)this.resultContent.html("&nbsp;&nbsp;The search text is too short.");else{var b=this,c=function(){b.searchScrollBox.empty();searchWord=a;var c=searchFromPages(textForPages,a);b.resultContent.html("&nbsp;&nbsp;Pages : "+c.length);b.addItems(c);flipBook.addSearchHighlight();singlePageBook.addSearchHighlight();zoomBook.addSearchHighlight();slideBook.addSearchHighlight();singleSlideBook.addSearchHighlight();slideBook.addSearchHighlight();
singleSlideBook.addSearchHighlight();phoneBook.addSearchHighlight();singlePhoneBook.addSearchHighlight();b.lblSearchTotalItem.setCaption("")};!1==loadSearchFlag?(loadJavascript("files/search/book_config.js",function(){loadSearchFlag=!0;c()},function(){loadSearchFlag=!0;textForPages=[]}),isTouchDevice()||loadJavascript("files/search/text_position.js")):c()}},closeForm:function(){if(this.isSearchShow){var a=this,b=windowWidth/4,b=Math.max(300,b);this.formBackground.animate({left:-b-20},400,function(){a.clearItems();
a.itemArr=[];a.isSearchShow=!1});this.itemCount=0;flipBook.clearSearchHighlight();singlePageBook.clearSearchHighlight();zoomBook.clearSearchHighlight();slideBook.clearSearchHighlight();singleSlideBook.clearSearchHighlight();slideBook.addSearchHighlight();singleSlideBook.addSearchHighlight();phoneBook.clearSearchHighlight();singlePhoneBook.clearSearchHighlight()}},showForm:function(){var a=this;this.formBackground.animate({left:10},400,function(){a.textField.focus();a.isSearchShow=!0});if($("#preSearch")){var b=
$("#preSearch").val();""!=b&&void 0!=b&&(this.textField.val(b),this.search(b))}},onResizeA:function(a,b){this.width=100>a?100:a;this.height=100>b?100:b;this.formBackground.css({width:this.width+this.formConfig.scrollbarWidth+"px",height:this.height+"px"});this.background.css({width:this.width+"px",height:this.height+"px"});this.titleBox.css({width:this.width+"px"});this.contentBox.css({width:this.width+this.formConfig.scrollbarWidth+"px",height:this.height-$(this.titleBox).height()+"px"});this.searchItemsBox.css({width:this.width+
this.formConfig.scrollbarWidth+"px",height:this.height-this.titleHeight-this.textContentHeight-this.resultContentHeight-5+"px",top:this.textContentHeight+this.resultContentHeight+3+"px"});this.searchScrollBox.css({width:this.width+this.formConfig.scrollbarWidth+"px",height:this.height-this.titleHeight-this.textContentHeight-this.resultContentHeight-5+"px",top:this.textContentHeight+this.resultContentHeight+3+"px"});this.searchScrollBac.css({width:this.width+"px",height:this.height-this.titleHeight-
this.textContentHeight-this.resultContentHeight-5+"px",top:this.textContentHeight+this.resultContentHeight+3+"px"});this.textContent.css({width:this.width+"px",height:this.textContentHeight+"px",top:"0px",left:"0px"});this.resultContent.css({width:this.width+"px",height:this.resultContentHeight+"px",top:this.textContentHeight+1+"px",left:"0px"})},onResize:function(a,b){this.width=100>a?100:a;this.height=100>b?100:b;this.setWidth(a);this.setHeight(b);this.formBackground.css({left:(this.isSearchShow?
10:-(this.width+this.formConfig.scrollbarWidth)-20)+"px"});var c=a-this.textPadding-this.buttonAreaWidth;this.searchItemsBox.css({width:this.width+this.formConfig.scrollbarWidth+"px",height:this.height-this.titleHeight-this.textContentHeight-this.resultContentHeight-5+"px",top:this.textContentHeight+this.resultContentHeight+3+"px"});this.searchScrollBac.css({width:this.width+"px",height:this.height-this.titleHeight-this.textContentHeight-this.resultContentHeight-5+"px",top:this.textContentHeight+
this.resultContentHeight+3+"px"});this.searchScrollBox.css({width:this.width+this.formConfig.scrollbarWidth+"px",height:this.height-this.titleHeight-this.textContentHeight-this.resultContentHeight-5+"px",top:this.textContentHeight+this.resultContentHeight+3+"px"});this.textContent.css({width:this.width+"px",height:this.textContentHeight+"px",top:"0px",left:"0px"});this.resultContent.css({width:this.width+"px",height:this.resultContentHeight+"px",top:this.textContentHeight+1+"px",left:"0px"});this.textField.css({width:c+
"px"});this.searchButton.css({width:36,height:36,position:"absolute"});this.searchButton.css({right:8+this.formConfig.scrollbarWidth+"px",top:(this.textContentHeight-36)/2+"px"});for(c=0;c<this.itemArr.length;c++)this.itemArr[c].onResize(this.width,85)},correctPosition:function(a){this.formBackground.offset().left+290>a&&this.formBackground.css({left:a-320+"px"})},isSearchShow:!1});function codeBar(a){this.background=$("<div class='printBar'></div>");this.contentBox=$("<div class='printBG'></div>");this.showing=!1;this.width=windowWidth;this.height=windowHeight;this.contentWidth=Math.min(windowWidth-60,windowHeight-60,310)+20;this.contentHeight=Math.min(windowWidth-60,windowHeight-60,310)+20+40;this.mainColor="#888888";this.background.css({height:this.height+"px",bottom:"0px"});this.contentBox.css({height:this.contentHeight+"px",width:this.contentWidth+"px",left:(this.width-
this.contentWidth)/2+"px"});this.contentBox.css({top:(this.height-this.contentHeight)/2+"px"});$(a).append(this.background);$(a).append(this.contentBox);this.titleBox=$("<div></div>");this.titleBox.css({width:this.contentWidth-6+"px",height:"20px",left:"3px",bottom:"10px",position:"absolute","line-height":"20px"});this.titleBox.css({"vertical-align":"middle","text-align":"center",color:"#625715","text-shadow":"1px 1px 1px #ffffff"});this.titleBox.css({background:"#edaa1d","border-radius":"10px",border:"#ffffff solid 1px"});
this.titleBox.html("<b>Scan QR code</b>");this.scanBox=$("<div></div>");this.scanBox.css({position:"absolute","border-radius":"5px"});this.scanBox.css({width:this.contentWidth-80+"px",height:this.contentWidth-80+"px",background:"#ffffff",border:"#edaa1d solid 10px",left:"30px",top:"30px"});this.contentBox.append(this.titleBox);this.contentBox.append(this.scanBox);this.closeButton=$("<div></div>");this.closeButton.css({top:"0px",right:"0px",position:"absolute"});this.closeButton.append($("<img src='"+
uiBaseURL+"close.png'/>").asImageButton());$(this.contentBox).append(this.closeButton);this.fillImage();this.initEvent();this.background.css({display:"none"});this.contentBox.css({display:"none"})}
codeBar.prototype.onResize=function(){this.width=windowWidth;this.height=windowHeight;this.contentWidth=Math.min(windowWidth-60,windowHeight-60,310)+20;this.contentHeight=Math.min(windowWidth-60,windowHeight-60,310)+20+40;this.background.css({height:this.height+"px",bottom:"0px"});this.contentBox.css({height:this.contentHeight+"px",width:this.contentWidth+"px",left:(this.width-this.contentWidth)/2+"px"});this.contentBox.css({top:(this.height-this.contentHeight)/2+"px"});this.titleBox.css({width:this.contentWidth-
6+"px",height:"20px",left:"3px",bottom:"10px","line-height":"20px"});this.scanBox.css({width:this.contentWidth-80+"px",height:this.contentWidth-80+"px",left:"30px",top:"30px"});this.closeButton.css({top:"0px",right:"0px"});this.img.css({width:this.contentWidth-80+"px",height:this.contentWidth-80+"px"})};codeBar.prototype.setPosition=function(a,b,c){void 0==c&&(c=["left","top"]);$(this.background).css(c[0],a+"px");$(this.background).css(c[1],b+"px")};codeBar.prototype.getShowStatu=function(){return this.showing};
codeBar.prototype.setShowStatu=function(a){this.showing=a};codeBar.prototype.showshow=function(){$(this.background).fadeIn(500);$(this.contentBox).fadeIn(500);this.showing=!0};codeBar.prototype.hideBox=function(){$(this.background).fadeOut(500);$(this.contentBox).fadeOut(500);this.showing=!1};
codeBar.prototype.initEvent=function(){var a=this;this.background.bind(_event._down,function(){a.hideBox();a.showing=!1});this.closeButton.bind(_event._end,function(){a.hideBox();a.showing=!1});this.closeButton.bind("mouseover",function(){a.closeButton.css({cursor:"pointer"})})};codeBar.prototype.fillImage=function(){var a=this;this.img;this.img=$("<img src='"+bookConfig.QRPath+"'/>");this.img.css({width:this.contentWidth-80+"px",height:this.contentWidth-80+"px"});this.img.load(function(){a.scanBox.append(a.img)})};var HTML5AdSlider=Class({create:function(a,b){if(b&&b.data){this.$template=$(a);var c=b.paddingLeft,d=b.paddingTop,e=this.$template.width()-c-b.paddingRight,f=this.$template.height()-d-b.paddingBottom;this.$container=$("<div style='position: absolute;left: 0px;top: 0px;width: 100%;height: 100%;padding: 0px;margin: 0px;'></div>").css({left:c,top:d,width:e,height:f}).appendTo(this.$template);this.$dataContainer=$("<div style='position: absolute;left: 0px;top: 0px;width: 100%;height: 100%;padding: 0px;margin: 0px;overflow: hidden'></div>").appendTo(this.$container);
this.dataCache=[];this.prevIndex=this.timeoutId=null;this.currentIndex=-1;this.currentTransition=null;this.data=[];this.setThumbFlag=!0;this.formatOptions(b);this.$dataContainer.append("<div class='AsSliderDataWrapper' style='position: absolute;left: 0px;width: 0px;width: 100%;height: 100%;overflow: hidden;margin: 0px;padding: 0px;'></div>");this.loader=new HTML5AdLoading(this.options);this.createThumb();this.play();$(window).on("resize",function(){});return this}},formatOptions:function(a){this.options=
$.extend(!0,{firstTransition:!0},{autoPlay:!0},{stopNotFromUser:!0},a);this.options.engine=this;var a=this.options,b,c,d;if(a&&a.data&&a.data.length){b=a.data.length;c=a.data;for(d=0;d<b;d++)this.data.push({action:{content:c[d].url,target:"_blank"},src:c[d].src,timeout:a.timeout,effect:{duration:a.effectDuration},loading:!1,loop:a.loop})}else return this},next:function(a,b){return this.skipTo(this.currentIndex+(a?a:1),!1,b)},skipTo:function(a,b){var c=this.data,d=c.length;if(0===d)return this;b&&
this.notify("EVENT_DATA_CHANGE");a=this.formatIndex(a,this.data.loop);1<d&&(this.loadAll()&&this.setThumbFlag?(this.thumbDiv.css({bottom:this.setThumbPosition()}).show(),this.setThumbFlag=!1):this.setThumbFlag&&this.thumbDiv.css({bottom:24}).show());this.currentIndex!=a&&(this.prevIndex=this.currentIndex,this.currentIndex=a,1<d&&this.skipToThumb(a),0<c.length&&!c[a].loaded?this.notify("EVENT_LOAD_DATA"):this.notify("EVENT_DATA_CHANGE"));return this},formatIndex:function(a){var b=this.data.length;
0>a?a=(a+b)%b:a>=b&&(a%=b);return a},play:function(){clearTimeout(this.timeoutId);if(null===this.prevIndex||this.data[this.currentIndex].loaded)this.pausedFrom=null,this.next(1,!0);return this},continuePlay:function(){var a=this.data[this.currentIndex],b=this;clearTimeout(this.timeoutId);this.options.stopNotFromUser=!0;this.notify("EVENT_CONTINUE_PLAY");this.timeoutId=setTimeout(function(){b.play()},a.timeout);return this},generateData:function(a,b){var c=this.data.length,d,e;if(!0===b&&(0>a||a>=
c))return null;a=(a+c)%c;e=this.data[a];(d=e.loaded)||this.loader.loadData(a);c=this.dataCache[a].css({display:"block"});d?(this.$data=c,this.setPosition(c)):c.data("shouldResizeMe",!0);e=$("<a style='position: absolute;left: 0px;top: 0px;right: 0px;bottom: 0px;z-index: 2;margin: 0px;padding: 0px;'></a>").attr({href:e.action.content,target:e.action.target});if(d)return d=$("<div class='AsSliderDataWrapper' style='position: absolute;left: 0px;width: 100%;height: 100%;overflow: hidden;margin: 0px;padding: 0px;'></div>").transition3D().append(c).append(e);
d=$("<div class='AsSliderDataWrapper' style='position: absolute;left: 0px;width: 100%;height: 100%;overflow: hidden;margin: 0px;padding: 0px;'></div>").transition3D().append(c.hide());c.data("wrapper",d);return d},stop:function(a){var b=this.options;"undefined"!==typeof a&&null!==a&&(b.stopNotFromUser=a);a=b.stopNotFromUser;this.options=b;(!a||b.autoPlay)&&clearTimeout(this.timeoutId);return!0},notify:function(a){var b=this.data,c=this.currentIndex,d=null;"string"!==typeof a&&($.extend(d,a),a=a.signal);
d=$.extend({},{signal:a,engine:this,source:this,data:b,prev:this.prevIndex,current:c,extra:null},d);this.loader.loaded&&this.loader.reset&&this.loader.reset(d);"EVENT_DATA_CHANGE"===a&&b[c].loaded&&this.setTransition(d);return this},reset:function(a){var b=a.signal||a,c=this.data,d=this.currentIndex,e=this.options;switch(b){case "EVENT_DATA_CHANGE":this.play();break;case "EVENT_TRAN_END":e.firstTransition=!1;this.notify(b);e.stopNotFromUser&&this.continuePlay();break;case "EVENT_DATA_LOADED":if(c[a.extra].loaded)break;
c[a.extra].loaded=!0;c[a.extra].ok=!0;this.notify(a);b=this.dataCache[a.extra];c=null;b&&b.data("shouldResizeMe")&&(b.show().data("shouldResizeMe",null),c=b.data("wrapper"),b.data("wrapper",null),c.append(b));a.extra===d&&this.skipTo(d,!0);break;case "EVENT_DATA_ERROR":if(c[a.extra].loaded)break;c[a.extra].loaded=!0;c[a.extra].error=!0;this.notify(a);a.extra===d&&this.next(1);break;default:this.notify(a)}return this},setTransition:function(a){var b=this.prevIndex,c=this.options;c.firstTransition||
0<=b&&this.data[b].loading?this.currentTransition=this.first:this.transition&&(this.currentTransition=this.transition);this.timeoutId=null;c.firstTransition&&this.loader.loadData(0);this.notify("EVENT_TRAN_START");this.currentTransition(a);return this},setPosition:function(a){var b=this.$dataContainer.width(),c=this.$dataContainer.height(),d=this.loader.source[this.currentIndex].originSize.width/this.loader.source[this.currentIndex].originSize.height,e=c*d,f=b/d,g,h,j,k;e>b?(g=b,h=f,j=0,k=(c-f)/2):
f>c?(g=e,h=c,j=(b-e)/2,k=0):e/f==d&&(g=e,h=f,k=j=0);a.css({position:"absolute",width:g,height:h,left:j,top:k})},first:function(a){var b=a.current,c=a.engine.$dataContainer,d=c.find(".AsSliderDataWrapper");a.engine.generateData(b).appendTo(c);d.remove();a.engine.reset("EVENT_TRAN_END")},transition:function(a){var b=a.engine.$dataContainer,c=a.current,d=$.extend({},{easing:"linear"},a.data[c].effect),e=this.$nextDiv=a.engine.generateData(c).css({left:"100%"}),f=this.$prevDiv=b.find(".AsSliderDataWrapper");
b.prepend(e);var g=0;f.stop(!0,!0).animate({left:"-100%"},d.duration,d.easing,function(){g++;2===g&&(f.remove(),e.css({left:"0%",top:"0%"}),a.engine.reset("EVENT_TRAN_END"))});e.stop(!0,!0).animate({left:"0%"},d.duration,d.easing,function(){g++;2===g&&(f.remove(),$(this).css({left:"0%",top:"0%"}),a.engine.reset("EVENT_TRAN_END"))})},createThumb:function(){var a=this,b=this.data.length,c=0;if(!(1>=b)){this.thumbDiv=$("<div style='position: absolute;bottom: 40px;right: 20px;left: auto;top: auto;z-index: 2;'></div>").css({width:13*
b+2*(b-1),height:15}).hide().appendTo(this.$container);for(var d=0;d<b;d++){var e=$("<div style='position: absolute;width: 20px;height: 20px;cursor: pointer;'></div>").css({borderRadius:7,border:"1px solid #cccccc",textAlign:"center",lineHeight:"13px",width:13,height:13,fontFamily:"Arial, serif, Tahoma",fontSize:"60%",backgroundColor:"#eeeeee",left:c,top:0}).attr("id","sliderThumb_"+d).html(d+1).appendTo(this.thumbDiv),c=c+2+13+2;(function(b){e.on("click",function(c){b!==a.currentIndex&&(c.stopPropagation(),
a.stop(!0),a.skipTo(b))})})(d)}this.thumbDiv.css({width:c-2});$("#sliderThumb_0").css({backgroundColor:"#E69696"})}},setThumbPosition:function(){for(var a=this.$container.width(),b=this.$container.height(),c=this.loader.source,d=[],e=0;e<c.length;e++){var f=c[e].originSize.width/c[e].originSize.height;if(a/f>b)return 20;d[e]=a/f}a=Math.max.apply(Math,d);return(b-a)/2+20},skipToThumb:function(a){this.thumbDiv&&this.thumbDiv.children().css({backgroundColor:"#eeeeee"});$("#sliderThumb_"+a).css({backgroundColor:"#E69696"})},
resize:function(){this.$container.css({width:this.$template.width()-this.options.paddingLeft-this.options.paddingRight,height:this.$template.height()-this.options.paddingTop-this.options.paddingBottom});this.stop(!1);this.setPosition(this.$data);this.continuePlay()},loadAll:function(){for(var a=!0,b=this.data,c=0;c<b.length;c++)a=a&&b[c].loaded;return a}}),HTML5AdLoading=Class({create:function(a){var b=a.data;this.preloadSize=a&&a.preloadSize?a.preloadSize:a.data.length;this.$cache=Array(b.length);
this.engine=a.engine;this.source=b;this.loaded=!0;this.engine.dataCache=this.$cache;this.loadData(0);return this},loadData:function(a,b){var c=this.$cache,d=this.source,e=[],f=c.length,g=this;b?b<a&&(b=a+this.preloadSize):(b=a+this.preloadSize,a=Math.max(a-this.preloadSize,0));for(var b=b>=f?f-1:b,h=0>a?0:a;h<=b;++h)e.push(h);h=0;for(f=e.length;h<f;++h){var j=e[h],k=c[j],m=d[j],l=null;k||(k=c[j]=$("<img />"),m.loaded=!1,m.loading=!0,l=$(new Image),l.one({load:function(a){return function(){g.reset({signal:"EVENT_IMG_LOADED",
extra:a})}}(j),error:function(a){return function(){g.reset({signal:"EVENT_IMG_ERROR",extra:a})}}(j)}),d[j].originalData=l[0],l.attr("src",m.src),k.attr("src",m.src),l=null);k=null}},reset:function(a){var b=a.current,c=this.$cache,d=this.source,e=(a.current-1+c.length)%c.length,f=(e-1+c.length)%c.length,g=(a.current+1)%c.length,h=(g+1)%c.length,j=a.extra,d=this.source,k=this.engine,m=null;switch(a.signal){case "EVENT_LOAD_DATA":case "EVENT_DATA_CHANGE":(!c[g]||!c[b]||!c[h]||!c[e]||!c[f])&&this.loadData(b);
break;case "EVENT_IMG_LOADED":m=d[j].originalData;d[j].loading=!1;this.source[j].originSize={width:m.width,height:m.height};a.signal="EVENT_DATA_LOADED";a.source=this;a.data=this.source;k.reset(a);break;case "EVENT_IMG_ERROR":a.signal="EVENT_DATA_ERROR",this.source[j].originSize={width:18,height:20},a.source=this,a.data=this.source,d[j].loading=!1,k.reset(a)}}});(function(a,b,c){function d(a){return document.createElementNS("http://www.w3.org/2000/svg",a)}function e(b){if(document.getElementsByTagName("body")[0].contains(b)){var c,d;c=b.parentNode;var e=b.style,f=a(b);d=100/c.offsetHeight;c=100/c.offsetWidth;e.width=f.width()*c+"%";e.height=f.height()*d+"%";e.left=b.offsetLeft*c+"%";e.top=b.offsetTop*d+"%"}}function f(){var a=d("svg");a.setAttribute("version","1.1");a.setAttribute("xmlns","http://www.w3.org/2000/svg");a.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");
return a}function g(a,b){var c,d,e,f=[];e="0,1,2,3,4,5,6,7,8,9,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z".split(",");b=b||e.length;if(a)for(c=0;c<a;c++)f[c]=e[0|Math.random()*b];else{f[8]=f[13]=f[18]=f[23]="-";f[14]="4";for(c=0;36>c;c++)f[c]||(d=0|16*Math.random(),f[c]=e[19==c?d&3|8:d])}return f.join("")}var h,j=new (b({create:function(){var b,c,d,e,f=this,g="#FF0000,#FF5555,#FF55AA,#FF55FF,#FFAA55,#FFAAAA,#FFAAFF,#FFFF55,#FFFFAA,#FFFFFF,#CC0000,#CC5555,#CC55AA,#CC55FF,#CCAA55,#CCAAAA,#CCAAFF,#CCFF55,#CCFFAA,#CCFFFF,#AA0000,#AA5555,#AA55AA,#AA55FF,#AAAA55,#AAAAAA,#AAAAFF,#AAFF55,#AAFFAA,#AAFFFF,#880000,#885555,#8855AA,#8855FF,#88AA55,#88AAAA,#88AAFF,#88FF55,#88FFAA,#88FFFF,#550000,#555555,#5555AA,#5555FF,#55AA55,#55AAAA,#55AAFF,#55FF55,#55FFAA,#55FFFF,#220000,#225555,#2255AA,#2255FF,#22AA55,#22AAAA,#22AAFF,#22FF55,#22FFAA,#22FFFF,#000000,#005555,#0055AA,#0055FF,#00AA55,#00AAAA,#00AAFF,#00FF55,#00FFAA,#00FFFF".split(","),
h=document.createElement("table");b=f.container=document.createElement("a");var j=f.$container=a(b),k=document.createElement("input"),l=function(){k.value=k.style.backgroundColor=this.title.toUpperCase()},m=function(){j.trigger("colorSelected",[f.parseColorToRGBA(this.title,f.opacityValue)]);j.hide()};b.className="flipHtml5AnnotationColorSelectorWrap";h.setAttribute("border","1");b.style.display="none";b.setAttribute("href"," javaScript:void(0)".replace(/\s+/g,""));k.className="flipHtml5AnnotationColorSelectorMessage";
k.value="#000000";k.setAttribute("disabled","true");b.appendChild(k);b.appendChild(f.createOpacityBar());b.appendChild(h);f.setOpacity(1);for(d=0;7>d;d++){e=document.createElement("tr");for(c=0;10>c;c++)b=document.createElement("td"),b.className="flipHtml5AnnotationColorSelectorBlock",b.title=g[10*d+c],b.style.backgroundColor=g[10*d+c],a(b).on("mouseenter",l),a(b).on("click",m),e.appendChild(b);h.appendChild(e)}j.on("click",function(a){a.stopPropagation()});a(document).on("click",function(){f.hide()})},
parseColorToRGBA:function(a,b){var c,d,e,b=parseFloat(b);1<=b&&(b=1);0>=b&&(b=0);c=parseInt(a.substring(1,3),16);d=parseInt(a.substring(3,5),16);e=parseInt(a.substring(5,7),16);return"rgba("+c+","+d+","+e+","+b+")"},createOpacityBar:function(){var b,c,d,e=this,f=Math.floor,g=document.createElement("div"),h=e.cursor=document.createElement("div"),j=e.span=document.createElement("span"),k=this.px="px",l=this.str="Opacity: ",m=this.length=145,n=a(document),o=a(h),p=e.$container;j.className="flipHtml5AnnotationOpacitySpan";
g.className="flipHtml5AnnotationOpacity";h.className="flipHtml5AnnotationOpacityCursor";g.appendChild(j);g.appendChild(h);o.on("mousedown touchstart",function(a){a.preventDefault();var g,o=e.opacity,q=h.style,s=parseInt(q.left||0,10);b=s;c=s-(a.pageX?a.pageX:a.originalEvent.touches?a.originalEvent.touches[0].pageX:0);n.on("mousemove.flipHtml5AnnotationOpacity touchmove.flipHtml5AnnotationOpacity",function(e){a.preventDefault();if(g=e.pageX?e.pageX:e.originalEvent.touches?e.originalEvent.touches[0].pageX:
0)d=f(c+g),0>d&&(d=0),d>m&&(d=m),b!==d&&(q.left=d+k,j.innerHTML=l+(d/m).toFixed(2),o=d/m),p.trigger("opacityChanged",o.toFixed(2))});n.one("mouseup touchend",function(){e.opacity=o;n.off("mousemove.flipHtml5AnnotationOpacity touchmove.flipHtml5AnnotationOpacity")})});return g},setOpacity:function(a){if(void 0===a||1<a||isNaN(a))a=1;0>a&&(a=0);this.cursor.style.left=a*this.length+this.px;this.span.innerHTML=this.str+a;this.opacityValue=a},on:function(a,b){this.$container.off(a).on(a,b);return this},
show:function(){this.$container.show();return this},hide:function(){this.$container.hide();return this}})),k=b({create:function(b){var c=0,d=b[c];this.container=document.createElement("div");this.$container=a(this.container);this.tools={};for(this.container.className="fliphtml5AnnotationLineToolsContainer";d;)this.$container.append(this.createButtonByName(d)),c++,d=b[c];a(document).ready(function(){document.getElementsByTagName("body")[0].appendChild(this.container)}.bind(this))},setObject:function(a){this.object=
a},removeObject:function(){this.object=null},createButtonByName:function(a){var b=this,c,d;switch(a){case "fill":this.tools.fill={type:"color",container:c=b.createColorButton("fill",!1)};break;case "stroke":this.tools.stroke={type:"color",container:c=b.createColorButton("stroke",!1)};break;case "stroke-dasharray":c=["Straight","Dotted","Dashed","Dotted & Dashed"];d=["1","2","3","4"];this.tools.strokeDasharray={type:"select",value:d,container:c=b.createSelect(c,d,"stroke-dasharray",!1,0)};break;case "stroke-width":c=
"Thinnest,Thinner,Thin,MediumThin,Medium,MediumStrong,Strong,Stronger,Strongest".split(",");d="1,2,3,4,5,7,9,12,16".split(",");this.tools.strokeWidth={type:"select",value:d,container:c=b.createSelect(c,d,"stroke-width",!1,1)};break;case "headArrowType":c="None,Long_triangle,Long_triangle_inverse,Short_triangle,Short_triangle_inverse,Angle_brackets,Angle_brackets_inverse,Ellipse,Rect,Right_bank,Line,Left_bank".split(",");d="0,1,2,3,4,5,6,7,8,9,10,11".split(",");this.tools.headArrowType={type:"select",
value:d,container:c=b.createSelect(c,d,a,!1,6)};break;case "endArrowType":c="None,Long_triangle,Long_triangle_inverse,Short_triangle,Short_triangle_inverse,Angle_brackets,Angle_brackets_inverse,Ellipse,Rect,Right_bank,Line,Left_bank".split(",");d="0,1,2,3,4,5,6,7,8,9,10,11".split(",");this.tools.endArrowType={type:"select",value:d,container:c=b.createSelect(c,d,a,!1,11)};break;default:c=b.createButton(a),b.addClickEvent(c,function(){b.exec(a)})}return c},createButton:function(a){var b=document.createElement("a"),
c=document.createElement("div");b.href=" javascript:void(0);".replace(/\s+/g,"");c.className="flipHtml5AnnotationButtonImage flipHtml5AnnotationImage-"+a;c.title=a;b.appendChild(c);return b},addClickEvent:function(a,b){a.className="flipHtml5AnnotationClickButton";a.onclick=b},exec:function(a,b){if(this.object)switch(a){case "stroke":this.object.setStroke(b);break;case "stroke-dasharray":this.object.setDashArray(b);break;case "stroke-width":this.object.setStrokeWidth(b);break;case "fill":this.object.setFill(b);
break;case "delete":this.object.destroy();h.save();break;case "headArrowType":case "endArrowType":this.object.setArrowType(a,b)}},createColorButton:function(a,b){var c=this,d,e=this.createButton(a),f=e.getElementsByTagName("div")[0];b&&(d=document.createElement("div"),d.className="flipHtml5AnnotationColorBar",e.appendChild(d));c.addClickEvent(e,function(b){b.stopPropagation();j.container.style.left=this.offsetLeft+"px";j.container.style.top=this.offsetTop+20+"px";j.show();j.on("colorSelected",function(b,
e){d?d.style.backgroundColor=e:f.style.backgroundColor=e;c.exec(a,e)});j.setOpacity(c.object.getOpacity(a));j.on("opacityChanged",function(b,d){c.object.setOpacity(a,d)})});return e},createSelect:function(a,b,c,d,e){var f=document.createElement("select"),g=0,h=this,j;f.className="flipHtml5AnnotationSelect flipHtml5Annotation-"+c;for(d&&(f.style[d]=b[e]);a[g];)j=document.createElement("option"),j.className="flipHtml5AnnotationOption-"+c+" flipHtml5AnnotationOption-"+b[g],j.innerHTML=a[g],d&&(j.style[d]=
b[g]),g===e&&j.setAttribute("selected",!0),f.appendChild(j),g++;f.onchange=function(){h.exec(c,b[this.selectedIndex]);d&&(this.style[d]=b[this.selectedIndex])};return f},active:function(a){if(a){var b,c;this.setObject(a);a.toolbar.$container.append(j.container);for(b in this.tools)if(this.tools.hasOwnProperty(b)&&(c=this.tools[b],"color"===c.type&&(c.container.getElementsByTagName("div")[0].style.backgroundColor=a[b]),"select"===c.type))c.container.selectedIndex=c.value.indexOf(a[b].toString())}this.container.style.display=
"block"},inactive:function(){this.container.style.display="none";this.removeObject()}}),m=new k("stroke-width,stroke-dasharray,headArrowType,endArrowType,stroke,delete".split(",")),l=new k(["stroke-width","stroke-dasharray","stroke","delete"]),n=new k(["stroke-width","stroke-dasharray","stroke","fill","delete"]),o=new (b({create:function(){var b,c=1,d=this.sizeWrap=document.createElement("div"),e=this.sizePointArray=[];for(d.className="flipHtml5AnnotationSizeWrap";9>c;)b=document.createElement("div"),
b.className="flipHtml5SizePoint flipHtml5SizePoint"+c,d.appendChild(b),e.push(b),c++;this.$container=a(d);this.container=d},addEvents:function(b){var d=this,f=d.sizeWrap,g=d.sizePointArray;d.sizeWrapStyle=f.style;b&&(d.$context=b.add(n.$container).add(l.$container).add(m.$container));d.northResize(g[0]).westResize(g[0]);d.northResize(g[1]);d.eastResize(g[2]).northResize(g[2]);d.eastResize(g[3]);d.eastResize(g[4]).southResize(g[4]);d.southResize(g[5]);d.southResize(g[6]).westResize(g[6]);d.westResize(g[7]);
a(f).off("mousedown touchstart").on("mousedown touchstart",function(a){a.preventDefault();var b,g,h,j,k,l,r,m=Math.floor,n=d.sizeWrapStyle,o=f.offsetLeft,p=f.offsetTop,q=a.pageX||a.originalEvent.touches[0].pageX,s=a.pageY||a.originalEvent.touches[0].pageY;b=d.$context;b.off("mousemove.flipHtml5SizeWrap touchmove.flipHtml5SizeWrap").on("mousemove.flipHtml5SizeWrap touchmove.flipHtml5SizeWrap",function(a){a.preventDefault();a.stopPropagation();g=a.pageX?a.pageX:a.originalEvent.touches?a.originalEvent.touches[0].pageX:
0;h=a.pageY?a.pageY:a.originalEvent.touches?a.originalEvent.touches[0].pageY:0;if(g){r=m(o-(q-g)/c.scale());if(k!==r){n.left=r+"px";k=r;if(d.onResize)d.onResize(void 0,void 0,r,void 0)}}if(h){l=m(p-(s-h)/c.scale());if(j!==l){n.top=l+"px";j=l;if(d.onResize)d.onResize(void 0,void 0,void 0,l)}}});b.one("mouseup touchend",function(){b.off("mousemove.flipHtml5SizeWrap touchmove.flipHtml5SizeWrap");e(f);if(d.onResizeEnd)d.onResizeEnd()})})},northResize:function(b){var d=this;a(b).off("mousedown.north touchstart.north").on("mousedown.north touchstart.north",
function(a){a.preventDefault();a.stopPropagation();var b,f,g,h,j=Math.floor,k=d.sizeWrap,l=k.offsetTop,r=d.sizeWrapStyle,m=d.$context,n=k.offsetHeight||11,o=l+n-11,p=a.pageY||a.orginalEvent.touches[0].pageY;f=n;m.one("mouseup touchend",function(){m.off("mousemove.fliphtml5AnnotationResize touchmove.fliphtml5AnnotationResize");e(k);if(d.onResizeEnd)d.onResizeEnd()});m.on("mousemove.fliphtml5AnnotationResize touchmove.fliphtml5AnnotationResize",function(a){a.preventDefault();a.pageY?b=a.pageY:a.originalEvent.touches&&
(b=a.originalEvent.touches[0].pageY);if(b&&(g=j(f+(p-b)/c.scale()),n!==g&&(h=l+(f-g),11>g&&(g=11),h>o&&(h=o),r.top=h+"px",r.height=g+"px",n=g,d.onResize)))d.onResize(void 0,g,void 0,h)})});return this},westResize:function(b){var d=this;a(b).off("mousedown.west touchstart.west").on("mousedown.west touchstart.west",function(a){a.preventDefault();a.stopPropagation();var b,f,g,h,j=Math.floor,k=d.$context,l=d.sizeWrap,r=l.offsetLeft,m=d.sizeWrapStyle,n=l.offsetWidth||11,o=r+n-11,p=a.pageX||a.originalEvent.touches[0].pageX;
g=n;k.one("mouseup touchend",function(){k.off("mousemove.fliphtml5AnnotationResize touchmove.fliphtml5AnnotationResize");e(l);if(d.onResizeEnd)d.onResizeEnd()});k.on("mousemove.fliphtml5AnnotationResize touchmove.fliphtml5AnnotationResize",function(a){a.preventDefault();a.pageX?b=a.pageX:a.originalEvent.touches&&(b=a.originalEvent.touches[0].pageX);if(b&&(f=-j((b-p)/c.scale()-g),n!==f&&(h=r+(g-f),11>f&&(f=11),h>o&&(h=o),m.left=h+"px",m.width=f+"px",n=f,d.onResize)))d.onResize(f,void 0,h,void 0)})});
return this},eastResize:function(b){var d=this;a(b).off("mousedown.east touchstart.east").on("mousedown.east touchstart.east",function(a){a.preventDefault();a.stopPropagation();var b,f,g,h=Math.floor,j=d.$context,k=d.sizeWrap,l=d.sizeWrapStyle,r=k.offsetWidth||11,m=a.pageX||a.originalEvent.touches[0].pageX;j.one("mouseup touchend",function(){j.off("mousemove.fliphtml5AnnotationResize touchmove.fliphtml5AnnotationResize");e(k);if(d.onResizeEnd)d.onResizeEnd()});j.on("mousemove.fliphtml5AnnotationResize touchmove.fliphtml5AnnotationResize",
function(a){a.preventDefault();a.pageX?b=a.pageX:a.originalEvent.touches&&(b=a.originalEvent.touches[0].pageX);if(b&&(f=h(r-(m-b)/c.scale()),g!==f&&(11>f&&(f=11),l.width=f+"px",g=f,d.onResize)))d.onResize(f,void 0,void 0,void 0)})});return this},southResize:function(b){var d=this;a(b).off("mousedown.south touchstart.south").on("mousedown.south touchstart.south",function(a){a.preventDefault();a.stopPropagation();var b,f,g,h=Math.floor,j=d.$context,k=d.sizeWrap,l=d.sizeWrapStyle,r=k.offsetHeight,m=
a.pageY||a.originalEvent.touches[0].pageY;j.one("mouseup touchend",function(){j.off("mousemove.fliphtml5AnnotationResize touchmove.fliphtml5AnnotationResize");e(k);if(d.onResizeEnd)d.onResizeEnd()});j.on("mousemove.fliphtml5AnnotationResize touchmove.fliphtml5AnnotationResize",function(a){a.preventDefault();a.pageY?b=a.pageY:a.originalEvent.touches&&(b=a.originalEvent.touches[0].pageY);if(b&&(f=h(r-(m-b)/c.scale()),g!==f&&(11>f&&(f=11),l.height=f+"px",g=f,d.onResize)))d.onResize(void 0,f,void 0,void 0)})});
return this},onResizeEnd:function(){},onResize:function(){},active:function(){this.container.style.display="block"},inactive:function(){this.container.style.display="none"}})),p=b({create:function(b,c){var d=this.svg=f(),e=this.container=document.createElement("div"),b=b||[];this.$parent=c;d.style.position="absolute";d.style.left="0";d.style.top="0";d.style.width="100%";d.style.height="100%";this.id=g(8,10);this.$container=a(e);e.className="flipHtml5SVGContainer";e.appendChild(d);c&&(this._width=
b[0]||0,this._height=b[1]||0,this._left=b[2]||0,this._top=b[3]||0);e.style.width=b[0]||0;e.style.height=b[1]||0;e.style.left=b[2]||0;e.style.top=b[3]||0;c&&(this.prevWidth=parseFloat(b[0])*c[0].offsetWidth/100,this.prevHeight=parseFloat(b[1])*c[0].offsetHeight/100,this.prevLeft=parseFloat(b[2])*c[0].offsetWidth/100,this.prevTop=parseFloat(b[3])*c[0].offsetHeight/100);this.fill=b[4]||"transparent";this.fillOpacity=b[5]||1;this.stroke=b[6]||"rgba(0, 0, 0, 1)";this.strokeDasharray=b[7]||"1";this.strokeOpacity=
b[8]||"1";this.strokeWidth=b[9]||"2";this.createGraphics(b);this.setStrokeWidth(this.strokeWidth);this.setFill(this.fill);this.setFillOpacity(this.fillOpacity);this.setStroke(this.stroke);this.setDashArray(this.strokeDasharray);this.setStrokeOpacity(this.strokeOpacity);this.actived=!1;this.$container.on("click",function(){if(!this.actived){this.active(this.$parent);this.actived=true}}.bind(this))},active:function(a){var b=this;h.activedShape&&h.activedShape.inactive();h.activedShape=this;b.$container.after(o.$container);
b.position();a&&(b.$parent=a);o.addEvents(b.$parent);o.active();b.toolbar.active(b);a.off("mousedown.flipHtml5Graphic"+b.id+" touchstart.flipHtml5Graphic"+b.id).on("mousedown.flipHtml5Graphic"+b.id+" touchstart.flipHtml5Graphic"+b.id,function(c){if(b.actived&&c.target!==b.container&&c.target!==b.toolbar.container&&c.target!==o.container){a.off("mousedown.flipHtml5Graphic"+b.id+" touchstart.flipHtml5Graphic"+b.id);b.inactive()}});this.actived=!0},_parsePresentValue:function(){e(this.container);var a=
this.container.style;this._width=a.width;this._height=a.height;this._left=a.left;this._top=a.top},inactive:function(){h&&(h.save(),h.activedShape=null);this.toolbar.inactive();o.inactive();this.actived=!1},position:function(){var a=this,b=a.px,c=a.container,d=a.$container,e=o.container.style,f=a.toolbar.container.style;e.width=c.offsetWidth+8+b;e.height=c.offsetHeight+8+b;e.left=c.offsetLeft-3+b;e.top=c.offsetTop-4+b;f.left=d.offset().left-8+b;f.top=d.offset().top-52+b;o.onResize=function(c,e,g,h){a.css(c-
8,e-8,g+3,h+4);f.left=d.offset().left-8+b;f.top=d.offset().top-52+b};o.onResizeEnd=function(){a._parsePresentValue();h.save()}},setFill:function(a){this.setStyle("fill",a);this.fill=a},setFillOpacity:function(a){this.setStyle("fill",this.fill.replace(/,[0-9]+(\.[0-9]*)?\)/,","+a+")"));this.fillOpacity=parseFloat(a)},setStroke:function(a){this.setStyle("stroke",a);this.stroke=a},setStrokeOpacity:function(a){this.setStyle("stroke",this.stroke.replace(/,[0-9]+(\.[0-9]*)?\)/,","+a+")"));this.strokeOpacity=
parseFloat(a)},setOpacity:function(a,b){"fill"===a&&this.setFillOpacity(b);"stroke"===a&&this.setStrokeOpacity(b)},getOpacity:function(a){return"fill"===a?this.fillOpacity:this.strokeOpacity},setStrokeWidth:function(a){this.setStyle("stroke-width",a);this.strokeWidth=parseInt(a,10);this.setDashArray(this.strokeDasharray);this.shapeCss(this.prevWidth,this.prevHeight)},setDashArray:function(a){this.strokeDasharray=a;a="1"===a?"":"2"===a?"1,"+2*this.strokeWidth:"3"===a?"1,"+2*this.strokeWidth+",1":4*
this.strokeWidth+","+2*this.strokeWidth+",1,"+2*this.strokeWidth;this.setStyle("stroke-dasharray",a)},shapeCss:function(){},css:function(a,b,c,d){var e=this.container.style,a=Math.floor(a),c=Math.floor(c),b=Math.floor(b),d=Math.floor(d);a&&(this.prevWidth=a,a<this.minWidth&&(a=this.minWidth),e.width=a+"px",this.shapeCss(a,null));b&&(this.prevHeight=b,b<this.minHeight&&(b=this.minHeight),e.height=b+"px",this.shapeCss(null,b));c&&(e.left=c+"px",this.prevLeft=c);this.prevWidth<this.minWidth&&(e.left=
this.prevLeft-4-(this.minWidth-this.prevWidth-8)/2+"px");d&&(e.top=d+"px",this.prevTop=d);this.prevHeight<this.minHeight&&(e.top=this.prevTop-3-(this.minHeight-this.prevHeight-6)/2+"px")},destroy:function(){this.inactive();this.$container.remove();h.removeGraphic(this)}}),k=b({name:"line",toolbar:l,createGraphics:function(a){var b=d("line");b.setAttribute("stroke-linecap","round");b.setAttribute("stroke-linejoin","round");this.italic=parseInt(a[10]||1,10);this.svg.appendChild(b);this.line=b;this.px=
"px"},setStyle:function(a,b){(b||0===b)&&this.line.setAttribute(a,b);return this},setStrokeWidth:function(a){a=parseInt(a,10);this._super(a);this.minHeight=this.minWidth=a},draw:function(a,b,c,d,e,f,g){var h=this.strokeWidth/2,j=this.strokeWidth,k,l=b-a,m=d-c;b>a?(k=l+j,e=a-e-h):(k=-l+j,e=b-e-h);d>c?(a=m+j,f=c-f-h):(a=-m+j,f=d-f-h);0<l&&0<m&&(this.italic=1);0>l&&0<m&&(this.italic=2);0>l&&0>m&&(this.italic=3);0<l&&0>m&&(this.italic=4);this.css(k/g,a/g,e/g,f/g)},shapeCss:function(a,b){var c,d;1===this.italic||
3===this.italic?(c="x1",d="x2"):(c="x2",d="x1");this.setStyle(c,this.strokeWidth/2);a&&this.setStyle(d,a-this.strokeWidth/2);this.setStyle("y1",this.strokeWidth/2);b&&this.setStyle("y2",b-this.strokeWidth/2)}}).extend(p),q=b({name:"ellipse",toolbar:n,createGraphics:function(a){this.ellipse=d("ellipse");this.svg.appendChild(this.ellipse);this.px="px";this.ellipse.setAttribute("stroke-linecap","round");this.ellipse.setAttribute("stroke-linejoin","round");this.ellipse.setAttribute("cx","50%");this.ellipse.setAttribute("cy",
"50%");this.setFillOpacity(a[5]||"0.5")},setStyle:function(a,b){this.ellipse.setAttribute(a,b);return this},setStrokeWidth:function(a){a=parseInt(a,10);this._super(a);this.minWidth=2*a;this.minHeight=2*a},draw:function(a,b,c,d,e,f,g){var h=this.strokeWidth/2,j=this.strokeWidth,k;b>a?(k=b-a+j,e=a-e-h):(k=a-b+j,e=b-e-h);d>c?(a=d-c+j,f=c-f-h):(a=c-d+j,f=d-f-h);this.css(k/g,a/g,e/g,f/g)},shapeCss:function(a,b){a&&this.setStyle("rx",a/2-this.strokeWidth/2);b&&this.setStyle("ry",b/2-this.strokeWidth/2)}}).extend(p),
p=b({name:"rect",toolbar:n,createGraphics:function(){this.rect=d("rect");this.rect.setAttribute("stroke-linecap","round");this.rect.setAttribute("stroke-linejoin","round");this.svg.appendChild(this.rect);this.px="px"},setStrokeWidth:function(a){a=parseInt(a,10);this._super(a);this.setStyle("x",a/2);this.setStyle("y",a/2);this.minWidth=2*a;this.minHeight=2*a},setStyle:function(a,b){this.rect.setAttribute(a,b);return this},draw:function(a,b,c,d,e,f,g){var h=this.strokeWidth/2,j=this.strokeWidth,k;b>
a?(k=b-a+j,e=a-e-h):(k=a-b+j,e=b-e-h);d>c?(a=d-c+j,f=c-f-h):(a=c-d+j,f=d-f-h);this.css(k/g,a/g,e/g,f/g)},shapeCss:function(a,b){a&&this.setStyle("width",a-this.strokeWidth);b&&this.setStyle("height",b-this.strokeWidth)}}).extend(p),s=b({create:function(b,c,e){var g=this.svg=f(),h=this.path=d("path"),j=this.line=d("line"),k=this.rect=d("rect"),l=this.ellipse=d("ellipse");g.style.position="absolute";j.style.display="none";k.style.display="none";l.style.display="none";g.appendChild(k);g.appendChild(h);
g.appendChild(j);g.appendChild(l);this.container=g;this.$container=a(g);l.setAttribute("cx","50%");l.setAttribute("cy","50%");this.setStyle("stroke-linecap","round");this.setStyle("stroke-linejoin","round");this.type=0;this.inverse="true"==c;this.position=b;this.currentType="path";this.setCurrentType(e[10]||"path");this.backgroundTransparent=!1;this.deg=e[11]||0;this.italic=parseInt(e[12]||1,10)},setStyle:function(a,b){this.path.setAttribute(a,b);this.line.setAttribute(a,b);this.ellipse.setAttribute(a,
b);this.rect.setAttribute(a,b)},setStrokeWidth:function(a){var b=a=parseInt(a,10);this.lineStrokeWidth=a;this.strokeWidth=b;this.setType(this.type);this.setPosition(this.deg,this.italic);this.setStyle("stroke-width",b)},getDegByItalic:function(a,b){var c=this.inverse?180:0;switch(b){case 1:a+=c;break;case 2:a=180-a+c;break;case 3:a=180+a+c;break;case 4:a=360-a+c}return a},setPosition:function(a,b){var c=this.svg.style,d=(-this.width-this.lineStrokeWidth/2)/2+"px",e=(-this.height-this.lineStrokeWidth/
2)/2+"px";this.italic=b;this.deg=a;for(var f="rotate("+this.getDegByItalic(a,b)+"deg)",g=0,h=this.svg.style,j=["transform","webkitTransform","mozTransform","msTransform"];j[g];)h[j[g]]=f,g++;this.position&&(b=(b+2)%4,0===b&&(b=4));switch(b){case 1:c.left="100%";c.top="100%";c.right="auto";c.bottom="auto";c.margin=e+" auto auto "+d;break;case 2:c.left="auto";c.top="100%";c.right="100%";c.bottom="auto";c.margin=e+" "+d+" auto auto";break;case 3:c.left="auto";c.top="auto";c.right="100%";c.bottom="100%";
c.margin="auto "+d+" "+e+" auto";break;case 4:c.left="100%",c.top="auto",c.right="auto",c.bottom="100%",c.margin="auto auto "+e+" "+d}},setCurrentType:function(a){var b,c;a!==this.currentType&&(b=this.svg.getElementsByTagName(a)[0],c=this.svg.getElementsByTagName(this.currentType)[0],this.currentType=a,c.style.display="none",b.style.display="block")},setType:function(a){this.type=parseInt(a,10);this.inverse=!1;var b,c,a=this.strokeWidth,d=this.path,e=a/2;switch(this.type){case 0:this.setCurrentType("path");
b=c=0;break;case 2:this.inverse=!0;case 1:this.setCurrentType("path");c=20+5*a;b=30+4*a;this.backgroundTransparent=!1;d.setAttribute("d","M "+e+" "+0.3*b+" L "+(c-a/2)+" "+0.5*b+" L "+e+" "+0.7*b+" Z");break;case 4:this.inverse=!0;case 3:this.setCurrentType("path");this.backgroundTransparent=!1;c=5+4*a;b=20+5*a;d.setAttribute("d","M "+e+" "+0.2*b+" L "+(c-e)+" "+0.5*b+" L "+e+" "+0.8*b+" Z");break;case 6:this.inverse=!0;case 5:this.setCurrentType("path");this.backgroundTransparent=!0;c=10+4*a;b=30+
3*a;this.path.setAttribute("d","M "+e+" "+0.2*b+" L "+(c-a)/2+" "+0.5*b+" L "+e+" "+0.8*b);break;case 7:this.setCurrentType("ellipse");this.backgroundTransparent=!1;c=b=10+4*a;this.ellipse.setAttribute("rx",c/2-e);this.ellipse.setAttribute("ry",b/2-e);break;case 8:this.setCurrentType("rect");this.backgroundTransparent=!1;c=b=10+4*a;this.rect.setAttribute("x",e);this.rect.setAttribute("y",e);this.rect.setAttribute("width",c-a);this.rect.setAttribute("height",b-a);break;case 9:this.setCurrentType("line");
this.backgroundTransparent=!0;c=b=10+4*a;this.line.setAttribute("x1",e);this.line.setAttribute("y1",e);this.line.setAttribute("x2",c-e);this.line.setAttribute("y2",b-e);break;case 10:this.setCurrentType("line");this.backgroundTransparent=!0;c=b=10+4*a;this.line.setAttribute("x1",c/2-e);this.line.setAttribute("y1",e);this.line.setAttribute("x2",c/2-e);this.line.setAttribute("y1",b-e);break;case 11:this.setCurrentType("line"),this.backgroundTransparent=!0,c=b=10+4*a,this.line.setAttribute("x1",e),this.line.setAttribute("y2",
e),this.line.setAttribute("x2",c-e),this.line.setAttribute("y1",b-e)}this.svg.setAttribute("width",c);this.svg.setAttribute("height",b);this.width=c;this.height=b;this.setColor(this.color);this.setPosition(this.deg,this.italic)},setColor:function(a){this.color=a;this.setStyle("stroke",a);this.backgroundTransparent?this.setStyle("fill","transparent"):this.setStyle("fill",a)}}),v=b({name:"arrow",toolbar:m,createGraphics:function(a){this._super(a);this.italic=parseInt(a[12]||1,10);this.headArrow=new s(!1,
"false",a);this.endArrow=new s(!0,"false",a);this.deg=parseInt(a[11],10);this.headArrow.setPosition(this.deg,this.italic);this.endArrow.setPosition(this.deg,this.italic);this.container.appendChild(this.headArrow.container);this.container.appendChild(this.endArrow.container);this.setStrokeWidth(a[9]||"1");this.setStroke(a[6]||"rgba(0, 0, 0, 1)");this.setArrowType("endArrowType",a[14]||10);this.setArrowType("headArrowType",a[13]||5)},setArrowType:function(a,b){var c;"endArrowType"===a?(c=this.endArrow,
this.endArrowType=b):(c=this.headArrow,this.headArrowType=b);c.setType(b);c.setStrokeWidth(this.strokeWidth)},setStroke:function(a){this._super(a);this.headArrow.setColor(a);this.endArrow.setColor(a)},setStrokeWidth:function(a){a=parseInt(a,10);this._super(a);this.headArrow.setStrokeWidth(a);this.endArrow.setStrokeWidth(a)},css:function(a,b,c,d){this._super(a,b,c,d);a=180*Math.atan(this.prevHeight/this.prevWidth)/Math.PI;this.prevHeight<=this.minHeight&&(a=0);this.prevWidth<=this.minWidth&&(a=90);
this.deg=a;this.headArrow.setPosition(a,this.italic);this.endArrow.setPosition(a,this.italic)}}).extend(k),t={shapes:{ellipse:q,rect:p,line:k,arrow:v},getShape:function(a,b,c){return this.shapes[a]?new this.shapes[a](b,c):null}},b=b({create:function(){this.containerArray={};this.graphics={};this.activedShape=null},bindOnCreated:function(a,b){this.onCreated=[a,b]},addEvent:function(a,b,d){var e=this,f=t.getShape(d);this.containers=this.containers?this.containers.add(b):b;b.css("cursor","crosshair");
b.one("contextmenu.draw",function(a){a.preventDefault();return!1});b.off("mousedown.draw touchstart.draw").one("mousedown.draw touchstart.draw",function(d){d.stopPropagation();d.preventDefault();var g,h,j,k,l,m=d.button,n=b.offset().top,o=b.offset().left;if(!document.implementation.hasFeature("MouseEvents","2.0"))switch(event.button){case 0:case 1:case 3:case 5:case 7:m=0;break;case 2:case 6:m=2;break;case 4:m=1}0===m?(d.pageX?(g=d.pageX,h=d.pageY):d.originalEvent.touches&&(l=!0,g=d.originalEvent.touches[0].pageX,
h=d.originalEvent.touches[0].pageY),b.append(f.$container),e.groupGraphicByIndex(a,f),f.draw(g,g,h,h,o,n),b.off("mousemove.draw touchmove.draw").on("mousemove.draw touchmove.draw",function(a){a.preventDefault();a.stopPropagation();if(l){j=a.originalEvent.touches[0].pageX;k=a.originalEvent.touches[0].pageY}else{j=a.pageX;k=a.pageY}f.draw(g,j,h,k,o,n,c.scale())}),b.one("mouseup touchend",function(){f._parsePresentValue();e.delEvents();e.popUpButton();f.active(b);e.save()})):(f._parsePresentValue(),
e.delEvents(),e.popUpButton())})},groupGraphicByIndex:function(a,b){this.graphics[a]||(this.graphics[a]=[]);this.graphics[a].push(b)},removeGraphicByIndex:function(a){var b,c=this.graphics,d,e;for(b in c)if(c.hasOwnProperty(b)&&b==a){e=c[b];for(d=0;e[d];)e[d].$container.remove(),d++;c[b]=[]}},removeGraphic:function(a){var b,c,d,e=this.graphics;for(c in e)if(e.hasOwnProperty(c)&&e[c]){b=0;for(d=e[c];d[b];)d[b]===a&&d.splice(b,1),b++}},popUpButton:function(){this.onCreated&&this.onCreated[1].call(this.onCreated[0])},
delEvents:function(){this.containers&&this.containers.off("mousedown.draw touchstart.draw contextmenu.draw mousemove.draw touchmove.draw").css("cursor","auto");this.containers=null},getPageContent:function(a){for(var b,c=0,d,e,f,g,h=this.graphics[a];h&&(b=h[c]);){switch(b.name){case "line":a=[b._width,b._height,b._left,b._top,b.fill,b.fillOpacity,b.stroke,b.strokeDasharray,b.strokeOpacity,b.strokeWidth,b.italic];d||(d=[]);d.push(a.join("$$"));break;case "arrow":a=[b._width,b._height,b._left,b._top,
b.fill,b.fillOpacity,b.stroke,b.strokeDasharray,b.strokeOpacity,b.strokeWidth,b.currentType,b.deg,b.italic,b.headArrowType,b.endArrowType];e||(e=[]);e.push(a.join("$$"));break;case "rect":a=[b._width,b._height,b._left,b._top,b.fill,b.fillOpacity,b.stroke,b.strokeDasharray,b.strokeOpacity,b.strokeWidth];f||(f=[]);f.push(a.join("$$"));break;case "ellipse":a=[b._width,b._height,b._left,b._top,b.fill,b.fillOpacity,b.stroke,b.strokeDasharray,b.strokeOpacity,b.strokeWidth],g||(g=[]),g.push(a.join("$$"))}c++}a=
[d&&d.join("@@"),e&&e.join("@@"),f&&f.join("@@"),g&&g.join("@@")];return a.join("##")},saveByIndex:function(a){var b=new Date,c=this.getPageContent(a)||"";""===c||"######"===c||(window.localStorage?(window.localStorage.removeItem("flipHtml5Shapes"+a),window.localStorage.setItem("flipHtml5Shapes"+a,c)):(b.setDate(b.getDate()+this.expires),document.cookie="flipHtml5Shapes"+a+"="+c+";expires="+b.toUTCString()+";"))},save:function(){var a,b=c.getCurrentPages();for(a=0;a<b.length;a++)this.containerArray[c.getBookType()][b[a]]&&
this.saveByIndex(b[a])},restoreByIndex:function(a,b){var c;this.removeGraphicByIndex(a);if((c=window.localStorage?window.localStorage.getItem("flipHtml5Shapes"+a)||"":(document.cookie||"").replace(RegExp("(?:(?:^|.*;\\s*)flipHtml5Shapes"+a+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))&&0!==c.length){var d,e=0,f=c.split("##");c=f[0].split("@@");for(var g=f[1].split("@@"),h=f[2].split("@@"),f=f[3].split("@@");d=c[e++];)d=t.getShape("line",d.split("$$"),b),b.append(d.container),this.groupGraphicByIndex(a,d);
for(e=0;d=g[e++];)d=t.getShape("arrow",d.split("$$"),b),b.append(d.container),this.groupGraphicByIndex(a,d);for(e=0;d=h[e++];)d=t.getShape("rect",d.split("$$"),b),b.append(d.container),this.groupGraphicByIndex(a,d);for(e=0;d=f[e++];)d=t.getShape("ellipse",d.split("$$"),b),b.append(d.container),this.groupGraphicByIndex(a,d)}},restore:function(a,b,d){var e=this.containerArray;o.inactive();n.inactive();l.inactive();m.inactive();e[a]||(e[a]={});e[a][b]=d;a===c.getBookType()&&this.restoreByIndex(b,d)},
setContainers:function(a,b,c){this.restore(a,b,c)},addEvents:function(a){var b,d=-1,e=c.getCurrentPages(),f=this.containerArray[c.getBookType()];if(f)for(;d++<e.length;)b=e[d],f[b]&&this.addEvent(b,f[b],a)}});h=window.annotationShapes=new b})(window.jQuery,window.Class,window.BookInfo);
var NoteCookie=Class({statics:{noteCookie:function(a){void 0==this._noteCookie&&(this._noteCookie=new NoteCookie(a));return this._noteCookie}},create:function(a){this.noteImgs={};this.rowObjs={};this.noteTexts={};this.svgObjs={};this.notes=[];this.cookieName="NoteCookie";this.rows=[];this.noteImgContainers={};this.showFlag=!1;this.container=a;this.width=a.width();this.height=a.height();this.address=uiBaseURL;this.noteButtonIsShow=!0;this.noteHeight=0;this.createNote(a);this.bindEvents()},createNote:function(a){var b=
this;this.note=$("<div class='noteCookie-note'></div>").css({left:"40%"}).appendTo(a).hide();this.noteTitle=$("<div class='noteCookie-noteTitle'></div>").appendTo(this.note);this.noteTitleText=$("<span class='noteCookie-noteTitle-text'></span>").html("Notes").appendTo(this.noteTitle);this.noteTitleShowBtn=$("<div class='noteCookie-noteTitle-showBtn'></div>").attr("title","Minimize").append($("<img style='margin-left: 3px;margin-top: 3px;'/>").attr("src",this.address+"note_narrow.png")).appendTo(this.noteTitle);
this.noteTitleCloseBtn=$("<div class='noteCookie-noteTitle-closeBtn'></div>").attr("title","Close").append($("<img style='margin-left: 3px;margin-top: 3px;'/>").attr("src",this.address+"note_close.png")).appendTo(this.noteTitle);this.noteButton=$("<div class='noteCookie-noteButton'></div>").appendTo(this.note);this.noteBottomTop=$("<div class='noteCookie-noteButton-top'></div>").appendTo(this.noteButton);this.inputText=$("<textarea class='noteCookie-noteButton-inputText'></textarea>").appendTo(this.noteBottomTop);
this.addBtn=$("<div class='noteCookie-noteButton-addBtn'></div>").html("Add").appendTo(this.noteBottomTop);this.removeAllBtn=$("<div class='noteCookie-noteButton-removeAllBtn'></div>").html("Remove All").appendTo(this.noteBottomTop);this.noteLists=$("<div class='noteCookie-noteList'></div>").appendTo(this.noteButton);var c=$("<div class='noteCookie-noteTable-row-th'></div>"),d=$("<span class='noteCookie-noteTable-cellLeft-th'></span>").html("Page"),e=$("<div class='noteCookie-noteTable-cellRight-th'></div>");
e.append($("<div style='position: absolute;width: 1px;height: 22px;left: 0px;top: 3px;background-color: #FFFFFF;'></div>")).append($("<span style='position: absolute;width: 319px;height: 100%;left: 1px;text-indent: 6px;'></span>").html("Title")).append($("<div style='position: absolute;width: 1px;height: 22px;left: auto;right: 89px;top: 3px;background-color: #FFFFFF;'></div>")).append($("<span style='position: absolute;width: 34px;height: 100%;left: auto;right: 55px;text-indent: 4px;'></span>").html("Edit")).append($("<div style='position: absolute;width: 1px;height: 22px;left: auto;right: 54px;top: 3px;background-color: #FFFFFF;'></div>")).append($("<span style='position: absolute;width: 54px;height: 100%;left: auto;right: 0px;text-indent: 4px;'></span>").html("Delete"));
c.append(d).append(e);this.noteLists.append(c);this.noteTable=$("<div class='noteCookie-noteTable'></div>").appendTo(this.noteLists);this.noteTableInner=$("<div class='noteCookie-noteTable-inner'></div>").appendTo(this.noteTable);isTouch||this.note.transition3D();this.createScrollBar(this.noteTable);c=this.getLocalStorage(this.cookieName);if(c=eval(c)){this.downJSonArrByKey(c,"page");for(d=0;d<c.length;d++)this.addListData($.extend(c[d],{firstDown:!0}))}for(d=0;d<this.rows.length;d++)this.rows[d].rowObj.css({backgroundColor:0==
d%2?"":"#bababa"});this.setDelNoteHeight();this.scrollBarShowHide();this.noteHeight=this.note.height();var f,g;this.noteTitle.on("mousedown touchstart",function(c){c=isTouch?c.originalEvent.touches[0]:c;f=c.clientX-b.note.position().left;g=c.clientY-b.note.position().top;a.add(b.noteImgContainers[BookInfo.getBookType()][BookInfo.getCurrentPages()[0]]).add(b.noteImgContainers[BookInfo.getBookType()][BookInfo.getCurrentPages()[1]]).on("mousemove.noteMove touchmove.noteMove",function(a){b.noteTitle.css({cursor:"move"});
a=isTouch?a.originalEvent.touches[0]:a;b.note.css({left:a.clientX-f,top:a.clientY-g})});a.on("mouseup.noteMove touchend.noteMove",function(){b.noteTitle.css({cursor:"default"});a.add(b.noteImgContainers[BookInfo.getBookType()][BookInfo.getCurrentPages()[0]]).add(b.noteImgContainers[BookInfo.getBookType()][BookInfo.getCurrentPages()[1]]).off("mousemove.noteMove touchmove.noteMove");a.off("mouseup.noteMove touchend.noteMove")});c.preventDefault();c.stopPropagation();return!1})},setNoteButtonHeight:function(){this.noteButton.css({height:161+
this.noteLists.outerHeight()})},setDelNoteHeight:function(){this.setNoteButtonHeight();this.note.css({height:this.noteTitle.outerHeight()+this.noteButton.outerHeight()});this.noteHeight=this.noteTitle.outerHeight()+this.noteButton.outerHeight();this.isNoteListShowHide();this.noteButtonIsShow=!0;this.noteTitleShowBtn.children("img").attr("src",this.address+"note_narrow.png")},setAddNoteHeight:function(){this.setNoteButtonHeight();this.noteHeight=this.noteTitle.outerHeight()+this.noteButton.outerHeight();
this.isNoteListShowHide()},isNoteListShowHide:function(){0<this.noteTableInner.children("div").length?this.noteLists.show():this.noteLists.hide()},updateListDataText:function(a,b){var c=this.noteTexts[a],d=this.noteImgs[a].find(".noteCookie-eachNote-img"),c=c.find(".noteCookie-eachNote-textList-text");d.attr("title",b);c.val(b)},updateNoteImgText:function(a,b){this.rowObjs[a].find(".noteCookie-noteTable-cellRight-text").val(b)},deleteListData:function(a){var b=this.noteTexts[a],c=this.svgObjs[a];
this.noteImgs[a].remove();b.remove();c.remove();delete this.noteImgs[a];delete this.rowObjs[a];delete this.noteTexts[a];delete this.svgObjs[a]},deleteNoteImg:function(a){this.rowObjs[a].remove();delete this.noteImgs[a];delete this.rowObjs[a]},revertNoteImgText:function(a){var b=this.noteTexts[a].find(".noteCookie-eachNote-textList-text"),a=this.rowObjs[a].find(".noteCookie-noteTable-cellRight-text");b.val(a.val())},addListData:function(a){var b=this,c=!0,d=$("<div class='noteCookie-noteTable-row'></div>").css({height:28}).attr("data-key",
a.key).attr("data-page",a.page).appendTo(b.noteTableInner);$("<span class='noteCookie-noteTable-cellLeft'></span>").html(a.page).appendTo(d);var e=$("<span class='noteCookie-noteTable-cellRight'></span>").appendTo(d),f=$("<input class='noteCookie-noteTable-cellRight-text' disabled='true'/>").attr("disabled",c).val(a.value).appendTo(e),g=$("<div class='noteCookie-noteTable-cellRight-edit'></div>").attr("title","Edit").append($("<img style='margin-left: 3px;margin-top: 3px;'/>").attr("src",b.address+
"note_edit.png")).appendTo(e);$("<div class='noteCookie-noteTable-cellRight-del'></div>").attr("title","Delete").append($("<img style='margin-left: 0px;margin-top: 3px;'/>").attr("src",b.address+"note_del.png")).appendTo(e).on("click touchend",function(a){d.remove();var c=d.attr("data-key");b.deleteListData(c);b.setDelNoteHeight();b.delArrayOrderKey(b.rows,c);b.delArrayOrderKey(b.notes,c);b.addLocalStorage(b.cookieName,b.parseJSONArrayToString(b.notes));for(c=0;c<b.rows.length;c++)b.rows[c].rowObj.css({backgroundColor:0==
c%2?"":"#bababa"});b.scrollBarShowHide();a.preventDefault();a.stopPropagation();return!1});d.on("click touchend",function(){gotoPageFun($(this).attr("data-page"));f.attr("disabled")&&(b.noteTitleShowBtn.children("img").attr("src",b.address+"note_revert.png"),b.note.animate({height:34},500,function(){b.noteButtonIsShow=!1}))});g.on("click touchend",function(a){if(c)c=!1,f.css({backgroundColor:"#ffffff",color:"#000000"}),g.children("img").attr("src",b.address+"note_save.png"),f.attr("disabled",c),f[0].focus(),
g.attr("title","Save");else{c=!0;f.css({backgroundColor:"transparent",color:"#1a1a1a"});f.attr("disabled",c);g.attr("title","Edit");var e=f.val(),k=d.attr("data-key");b.updateListDataText(k,e);g.children("img").attr("src",b.address+"note_edit.png");b.updateArrayOrderKey(b.notes,k,{value:e});b.addLocalStorage(b.cookieName,b.parseJSONArrayToString(b.notes))}a.preventDefault();a.stopPropagation();return!1});b.setAddNoteHeight();b.rows.push($.extend(a,{rowObj:d}));b.rowObjs[a.key]=d;b.scrollBarShowHide();
b.notes.push(a);b.addLocalStorage(b.cookieName,b.parseJSONArrayToString(b.notes));return{rowObj:d,rowText:f}},addNoteImg:function(a,b){var c=this,d=$("<div class='noteCookie-eachNote'></div>").attr("data-key",a.key).attr("data-page",a.page).css({left:""+a.left+"",top:""+a.top+""}).appendTo(b),e=$("<img class='noteCookie-eachNote-img'/>").attr("src",c.address+"note.png").attr("title",a.value).attr("data-key",a.key).attr("data-page",a.page).appendTo(d);isTouch||d.transition3D();var f=$(document.createElementNS("http://www.w3.org/2000/svg",
"svg")).css({zIndex:121,position:"absolute"}).attr("class","noteCookie-eachNote-svg noteCookie-eachNote-svg"+a.page).appendTo(BookInfo.container()),g=$(document.createElementNS("http://www.w3.org/2000/svg","path")).css({fill:"#FFF4A1",stroke:"#C99F1D",strokeWidth:1}).appendTo(f);f.css({left:0,top:0,width:0,height:0}).hide();var h=$("<div class='noteCookie-eachNote-textList noteCookie-eachNote-text"+a.page+"'></div>").attr("data-key",a.key).attr("data-page",a.page).hide().appendTo(BookInfo.container());
h.css({left:d.offset().left,top:d.offset().top});h.on("click mousedown touchstart",function(a){a.preventDefault();a.stopPropagation();return!1});var j=$("<div class='noteCookie-eachNote-textList-top'></div>").appendTo(h),k=$("<div style='position: absolute;left: 4px;top: 0px;width: 24px;height: 20px;cursor: pointer;'></div>").append($("<img style='margin-top: 2px;margin-left: 4px;'/>").attr("src",c.address+"showNoteList.png")).appendTo(j),m=$("<div class='noteCookie-eachNote-textList-topClose'></div>").attr("title",
"Close").append($("<img style='margin-top: 1px;margin-left: 1px;'/>").attr("src",c.address+"noteImg_close.png")).appendTo(j),l=$("<div class='noteCookie-eachNote-textList-topSave'></div>").attr("title","Save").append($("<img style='margin-top: 1px;margin-left: 0px;'/>").attr("src",c.address+"noteImg_save.png")).appendTo(j),n=$("<div class='noteCookie-eachNote-textList-topDel'></div>").attr("title","Delete").append($("<img style='margin-top: 1px;margin-left: 0px;'/>").attr("src",c.address+"noteImg_del.png")).appendTo(j),
o=$("<div class='noteCookie-eachNote-textList-textDiv'></div>").appendTo(h),p=$("<textarea class='noteCookie-eachNote-textList-text'></textarea>").val(a.value).appendTo(o);$("<span class='noteCookie-eachNote-textList-topTitle'></span>").html(a.time).appendTo(o);p.on("mousedown click",function(a){a.stopPropagation()});isTouch||h.transition3D();k.on("click touchend",function(){!c.noteButtonIsShow||!c.showFlag?(c.note.show(),c.setDelNoteHeight(),c.showFlag=!0):(c.note.hide(),c.showFlag=!1)});var q,s,
v,t,r,u;j.on("mousedown.note touchstart.note",function(a){a=isTouch?a.originalEvent.touches[0]:a;v=d.offset().left;t=d.offset().top;r=h.offset().left;u=h.offset().top;q=a.clientX-r;s=a.clientY-u;BookInfo.container().add(f).add(c.noteImgContainers[BookInfo.getBookType()][BookInfo.getCurrentPages()[0]]).add(c.noteImgContainers[BookInfo.getBookType()][BookInfo.getCurrentPages()[1]]).on("mousemove.noteB touchmove.noteB",function(a){j.css({cursor:"move"});a=isTouch?a.originalEvent.touches[0]:a;h.css({left:Math.floor(a.clientX-
q),top:a.clientY-s});c.drawSVG(v,t,h.offset().left,h.offset().top,f,g)});BookInfo.container().add(f).add(j).on("mouseup.noteB touchend.noteB",function(){j.css({cursor:"default"});BookInfo.container().add(f).add(c.noteImgContainers[BookInfo.getBookType()][BookInfo.getCurrentPages()[0]]).add(c.noteImgContainers[BookInfo.getBookType()][BookInfo.getCurrentPages()[1]]).off("mousemove.noteB touchmove.noteB");BookInfo.container().add(f).add(j).off("mouseup.noteB touchend.noteB")});a.stopPropagation();a.preventDefault();
return!1});var w,B,x,y=a.firstDown?!1:!0,C=!1;m.on("click touchend",function(){c.revertNoteImgText(d.attr("data-key"));h.hide();f.hide();C=!1});l.on("click touchend",function(){var a=p.val();e.attr("title",a);var b=d.attr("data-key");c.updateNoteImgText(b,a);c.updateArrayOrderKey(c.notes,b,{value:a});c.addLocalStorage(c.cookieName,c.parseJSONArrayToString(c.notes));h.hide();f.hide();C=!1});n.on("click touchend",function(){w||(w=$("<div class='noteCookie-eachNote-textList-textDiv-bg'></div>").appendTo(o),
$("<span class='noteCookie-eachNote-textList-textDiv-bgText'></span>").html("Delete This Note!").appendTo(w),B=$("<div class='noteCookie-eachNote-textList-textDiv-bgYes'></div>").html("Yes").appendTo(w),x=$("<div class='noteCookie-eachNote-textList-textDiv-bgNo'></div>").html("No").appendTo(w),B.on("click touchend",function(){var a=d.attr("data-key");c.deleteNoteImg(a);h.remove();f.remove();d.remove();c.noteButtonIsShow?c.setDelNoteHeight():c.setAddNoteHeight();a=d.attr("data-key");c.delArrayOrderKey(c.rows,
a);c.delArrayOrderKey(c.notes,a);c.addLocalStorage(c.cookieName,c.parseJSONArrayToString(c.notes));c.scrollBarShowHide();for(a=0;a<c.rows.length;a++)c.rows[a].rowObj.css({backgroundColor:0==a%2?"":"#bababa"});w=null}),x.on("click touchend",function(){w.remove();w=null}))});var D=!1;e.on("mouseup.noteImgShowHide touchend.noteImgShowHide",function(a){if(isTouch||1==a.which)if(y)y=!1;else return D?D=!1:C?(h.hide(),f.hide(),C=!1):(h.show(),f.show(),C=!0,c.drawSVG(d.offset().left,d.offset().top,h.offset().left,
h.offset().top,f,g)),a.preventDefault(),a.stopPropagation(),!1});$(document).add(b).on("mousedown.noteImgShowHide touchstart.noteImgShowHide",function(){C&&(h.hide(),f.hide(),C=!1)});h.add(f).on("mousedown.noteImgShowHide touchstart.noteImgShowHide",function(a){a.preventDefault();a.stopPropagation();return!1});var E,G,z,A,H,F=!1;e.bind(_event._down,function(a){a=isTouch?a.originalEvent.touches[0]:a;E=parseFloat(d[0].offsetLeft);G=parseFloat(d[0].offsetTop);z=a.clientX;A=a.clientY;H=e.attr("data-key");
F=!0;if(C)var g=h.offset().left,j=h.offset().top,k=f.offset().left,l=f.offset().top;b.on("mousemove.noteObj touchmove.noteObj",function(a){if(F){d.css({cursor:"move"});var a=isTouch?a.originalEvent.touches[0]:a,e=E*BookInfo.scale()-(z-a.clientX),m=G*BookInfo.scale()-(A-a.clientY),e=100*(e/(b.width()*BookInfo.scale()))+"%",m=100*(m/(b.height()*BookInfo.scale()))+"%";d.css({left:e,top:m});C&&(h.css({left:g+(a.clientX-z),top:j+(a.clientY-A)}),f.css({left:k+(a.clientX-z),top:l+(a.clientY-A)}));if(8<Math.abs(a.clientX-
z)||8<Math.abs(a.clientY-A))D=!0;c.updateArrayOrderKey(c.notes,H,{left:e,top:m});c.addLocalStorage(c.cookieName,c.parseJSONArrayToString(c.notes))}});b.add(e).on("mouseup.noteObj touchend.noteObj",function(){F&&(d.css({cursor:"default"}),D=F=!1,b.off("mousemove.noteObj touchmove.noteObj"),b.add(e).off("mouseup.noteObj touchend.noteObj"))});a.stopPropagation();a.preventDefault();return!1});j.bind(_event._down,function(){$(".noteCookie-eachNote-textList").removeClass("noteCookie-eachNote-textList-current");
$(".noteCookie-eachNote").removeClass("noteCookie-eachNote-textList-current");h.addClass("noteCookie-eachNote-textList-current");d.addClass("noteCookie-eachNote-textList-current")});c.noteImgs[a.key]=d;c.noteTexts[a.key]=h;c.svgObjs[a.key]=f;return{noteObj:d,noteImg:e,noteText:p}},addNoteImgByPageIndex:function(a,b){b.find(".noteCookie-eachNote").remove();$(".noteCookie-eachNote-text"+a).remove();$(".noteCookie-eachNote-svg"+a).remove();for(var c=0;c<this.notes.length;c++)this.notes[c].page===a&&
this.addNoteImg(this.notes[c],b)},addListDataAndNoteImg:function(a,b){this.addListData(a);this.addNoteImg(a,b)},drawSVG:function(a,b,c,d,e,f){var g,h,j,k,m,l;a+28>=c+90.5&&b+28<=d?(l=b+28,d-=l,a+28<=c+109?(m=a+28,k=c+181-24-a+28,b=a=0,g=c+181-24-48-m,h=d,c=c+181-24-m):(m=c+109,c+181-24>=a+28?(k=48,a=a+28-m):a=k=a+28-m,g=b=0,h=d,c=48),j=d):a+28<c+90.5&&b+28<=d?(l=b+28,d-=l,a+28<=c+24?(m=a+28,k=c+24+48-m,b=a=0,g=k-48,h=d,c=k):(m=c+24,c+24+48<=a+28?a=k=a+28-m:(k=48,a=a+28-m),g=b=0,h=d,c=48),j=d):a+28>=
c+90.5&&b>=d+141-28?(l=d+141,d=b+28-l,a+28<=c+109?(m=a+28,k=c+181-24-a+28,a=0,b=d,g=c+181-24-48-m,h=0,c=c+181-24-m):(m=c+109,c+181-24>=a+28?(k=48,a=a+28-m):a=k=a+28-m,b=d,h=g=0,c=48),j=0):a+28<c+90.5&&b>=d+141-28?(l=d+141,d=b+28-l,a+28<=c+24?(m=a+28,k=c+24+48-m,a=0,b=d,g=k-48,h=0,c=k):(m=c+24,c+24+48<=a+28?a=k=a+28-m:(k=48,a=a+28-m),b=d,h=g=0,c=48),j=0):c+181<=a+28&&b+28>=d&&b+28<=d+70.5?(m=c+181,k=a+28-m,b+28<=d+20?(l=b+28,d=d+20+48-l,a=k,g=b=0,h=d-48,c=0,j=d):d+20+48<=b+28?(l=d+20,d=b+28-l,a=k,
b=d,c=h=g=0,j=48):(l=d+20,d=48,a=k,b=b+28-l,c=h=g=0,j=d)):c+181<=a+28&&b+28<=d+141&&b+28>=d+70.5?(m=c+181,k=a+28-m,b+28<=d+141-20-48?(l=b+28,d=d+141-20-l,a=k,g=b=0,h=d-48,c=0,j=d):d+141-20<=b+28?(l=d+141-68,d=b+28-l,a=k,b=d,c=h=g=0,j=48):(l=d+141-68,d=48,a=k,b=b+28-l,c=h=g=0,j=d)):c>=a+28&&b+28>=d&&b+28<=d+70.5?(m=a+28,k=c-m,b+28<=d+20?(l=b+28,d=d+20+48-l,b=a=0,g=k,h=d-48,c=k,j=d):d+20+48<=b+28?(l=d+20,d=b+28-l,a=0,b=d,g=k,h=0,c=k,j=48):(l=d+20,d=48,a=0,b=b+28-l,g=k,h=0,c=k,j=d)):c>=a+28&&b+28<=d+
141&&b+28>=d+70.5?(m=a+28,k=c-m,b+28<=d+141-20-48?(l=b+28,d=d+141-20-l,b=a=0,g=k,h=d-48,c=k,j=d):d+141-20<=b+28?(l=d+141-68,d=b+28-l,a=0,b=d,g=k,h=0,c=k,j=48):(l=d+141-68,d=48,a=0,b=b+28-l,g=k,h=0,c=k,j=d)):(h=g=b=a=k=d=l=m=0,c=48,j=0);e.show().css({width:k,height:d,left:m,top:l});f.attr("d","M"+c+","+j+" L"+a+","+b+" L"+g+","+h)},bindEvents:function(){var a=this,b=!1;BookInfo.container().on("mousedown.addNote touchstart.addNote",function(){a.noteImgContainers[BookInfo.getBookType()]&&a.noteImgContainers[BookInfo.getBookType()][BookInfo.getCurrentPages()[0]]&&
(a.noteImgContainers[BookInfo.getBookType()][BookInfo.getCurrentPages()[0]].css({cursor:"default"}),a.noteImgContainers[BookInfo.getBookType()][BookInfo.getCurrentPages()[0]].off("mousedown.addNote touchstart.addNote"));a.noteImgContainers[BookInfo.getBookType()]&&a.noteImgContainers[BookInfo.getBookType()][BookInfo.getCurrentPages()[1]]&&(a.noteImgContainers[BookInfo.getBookType()][BookInfo.getCurrentPages()[1]].css({cursor:"default"}),a.noteImgContainers[BookInfo.getBookType()][BookInfo.getCurrentPages()[1]].off("mousedown.addNote touchstart.addNote"));
BookInfo.container().off("mousedown.addNote touchstart.addNote");b=!1});a.addBtn.bind(_event._end,function(){if(a.inputText.val()){a.noteImgContainers[BookInfo.getBookType()]&&a.noteImgContainers[BookInfo.getBookType()][BookInfo.getCurrentPages()[0]]&&a.noteImgContainers[BookInfo.getBookType()][BookInfo.getCurrentPages()[0]].css({cursor:"url("+a.address+"note.png),auto"});a.noteImgContainers[BookInfo.getBookType()]&&a.noteImgContainers[BookInfo.getBookType()][BookInfo.getCurrentPages()[1]]&&a.noteImgContainers[BookInfo.getBookType()][BookInfo.getCurrentPages()[1]].css({cursor:"url("+
a.address+"note.png),auto"});a.noteHeight=a.note.height();a.noteTitleShowBtn.children("img").attr("src",a.address+"note_revert.png");a.note.animate({height:34},500,function(){a.noteButtonIsShow=!1});b=!0;var c=BookInfo.getCurrentPages();$.each(c,function(c,e){var f=a.noteImgContainers[BookInfo.getBookType()][e];f&&(f.off("mousedown.addNote touchstart.addNote"),f.on("mousedown.addNote touchstart.addNote",function(c){f.off("mousedown.addNote touchstart.addNote");if(b){var d=c.clientX-f.offset().left,
c=c.clientY-f.offset().top,d=100*(d/(f.width()*BookInfo.scale()))+"%",c=100*(c/(f.height()*BookInfo.scale()))+"%",d={key:(new Date).getTime(),time:(new Date).format("yyyy-MM-dd hh:mm:ss",!0),value:a.inputText.val(),left:d,top:c,page:e};a.addListDataAndNoteImg(d,$(this));a.downJSonArrByKey(a.rows,"page");$(".noteCookie-noteTable-row").detach();for(d=0;d<a.rows.length;d++)a.rows[d].rowObj.css({backgroundColor:0==d%2?"":"#bababa"}),a.rows[d].rowObj.appendTo(a.noteTableInner);a.scrollBarShowHide();a.noteImgContainers[BookInfo.getBookType()]&&
a.noteImgContainers[BookInfo.getBookType()][BookInfo.getCurrentPages()[0]]&&a.noteImgContainers[BookInfo.getBookType()][BookInfo.getCurrentPages()[0]].css({cursor:"default"});a.noteImgContainers[BookInfo.getBookType()]&&a.noteImgContainers[BookInfo.getBookType()][BookInfo.getCurrentPages()[1]]&&a.noteImgContainers[BookInfo.getBookType()][BookInfo.getCurrentPages()[1]].css({cursor:"default"});a.inputText.val("");b=!1}}))})}});a.noteTitleShowBtn.on("click.note touchend.note",function(){a.noteButtonIsShow?
(a.noteButtonIsShow=!1,a.noteTitleShowBtn.children("img").attr("src",a.address+"note_revert.png"),a.note.stop(!1,!1).animate({height:34},500,function(){})):(a.noteButtonIsShow=!0,a.noteTitleShowBtn.children("img").attr("src",a.address+"note_narrow.png"),a.note.stop(!1,!1).animate({height:a.noteHeight},500,function(){}))});a.noteTitleCloseBtn.on("click.note touchend.note",function(b){void 0!=a.onCreated?a.onCreated[1].call(a.onCreated[0]):a.hide();b.preventDefault();b.stopPropagation();return!1});
a.removeAllBtn.on("click.note touchend.note",function(){$(".noteCookie-eachNote").remove();$(".noteCookie-noteTable-row").remove();a.notes=[];a.rowObjs={};a.noteImgs={};a.noteTexts={};a.svgObjs={};a.rows=[];a.addLocalStorage(a.cookieName,a.parseJSONArrayToString(a.notes));a.setDelNoteHeight();a.scrollBarShowHide()})},setContainers:function(a,b,c){void 0==this.noteImgContainers[a]&&(this.noteImgContainers[a]={});this.noteImgContainers[a][b]=c;a==BookInfo.getBookType()&&($(".noteCookie-eachNote-textList").hide(),
$(".noteCookie-eachNote-svg").hide(),this.addNoteImgByPageIndex(b,c))},show:function(){this.showFlag=!0;this.note.show();parseInt(this.note.css("left"))>this.container.width()&&this.note.css({left:"50%"});0>parseInt(this.note.css("top"))&&this.note.css({top:24});this.scrollBarShowHide()},hide:function(){this.showFlag=!1;this.note.hide()},bindOnCreated:function(a,b){this.onCreated=[a,b]},showHide:function(){this.showFlag?this.hide():this.show();this.setDelNoteHeight()},parseJSONArrayToString:function(a){if(0!=
a.length){for(var b="[",c=0;c<a.length;c++)b+="{key:'"+a[c].key+"',value:'"+a[c].value+"',page:"+a[c].page+",time:'"+a[c].time+"',left:'"+a[c].left+"',top:'"+a[c].top+"'},";b=b.substring(0,b.length-1);return b+"]"}},delArrayOrderKey:function(a,b){if(a)for(var c=0;c<a.length;c++)a[c].key&&a[c].key==b&&a.remove(c)},updateArrayOrderKey:function(a,b,c){if(a)for(var d=0;d<a.length;d++)a[d].key&&a[d].key==b&&$.extend(a[d],c)},downJSonArrByKey:function(a,b){a.sort(function(a,d){return parseInt(a[b])>parseInt(d[b])?
1:parseInt(a[b])==parseInt(d[b])?0:-1})},isArray:function(a){return"[object Array]"==Object.prototype.toString.call(a)},getLocalStorage:function(a){return window.localStorage.getItem(a)},addLocalStorage:function(a,b){window.localStorage.setItem(a,b)},createScrollBar:function(a){var a=$("<div>",{"class":"ScrollBar",css:{position:"absolute",width:6,height:"100%",backgroundColor:"#a8a8a8",borderRadius:0,right:0,top:0,borderLeft:"1px solid #ffffff"}}).appendTo(a),b=$("<div>",{"class":"OuterScroll",css:{position:"absolute",
width:6,height:"100%",left:0,top:0,backgroundColor:"transparent",borderRadius:0,overflow:"hidden",cursor:"pointer"}}).appendTo(a);$("<div>",{"class":"InnerScroll",css:{position:"absolute",width:6,height:"100%",marginLeft:0,marginRight:0,left:0,top:0,backgroundColor:"#5e5e5e",borderRadius:0,cursor:"pointer"}}).appendTo(b);this.scrollBar=a;this.outerScroll=b;this.bindScrollBarEvents(a,b,this.noteTable,this.noteTableInner)},scrollBarShowHide:function(){this.outerScroll.css({height:this.noteTable.outerHeight()*
this.scrollBar.outerHeight()/this.noteTableInner.outerHeight()});this.noteTable.height()>=this.noteTableInner.height()?(this.scrollBar.hide(),this.noteTableInner.css({top:0}),$(".noteCookie-noteTable-inner").css({width:464}),$(".noteCookie-noteTable-cellRight").css({width:410}),$(".noteCookie-noteTable-cellRight-del").css({left:"auto",right:15})):(this.scrollBar.show(),Math.abs(parseFloat(this.noteTableInner.css("top")))>this.noteTableInner.outerHeight()-this.noteTable.outerHeight()&&(this.noteTableInner.css({top:-(this.noteTableInner.outerHeight()-
this.noteTable.outerHeight())}),this.outerScroll.css({top:this.scrollBar.outerHeight()-this.outerScroll.outerHeight()})),$(".noteCookie-noteTable-inner").css({width:457}),$(".noteCookie-noteTable-cellRight").css({width:403}),$(".noteCookie-noteTable-cellRight-del").css({left:"auto",right:11.5}))},bindScrollBarEvents:function(a,b,c,d){var e=this;b.on(_event._down,function(a){var c=a||event,h=c.clientY-e.outerScroll.position().top,j=a.which;a.stopPropagation();1==j&&($(document).on("mousemove.scrollBar touchmove.scrollBar",
function(a){a.preventDefault();a.stopPropagation();c=a||event;a=c.clientY-h;0>=a?a=0:a>=e.scrollBar.outerHeight()-e.outerScroll.outerHeight()&&(a=e.scrollBar.outerHeight()-e.outerScroll.outerHeight());b.css({top:a});d.css({top:-a/(e.scrollBar.outerHeight()-e.outerScroll.outerHeight())*(e.noteTableInner.outerHeight()-e.noteTable.outerHeight())})}),$(document).on("mouseup.scrollBar touchend.scrollBar",function(a){a=a||event;a.preventDefault();a.stopPropagation();$(document).off("mousemove.scrollBar touchmove.scrollBar");
$(document).off("mouseup.scrollBar touchend.scrollBar")}))});c.bind($.browser.mozilla?"DOMMouseScroll":"mousewheel",function(e){if(!(c.outerHeight()>=d.outerHeight())){var g=e.originalEvent,g=g.wheelDelta||-g.detail,h=d.position().top,j;d.stop(!1,!1);0<g?j=0>h+c.outerHeight()/11?h+c.outerHeight()/11:0:0>g&&(j=d.outerHeight()-c.outerHeight()>-(h-c.outerHeight()/11)?h-c.outerHeight()/11:-(d.outerHeight()-c.outerHeight()));d.css({top:j});b.css({top:-j/(d.outerHeight()-c.outerHeight())*(a.outerHeight()-
b.outerHeight())});e.stopPropagation();e.preventDefault();return!1}})}}),Signature=Class({statics:{signature:function(a){void 0==this._signature&&(this._signature=new Signature(a));return this._signature}},create:function(a){this.container=a;this.address=uiBaseURL;this.disableCss={boxShadow:"rgba(0, 0, 0, 0.6) 0px 1px 4px inset",backgroundColor:"#cccccc",textShadow:"0 1px 1px white",color:"rgb(165, 148, 148)",cursor:"default"};this.normalCss={boxShadow:"inset 0px 1px 0px rgba(255, 255, 255, 0.5), 0px 1px 2px rgba(0, 0, 0, 0.2)",
backgroundColor:"#E4E4E4",color:"#464343",textShadow:"",cursor:"pointer"};this.overCss={};this.downCss={backgroundColor:"#E4E4E4",color:"#374f00",boxShadow:"inset 0px 1px 3px rgba(0, 0, 0, 0.3), 0px 1px 0px white",textShadow:"0px 1px 0px rgba(255, 255, 255, 0.4)"};this.natureMessage="Welcome to the signature manager! Here, you can draw,type, or upload signatures to use on the PDF documents you sign.";this.writeMessage='Type your signature below, then press the "Save" or "Save & Use" button to proceed.';
this.drawMessage='Draw your signature below, then press the "Save" or "Save & Use" button to proceed.';this.redoIsUse=this.undoIsUse=this.clearAllFalg=this.hasDrawFlag=this.showFlag=this.hasAndChangeText=!1;this.drawOldData=this.currentDrawDel=this.currentDrawEdit=this.currentDrawSave=this.currentWriteDel=this.currentWriteEdit=this.currentWriteSave=null;this.drawOldPoints=[];this.savePoints=[];this.saveText=null;this.signatureName="Signature";this.signatureCookies=[];this.currentObj=null;this.signatureContexts=
{};this.createSignature(a);this.toolBar=this.createToolBar(a)},createToolBar:function(a){var b=this;this.showTimeFalg={};this.oldData={};var c=$("<div class='flipHTML5Signature-toolBar'></div>").appendTo(a).hide(),a=$("<div class='flipHTML5Signature-toolBar-del'></div>").css({left:4}).append($("<img style='margin-left: 3px;margin-top: 3px;'/>").attr("src",this.address+"signature_del.png")).appendTo(c),d=$("<div class='flipHTML5Signature-toolBar-up'></div>").css({left:32}).append($("<img style='margin-left: 3px;margin-top: 3px;'/>").attr("src",
this.address+"signature_up.png")).appendTo(c),e=$("<div class='flipHTML5Signature-toolBar-down'></div>").css({left:60}).append($("<img style='margin-left: 3px;margin-top: 3px;'/>").attr("src",this.address+"signature_down.png")).appendTo(c),f=$("<div class='flipHTML5Signature-toolBar-revert'></div>").css({left:88}).append($("<img style='margin-left: 2px;margin-top: 4px;'/>").attr("src",this.address+"signature_revert.png")).appendTo(c),g=$("<div class='flipHTML5Signature-toolBar-date'></div>").css({left:116}).append($("<img style='margin-left: 3px;margin-top: 4px;'/>").attr("src",
this.address+"signature_date.png")).appendTo(c);a.on("click touchend",function(){if(b.currentObj){b.currentObj.remove();c.hide();var a=b.currentObj.attr("data-key");delete b.showTimeFalg[a];delete b.oldData[a];b.delArrayOrderKey(b.signatureCookies,a);b.addLocalStorage(b.signatureName,b.parseToString(b.signatureCookies))}});d.on("click touchend",function(){if(b.currentObj){var a=b.currentObj.width(),c=b.currentObj.height(),d=a+20,a=d/(a/c);b.currentObj.css({width:d,height:a});c=b.currentObj.attr("data-key");
b.updateArrayOrderKey(b.signatureCookies,c,{width:d,height:a});b.addLocalStorage(b.signatureName,b.parseToString(b.signatureCookies));b.showTimeFalg[c]&&b.reviseDateTag()}});e.on("click touchend",function(){if(b.currentObj){var a=b.currentObj.width(),c=b.currentObj.height(),d=a-20,a=d/(a/c);b.currentObj.css({width:d,height:a});c=b.currentObj.attr("data-key");b.updateArrayOrderKey(b.signatureCookies,c,{width:d,height:a});b.addLocalStorage(b.signatureName,b.parseToString(b.signatureCookies));b.showTimeFalg[c]&&
b.reviseDateTag()}});f.on("click touchend",function(){if(b.currentObj){var a=b.currentObj.attr("data-key"),c=b.oldData[a].width,d=b.oldData[a].height;b.currentObj.css({width:c,height:d});b.showTimeFalg[a]&&b.reviseDateTag();b.updateArrayOrderKey(b.signatureCookies,a,{width:c,height:d});b.addLocalStorage(b.signatureName,b.parseToString(b.signatureCookies))}});g.on("click touchend",function(){var a=b.currentObj.attr("data-key");b.showTimeFalg[a]?(b.currentObj.find(".flipHTML5Signature-eachDate").hide(),
b.showTimeFalg[a]=!1):(b.reviseDateTag(),b.currentObj.find(".flipHTML5Signature-eachDate").show(),b.showTimeFalg[a]=!0)});c.on("mousedown touchstart",function(a){a.preventDefault();a.stopPropagation();return!1});this.container.add($(document)).add(BookInfo.container()).on("mousedown.hideToolBar touchstart.hideToolBar",function(){c.hide()});return c},createSignature:function(a){var b=this;this.$signature=$("<div class='flipHTML5Signature'></div>").appendTo(a).hide();this.$signatureTitle=$("<div class='flipHTML5Signature-title'></div>").append($("<span class='flipHTML5Signature-titleText'></span>").html("Signature Manager")).appendTo(this.$signature);
this.$closeBtn_title=$("<div class='flipHTML5Signature-titleClose'></div>").append($("<img style='margin-left: 2px;margin-top: 2px;'/>").attr("src",this.address+"signature_close.png")).appendTo(this.$signatureTitle);var c=this.getLocalStorage(this.signatureName);this.signatureCookies=c&&"undefined"!=c?eval(c):[];var d,e;this.$signatureTitle.on("mousedown touchstart",function(c){c=isTouch?c.originalEvent.touches[0]:c;d=c.clientX-b.$signature.position().left;e=c.clientY-b.$signature.position().top;
a.add($(document)).add(b.signatureContexts[BookInfo.getBookType()][BookInfo.getCurrentPages()[0]]).add(b.signatureContexts[BookInfo.getBookType()][BookInfo.getCurrentPages()[1]]).on("mousemove.signatureMove touchmove.signatureMove",function(a){b.$signatureTitle.css({cursor:"move"});a=isTouch?a.originalEvent.touches[0]:a;b.$signature.css({left:a.clientX-d,top:a.clientY-e})});a.add($(document)).on("mouseup.signatureMove touchend.signatureMove",function(){b.$signatureTitle.css({cursor:"default"});a.add($(document)).add(b.signatureContexts[BookInfo.getBookType()][BookInfo.getCurrentPages()[0]]).add(b.signatureContexts[BookInfo.getBookType()][BookInfo.getCurrentPages()[1]]).off("mousemove.signatureMove touchmove.signatureMove");
a.add($(document)).off("mouseup.signatureMove touchend.signatureMove")});c.preventDefault();c.stopPropagation();return!1});this.createSignatureUnder(this.$signature);this.createWriteTypeUnder(this.$signature);this.createDrawTypeUnder(this.$signature)},createSignatureUnder:function(a){var b=this;this.$signatureUnder=$("<div class='flipHTML5Signature-nuder'></div>").append($("<div class='flipHTML5Signature-nuderMessage'></div>").html(this.natureMessage)).appendTo(a);this.$underClose=$("<div class='flipHTML5Signature-nuderClose'></div>").html("Close").appendTo(this.$signatureUnder);
this.$closeBtn_title.add(this.$underClose).on("click.signature touchend.signature",function(){void 0!=b.onCreated?b.onCreated[1].call(b.onCreated[0]):b.hide()});this.createEachTypes(this.$signatureUnder)},createEachTypes:function(a){var b=this,c={width:52,left:57,borderTopLeftRadius:5,borderBottomLeftRadius:5},d={width:70,left:111,borderTopRightRadius:5,borderBottomRightRadius:5},a=$("<div class='flipHTML5Signature-nuderTypes'></div>").appendTo(a),e=$("<div class='flipHTML5Signature-nuderTypes-type'></div>").append($("<span class='flipHTML5Signature-typeTitle'></span>").html("Type on Keyboard")).css({left:17}).appendTo(a),
e=$("<div class='flipHTML5Signature-typeUnder'></div>").appendTo(e),f=$("<div class='flipHTML5Signature-typeMid'></div>").appendTo(e),g=$("<div class='flipHTML5Signature-typeEdit-typeDel'></div>").css(c).html("Edit").appendTo(e).hide(),h=$("<div class='flipHTML5Signature-typeEdit-typeDel'></div>").css(d).html("Delete").appendTo(e).hide(),a=$("<div class='flipHTML5Signature-nuderTypes-type'></div>").append($("<span class='flipHTML5Signature-typeTitle'></span>").html("Draw with Mouse")).css({left:"auto",
right:17}).appendTo(a),a=$("<div class='flipHTML5Signature-typeUnder'></div>").appendTo(a),j=$("<div class='flipHTML5Signature-typeMid'></div>").appendTo(a),k=$("<div class='flipHTML5Signature-typeEdit-typeDel'></div>").css(c).html("Edit").appendTo(a).hide(),m=$("<div class='flipHTML5Signature-typeEdit-typeDel'></div>").css(d).html("Delete").appendTo(a).hide();f.on("mouseover.signature touchstart.signature",function(){f.css({borderColor:"#ff0000"})});f.on("mouseout.signature touchend.signature",function(){f.css({borderColor:"#cccccc"})});
f.on("click.signature touchend.signature",function(){var a=$(this).html();a?(b.$writeText.val(a),b.saveAndUseWrite(a)):(b.writeSave.add(b.writeSaveAndUse).removeClass("flipHTML5Signature-hover flipHTML5Signature-normal").css(b.disableCss),b.hasAndChangeText=!1,b.$signatureUnder.hide(),b.$drawTypeUnder.hide(),b.$writeTypeUnder.show(),b.$writeText.focus(),b.currentWriteSave=f,b.currentWriteEdit=g,b.currentWriteDel=h)});g.on("click.signature touchend.signature",function(){b.currentWriteSave=f;b.currentWriteEdit=
g;b.currentWriteDel=h;b.$writeText.val(f.html());b.writeSave.add(b.writeSaveAndUse).removeClass("flipHTML5Signature-normal flipHTML5Signature-hover").css(b.disableCss);b.hasAndChangeText=!1;b.$signatureUnder.hide();b.$drawTypeUnder.hide();b.$writeTypeUnder.show()});h.on("click.signature touchend.signature",function(){b.currentWriteSave=f;b.currentWriteEdit=g;b.currentWriteDel=h;b.writeSave.add(b.writeSaveAndUse).removeClass("flipHTML5Signature-normal flipHTML5Signature-hover").css(b.disableCss);b.hasAndChangeText=
!1;f.html("");b.$writeText.val("");g.hide();h.hide()});j.on("mouseover.signature touchstart.signature",function(){j.css({borderColor:"#ff0000"})});j.on("mouseout.signature touchend.signature",function(){j.css({borderColor:"#cccccc"})});j.on("click.signature touchend.signature",function(){j.children("img").length?b.saveAndUseDraw(b.drawOldData):(b.$signatureUnder.hide(),b.$writeTypeUnder.hide(),b.$drawTypeUnder.show(),b.currentDrawSave=j,b.currentDrawEdit=k,b.currentDrawDel=m)});k.on("click.signature touchend.signature",
function(){b.currentDrawSave=j;b.currentDrawEdit=k;b.currentDrawDel=m;b.$signatureUnder.hide();b.$writeTypeUnder.hide();b.$drawTypeUnder.show()});m.on("click.signature touchend.signature",function(){b.currentDrawSave=j;b.currentDrawEdit=k;b.currentDrawDel=m;b.undo.add(b.redo).add(b.clearAllBtn).add(b.drawSave).add(b.drawSaveAndUse).removeClass("flipHTML5Signature-normal flipHTML5Signature-hover").css(b.disableCss);b.undoIsUse=!1;b.redoIsUse=!1;b.clearAllFalg=!1;b.hasDrawFlag=!1;k.hide();m.hide();
b.currentDrawSave&&b.currentDrawSave.empty();b.context.clearRect(0,0,b.canvas.width,b.canvas.height);b.previewContext.clearRect(0,0,b.previewCanvas.width,b.previewCanvas.height);b.drawOldPoints=[];b.points=[];b.drawOldPoints.push([])})},createWriteTypeUnder:function(a){var b=this,c=!1,d;this.$writeTypeUnder=$("<div class='flipHTML5Signature-writeType'></div>").append($("<div class='flipHTML5Signature-nuderMessage'></div>").html(this.writeMessage)).appendTo(a).hide();this.$writeText=$("<input type='text' class='flipHTML5Signature-writeType-text' maxlength='35'/>").appendTo(this.$writeTypeUnder);
this.writeSave=$("<div class='flipHTML5Signature-typeBtn flipHTML5Signature-type-save'></div>").html("Save").appendTo(this.$writeTypeUnder);this.writeSaveAndUse=$("<div class='flipHTML5Signature-typeBtn flipHTML5Signature-type-save-use'></div>").html("Save & Use").appendTo(this.$writeTypeUnder);a=$("<div class='flipHTML5Signature-typeBtn flipHTML5Signature-type-cancel'></div>").html("Cancel").appendTo(this.$writeTypeUnder);d=this.$writeText.val();this.writeSave.add(this.writeSaveAndUse).css(this.disableCss);
a.on("click touchend",function(){b.$writeText.val(d);b.$writeTypeUnder.hide();b.$drawTypeUnder.hide();b.$signatureUnder.show()});this.writeSaveAndUse.on("click touchend",function(){if(b.hasAndChangeText){var a=b.$writeText.val();if((d=a)&&c)b.saveText=a,b.saveAndUseWrite(a)}});this.writeSave.on("click touchend",function(){if(b.hasAndChangeText){var a=b.$writeText.val();if((d=a)&&c)b.saveText=a,b.saveWrite(a)}});b.writeSave.on("mouseover.signature touchstart.signature",function(){b.hasAndChangeText&&
b.writeSave.removeClass("flipHTML5Signature-normal").addClass("flipHTML5Signature-hover").css(b.overCss)});b.writeSaveAndUse.on("mouseover.signature touchstart.signature",function(){b.hasAndChangeText&&b.writeSaveAndUse.removeClass("flipHTML5Signature-normal").addClass("flipHTML5Signature-hover").css(b.overCss)});b.writeSave.on("mouseout.signature touchend.signature",function(){b.hasAndChangeText&&b.writeSave.removeClass("flipHTML5Signature-hover").addClass("flipHTML5Signature-normal").css(b.normalCss)});
b.writeSaveAndUse.on("mouseout.signature touchend.signature",function(){b.hasAndChangeText&&b.writeSaveAndUse.removeClass("flipHTML5Signature-hover").addClass("flipHTML5Signature-normal").css(b.normalCss)});b.writeSave.on("mousedown.signature",function(){b.hasAndChangeText&&b.writeSave.removeClass("flipHTML5Signature-hover flipHTML5Signature-normal").css(b.downCss)});b.writeSaveAndUse.on("mousedown.signature",function(){b.hasAndChangeText&&b.writeSaveAndUse.removeClass("flipHTML5Signature-hover flipHTML5Signature-normal").css(b.downCss)});
b.writeSave.add($(document)).on("mouseup.signature",function(){b.hasAndChangeText&&b.writeSave.removeClass("flipHTML5Signature-hover").addClass("flipHTML5Signature-normal").css(b.normalCss)});b.writeSaveAndUse.add($(document)).on("mouseup.signature",function(){b.hasAndChangeText&&b.writeSaveAndUse.removeClass("flipHTML5Signature-hover").addClass("flipHTML5Signature-normal").css(b.normalCss)});this.$writeText.on("input propertychange",function(){var a=b.$writeText.val();c=!0;a&&c?(b.writeSave.add(b.writeSaveAndUse).css(b.normalCss).addClass("flipHTML5Signature-normal").removeClass("flipHTML5Signature-hover"),
b.hasAndChangeText=!0):(b.hasAndChangeText=!1,b.writeSave.add(b.writeSaveAndUse).removeClass("flipHTML5Signature-hover flipHTML5Signature-normal").css(b.disableCss))})},createDrawTypeUnder:function(a){var b=this;this.$drawTypeUnder=$("<div class='flipHTML5Signature-drawType'></div>").append($("<div class='flipHTML5Signature-nuderMessage'></div>").html(this.drawMessage)).appendTo(a).hide();this.drawSave=$("<div class='flipHTML5Signature-typeBtn flipHTML5Signature-type-save'></div>").html("Save").appendTo(this.$drawTypeUnder);
this.drawSaveAndUse=$("<div class='flipHTML5Signature-typeBtn flipHTML5Signature-type-save-use'></div>").html("Save & Use").appendTo(this.$drawTypeUnder);a=$("<div class='flipHTML5Signature-typeBtn flipHTML5Signature-type-cancel'></div>").html("Cancel").appendTo(this.$drawTypeUnder);this.drawSave.add(this.drawSaveAndUse).removeClass("flipHTML5Signature-normal flipHTML5Signature-hover").css(this.disableCss);this.drawSave.on("click touchend",function(){if(b.hasDrawFlag){var a=b.trimCanvas(t);b.savePoints=
b.points.concat();b.savePoints.push({color:b.drawColor});b.saveDraw(a)}});this.drawSaveAndUse.on("click touchend",function(){if(b.hasDrawFlag){var a=b.trimCanvas(t);b.savePoints=b.points.concat();b.savePoints.push({color:b.drawColor});b.saveAndUseDraw(a)}});b.drawSave.on("mouseover.signature touchstart.signature",function(){b.hasDrawFlag&&b.drawSave.removeClass("flipHTML5Signature-normal").addClass("flipHTML5Signature-hover").css(b.overCss)});b.drawSaveAndUse.on("mouseover.signature touchstart.signature",
function(){b.hasDrawFlag&&b.drawSaveAndUse.removeClass("flipHTML5Signature-normal").addClass("flipHTML5Signature-hover").css(b.overCss)});b.drawSave.on("mouseout.signature touchend.signature",function(){b.hasDrawFlag&&b.drawSave.removeClass("flipHTML5Signature-hover").addClass("flipHTML5Signature-normal").css(b.normalCss)});b.drawSaveAndUse.on("mouseout.signature touchend.signature",function(){b.hasDrawFlag&&b.drawSaveAndUse.removeClass("flipHTML5Signature-hover").addClass("flipHTML5Signature-normal").css(b.normalCss)});
b.drawSave.on("mousedown.signature",function(){b.hasDrawFlag&&b.drawSave.removeClass("flipHTML5Signature-hover flipHTML5Signature-normal").css(b.downCss)});b.drawSaveAndUse.on("mousedown.signature",function(){b.hasDrawFlag&&b.drawSaveAndUse.removeClass("flipHTML5Signature-hover flipHTML5Signature-normal").css(b.downCss)});b.drawSave.add($(document)).on("mouseup.signature",function(){b.hasDrawFlag&&b.drawSave.removeClass("flipHTML5Signature-hover").addClass("flipHTML5Signature-normal").css(b.normalCss)});
b.drawSaveAndUse.add($(document)).on("mouseup.signature",function(){b.hasDrawFlag&&b.drawSaveAndUse.removeClass("flipHTML5Signature-hover").addClass("flipHTML5Signature-normal").css(b.normalCss)});a.on("click touchend",function(){b.$writeTypeUnder.hide();b.$drawTypeUnder.hide();b.$signatureUnder.show()});var a=$("<div class='flipHTML5Signature-drawTypeMid'></div>").appendTo(this.$drawTypeUnder),c=$("<div class='flipHTML5Signature-drawTypeMid-lineWidth'></div>").appendTo(a).append($("<img>").attr("src",
this.address+"pen.png")),d=$("<div style='position: absolute;width: 100px;height: 4px; background-color: #E0E0E0;left: 20px;top: 6px;border-radius: 2px;'></div>").css({boxShadow:"rgb(166, 166, 166) 1px 1px 0px inset, rgb(246, 246, 246) 1px 1px 0px"}).appendTo(c),e=$("<div style='position: absolute;cursor:pointer;width: 0px; height: 0px;border-bottom-width: 11px;border-style: solid;border-left-width: 6px;border-right-width: 6px;top: -3px;border-color: transparent;border-bottom-color: #373737;left: -4px;'></div>").appendTo(d),
f=$("<input type='text' style='position: absolute;width: 40px;height: 13px;left: 130px;top: 0px;'/>").appendTo(c),g=$("<div class='flipHTML5Signature-drawTypeMid-undo'></div>").appendTo(a).html("UNDO"),h=$("<div class='flipHTML5Signature-drawTypeMid-redo'></div>").appendTo(a).html("REDO"),j=$("<div class='flipHTML5Signature-drawTypeMid-clearAll'></div>").html("Clear All").appendTo(a);this.clearAllBtn=j;g.add(h).add(j).removeClass("flipHTML5Signature-normal flipHTML5Signature-hover").css(this.disableCss);
this.undo=g;this.redo=h;g.on("mouseover.signature touchstart.signature",function(){b.undoIsUse&&g.removeClass("flipHTML5Signature-normal").addClass("flipHTML5Signature-hover").css(b.overCss)});h.on("mouseover.signature touchstart.signature",function(){b.redoIsUse&&h.removeClass("flipHTML5Signature-normal").addClass("flipHTML5Signature-hover").css(b.overCss)});j.on("mouseover.signature touchstart.signature",function(){b.clearAllFalg&&j.removeClass("flipHTML5Signature-normal").addClass("flipHTML5Signature-hover").css(b.overCss)});
g.on("mouseout.signature touchend.signature",function(){b.undoIsUse&&g.removeClass("flipHTML5Signature-hover").addClass("flipHTML5Signature-normal").css(b.normalCss)});h.on("mouseout.signature touchend.signature",function(){b.redoIsUse&&h.removeClass("flipHTML5Signature-hover").addClass("flipHTML5Signature-normal").css(b.normalCss)});j.on("mouseout.signature touchend.signature",function(){b.clearAllFalg&&j.removeClass("flipHTML5Signature-hover").addClass("flipHTML5Signature-normal").css(b.normalCss)});
g.on("mousedown.signature",function(){b.undoIsUse&&g.removeClass("flipHTML5Signature-hover flipHTML5Signature-normal").css(b.downCss)});h.on("mousedown.signature",function(){b.redoIsUse&&h.removeClass("flipHTML5Signature-hover flipHTML5Signature-normal").css(b.downCss)});j.on("mousedown.signature",function(){b.clearAllFalg&&j.removeClass("flipHTML5Signature-hover flipHTML5Signature-normal").css(b.downCss)});g.add($(document)).on("mouseup.signature",function(){b.undoIsUse&&g.removeClass("flipHTML5Signature-hover").addClass("flipHTML5Signature-normal").css(b.normalCss)});
h.add($(document)).on("mouseup.signature",function(){b.redoIsUse&&h.removeClass("flipHTML5Signature-hover").addClass("flipHTML5Signature-normal").css(b.normalCss)});j.add($(document)).on("mouseup.signature",function(){b.clearAllFalg&&j.removeClass("flipHTML5Signature-hover").addClass("flipHTML5Signature-normal").css(b.normalCss)});var k=$("<div class='flipHTML5Signature-drawTypeMid-preview'></div>").html("Preview").appendTo(a),m=16*(60/140),l=document.createElement("canvas"),n=l.getContext("2d"),
o=$(l).css({position:"absolute",left:0,top:-Math.floor(m)});k.append(o);this.previewCanvas=l;this.previewContext=n;l.width=234;l.height=60+Math.ceil(m)+10;a=this.colorPicker(a);a.container.css({left:220,top:11});var p,q,s;f[0].value=parseFloat((7*(parseInt(e.css("left"))+4)+1).toFixed(2));e.on("mousedown touchstart",function(a){p=a.clientX-e.position().left;d.add(c).add($(document)).on("mousemove.lineWidth touchmove.lineWidth",function(a){q=a.clientX-p;q=-4>=q?-4:93<=q?93:q;e.css({left:q});s=7*((q+
4)/97)+1;s=parseFloat(s.toFixed(2));f[0].value=s});c.add($(document)).on("mouseup.lineWidth touchend.lineWidth",function(){b.changeLineWidth(s);d.add(c).add($(document)).off("mousemove.lineWidth touchmove.lineWidth");c.add($(document)).off("mouseup.lineWidth touchend.lineWidth")});a.preventDefault();a.stopPropagation();return!1});d.on("mousedown touchstart",function(a){a=a.clientX-d.offset().left;a=0>=a?0:97<=a?97:a;e.css({left:a-4});s=7*(a/97)+1;s=parseFloat(s.toFixed(2));f[0].value=s;b.changeLineWidth(s)});
f.on("change",function(){var a=f[0].value;isNaN(a)?f[0].value=parseFloat((7*((e.position().left+4)/97)+1).toFixed(2)):(1>a?(f[0].value=1,e.css({left:-4})):8<a?(f[0].value=8,e.css({left:93})):(f[0].value=a,e.css({left:97*((a-1)/7)-4})),b.changeLineWidth(f[0].value))});j.on("click touchend",function(){b.clearAllFalg&&(u.clearRect(0,0,t.width,t.height),n.clearRect(0,0,l.width,l.height),b.drawSave.add(b.drawSaveAndUse).removeClass("flipHTML5Signature-normal flipHTML5Signature-hover").css(b.disableCss),
b.hasDrawFlag=!1,b.redoIsUse=!0,h.css(b.normalCss).addClass("flipHTML5Signature-normal").removeClass("flipHTML5Signature-hover"),b.undoIsUse=!1,g.removeClass("flipHTML5Signature-hover flipHTML5Signature-normal").css(b.disableCss),v=b.drawOldPoints.length-1,j.add(b.drawSaveAndUse).removeClass("flipHTML5Signature-normal flipHTML5Signature-hover").css(b.disableCss),b.clearAllFalg=!1,b.points=[])});var v=0;g.on("mousedown.signature touchstart.signature",function(a){if(b.undoIsUse){b.redoIsUse=!0;h.css(b.normalCss).addClass("flipHTML5Signature-normal").removeClass("flipHTML5Signature-hover");
v+=1;v=v>=b.drawOldPoints.length?b.drawOldPoints.length-1:v;u.clearRect(0,0,t.width,t.height);n.clearRect(0,0,l.width,l.height);var c=b.drawOldPoints[b.drawOldPoints.length-1-v];b.points=c.concat();b.draw(t,u,b.drawOldPoints[b.drawOldPoints.length-1-v],b.drawColor,b.lineWidth);b.drawPreview(l,n,c,b.drawColor,b.lineWidth);b.drawSave.add(b.drawSaveAndUse).removeClass("flipHTML5Signature-hover").addClass("flipHTML5Signature-normal").css(b.normalCss);b.hasDrawFlag=!0;j.add(b.drawSaveAndUse).removeClass("flipHTML5Signature-hover").addClass("flipHTML5Signature-normal").css(b.normalCss);
b.clearAllFalg=!0;v==b.drawOldPoints.length-1&&(b.undoIsUse=!1,g.removeClass("flipHTML5Signature-hover flipHTML5Signature-normal").css(b.disableCss),b.drawSave.add(b.drawSaveAndUse).removeClass("flipHTML5Signature-normal flipHTML5Signature-hover").css(b.disableCss),b.hasDrawFlag=!1,j.add(b.drawSaveAndUse).removeClass("flipHTML5Signature-normal flipHTML5Signature-hover").css(b.disableCss),b.clearAllFalg=!1);a.preventDefault();a.stopPropagation();return!1}});h.on("mousedown.signature touchstart.signature",
function(a){if(b.redoIsUse){b.undoIsUse=!0;g.css(b.normalCss).addClass("flipHTML5Signature-normal").removeClass("flipHTML5Signature-hover");v-=1;v=0>=v?0:v;u.clearRect(0,0,t.width,t.height);n.clearRect(0,0,l.width,l.height);var c=b.drawOldPoints[b.drawOldPoints.length-1-v];b.points=c.concat();b.draw(t,u,b.drawOldPoints[b.drawOldPoints.length-1-v],b.drawColor,b.lineWidth);b.drawPreview(l,n,c,b.drawColor,b.lineWidth);b.drawSave.add(b.drawSaveAndUse).removeClass("flipHTML5Signature-hover").addClass("flipHTML5Signature-normal").css(b.normalCss);
b.hasDrawFlag=!0;j.add(b.drawSaveAndUse).removeClass("flipHTML5Signature-hover").addClass("flipHTML5Signature-normal").css(b.normalCss);b.clearAllFalg=!0;0==v&&(b.redoIsUse=!1,h.removeClass("flipHTML5Signature-hover flipHTML5Signature-normal").css(b.disableCss));a.preventDefault();a.stopPropagation();return!1}});b.drawOldPoints.push([]);k=$("<div class='flipHTML5Signature-drawTypeBottom-out'></div>").appendTo(this.$drawTypeUnder);m=$("<div class='flipHTML5Signature-drawTypeBottom'></div>").appendTo(k);
k.css({cursor:"url("+b.address+"pen.png),auto"});var t=document.createElement("canvas"),r=window.canvas=$(t);m.append(r);t.width=540;t.height=158;$(t).css({position:"absolute",left:0,top:-16});var u=t.getContext("2d");this.canvas=t;this.context=u;this.points=[];this.drawColor=a.message[0].style.backgroundColor;this.lineWidth=1;var w,B;r.on("mousedown.signature touchstart.signature",function(a){if(b.redoIsUse){var c=b.drawOldPoints.length;b.drawOldPoints.length=c-v;b.points=b.drawOldPoints[c-v-1].concat();
v=0}b.undoIsUse=!0;g.css(b.normalCss).addClass("flipHTML5Signature-normal").removeClass("flipHTML5Signature-hover");b.redoIsUse=!1;h.removeClass("flipHTML5Signature-hover flipHTML5Signature-normal").css(b.disableCss);b.clearAllFalg=!0;j.removeClass("flipHTML5Signature-hover").addClass("flipHTML5Signature-normal").css(b.normalCss);b.hasDrawFlag=!0;b.drawSave.add(b.drawSaveAndUse).css(b.normalCss).addClass("flipHTML5Signature-normal").removeClass("flipHTML5Signature-hover");w={x:a.clientX-r.offset().left+
0,y:a.clientY-r.offset().top+16,t:0,w:b.lineWidth};b.points.push(w);r.on("mousemove.signature touchmove.signature",function(a){B={x:a.clientX-r.offset().left+0,y:Math.min(a.clientY-r.offset().top+16,156),t:1};b.points.push(B);b.draw(t,u,b.points,b.drawColor,b.lineWidth);b.drawPreview(l,n,b.points,b.drawColor,b.lineWidth)});r.add($(document)).on("mouseup.signature touchend.signature",function(){b.drawOldPoints.push(b.points.concat());r.off("mousemove.signature touchmove.signature");r.add($(document)).off("mouseup.signature touchend.signature")});
a.preventDefault();a.stopPropagation();return!1})},addSignatureImg:function(a,b,c){var d=this;a.on("mousedown.hideToolBar touchstart.hideToolBar",function(){d.toolBar&&d.toolBar.hide()});a.css({cursor:"url("+b.url+"),auto"});void 0!=d.onCreated?d.onCreated[1].call(d.onCreated[0]):d.hide();a.off("mousedown.signature touchstart.signature");a.on("mousedown.signature touchstart.signature",function(e){a.off("mousedown.signature touchstart.signature");if(isTouch||1===e.which){var f=new Date,g=f.getTime(),
f=f.format("MM/dd/yyyy hh:mm:ss");d.showTimeFalg[g]=!1;d.oldData[g]=b;var h=e.clientX-a.offset().left,e=e.clientY-a.offset().top,h=100*(h/(a.width()*BookInfo.scale()))+"%",e=100*(e/(a.height()*BookInfo.scale()))+"%";d.createSignatureImg(a,b,c,h,e,g,f);d.signatureCookies.push({type:b.type,data:0===b.type?d.saveText:d.savePoints,key:g,page:c,currentTime:f,left:h,top:e,width:b.width,height:b.height});d.addLocalStorage(d.signatureName,d.parseToString(d.signatureCookies))}});a.add($(document)).add(BookInfo.container()).on("mouseup.signature touchend.signature",
function(){d.signatureContexts[BookInfo.getBookType()]&&d.signatureContexts[BookInfo.getBookType()][BookInfo.getCurrentPages()[0]]&&(d.signatureContexts[BookInfo.getBookType()][BookInfo.getCurrentPages()[0]].css({cursor:"default"}),d.signatureContexts[BookInfo.getBookType()][BookInfo.getCurrentPages()[0]].off("mousedown.signature touchstart.signature"));d.signatureContexts[BookInfo.getBookType()]&&d.signatureContexts[BookInfo.getBookType()][BookInfo.getCurrentPages()[1]]&&(d.signatureContexts[BookInfo.getBookType()][BookInfo.getCurrentPages()[1]].css({cursor:"default"}),
d.signatureContexts[BookInfo.getBookType()][BookInfo.getCurrentPages()[1]].off("mousedown.signature touchstart.signature"));a.css({cursor:"default"});a.off("mousedown.signature touchstart.signature");a.add($(document)).add(BookInfo.container()).off("mousedown.signature touchstart.signature")})},createSignatureImg:function(a,b,c,d,e,f,g){var h=this;a.on("mousedown.hideToolBar touchstart.hideToolBar",function(){h.toolBar&&h.toolBar.hide()});var j=$("<div class='flipHTML5Signature-eachSignatureImg'></div>").append($("<img style='width: 100%;height: 100%;position: absolute;left: 0px;top: 0px;'/>").attr("src",
b.url)).attr("data-key",f).attr("data-page",c).css({position:"absolute",width:b.width,height:b.height,left:d,top:e}).appendTo(a),k=$("<div class='flipHTML5Signature-eachDate' style='position: absolute;width: 180px;height: 45px;border: 1px dashed #2F2F2F;top: -24px;'></div>").css({left:b.width+2}).hide().html(g),b=$("<img/>").attr("src",h.address+"signature_dateClose.png").css({position:"absolute",top:0,right:0,cursor:"pointer"});k.appendTo(j).append(b);b.off("mousedown touchstart");b.on("mousedown touchstart",
function(){var a=h.currentObj.attr("data-key");k.hide();h.showTimeFalg[a]=!1});k.off("mousedown touchstart");k.on("mousedown touchstart",function(a){a.preventDefault();a.stopPropagation();return!1});j.off("mouseover.signature touchstart.signature");j.on("mouseover.signature touchstart.signature",function(){j.css({border:"1px solid #ff0000"})});j.off("mouseout.signature touchend.signature");j.on("mouseout.signature touchend.signature",function(){j.css({border:0})});j.off("mousedown.getObj touchstart.getObj");
j.on("mousedown.getObj touchstart.getObj",function(){$(".flipHTML5Signature-eachSignatureImg").css({zIndex:1});j.css({zIndex:4});h.currentObj=j;h.toolBar.css({left:j.offset().left-h.container.offset().left,top:j.offset().top-h.container.offset().top-h.toolBar.outerHeight()}).show()});var m,l,n=!1;j.off("mousedown.signatureImg touchstart.signatureImg");j.on("mousedown.signatureImg touchstart.signatureImg",function(b){m=b.clientX-j.position().left;l=b.clientY-j.position().top;a.on("mousemove.signatureImg touchmove.signatureImg",
function(b){n=!0;var c=b.clientX-m,b=b.clientY-l,c=100*(c/(a.width()*BookInfo.scale()))+"%",b=100*(b/(a.height()*BookInfo.scale()))+"%";j.css({left:c,top:b,cursor:"move"});h.toolBar.css({left:j.offset().left-h.container.offset().left,top:j.offset().top-h.container.offset().top-h.toolBar.outerHeight()}).show();h.showTimeFalg[f]&&h.reviseDateTag()});j.add(a).add($(document)).on("mouseup.signatureImg touchend.signatureImg",function(){j.css({cursor:"default"});a.off("mousemove.signatureImg touchmove.signatureImg");
j.add(a).add($(document)).off("mouseup.signatureImg touchend.signatureImg");if(n){var b=j.attr("data-key"),c=100*(parseFloat(j.css("left"))/a.width())+"%";e=100*(parseFloat(j.css("top"))/a.height())+"%";h.updateArrayOrderKey(h.signatureCookies,b,{left:c,top:e});h.addLocalStorage(h.signatureName,h.parseToString(h.signatureCookies))}});b.preventDefault();b.stopPropagation();return!1});a.css({cursor:"default"})},draw:function(a,b,c,d,e){var f=-1,g=c.length;b.clearRect(0,0,a.width,a.height);b.save();
b.beginPath();b.lineJoin="round";b.strokeStyle=d;for(b.lineWidth=e;++f<g;)a=c[f],0===a.t?(b.stroke(),b.beginPath(),b.lineWidth=a.w,b.moveTo(a.x,a.y)):b.lineTo(a.x,a.y);b.stroke();b.restore()},drawPreview:function(a,b,c,d,e){var f=-1,g=c.length,h=140/60,j=540/234;b.clearRect(0,0,a.width,a.height);b.save();b.beginPath();b.lineJoin="round";b.strokeStyle=d;for(b.lineWidth=e;++f<g;)a=c[f],0===a.t?(b.stroke(),b.beginPath(),b.lineWidth=a.w/h,b.moveTo(a.x/j,a.y/h)):b.lineTo(a.x/j,a.y/j);b.stroke();b.restore()},
trimCanvas:function(a){var b=a.getContext("2d"),c=document.createElement("canvas").getContext("2d"),d=b.getImageData(0,0,a.width,a.height),e=d.data.length,f,g=null,h=null,j=null,k=null,m,l;for(f=0;f<e;f+=4)0!==d.data[f+3]&&(m=f/4%a.width,l=~~(f/4/a.width),null===g&&(g=l),null===h?h=m:m<h&&(h=m),null===j?j=m:j<m&&(j=m),null===k?k=l:k<l&&(k=l));a=k-g;j-=h;b=b.getImageData(h,g,j,a);c.canvas.width=j;c.canvas.height=a;c.putImageData(b,0,0);return{url:c.canvas.toDataURL("image/png"),width:j,height:a}},
saveDraw:function(a){if(this.currentDrawSave){this.currentDrawSave.empty();var b=this.currentDrawSave.width(),c=this.currentDrawSave.height(),d=b/c,e=a.width,f=a.height,g=e/f;b>e&&c>f?(d=e,b=(b-d)/2,c=(c-f)/2):b>e&&c<f?(d=c*g,f=c,b=(b-d)/2,c=(c-f)/2):b<e&&c>f?(d=b,f=b/g,b=(b-d)/2,c=(c-f)/2):d>g?(f=c,d=c*g,b=(b-d)/2,c=0):d<g?(d=b,f=b/g,b=0,c=(c-f)/2):(d=b,f=c,c=b=0);this.currentDrawSave.append($("<img/>").css({position:"absolute",width:d,height:f,left:b,top:c}).attr("src",a.url))}this.drawOldData=
a;this.currentDrawEdit.show();this.currentDrawDel.show();this.$writeTypeUnder.hide();this.$drawTypeUnder.hide();this.$signatureUnder.show()},saveAndUseDraw:function(a){var b=this,c=BookInfo.getCurrentPages();$.each(c,function(c,e){var f=b.signatureContexts[BookInfo.getBookType()][e];f&&(a.type=1,b.addSignatureImg(f,a,e))});b.saveDraw(a)},saveWrite:function(a){this.currentWriteSave.html(a);this.currentWriteEdit.show();this.currentWriteDel.show();this.$writeTypeUnder.hide();this.$drawTypeUnder.hide();
this.$signatureUnder.show()},saveAndUseWrite:function(a){var b=this,c=b.drawTextByDiv(a,"38px","Mistral","#000000"),d=BookInfo.getCurrentPages();$.each(d,function(a,d){var g=b.signatureContexts[BookInfo.getBookType()][d];g&&(c.type=0,g.css({cursor:"default"}),b.addSignatureImg(g,c,d))});b.saveWrite(a)},drawTextByDiv:function(a,b,c,d){var e=document.createElement("canvas"),f=window.context=e.getContext("2d");f.fillStyle=d;f.font=""+b+" "+c+"";var g=f.measureText(a).width+8;e.width=g;e.height=54;f.fillStyle=
d;f.font=""+b+" "+c+"";f.textBaseline="top";f.fillText(a,3,0);return{url:e.toDataURL("image/png"),width:g,height:54}},close:function(){this.$signature.hide();this.$signatureUnder.show();this.$writeTypeUnder.hide();this.$drawTypeUnder.hide();this.showFlag=!1},show:function(){this.$signature.show();this.$signatureUnder.show();this.$writeTypeUnder.hide();this.$drawTypeUnder.hide();this.showFlag=!0},hide:function(){this.close()},showHide:function(){this.showFlag?this.hide():this.show()},changeColor:function(a){this.drawColor=
a;this.draw(this.canvas,this.context,this.points,a,this.lineWidth);this.drawPreview(this.previewCanvas,this.previewContext,this.points,this.drawColor,this.lineWidth);return a},changeLineWidth:function(a){return this.lineWidth=a},colorPicker:function(a){var b,c,d,e=this,f="#FF0000,#FF5555,#FF55AA,#FF55FF,#FFAA55,#FFAAAA,#FFAAFF,#FFFF55,#FFFFAA,#FFFFFF,#CC0000,#CC5555,#CC55AA,#CC55FF,#CCAA55,#CCAAAA,#CCAAFF,#CCFF55,#CCFFAA,#CCFFFF,#AA0000,#AA5555,#AA55AA,#AA55FF,#AAAA55,#AAAAAA,#AAAAFF,#AAFF55,#AAFFAA,#AAFFFF,#880000,#885555,#8855AA,#8855FF,#88AA55,#88AAAA,#88AAFF,#88FF55,#88FFAA,#88FFFF,#550000,#555555,#5555AA,#5555FF,#55AA55,#55AAAA,#55AAFF,#55FF55,#55FFAA,#55FFFF,#220000,#225555,#2255AA,#2255FF,#22AA55,#22AAAA,#22AAFF,#22FF55,#22FFAA,#22FFFF,#000000,#005555,#0055AA,#0055FF,#00AA55,#00AAAA,#00AAFF,#00FF55,#00FFAA,#00FFFF".split(","),
g=document.createElement("table");b=document.createElement("a");var h=$(b),j=document.createElement("input"),k=function(){},m=function(){g.style.display="none";j.value=j.style.backgroundColor=this.title.toUpperCase();e.changeColor(this.title.toUpperCase())};h.appendTo(a);b.className="flipHtml5ColorSelectorWrap";g.setAttribute("border","1");b.style.position="absolute";b.href="javascript:void(0);";j.type="text";j.className="flipHtml5ColorSelectorMessage";j.value=j.style.backgroundColor="#000000";j.style.cursor=
"pointer";j.style.padding="0px";b.appendChild(j);b.appendChild(g);g.style.display="none";g.style.position="relative";g.style.zIndex=9999;g.style.backgroundColor="#ffffff";for(c=0;7>c;c++){d=document.createElement("tr");d.style.position="relative";for(b=0;10>b;b++)a=document.createElement("td"),a.className="flipHtml5ColorSelectorBlock",a.title=f[10*c+b],a.style.backgroundColor=f[10*c+b],$(a).on("mouseenter",k),$(a).on("click touchstart",m),d.appendChild(a);g.appendChild(d)}$(j).on("click touchstart",
function(a){g.style.display="table-cell";a.stopPropagation();a.stopPropagation();return!1});$(document).on("click touchstart",function(){g.style.display="none"});return{container:h,message:$(j)}},setContainers:function(a,b,c){void 0==this.signatureContexts[a]&&(this.signatureContexts[a]={});this.signatureContexts[a][b]=c;a==BookInfo.getBookType()&&(this.toolBar.hide(),this.addSignatureByPageIndex(b,c))},addSignatureByPageIndex:function(a,b){b.find(".flipHTML5Signature-eachSignatureImg").remove();
for(var c=0;c<this.signatureCookies.length;c++){var d=this.signatureCookies[c];if(d.page===a){var e=d.left,f=d.top,g=d.key,h=d.currentTime;if(0==d.type)var j=this.drawTextByDiv(d.data,"38px","Mistral","#000000");else{j=document.createElement("canvas");j.width=540;j.height=158;$(j).css({position:"absolute",left:0,top:-16});var k=j.getContext("2d"),m=d.data.concat(),l=m.pop();this.draw(j,k,m,l.color,1);j=this.trimCanvas(j)}this.oldData[g]=j;j=$.extend({},j,{width:d.width,height:d.height});this.createSignatureImg(b,
j,d.page,e,f,g,h)}}},getLocalStorage:function(a){return window.localStorage.getItem(a)},addLocalStorage:function(a,b){window.localStorage.setItem(a,b)},parseToString:function(a){if(0==a.length)return console.log("===="),"";for(var b="[",c=0;c<a.length;c++)b=0==a[c].type?b+("{type:"+a[c].type+",key:"+a[c].key+",data:'"+a[c].data+"',page:"+a[c].page+",currentTime:'"+a[c].currentTime+"',left:'"+a[c].left+"',top:'"+a[c].top+"',width:"+a[c].width+",height:"+a[c].height+"},"):b+("{type:"+a[c].type+",key:"+
a[c].key+",data:"+this.parsePointsToString(a[c].data)+",page:"+a[c].page+",currentTime:'"+a[c].currentTime+"',left:'"+a[c].left+"',top:'"+a[c].top+"',width:"+a[c].width+",height:"+a[c].height+"},");b=b.substring(0,b.length-1);return b+"]"},parsePointsToString:function(a){if(0!=a.length){for(var b="[",c=0;c<a.length-1;c++)b+="{x:"+a[c].x+",y:"+a[c].y+",t:"+a[c].t+",w:"+a[c].w+"},";b+="{color:'"+a[a.length-1].color+"'}";return b+"]"}},delArrayOrderKey:function(a,b){if(a)for(var c=0;c<a.length;c++)a[c].key&&
a[c].key==b&&a.remove(c)},updateArrayOrderKey:function(a,b,c){if(a)for(var d=0;d<a.length;d++)a[d].key&&a[d].key==b&&$.extend(a[d],c)},createCursorImg:function(a,b,c){var d=$("<img/>").attr("src",a.url).css({position:"absolute",width:a.width,height:a.height,left:b+10,top:c+10}).appendTo(this.container);d.on("mousemove touchmove",function(a){d.css({left:a.clientX+10,top:a.clientY+10})});return d},reviseDateTag:function(){if(this.currentObj){var a=this.currentObj.find(".flipHTML5Signature-eachDate"),
b=this.currentObj.parent(),c=parseInt(this.currentObj.css("left")),d=parseInt(this.currentObj.css("top"));this.currentObj.position();var e=this.currentObj.outerWidth(),f=this.currentObj.outerHeight(),g=b.width();b.height();var b=a.outerWidth(),h=a.outerHeight(),j=this.toolBar.height();c+e+2+b<=g?a.css({left:e+2,top:-24}):h+j<=d?a.css({left:e-b,top:-(h+j)}):a.css({left:e-b,top:f+18})}},bindOnCreated:function(a,b){this.onCreated=[a,b]}});
(function(a,b,c){window.Remark=b({statics:{},create:function(){this.expires=30;this.currentEditor=a("<div>");this.backgroundColor="rgba(255, 255, 85, 0.5)";this.highlightBackcolor="rgba(2, 255, 245, 0.5)";this.fontSize=5;this.fontName="Times";this.$bookContainer=c.container();this.fontColor="black";this.title="#00000";this.opacity="1.0";this.contextArray=[];this.noteImgContainers={};this.$document=a(document);this.newSizeWrap();var b=this.createToolbar(),e=this.createHighlightToolbar();b.appendChild(this.createColorSelector());
document.getElementsByTagName("body")[0].appendChild(b).appendChild(e);document.getElementsByTagName("body")[0].appendChild(e);a(window).on("beforeunload",function(){this.save()}.bind(this));this.oneBindEvent()},bindOnCreated:function(a,b){this.onCreated=[a,b]},bindCreateEvents:function(b,e,f){var g,h,j,k,m,l,n,o=this,p=Math.floor,q=b.offset().left,s=b.offset().top,v=function(a){j=a.pageX?a.pageX:a.originalEvent.touches?a.originalEvent.touches[0].pageX:0;k=a.pageY?a.pageY:a.originalEvent.touches?
a.originalEvent.touches[0].pageY:0;j&&(0>j-g?(l.left=p((j-q)/c.scale())+"px",l.width=p((g-j)/c.scale())+"px"):(l.left=p((g-q)/c.scale())+"px",l.width=p((j-g)/c.scale())+"px"));k&&(0>a.pageY-h?(l.top=p((k-s)/c.scale())+"px",l.height=p((h-k)/c.scale())+"px"):(l.top=p((h-s)/c.scale())+"px",l.height=p((k-h)/c.scale())+"px"));f&&f.draw(g,h,j,k)};b.css("cursor","crosshair");b.off("mousedown.fliphtml5Remark touchstart.fliphtml5Remark").one("mousedown.fliphtml5Remark touchstart.fliphtml5Remark",function(t){o.unbindCreateEvents();
var r=t.button;if(!document.implementation.hasFeature("MouseEvents","2.0"))switch(event.button){case 0:case 1:case 3:case 5:case 7:r=0;break;case 2:case 6:r=2;break;case 4:r=1}0===r&&(t.stopPropagation(),m=document.createElement("div"),n=a(m),l=m.style,f?(n.append(f),m.className="flipHtml5Shape flipHtml5Store"):(l.backgroundColor=e?"rgba(0, 71, 255, 0.33)":o.highlightBackcolor,m.className=(e?"flipHtml5Remark flipHtml5Store":"flipHtml5Highlight flipHtml5Store")+" flipHtml5RemarkCurrentEditor",m.setAttribute("contenteditable",
e)),b.find(".flipHtml5RemarkCurrentEditor").removeClass("flipHtml5RemarkCurrentEditor"),b.append(m),g=j=t.pageX||t.originalEvent.touches[0].pageX,h=k=t.pageY||t.originalEvent.touches[0].pageY,o.reBindEvent(n,e),b.on("mousemove.fliphtml5Remark touchmove.fliphtml5Remark",v),b.off("mouseup.fliphtml5Remark touchend.fliphtml5Remark").one("mouseup.fliphtml5Remark touchend.fliphtml5Remark",function(a){j=a.pageX||a.originalEvent.touches[0].pageX;k=a.pageY||a.originalEvent.touches[0].pageY;b.off("mousemove.fliphtml5Remark touchmove.fliphtml5Remark");
if(Math.abs(j-g)<10||Math.abs(k-h)<10){l.left=p((j-q)/c.scale())+"px";l.top=p((k-s)/c.scale())+"px";l.width="280px";l.height="28px"}o.parsePresentValue(m);o.parsePresentValue(o.sizeWrap);n.css({outline:"none",backgroundColor:e?o.backgroundColor:o.highlightBackcolor,color:o.fontColor});n.trigger("click");o.onCreated!=void 0&&o.onCreated[1].call(o.onCreated[0])}))})},oneBindEvent:function(){var a=this;this.$document.on("keydown.flipHtml5RemarkDelete",function(b){var c=b.keyCode;!b.altKey&&!b.ctrlKey&&
!b.shiftKey&&(a.editing&&c===KEY_CODE_DELETE&&a.currentEditor&&"flipHtml5Remark flipHtml5Store"!==a.currentEditor[0].className&&(a.currentEditor.remove(),a.removeSizeWrap(),a.save()),a.currentEditor&&c===KEY_CODE_LEFT&&c===KEY_CODE_RIGHT&&c===KEY_CODE_UP&&c===KEY_CODE_DOWN&&b.stopPropagation())})},parsePresentValue:function(b){if(document.getElementsByTagName("body")[0].contains(b)){var c,f;c=b.parentNode;var g=b.style,h=a(b);f=100/c.offsetHeight;c=100/c.offsetWidth;g.width=h.width()*c+"%";g.height=
h.height()*f+"%";g.left=b.offsetLeft*c+"%";g.top=b.offsetTop*f+"%"}},reBindEvent:function(b,c){var f=this,g;b.on("click",function(){a(this).css({outline:"none"});f.removeSizeWrap();f.addSizeWrap(this,c);b.on("mousedown.flipHtml5Annotation touchstart.flipHtml5Annotation",function(a){a.stopPropagation()})});b.on("sizeChange",function(a,b,d,m,l){g=this.style;b&&(g.width=b-16+"px");d&&(g.height=d-16+"px");m&&(g.left=m+8+"px");l&&(g.top=l+8+"px");f.showToolbar(this,c)});b.on("change cut drop paste keydown",
function(a){if(!a.altKey&&!a.ctrlKey&&!a.shiftKey){var b=this,c=b.offsetHeight,d=b.style,e=d.height;setTimeout(function(){d.height="auto";d.height=b.scrollHeight>c?100*b.scrollHeight/b.parentNode.offsetHeight+"%":e},0)}})},unbindCreateEvents:function(){for(var a=0,b,c=this.contextArray;c[a];)b=c[a],b.css("cursor","default"),b.off("mousedown.fliphtml5Remark touchstart.fliphtml5Remark"),a++},newSizeWrap:function(){var b,e,f,g,h,j,k,m,l=this,n=1,o=l.sizeWrap=document.createElement("div"),p=[],q=Math.floor,
s=l.sizeWrapStyle=o.style;for(o.className="flipHtml5SizeWrap";9>n;)b=document.createElement("div"),b.className="flipHtml5SizePoint flipHtml5SizePoint"+n,o.appendChild(b),p.push(b),n++;l.northResize(p[0]).westResize(p[0]);l.northResize(p[1]);l.eastResize(p[2]).northResize(p[2]);l.eastResize(p[3]);l.eastResize(p[4]).southResize(p[4]);l.southResize(p[5]);l.southResize(p[6]).westResize(p[6]);l.westResize(p[7]);a(o).on("mousedown.flipHtml5SizeWrap touchstart.flipHtml5SizeWrap",function(b){b.preventDefault();
b.stopPropagation();m=l.currentEditor;var d=o.offsetLeft,n=o.offsetTop,p=b.pageX||b.originalEvent.touches[0].pageX,w=b.pageY||b.originalEvent.touches[0].pageY;a.each([l.$context,a(l.toolbarContainer),a(l.highlightToolbarContainer)],function(b,v){v.on("mousemove.flipHtml5SizeWrap touchmove.flipHtml5SizeWrap",function(a){a.preventDefault();a.stopPropagation();e=a.pageX?a.pageX:a.originalEvent.touches?a.originalEvent.touches[0].pageX:0;f=a.pageY?a.pageY:a.originalEvent.touches?a.originalEvent.touches[0].pageY:
0;e&&(k=q(d-(p-e)/c.scale()),h!==k&&(s.left=k+"px",h=k,m.trigger("sizeChange",[0,0,k,0])));f&&(j=q(n-(w-f)/c.scale()),g!==j&&(s.top=j+"px",g=j,m.trigger("sizeChange",[0,0,0,j])))});v.one("mouseup.flipHtml5SizeWrap touchend.flipHtml5SizeWrap",function(){a.each([l.$context,a(l.toolbarContainer),a(l.highlightToolbarContainer)],function(){this.off("mouseup.flipHtml5SizeWrap touchend.flipHtml5SizeWrap");this.off("mousemove.flipHtml5SizeWrap touchmove.flipHtml5SizeWrap")});l.parsePresentValue(m[0]);l.parsePresentValue(o)})})});
return o},addSizeWrap:function(b,c){var f=this.sizeWrap,g=this.sizeWrap.style;c?(b.style.zIndex=999,g.zIndex=998):(b.style.zIndex=998,g.zIndex=999);g.width=b.offsetWidth+16+"px";g.height=b.offsetHeight+16+"px";g.left=b.offsetLeft-8+"px";g.top=b.offsetTop-8+"px";g.display="block";b=a(b);this.$context=b.parent();b.before(f);this.parsePresentValue(f);this.currentEditor=b;this.showToolbar(b,c);this.editing=!0},removeSizeWrap:function(){this.currentEditor[0].style.zIndex="2";this.sizeWrapStyle.zIndex=
"1";this.sizeWrapStyle.display="none";this.hideToolbar();this.editing=!1},hideToolbar:function(){this.toolbarContainer.style.display="none";this.highlightToolbarContainer.style.display="none"},showToolbar:function(b,c){var f=c?this.toolbarContainer:this.highlightToolbarContainer,g=f.style,h=a(b),j=h.css("backgroundColor").replace(/\s+/g,"");0<=j.indexOf("rgba")&&(j=j.replace(/a/,"").replace(/\,[0-9]+(\.[0-9]*)?\)/,")"));a(f).find(".flipHtml5RemarkImage-backcolor").css("backgroundColor",j);this.currentEditor=
h;g.left=h.offset().left-8+"px";g.top=h.offset().top-(c?80:30)+"px";g.display="block"},createToolbar:function(){for(var a=this.toolbarContainer=document.createElement("div"),b=0,c="bold,italic,strikeThrough,underline,forecolor,backcolor,blockquote,insertUnorderedList,insertOrderedList,justifyLeft,justifyCenter,justifyRight,createLink,removeFormat,outdent,indent,undo,redo,delete,paragraph,fontsize,fontname".split(",");c[b];)a.appendChild(this.createButton(c[b])),b++;a.className="fliphtml5RemarkToolbarContainer";
return a},createHighlightToolbar:function(){for(var a=this.highlightToolbarContainer=document.createElement("div"),b=0,c=["backcolor","delete"];c[b];)a.appendChild(this.createButton(c[b],!0)),b++;a.className="fliphtml5RemarkHighlightToolbarContainer";return a},createButton:function(a,b){var c=this,g,h;switch(a){case "hr":return h=document.createElement("hr"),h.className="flipHtml5RemarkHr",h;case "paragraph":return g="Paragraph,Address,Preformatted,Title 1,Title 2,Title 3,Title 4,Title 5,Title 6".split(","),
h="p,address,pre,h1,h2,h3,h4,h5,h6".split(","),h=c.createSelect(g,h,a);case "fontname":return g="Arial,Century,Courier,Gentium,Georgiae,Impact,King,Lalit,Modena,Papyrus,Tahoma,TeX,Times,Verdana,Verona,cursive,fantasy,monospace,serif".split(","),h="Arial,Century,Courier,Gentium,Georgiae,Impact,King,Lalit,Modena,Papyrus,Tahoma,TeX,Times,Verdana,Verona,cursive,fantasy,monospace,serif".split(","),h=c.createSelect(g,h,a,"fontFamily");case "fontsize":return g=[1,2,3,4,5,6,7],h=[1,2,3,4,5,6,7],h=c.createSelect(g,
h,a,"fontSize");case "forecolor":return c.createColorButton(a);case "backcolor":return c.createColorButton(a,b);default:return g=document.createElement("a"),g.href="javascript:void(0);",h=document.createElement("div"),h.className="flipHtml5RemarkButtonImage flipHtml5RemarkImage-"+a,h.title=a,g.className="flipHtml5RemarkButton",g.onclick=function(){c.exec(a)},g.appendChild(h),g}},createColorButton:function(b,c){var f,g,h,j,k=this,m;f=document.createElement("a");f.href="javascript:void(0);";g=document.createElement("div");
g.className="flipHtml5RemarkButtonImage flipHtml5RemarkImage-"+b;g.title=b;f.className="flipHtml5RemarkButton";h=document.createElement("div");h.className="flipHtml5RemarkColorBar";"backcolor"===b&&(h.style.display="none");f.onclick=function(l){l.stopPropagation();m=k.opacityHandel;j=k.colorSelector;a(f).after(j);j.style.left=this.offsetLeft+"px";j.style.top=this.offsetTop+22+"px";j.style.display="block";if(b==="forecolor"){m.hide();k.opacity=1}if(b==="backcolor"){k.opacity=m.val();m.show()}m.setOpacity(parseFloat(parseFloat(k.currentEditor.css("backgroundColor").replace(/\s*\)*/g,
"").split(",")[3]).toFixed(2)));k.$context.one("click",function(){j.style.display="none"});k.currentEditor.one("click",function(){j.style.display="none"});k.$bookContainer.one("click",function(){j.style.display="none"});k.$colorSelector.off("colorSelected").one("colorSelected",function(a,f){b==="backcolor"?g.style.backgroundColor=f:h.style.backgroundColor=f;j.style.display="none";k.exec(b,f,c)})};f.appendChild(h);f.appendChild(g);return f},createSelect:function(a,b,c,g,h){var j=document.createElement("select"),
k=0,m=this,l;j.className="flipHtml5RemarkSelect flipHtml5Remark-"+c;for(j.style[g]=b[1];a[k];)l=document.createElement("option"),l.className="flipHtml5RemarkOption-"+c+" flipHtml5RemarkOption-"+b[k],l.innerHTML=a[k],l.value=b[k],l.style[g]=b[k],0===k&&(l.setAttribute("selected",!0),h&&(l.style.display="none")),j.appendChild(l),k++;j.onchange=g?function(){m.exec(c,this[this.selectedIndex].value);this.style[g]=this[this.selectedIndex].value;h&&(this.selectedIndex=0)}:function(){m.exec(this[this.selectedIndex].value);
h&&(this.selectedIndex=0)};return j},createColorSelector:function(){var b,c,f,g,h=this,j="#FF0000,#FF5555,#FF55AA,#FF55FF,#FFAA55,#FFAAAA,#FFAAFF,#FFFF55,#FFFFAA,#FFFFFF,#CC0000,#CC5555,#CC55AA,#CC55FF,#CCAA55,#CCAAAA,#CCAAFF,#CCFF55,#CCFFAA,#CCFFFF,#AA0000,#AA5555,#AA55AA,#AA55FF,#AAAA55,#AAAAAA,#AAAAFF,#AAFF55,#AAFFAA,#AAFFFF,#880000,#885555,#8855AA,#8855FF,#88AA55,#88AAAA,#88AAFF,#88FF55,#88FFAA,#88FFFF,#550000,#555555,#5555AA,#5555FF,#55AA55,#55AAAA,#55AAFF,#55FF55,#55FFAA,#55FFFF,#220000,#225555,#2255AA,#2255FF,#22AA55,#22AAAA,#22AAFF,#22FF55,#22FFAA,#22FFFF,#000000,#005555,#0055AA,#0055FF,#00AA55,#00AAAA,#00AAFF,#00FF55,#00FFAA,#00FFFF".split(","),
k=document.createElement("table"),m=this.colorSelector=document.createElement("a"),l=this.$colorSelector=a(m),n=document.createElement("input");b=h.createOpacityPlugin();var o=function(){n.value=n.style.backgroundColor=this.title.toUpperCase()},p=function(){l.trigger("colorSelected",[h.parseColorToRGBA(this.title,h.opacity)])};m.className="flipHtml5RemarkColorSelectorWrap";k.setAttribute("border","1");m.style.display="none";m.href="javascript:void(0);";n.className="flipHtml5RemarkColorSelectorMessage";
n.value="#000000";n.setAttribute("disabled","true");m.appendChild(n);m.appendChild(b.container);m.appendChild(k);l.on("mousedown",function(a){a.stopPropagation()});l.on("click",function(a){a.stopPropagation()});for(f=0;7>f;f++){g=document.createElement("tr");for(c=0;10>c;c++)b=document.createElement("td"),b.className="flipHtml5RemarkColorSelectorBlock",b.title=j[10*f+c],b.style.backgroundColor=j[10*f+c],a(b).on("mouseenter",o),a(b).on("click",p),g.appendChild(b);k.appendChild(g)}return m},createOpacityPlugin:function(){var b,
c,f,g,h,j,k=0.5,m=this,l=Math.floor,n=document.createElement("div"),o=document.createElement("div"),p=document.createElement("span"),q=o.style,s,v=m.$document,t=m.changeOpacity,r=a(o),u=a(n);p.className="flipHtml5RemarkOpacitySpan";n.className="flipHtml5RemarkOpacity";o.className="flipHtml5RemarkOpacityCursor";n.appendChild(p);n.appendChild(o);u.on("click",function(a){a.preventDefault();a.stopPropagation();s=m.currentEditor;if(c=a.pageX?a.pageX:a.originalEvent.touches?a.originalEvent.touches[0].pageX:
0)f=c-u.offset().left,0>f&&(f=0),145<f&&(f=145),q.left=f+"px",s.css("backgroundColor",t(s,f/145)),p.innerHTML="Opacity: "+(f/145).toFixed(2),k=f/145});r.on("mousedown touchstart",function(a){a.preventDefault();a.stopPropagation();s=m.currentEditor;f=g=parseInt(q.left,10);b=a.pageX?a.pageX:a.originalEvent.touches?a.originalEvent.touches[0].pageX:0;h=f-b;v.on("mousemove.flipHtml5RemarkOpacity touchmove.flipHtml5RemarkOpacity",function(a){a.preventDefault();a.stopPropagation();if(c=a.pageX?a.pageX:a.originalEvent.touches?
a.originalEvent.touches[0].pageX:0)j=l(h+c),0>j&&(j=0),145<j&&(j=145),g!==j&&(q.left=j+"px",s.css("backgroundColor",t(s,j/145)),p.innerHTML="Opacity: "+(j/145).toFixed(2),k=j/145)});v.one("mouseup touchend",function(){v.off("mousemove.flipHtml5RemarkOpacity touchmove.flipHtml5RemarkOpacity")})});return this.opacityHandel={val:function(a){a&&(a=parseInt(a,10)||1,1<a&&(a=1),0>a&&(a=0),this.setOpacity(a),k=a);return k},container:n,show:function(){n.style.display=""},hide:function(){n.style.display="none"},
setOpacity:function(a){if(void 0===a||1<a||isNaN(a))a=1;0>a&&(a=0);q.left=145*a+"px";p.innerHTML="Opacity: "+a;k=a}}},changeOpacity:function(a,b){var c=a.css("backgroundColor").replace(/\s*/g,"");0<=c.indexOf("rgba")&&(0<=c.indexOf(",0)")||0<=c.indexOf(",1)"))?a.css("backgroundColor",c.replace(/b\(/,"ba(").replace(/,\d*\)$/,","+b+")")):a.css("backgroundColor",c.replace(/b\(/,"ba(").replace(/d*\)$/,","+b+")").replace(/\d*\.\d*,/g,""))},parseColorToRGBA:function(a,b){var c,g,h,b=parseFloat(b);1<=b&&
(b=1);0>=b&&(b=0);c=parseInt(a.substring(1,3),16);g=parseInt(a.substring(3,5),16);h=parseInt(a.substring(5,7),16);return"rgba("+c+","+g+","+h+","+b+")"},exec:function(a,b,c){switch(a){case "h1":case "h2":case "h3":case "h4":case "h5":case "h6":case "address":case "pre":case "p":case "blockquote":document.execCommand("formatBlock",!1,a);break;case "createLink":if((a=prompt("Enter a URL here","http://"))&&""!==a&&"http://"!==a)0>a.indexOf("http")&&(a="http://"+a),document.execCommand("createLink",!0,
a);break;case "fontsize":document.execCommand(a,!1,b);break;case "fontname":document.execCommand(a,!1,b);this.fontName=b;break;case "forecolor":document.execCommand(a,!1,b);this.fontColor=b;break;case "backcolor":this.currentEditor[0].style.backgroundColor=b;c?this.highlightBackcolor=b:this.backgroundColor=b;break;case "delete":this.removeSizeWrap();this.currentEditor.remove();this.save();break;default:document.execCommand(a,!1,null)}this.currentEditor.trigger("click")},northResize:function(b){var e,
f,g,h,j,k=this,m=Math.floor,l,n;a(b).on("mousedown.fliphtml5RemarkResize touchstart.fliphtml5RemarkResize",function(a){a.preventDefault();a.stopPropagation();f=k.currentEditor;l=k.sizeWrap;n=k.sizeWrapStyle;j=k.$context;var b=l.offsetHeight||20,d=a.pageY||a.originalEvent.touches[0].pageY;j.one("mouseup.fliphtml5RemarkResize touchend.fliphtml5RemarkResize",function(){j.off("mousemove.fliphtml5RemarkResize touchmove.fliphtml5RemarkResize");k.parsePresentValue(f[0]);k.parsePresentValue(l)});j.on("mousemove.fliphtml5RemarkResize touchmove.fliphtml5RemarkResize",
function(a){a.preventDefault();a.stopPropagation();a.pageY?e=a.pageY:a.originalEvent.touches&&(e=a.originalEvent.touches[0].pageY);e&&(h=m(b+(d-e)/c.scale()),g!==h&&20<h&&(n.top=e-j.offset().top+"px",n.height=h+"px",g=h,f.trigger("sizeChange",[0,h,0,e-j.offset().top])))})});return this},westResize:function(b){var e,f,g,h,j,k=this,m=Math.floor,l,n;a(b).on("mousedown.fliphtml5RemarkResize touchstart.fliphtml5RemarkResize",function(a){a.preventDefault();a.stopPropagation();j=k.$context;l=k.sizeWrap;
n=k.sizeWrapStyle;h=k.currentEditor;var b=l.offsetWidth||40,d=a.pageX||a.originalEvent.touches[0].pageX;j.one("mouseup.fliphtml5RemarkResize touchend.fliphtml5RemarkResize",function(){j.off("mousemove.fliphtml5RemarkResize touchmove.fliphtml5RemarkResize");k.parsePresentValue(h[0]);k.parsePresentValue(l)});j.on("mousemove.fliphtml5RemarkResize touchmove.fliphtml5RemarkResize",function(a){a.preventDefault();a.stopPropagation();if(!(e=a.pageX)&&a.originalEvent.touches)e=a.originalEvent.touches[0].pageX;
e&&(g=m(b+(d-e)/c.scale()),f!==g&&40<g&&(n.left=e-j.offset().left+"px",n.width=g+"px",f=g,h.trigger("sizeChange",[g,0,e-j.offset().left])))})});return this},eastResize:function(b){var e,f,g,h,j,k=this,m=Math.floor,l,n;a(b).on("mousedown.fliphtml5RemarkResize touchstart.fliphtml5RemarkResize",function(a){a.preventDefault();a.stopPropagation();g=k.currentEditor;j=k.$context;l=k.sizeWrap;n=k.sizeWrapStyle;var b=l.offsetWidth||40,d=a.pageX||a.originalEvent.touches[0].pageX;j.one("mouseup.fliphtml5RemarkResize touchend.fliphtml5RemarkResize",
function(){j.off("mousemove.fliphtml5RemarkResize touchmove.fliphtml5RemarkResize");k.parsePresentValue(g[0]);k.parsePresentValue(l)});j.on("mousemove.fliphtml5RemarkResize touchmove.fliphtml5RemarkResize",function(a){a.preventDefault();a.stopPropagation();a.pageX?e=a.pageX:a.originalEvent.touches&&(e=a.originalEvent.touches[0].pageX);e&&(f=m(b-(d-e)/c.scale()),h!==f&&40<f&&(n.width=f+"px",h=f,g.trigger("sizeChange",[f])))})});return this},southResize:function(b){var e,f,g,h,j=this,k=Math.floor,m,
l,n;a(b).on("mousedown.fliphtml5RemarkResize touchstart.fliphtml5RemarkResize",function(a){a.preventDefault();a.stopPropagation();h=j.$context;n=j.sizeWrap;l=j.sizeWrapStyle;f=j.currentEditor;var b=n.offsetHeight||20,d=a.pageY||a.originalEvent.touches[0].pageY;h.one("mouseup.fliphtml5RemarkResize touchend.fliphtml5RemarkResize",function(){h.off("mousemove.fliphtml5RemarkResize touchmove.fliphtml5RemarkResize");j.parsePresentValue(f[0]);j.parsePresentValue(n)});h.on("mousemove.fliphtml5RemarkResize touchmove.fliphtml5RemarkResize",
function(a){a.preventDefault();a.stopPropagation();a.pageY?e=a.pageY:a.originalEvent.touches&&(e=a.originalEvent.touches[0].pageY);e&&(g=k(b-(d-e)/c.scale()),m!==g&&20<g&&(l.height=g+"px",m=g,f.trigger("sizeChange",[0,g])))})});return this},parseRemark:function(b,c){var f,g=this;c.find(".flipHtml5Store").remove();g.removeSizeWrap();this.sizeWrapStyle&&(this.sizeWrapStyle.display="none",a(this.sizeWrap).remove());g.newSizeWrap();g.contextArray.push(c);f=window.localStorage?window.localStorage.getItem("flipHtml5Remark"+
b)||"":(document.cookie||"").replace(RegExp("(?:(?:^|.*;\\s*)flipHtml5Remark"+b+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1");c.append(f.replace(/#@&/g,";"));c.find(".flipHtml5Remark").each(function(){g.reBindEvent(a(this),true)});c.find(".flipHtml5Highlight").each(function(){g.reBindEvent(a(this),false)});c.on("mousedown.fliphtml5remarkHide touchstart.fliphtml5remarkHide",function(){g.save();g.removeSizeWrap();g.currentEditor.blur();g.currentEditor.off("mousedown.flipHtml5Annotation touchstart.flipHtml5Annotation")})},
getPageContent:function(b){for(var c=0,f,g="",b=b.find(".flipHtml5Store");f=b[c];)if(c++,!(""===f.innerHTML||""===a(f).text())||!(""===f.style.backgroundColor||"transparent"===f.style.backgroundColor||0===parseFloat(f.style.backgroundColor.split(",")[3])))g+=f.outerHTML;return g.replace(/\s*\n\s*/g,"").replace(/;/g,"#@&")},storageByIndex:function(a,b){var c=new Date,g=this.getPageContent(b);window.localStorage?(window.localStorage.removeItem("flipHtml5Remark"+a),window.localStorage.setItem("flipHtml5Remark"+
a,g)):(c.setDate(c.getDate()+this.expires),document.cookie="flipHtml5Remark"+a+"="+g+";expires="+c.toUTCString()+";");return g},save:function(){var a,b=c.getCurrentPages();for(a=0;a<b.length;a++)this.noteImgContainers[c.getBookType()][b[a]]&&this.storageByIndex(b[a],this.noteImgContainers[c.getBookType()][b[a]])},restoreRemark:function(a,b,f){this.noteImgContainers[a]||(this.noteImgContainers[a]={});this.noteImgContainers[a][b]=f;a==c.getBookType()&&(this.removeSizeWrap(),this.parseRemark(b,this.noteImgContainers[c.getBookType()][b]))},
setContainers:function(a,b,c){this.restoreRemark(a,b,c)},addHighlightEvent:function(){this.unbindCreateEvents();this.addEvents(!0)},addEvents:function(a){this.unbindCreateEvents();for(var b=0,c,g=this.contextArray;c=g[b];)b++,this.bindCreateEvents(c,!a)},destroy:function(a){a&&window.localStorage.clear();this.$document.off("keydown.flipHtml5RemarkDelete");return this.unbindCreateEvents()}})})(window.jQuery,window.Class,window.BookInfo);
var BookMark=Class({create:function(a){this.disableCss={boxShadow:"rgba(0, 0, 0, 0.69) 0px 1px 2px inset",backgroundColor:"#cccccc",textShadow:"0 1px 1px white",color:"rgb(165, 148, 148)",cursor:"default"};this.normalCss={boxShadow:"inset 0px 1px 0px rgba(255, 255, 255, 0.5), 0px 1px 2px rgba(0, 0, 0, 0.2)",backgroundColor:"#E4E4E4",color:"#464343",textShadow:"",cursor:"pointer"};this.overCss={};this.downCss={backgroundColor:"#E4E4E4",color:"#374f00",boxShadow:"inset 0px 1px 3px rgba(0, 0, 0, 0.3), 0px 1px 0px white",
textShadow:"0px 1px 0px rgba(255, 255, 255, 0.4)"};this.bookMarkName="BookMark";this.bookMarkShowFalg=!1;this.addRightBtnFalg=this.addLeftBtnFalg=!0;this.hasTextValue=!1;this.bottomShow=!0;this.$container=a;this.bookMarkContexts={};this.address=uiBaseURL;this.serverBookMark=[];this.cookieBookMark=[];this.totalBookMark=[];for(var b=0;b<bmtConfig.length;b++){var c=bmtConfig[b];this.serverBookMark.push({isCookie:0,text:c.caption,page:c.pageIndex,color:c.color,key:11})}this.totalPageMark=[];this.leftPageMark=
[];this.rigntPageMark=[];this.lists=[];this.serverLists=[];this.cookieLists=[];this.addedPages=[];this.cookiePage=[];this.serverPage=[];for(b=0;b<this.serverBookMark.length;b++)this.serverPage.push(this.serverBookMark[b].page);this.createBookMark(a)},createBookMark:function(a){var b=this;this.bookMark=$("<div class='flipHTML5BookMark'></div>").appendTo(a).hide();var c=$("<div class='flipHTML5BookMark-top'></div>").append($("<span class='flipHTML5BookMark-topText'></span>").html("Bookmark")).appendTo(this.bookMark);
this.shrink=$("<div class='flipHTML5BookMark-topShrink'></div>").css({right:32}).append($("<img style='margin-left: 2px;margin-top: 2px;'/>").attr("src",this.address+"note_narrow.png")).appendTo(c);this.close=$("<div class='flipHTML5BookMark-topClose'></div>").css({right:3}).append($("<img style='margin-left: 2px;margin-top: 2px;'/>").attr("src",this.address+"note_close.png")).appendTo(c);this.bookMarkBottom=$("<div class='flipHTML5BookMark-bottom'></div>").appendTo(this.bookMark);var d=$("<div style='position: relative;width: 100%;height: 94px;'></div>").appendTo(this.bookMarkBottom);
this.bookMarkText=$("<input type='text' class='flipHTML5BookMark-saveText'/>").appendTo(d);var e=this.colorPicker(d);e.container.css({top:13,left:453});this.selectColor=e.message.css({width:24,height:24});this.addLeftMark=$("<div class='flipHTML5BookMark-addLeftMark'></div>").css({width:100,left:18}).html("Add To Page").appendTo(d);this.addRightMark=$("<div class='flipHTML5BookMark-addRightMark'></div>").css({width:100,left:"auto",right:18}).html("Add To Page").appendTo(d);this.bookMarkList=$("<div class='flipHTML5BookMark-list'></div>").appendTo(this.bookMarkBottom);
var d=$("<div class='flipHTML5BookMark-row-th'></div>"),e=$("<span class='flipHTML5BookMark-cellLeft-th'></span>").html("Page"),f=$("<div class='flipHTML5BookMark-cellRight-th'></div>").append($("<div style='position: absolute;width: 1px;height: 22px;left: 0px;top: 3px;background-color: #FFFFFF;'></div>")).append($("<span style='position: absolute;width: 307px;height: 100%;left: 1px;text-indent: 6px;'></span>").html("Title")).append($("<div style='position: absolute;width: 1px;height: 22px;left: auto;right: 101px;top: 3px;background-color: #FFFFFF;'></div>")).append($("<span style='position: absolute;width: 50px;height: 100%;left: auto;right: 51px;text-indent: 10px;'></span>").html("Edit")).append($("<div style='position: absolute;width: 1px;height: 22px;left: auto;right: 50px;top: 3px;background-color: #FFFFFF;'></div>")).append($("<span style='position: absolute;width: 50px;height: 100%;left: auto;right: 0px;text-indent: 6px;'></span>").html("Delete"));
d.append(e).append(f);this.bookMarkList.append(d);this.bookMarkTable=$("<div class='flipHTML5BookMark-table'></div>").appendTo(this.bookMarkList);this.bookMarkLists=$("<div class='flipHTML5BookMark-table-lists'></div>").appendTo(this.bookMarkTable);this.createScrollBar(this.bookMarkTable);this.removeAllMark=$("<div class='flipHTML5BookMark-removeBookMark'></div>").css({position:"relative",width:462,left:18,top:0}).html("Remove All").appendTo(this.bookMarkBottom);var g,h;c.on("mousedown touchstart",
function(d){d=isTouch?d.originalEvent.touches[0]:d;g=d.clientX-b.bookMark.position().left;h=d.clientY-b.bookMark.position().top;c.css({cursor:"move"});a.on("mousemove.bookmarkMove touchmove.bookmarkMove",function(a){a=isTouch?a.originalEvent.touches[0]:a;b.bookMark.css({left:a.clientX-g,top:a.clientY-h})});a.add($(document)).on("mouseup.bookmarkMove touchend.bookmarkMove",function(){c.css({cursor:"default"});a.off("mousemove.bookmarkMove touchmove.bookmarkMove");a.add($(document)).off("mouseup.bookmarkMove touchend.bookmarkMove")});
d.preventDefault();d.stopPropagation();return!1});this.addCookieMark();this.registerEvents()},isListShowHide:function(){0<this.bookMarkLists.children("div").length?(this.bookMarkList.show(),this.removeAllMark.show()):(this.bookMarkList.hide(),this.removeAllMark.hide())},addCookieMark:function(){var a=this.getLocalStorage(this.bookMarkName),b=eval(a),c=this.serverBookMark.concat(),a=[];b?(this.cookieBookMark=b.concat(),a=b.concat(c)):a=c;if(a){this.downJSonArrByKey(a,"page");for(b=0;b<a.length;b++)this.addBookMarkList(a[b])}for(b=
0;b<this.lists.length;b++)this.lists[b].rowObj.css({backgroundColor:0==b%2?"":"#bababa"});this.scrollBarShowHide();this.updateBookMarkConfig()},registerEvents:function(){var a=this;this.shrink.on("click touchend",function(){a.bottomShow?(a.bottomShow=!1,a.shrink.children("img").attr("src",a.address+"note_revert.png"),a.bookMarkBottom.css({maxHeight:0,paddingBottom:0})):(a.bottomShow=!0,a.shrink.children("img").attr("src",a.address+"note_narrow.png"),a.bookMarkBottom.css({maxHeight:570,paddingBottom:6}))});
this.close.on("click touchend",function(){a.hide()});this.addLeftMark.on({"mouseover touchstart":function(){a.addLeftBtnFalg&&a.hasTextValue&&$(this).removeClass("flipHTML5Signature-normal").addClass("flipHTML5Signature-hover").css(a.overCss)},"mouseout touchend":function(){a.addLeftBtnFalg&&a.hasTextValue&&$(this).removeClass("flipHTML5Signature-hover").addClass("flipHTML5Signature-normal").css(a.normalCss)},"mousedown touchstart":function(){a.addLeftBtnFalg&&a.hasTextValue&&$(this).removeClass("flipHTML5Signature-hover flipHTML5Signature-normal").css(a.downCss)},
"mouseup touchend":function(){a.addLeftBtnFalg&&a.hasTextValue&&$(this).removeClass("flipHTML5Signature-hover").addClass("flipHTML5Signature-normal").css(a.normalCss)},"click touchend":function(){var b=a.bookMarkText.val();if(a.addLeftBtnFalg&&b&&a.hasTextValue){a.bookMarkText.val("");var c=BookInfo.getCurrentPages(),d=a.selectColor.attr("data-color"),c=BookInfo.isRightToLeft()?Math.max.apply(Math,c):Math.min.apply(Math,c),b={page:c,color:d,text:b,isCookie:1,key:(new Date).getTime()};a.addBookMarkList(b);
a.downJSonArrByKey(a.lists,"page");$(".flipHTML5BookMark-table-row").detach();for(d=0;d<a.lists.length;d++)a.lists[d].rowObj.css({backgroundColor:0==d%2?"":"#bababa"}),a.lists[d].rowObj.appendTo(a.bookMarkLists);a.cookiePage.push(c);a.cookieBookMark.push(b);a.addLocalStorage(a.bookMarkName,a.parseToString(a.cookieBookMark));a.selectRadio()}}});this.addRightMark.on({"mouseover touchstart":function(){a.addRightBtnFalg&&a.hasTextValue&&$(this).removeClass("flipHTML5Signature-normal").addClass("flipHTML5Signature-hover").css(a.overCss)},
"mouseout touchend":function(){a.addRightBtnFalg&&a.hasTextValue&&$(this).removeClass("flipHTML5Signature-hover").addClass("flipHTML5Signature-normal").css(a.normalCss)},"mousedown touchstart":function(){a.addRightBtnFalg&&a.hasTextValue&&$(this).removeClass("flipHTML5Signature-hover flipHTML5Signature-normal").css(a.downCss)},"mouseup touchend":function(){a.addRightBtnFalg&&a.hasTextValue&&$(this).removeClass("flipHTML5Signature-hover").addClass("flipHTML5Signature-normal").css(a.normalCss)},"click touchend":function(){var b=
a.bookMarkText.val();if(a.addRightBtnFalg&&b&&a.hasTextValue){a.bookMarkText.val("");var c=BookInfo.getCurrentPages(),d=a.selectColor.attr("data-color"),c=BookInfo.isRightToLeft()?Math.min.apply(Math,c):Math.max.apply(Math,c),b={page:c,color:d,text:b,isCookie:1,key:(new Date).getTime()};a.addBookMarkList(b);a.downJSonArrByKey(a.lists,"page");$(".flipHTML5BookMark-table-row").detach();for(d=0;d<a.lists.length;d++)a.lists[d].rowObj.css({backgroundColor:0==d%2?"":"#bababa"}),a.lists[d].rowObj.appendTo(a.bookMarkLists);
a.cookiePage.push(c);a.cookieBookMark.push(b);a.addLocalStorage(a.bookMarkName,a.parseToString(a.cookieBookMark));a.selectRadio()}}});this.bookMarkText.on("input propertychange change",function(){var b=$(this).val();a.hasTextValue=b?!0:!1;a.selectRadio()});this.removeAllMark.on("click touchend",function(){$(".flipHTML5BookMark-table-row-cookie").remove();a.cookieLists=[];a.lists=[];a.lists=a.serverLists.concat();a.downJSonArrByKey(a.lists,"page");$(".flipHTML5BookMark-table-row").detach();for(var b=
0;b<a.lists.length;b++)a.lists[b].rowObj.css({backgroundColor:0==b%2?"":"#bababa"}),a.lists[b].rowObj.appendTo(a.bookMarkLists);a.cookiePage=[];a.addedPages=[];a.addedPages=a.serverPage.concat();a.selectRadio();a.cookieBookMark=[];a.totalBookMark=[];a.totalBookMark=a.serverBookMark.concat();a.addLocalStorage(a.bookMarkName,a.parseToString(a.cookieBookMark));a.scrollBarShowHide();a.updateBookMarkConfig()})},updateBookMarkConfig:function(){this.downJSonArrByKey(this.totalBookMark,"page");bmtConfig=
[];for(var a=0;a<this.totalBookMark.length;a++){var b=this.totalBookMark[a];bmtConfig.push({caption:b.text,color:b.color,pageIndex:b.page})}BookInfo.getBookType()===BookType.normal_book&&BookInfo.getBook().bmt.refresh()},addBookMarkList:function(a){var b=this,c=!0,d=a.text,e=a.color,f=$("<div></div>").css({height:28}).addClass(1===a.isCookie?"flipHTML5BookMark-table-row flipHTML5BookMark-table-row-cookie":"flipHTML5BookMark-table-row").attr({"data-key":a.key,"data-page":a.page}).appendTo(b.bookMarkLists);
$("<span class='flipHTML5BookMark-table-cellLeft'></span>").html(a.page).appendTo(f);var g=$("<span class='flipHTML5BookMark-table-cellRight'></span>").appendTo(f),h=$("<div style='position: absolute;left: 0px;top: 0px;height: 100%;width: 100%;'></div>").appendTo(g),j=$("<input class='flipHTML5BookMark-table-cellRight-text' disabled='true'/>").css({width:1===a.isCookie?"307px":"100%"}).attr("disabled",c).val(a.text).appendTo(h),k,m;1===a.isCookie&&(h=this.colorPicker(h),k=h.message,m=h.container,
k.css({width:20,height:20,backgroundColor:a.color}).attr("data-color",a.color),m.css({top:4,left:284}).hide());var l=$("<div class='flipHTML5BookMark-table-cellRight-edit'></div>").css({display:1===a.isCookie?"block":"none"}).attr("title","Edit").append($("<img style='margin-left: 3px;margin-top: 3px;'/>").attr("src",b.address+"note_edit.png")).appendTo(g),n=$("<div class='flipHTML5BookMark-table-cellRight-cancel'></div>").attr("title","Cancel").append($("<img style='margin-left: 3px;margin-top: 3px;'/>").attr("src",
b.address+"bookMark_cancel.png")).appendTo(g).hide(),g=$("<div class='flipHTML5BookMark-table-cellRight-del'></div>").css({display:1===a.isCookie?"block":"none"}).attr("title","Delete").append($("<img style='margin-left: 3px;margin-top: 3px;'/>").attr("src",b.address+"note_del.png")).appendTo(g);n.on("click touchend",function(a){c=true;j.css({backgroundColor:"transparent",color:"#1a1a1a"});j.attr("disabled",c);l.attr("title","Edit").css({right:64});l.children("img").attr("src",b.address+"note_edit.png");
m&&m.hide();j.val(d);k.attr("data-color",e).css({backgroundColor:e});n.hide();a.preventDefault();a.stopPropagation();return false});f.on("click touchend",function(){c&&gotoPageFun($(this).attr("data-page"))});g.on("click touchend",function(a){f.remove();var c=f.attr("data-page");b.addedPages.splice(b.addedPages.indexOf(c),1);b.cookiePage.splice(b.cookiePage.indexOf(c),1);b.selectRadio();b.delArrayByKeyAndValue(b.totalBookMark,"page",c);b.delArrayByKeyAndValue(b.cookieBookMark,"page",c);b.addLocalStorage(b.bookMarkName,
b.parseToString(b.cookieBookMark));b.delArrayByKeyAndValue(b.lists,"page",c);b.delArrayByKeyAndValue(b.cookieLists,"page",c);for(c=0;c<b.lists.length;c++)b.lists[c].rowObj.css({backgroundColor:c%2==0?"":"#bababa"});b.scrollBarShowHide();b.updateBookMarkConfig();a.preventDefault();a.stopPropagation();return false});l.on("click touchend",function(a){if(c){c=false;j.css({backgroundColor:"#ffffff",color:"#000000"});l.children("img").attr("src",b.address+"note_save.png");j.attr("disabled",c);l.attr("title",
"Save").css({right:77});j[0].focus();n.show();m&&m.show()}else{c=true;j.css({backgroundColor:"transparent",color:"#1a1a1a"});j.attr("disabled",c);l.attr("title","Edit").css({right:64});l.children("img").attr("src",b.address+"note_edit.png");n.hide();var g=f.attr("data-key"),h=j.val();d=h;var s=k.attr("data-color");e=s;b.updateArrayByKeyValue(b.cookieBookMark,"key",g,{text:h,color:s});b.updateArrayByKeyValue(b.totalBookMark,"key",g,{text:h,color:s});b.addLocalStorage(b.bookMarkName,b.parseToString(b.cookieBookMark));
m&&m.hide();b.updateBookMarkConfig()}a.preventDefault();a.stopPropagation();return false});this.scrollBarShowHide();1===a.isCookie?this.cookieLists.push($.extend({},a,{rowObj:f})):this.serverLists.push($.extend({},a,{rowObj:f}));this.lists.push($.extend({},a,{rowObj:f}));this.addedPages.push(a.page);this.totalBookMark.push(a);this.updateBookMarkConfig()},addBookMarkPage:function(){},selectRadio:function(){var a=this.addLeftMark,b=this.addRightMark,c=this.bookMarkText[0],d=c.value,e=BookInfo.getCurrentPages(),
f=BookInfo.getPageCount();"The Bookmark has been added!"==d&&(d=c.value="");this.hasTextValue=d?!0:!1;0<=e.indexOf(0)?this.contains(this.addedPages,Math.max.apply(Math,e))?(a.add(b).removeClass("flipHTML5BookMark-normal flipHTML5BookMark-hover").css(this.disableCss),this.addRightBtnFalg=this.addLeftBtnFalg=!1,c.readOnly=!0,c.value="The Bookmark has been added!",a.add(b).hide()):(d?BookInfo.isRightToLeft()?(b.removeClass("flipHTML5BookMark-normal flipHTML5BookMark-hover").css(this.disableCss),a.removeClass("flipHTML5BookMark-normal").css(this.normalCss),
this.addLeftBtnFalg=!0,this.addRightBtnFalg=!1,a.show().html("Add to page "+Math.max.apply(Math,e)),b.hide().html("Add to page "+Math.min.apply(Math,e))):(a.removeClass("flipHTML5BookMark-normal flipHTML5BookMark-hover").css(this.disableCss),b.removeClass("flipHTML5BookMark-normal").css(this.normalCss),this.addLeftBtnFalg=!1,this.addRightBtnFalg=!0,a.hide().html("Add to page "+Math.min.apply(Math,e)),b.show().html("Add to page "+Math.max.apply(Math,e))):BookInfo.isRightToLeft()?(a.add(b).removeClass("flipHTML5BookMark-normal flipHTML5BookMark-hover").css(this.disableCss),
this.addLeftBtnFalg=!0,this.addRightBtnFalg=!1,a.show().html("Add to page "+Math.max.apply(Math,e)),b.hide().html("Add to page "+Math.min.apply(Math,e))):(a.add(b).removeClass("flipHTML5BookMark-normal flipHTML5BookMark-hover").css(this.disableCss),this.addLeftBtnFalg=!1,this.addRightBtnFalg=!0,a.hide().html("Add to page "+Math.min.apply(Math,e)),b.show().html("Add to page "+Math.max.apply(Math,e))),c.readOnly=!1,c.focus()):0<=e.indexOf(f)&&Math.min.apply(Math,e)==f?this.contains(this.addedPages,
f)?(a.add(b).removeClass("flipHTML5BookMark-normal flipHTML5BookMark-hover").css(this.disableCss),this.addRightBtnFalg=this.addLeftBtnFalg=!1,c.readOnly=!0,c.value="The Bookmark has been added!",a.hide().html("Add to page "+Math.min.apply(Math,e)),b.hide().html("Add to page "+Math.max.apply(Math,e))):(d?BookInfo.isRightToLeft()?(a.removeClass("flipHTML5BookMark-normal flipHTML5BookMark-hover").css(this.disableCss),b.removeClass("flipHTML5BookMark-normal").css(this.normalCss),this.addLeftBtnFalg=!1,
this.addRightBtnFalg=!0,a.hide().html("Add to page "+Math.max.apply(Math,e)),b.show().html("Add to page "+Math.min.apply(Math,e))):(b.removeClass("flipHTML5BookMark-normal flipHTML5BookMark-hover").css(this.disableCss),a.removeClass("flipHTML5BookMark-normal").css(this.normalCss),this.addLeftBtnFalg=!0,this.addRightBtnFalg=!1,a.show().html("Add to page "+Math.min.apply(Math,e)),b.hide().html("Add to page "+Math.max.apply(Math,e))):BookInfo.isRightToLeft()?(a.add(b).removeClass("flipHTML5BookMark-normal flipHTML5BookMark-hover").css(this.disableCss),
this.addLeftBtnFalg=!1,this.addRightBtnFalg=!0,a.hide().html("Add to page "+Math.max.apply(Math,e)),b.show().html("Add to page "+Math.min.apply(Math,e))):(a.add(b).removeClass("flipHTML5BookMark-normal flipHTML5BookMark-hover").css(this.disableCss),this.addLeftBtnFalg=!0,this.addRightBtnFalg=!1,a.show().html("Add to page "+Math.min.apply(Math,e)),b.hide().html("Add to page "+Math.max.apply(Math,e))),c.readOnly=!1,c.focus()):Math.min.apply(Math,e)>f?(a.add(b).removeClass("flipHTML5BookMark-normal flipHTML5BookMark-hover").css(this.disableCss),
this.addRightBtnFalg=this.addLeftBtnFalg=!1,c.readOnly=!0,c.value="The Bookmark has been added!",a.hide().html("Add to page "+Math.min.apply(Math,e)),b.hide().html("Add to page "+Math.max.apply(Math,e))):!this.contains(this.addedPages,Math.min.apply(Math,e))&&!this.contains(this.addedPages,Math.max.apply(Math,e))?(d?b.add(a).removeClass("flipHTML5BookMark-normal").css(this.normalCss):a.add(b).removeClass("flipHTML5BookMark-normal flipHTML5BookMark-hover").css(this.disableCss),this.addRightBtnFalg=
this.addLeftBtnFalg=!0,BookInfo.isRightToLeft()?(a.show().html("Add to page "+Math.max.apply(Math,e)),b.show().html("Add to page "+Math.min.apply(Math,e))):(a.show().html("Add to page "+Math.min.apply(Math,e)),b.show().html("Add to page "+Math.max.apply(Math,e))),c.readOnly=!1,c.focus()):!this.contains(this.addedPages,Math.min.apply(Math,e))&&this.contains(this.addedPages,Math.max.apply(Math,e))?(d?BookInfo.isRightToLeft()?(a.removeClass("flipHTML5BookMark-normal flipHTML5BookMark-hover").css(this.disableCss),
b.removeClass("flipHTML5BookMark-normal").css(this.normalCss),this.addLeftBtnFalg=!1,this.addRightBtnFalg=!0,a.hide().html("Add to page "+Math.max.apply(Math,e)),b.show().html("Add to page "+Math.min.apply(Math,e))):(b.removeClass("flipHTML5BookMark-normal flipHTML5BookMark-hover").css(this.disableCss),a.removeClass("flipHTML5BookMark-normal").css(this.normalCss),this.addLeftBtnFalg=!0,this.addRightBtnFalg=!1,a.show().html("Add to page "+Math.min.apply(Math,e)),b.hide().html("Add to page "+Math.max.apply(Math,
e))):BookInfo.isRightToLeft()?(a.add(b).removeClass("flipHTML5BookMark-normal flipHTML5BookMark-hover").css(this.disableCss),this.addLeftBtnFalg=!1,this.addRightBtnFalg=!0,a.hide().html("Add to page "+Math.max.apply(Math,e)),b.show().html("Add to page "+Math.min.apply(Math,e))):(a.add(b).removeClass("flipHTML5BookMark-normal flipHTML5BookMark-hover").css(this.disableCss),this.addLeftBtnFalg=!0,this.addRightBtnFalg=!1,a.show().html("Add to page "+Math.min.apply(Math,e)),b.hide().html("Add to page "+
Math.max.apply(Math,e))),c.readOnly=!1,c.focus()):this.contains(this.addedPages,Math.min.apply(Math,e))&&!this.contains(this.addedPages,Math.max.apply(Math,e))?(d?BookInfo.isRightToLeft()?(b.removeClass("flipHTML5BookMark-normal flipHTML5BookMark-hover").css(this.disableCss),a.removeClass("flipHTML5BookMark-normal").css(this.normalCss),this.addLeftBtnFalg=!0,this.addRightBtnFalg=!1,a.show().html("Add to page "+Math.max.apply(Math,e)),b.hide().html("Add to page "+Math.min.apply(Math,e))):(a.removeClass("flipHTML5BookMark-normal flipHTML5BookMark-hover").css(this.disableCss),
b.removeClass("flipHTML5BookMark-normal").css(this.normalCss),this.addLeftBtnFalg=!1,this.addRightBtnFalg=!0,a.hide().html("Add to page "+Math.min.apply(Math,e)),b.show().html("Add to page "+Math.max.apply(Math,e))):BookInfo.isRightToLeft()?(a.add(b).removeClass("flipHTML5BookMark-normal flipHTML5BookMark-hover").css(this.disableCss),this.addLeftBtnFalg=!0,this.addRightBtnFalg=!1,a.show().html("Add to page "+Math.max.apply(Math,e)),b.hide().html("Add to page "+Math.min.apply(Math,e))):(a.add(b).removeClass("flipHTML5BookMark-normal flipHTML5BookMark-hover").css(this.disableCss),
this.addLeftBtnFalg=!1,this.addRightBtnFalg=!0,a.hide().html("Add to page "+Math.min.apply(Math,e)),b.show().html("Add to page "+Math.max.apply(Math,e))),c.readOnly=!1,c.focus()):(a.add(b).removeClass("flipHTML5BookMark-normal flipHTML5BookMark-hover").css(this.disableCss),this.addRightBtnFalg=this.addLeftBtnFalg=!1,c.readOnly=!0,c.value="The Bookmark has been added!",a.hide().html("Add to page "+Math.min.apply(Math,e)),b.hide().html("Add to page "+Math.max.apply(Math,e)))},colorPicker:function(a){var b,
c,d,e="#FF0000,#FF5555,#FF55AA,#FF55FF,#FFAA55,#FFAAAA,#FFAAFF,#FFFF55,#FFFFAA,#FFFFFF,#CC0000,#CC5555,#CC55AA,#CC55FF,#CCAA55,#CCAAAA,#CCAAFF,#CCFF55,#CCFFAA,#CCFFFF,#AA0000,#AA5555,#AA55AA,#AA55FF,#AAAA55,#AAAAAA,#AAAAFF,#AAFF55,#AAFFAA,#AAFFFF,#880000,#885555,#8855AA,#8855FF,#88AA55,#88AAAA,#88AAFF,#88FF55,#88FFAA,#88FFFF,#550000,#555555,#5555AA,#5555FF,#55AA55,#55AAAA,#55AAFF,#55FF55,#55FFAA,#55FFFF,#220000,#225555,#2255AA,#2255FF,#22AA55,#22AAAA,#22AAFF,#22FF55,#22FFAA,#22FFFF,#000000,#005555,#0055AA,#0055FF,#00AA55,#00AAAA,#00AAFF,#00FF55,#00FFAA,#00FFFF".split(","),
f=document.createElement("table");b=document.createElement("a");var g=$(b),h=document.createElement("input"),j=function(){var a=this.title.toUpperCase();h.style.backgroundColor=a;$(h).attr("data-color",a)},k=function(){f.style.display="none"};g.appendTo(a);b.className="flipHtml5ColorSelectorWrap-bookMark";f.setAttribute("border","1");b.style.position="absolute";b.href="javascript:void(0);";h.type="text";h.className="flipHtml5ColorSelectorMessage-bookMark";h.style.backgroundColor="#000000";$(h).attr("data-color",
"#000000");h.style.cursor="pointer";h.style.borderWidth="0px";h.style.padding="0px";b.appendChild(h);this.$container[0].appendChild(f);f.style.display="none";f.style.position="absolute";f.style.zIndex=9999;f.style.width="204px";f.style.backgroundColor="#ffffff";for(c=0;7>c;c++){d=document.createElement("tr");d.style.position="relative";for(b=0;10>b;b++)a=document.createElement("td"),a.className="flipHtml5ColorSelectorBlock",a.style.position="relative",a.style.width="14px",a.style.height="14px",a.title=
e[10*c+b],a.style.backgroundColor=e[10*c+b],$(a).on("mouseenter",j),$(a).on("click touchstart",k),d.appendChild(a);f.appendChild(d)}$(h).on("click touchstart",function(a){$(f).css({left:$(h).offset().left,top:$(h).offset().top+$(h).outerHeight()});f.style.display="table-cell";a.stopPropagation();a.stopPropagation();return!1});$(document).on("click touchstart",function(){f.style.display="none"});return{container:g,message:$(h)}},show:function(){this.bookMarkShowFalg=!0;this.bookMark.show()},hide:function(){this.bookMarkShowFalg=
!1;this.bookMark.hide()},showHide:function(){this.bookMarkShowFalg?this.hide():this.show()},setContainers:function(a){BookInfo.getBookType()===a&&this.selectRadio()},parseToString:function(a){if(0!=a.length){for(var b="[",c=0;c<a.length;c++)b+="{key:'"+a[c].key+"',text:'"+a[c].text+"',page:"+a[c].page+",color:'"+a[c].color+"',isCookie:"+a[c].isCookie+"},";b=b.substring(0,b.length-1);return b+"]"}},downJSonArrByKey:function(a,b){a.sort(function(a,d){return parseInt(a[b])>parseInt(d[b])?1:parseInt(a[b])==
parseInt(d[b])?0:-1})},delArrayByKeyAndValue:function(a,b,c){if(a)for(var d=0;d<a.length;d++)a[d][b]&&a[d][b]==c&&a.remove(d)},updateArrayByKeyValue:function(a,b,c,d){if(a)for(var e=0;e<a.length;e++)a[e][b]&&a[e][b]==c&&$.extend(a[e],d)},getLocalStorage:function(a){return window.localStorage.getItem(a)},addLocalStorage:function(a,b){window.localStorage.setItem(a,b)},contains:function(a,b){for(var c=0;c<a.length;c++)if(a[c]===b)return!0;return!1},createScrollBar:function(a){var a=$("<div>",{"class":"ScrollBar",
css:{position:"absolute",width:6,height:"100%",backgroundColor:"#a8a8a8",borderRadius:0,right:0,top:0,borderLeft:"1px solid #ffffff"}}).appendTo(a),b=$("<div>",{"class":"OuterScroll",css:{position:"absolute",width:6,height:"100%",left:0,top:0,backgroundColor:"transparent",borderRadius:0,overflow:"hidden",cursor:"pointer"}}).appendTo(a);$("<div>",{"class":"InnerScroll",css:{position:"absolute",width:6,height:"100%",marginLeft:0,marginRight:0,left:0,top:0,backgroundColor:"#5e5e5e",borderRadius:0,cursor:"pointer"}}).appendTo(b);
this.scrollBar=a;this.outerScroll=b;this.bindScrollBarEvents(a,b,this.bookMarkTable,this.bookMarkLists)},scrollBarShowHide:function(){this.outerScroll.css({height:this.bookMarkTable.outerHeight()*this.scrollBar.outerHeight()/this.bookMarkLists.outerHeight()});this.bookMarkTable.height()>=this.bookMarkLists.height()?(this.scrollBar.hide(),this.bookMarkLists.css({top:0})):(this.scrollBar.show(),Math.abs(parseFloat(this.bookMarkLists.css("top")))>this.bookMarkLists.outerHeight()-this.bookMarkTable.outerHeight()&&
(this.bookMarkLists.css({top:-(this.bookMarkLists.outerHeight()-this.bookMarkTable.outerHeight())}),this.outerScroll.css({top:this.scrollBar.outerHeight()-this.outerScroll.outerHeight()})));this.isListShowHide()},bindScrollBarEvents:function(a,b,c,d){var e=this;b.on(_event._down,function(a){var g=a||event,h=g.clientY-e.outerScroll.position().top,j=a.which;a.stopPropagation();1==j&&($(document).on("mousemove.scrollBar touchmove.scrollBar",function(a){a.preventDefault();a.stopPropagation();g=a||event;
a=g.clientY-h;0>=a?a=0:a>=e.scrollBar.outerHeight()-e.outerScroll.outerHeight()&&(a=e.scrollBar.outerHeight()-e.outerScroll.outerHeight());b.css({top:a});d.css({top:-a/(e.scrollBar.outerHeight()-e.outerScroll.outerHeight())*(d.outerHeight()-c.outerHeight())})}),$(document).on("mouseup.scrollBar touchend.scrollBar",function(a){a=a||event;a.preventDefault();a.stopPropagation();$(document).off("mousemove.scrollBar touchmove.scrollBar");$(document).off("mouseup.scrollBar touchend.scrollBar")}))});c.bind($.browser.mozilla?
"DOMMouseScroll":"mousewheel",function(e){if(!(c.outerHeight()>=d.outerHeight())){var g=e.originalEvent,g=g.wheelDelta||-g.detail,h=d.position().top,j;d.stop(!1,!1);0<g?j=0>h+c.outerHeight()/11?h+c.outerHeight()/11:0:0>g&&(j=d.outerHeight()-c.outerHeight()>-(h-c.outerHeight()/11)?h-c.outerHeight()/11:-(d.outerHeight()-c.outerHeight()));d.css({top:j});b.css({top:-j/(d.outerHeight()-c.outerHeight())*(a.outerHeight()-b.outerHeight())});e.stopPropagation();e.preventDefault();return!1}})}});function shareButton(a,b){this.config=$.extend({iconURL:"",caption:"",link:""},b);this.bg=$("<div></div>");this.icon=$("<img />");this.caption=new label(this.config.caption,this.bg);this.width=200;this.height=40;this.bg.css({position:"absolute",width:this.width+"px",height:this.height+"px","-webkit-border-radius":"6px","-moz-border-radius":"6px","-o-border-radius":"6px","-ms-border-radius":"6px","border-radius":"6px","background-color":"#666666"});this.icon.attr({src:this.config.iconURL});this.icon.css({position:"absolute",
left:"5px",top:"-7px"});a.append(this.bg);this.bg.append(this.icon);this.caption.setLabelPosition(40,10);this.initEvent()}shareButton.prototype.onResize=function(a,b){this.bg.css({width:a+"px",height:b+"px"})};shareButton.prototype.initEvent=function(){this.bg.css({cursor:"pointer"});var a=this;this.bg.bind(_event._down,function(){window.open(a.config.link,"_blank")})};shareButton.prototype.setPosition=function(a,b){this.bg.css({left:a+"px",top:b+"px"})};function shareForm(a,b){form.call(this,a,b);this.visible=!1;this.addItem();this.setButtonPos();this.background.css({left:-windowWidth/2-20+"px",overflow:"hidden"})}$.extend(shareForm.prototype,form.prototype);
shareForm.prototype.addItem=function(){var a=window.location.href,b=window.document.title,c=window.location.pathname,c=c.substring(0,c.lastIndexOf("/"))+"/files/thumb/1.jpg",a="?&url="+a+"&title="+b+"&description="+bookDescription+"&screenshot="+c,b={iconURL:uiBaseURL+"facebook.png",caption:"Facebook",link:"http://api.addthis.com/oexchange/0.8/forward/facebook/offer"+a},c={iconURL:uiBaseURL+"google.png",caption:"Google+",link:"http://api.addthis.com/oexchange/0.8/forward/igoogle/offer"+a},d={iconURL:uiBaseURL+
"myspace.png",caption:"MySpace",link:"http://api.addthis.com/oexchange/0.8/forward/myspace/offer"+a},e={iconURL:uiBaseURL+"twitter.png",caption:"Twitter",link:"http://api.addthis.com/oexchange/0.8/forward/twitter/offer"+a},f={iconURL:uiBaseURL+"digg.png",caption:"Digg",link:"http://api.addthis.com/oexchange/0.8/forward/digg/offer"+a},g={iconURL:uiBaseURL+"more.png",caption:"More",link:"http://api.addthis.com/oexchange/0.8/offer"+a};this.emailButton=new shareButton(this.contentBox,{iconURL:uiBaseURL+
"email.png",caption:"Email",link:"http://api.addthis.com/oexchange/0.8/forward/email/offer"+a});this.fbButton=new shareButton(this.contentBox,b);this.ggButton=new shareButton(this.contentBox,c);this.msButton=new shareButton(this.contentBox,d);this.twButton=new shareButton(this.contentBox,e);this.diggButton=new shareButton(this.contentBox,f);this.moreButton=new shareButton(this.contentBox,g)};
shareForm.prototype.onResize=function(a,b){this.width=100>a?100:a;this.height=100>b?100:b;this.background.css({width:this.width+"px",height:this.height+"px",left:this.visible?"0px":-this.width-20+"px"});this.titleBox.css({width:this.width+"px"});this.contentBox.css({width:this.width+"px",height:this.height-this.titleBox.height()+"px"});this.emailButton.onResize(this.width/2-20,40);this.fbButton.onResize(this.width/2-20,40);this.ggButton.onResize(this.width/2-20,40);this.msButton.onResize(this.width/
2-20,40);this.twButton.onResize(this.width/2-20,40);this.diggButton.onResize(this.width/2-20,40);this.moreButton.onResize(this.width/2-20,40);this.setButtonPos()};shareForm.prototype.setButtonPos=function(){this.emailButton.setPosition(5,10);this.fbButton.setPosition(this.width/2,10);this.ggButton.setPosition(5,68);this.msButton.setPosition(this.width/2,68);this.twButton.setPosition(5,126);this.diggButton.setPosition(this.width/2,126);this.moreButton.setPosition(5,184)};
shareForm.prototype.show=function(){var a=this;this.background.animate({left:0},400,function(){a.visible=!0;window.setTimeout(function(){a.background.css({left:"0px"})},100)})};shareForm.prototype.hide=function(){var a=this;this.background.animate({left:-(this.width+20)},400,function(){a.visible=!1;window.setTimeout(function(){a.background.css({left:-(this.width+20)+"px"})},100)})};shareForm.prototype.closeForm=function(){this.hide()};function bookMarkTab(a,b,c,d){this.fnShow=b;this.fnHide=c;this.maxWidth=d?d:300;this.config=$.extend({caption:"",color:"#888"},a);if(this.config.pageIndex&&!(""==this.config.caption||this.config.pageIndex>originTotalPageCount))this.bg=$("<div></div>"),this.caption=new label(this.config.caption,this.bg),this.width=this.caption.getWidth()+30,this.width=this.width>this.maxWidth?this.maxWidth:this.width,this.height=60,this.hiding=this.showing=!1,this.bg.css({color:"#EEEEEE","font-family":"arial,tahoma,sans-serif",
"font-size":"12px",position:"absolute",width:this.width+"px",height:this.height+"px","background-color":this.config.color,border:"1px solid "+colorDiv(this.config.color,10),cursor:"pointer"}),this.bg.append(this.caption),this.caption.setLabelPosition(5,8),this.initEvent()}bookMarkTab.prototype.resize=function(a,b){a>this.maxWidth&&(a=this.maxWidth);this.width=a;this.height=b;this.bg.css({width:a+"px",height:b+"px"})};
bookMarkTab.prototype.setPosition=function(a,b,c){c?this.bg.css({top:b+"px",right:a+"px",left:"auto"}):this.bg.css({top:b+"px",left:a+"px",right:"auto"})};bookMarkTab.prototype.show=function(){if(!this.showing){this.showing=!0;var a=this;this.bg.animate({top:0},150,function(){a.showing=!1})}};bookMarkTab.prototype.hide=function(){if(!this.hiding){this.hiding=!0;var a=this;this.bg.animate({top:30},150,function(){a.hiding=!1})}};
bookMarkTab.prototype.setMaxWidth=function(a){this.maxWidth=a;this.resize(this.width,this.height)};bookMarkTab.prototype.getWidth=function(){return this.width};bookMarkTab.prototype.initEvent=function(){var a=this;this.bg.bind("mouseover",function(){a.show()});this.bg.bind("mouseleave",function(){a.hide()});this.bg.bind(_event._down,function(){gotoPageFun(a.config.pageIndex)})};function tabBox(a){this.tabArray=[];this.bg=$("<div></div>");this.width=400;this.height=60;this.tipBoxHeight=this.tipBoxWidth=70;this.bg.css({position:"absolute",width:this.width+"px",height:this.height+"px",overflow:"hidden","z-index":20,"font-family":"arial,tahoma,sans-serif","font-size":"12px"});a.append(this.bg)}tabBox.prototype.resize=function(a,b,c){this.width=a;this.height=b;this.bg.css({width:this.width+"px",height:this.height+"px"});this.setTabPosition(c)};
tabBox.prototype.setPosition=function(a,b){this.bg.css({left:a+"px",top:b+"px"})};tabBox.prototype.rotate=function(a){a=rotate(a);this.bg.css({"-webkit-transform-origin":"0% 0%","-moz-transform-origin":"0% 0%","-ms-transform-origin":"0% 0%","-o-transform-origin":"0% 0%","-webkit-transform":a,"-moz-transform":a,"-ms-transform":a,"-o-transform":a})};tabBox.prototype.show=function(){0==this.tabArray.length?this.hide():this.bg.css({display:"block"})};tabBox.prototype.hide=function(){this.bg.css({display:"none"})};
tabBox.prototype.setItem=function(a){this.tabArray=a||[];this.setTabPosition()};tabBox.prototype.initItem=function(a){for(var b=0;b<this.tabArray.length;b++)this.bg.append(this.tabArray[b].bg);this.setTabPosition(a);0==this.tabArray.length?this.hide():this.show()};tabBox.prototype.refresh=function(){this.bg.empty()};
tabBox.prototype.setTabPosition=function(a){for(var b=0,c=0,d=0;d<this.tabArray.length;d++)b+=this.tabArray[d].getWidth(),this.bg.append(this.tabArray[d]);if(b<=this.width)for(b=0;b<this.tabArray.length;b++)this.tabArray[b].setPosition(c,30,a),c=c+this.tabArray[b].getWidth()+2;else for(d=0;d<this.tabArray.length;d++)this.tabArray[d].setPosition(c,30,a),c+=this.tabArray[d].getWidth()*this.width/b};function initBookMarkTab(a,b){this.isRight=b;this.tabArray=[];this.leftBox=new tabBox(a);this.rightBox=new tabBox(a);this.leftTabArr=[];this.rightTabArr=[];this.tipBox=$("<div id='tipbox'></div>");this.tipImg=$("<img />");this.tipLabel=new label("page 1",this.tipBox);a.append(this.tipBox);this.tipBox.append(this.tipImg);this.tipBoxHeight=this.tipBoxWidth=70;this.tipBox.css({width:this.tipBoxWidth+"px",height:this.tipBoxHeight+"px",position:"absolute",left:(windowWidth-this.tipBoxWidth)/2+"px",top:(windowHeight-
this.tipBoxHeight)/2-200+"px",opacity:0,display:"none",background:"#ff0000","z-index":10});this.tipImg.attr({src:""});this.tipLabel.setLabelPosition(5,this.tipBoxHeight-25);0!=bmtConfig.length&&(this.setPosition(),this.resort(),this.initItem())}initBookMarkTab.prototype.resize=function(a,b){this.leftBox.resize(a,b,!0);this.rightBox.resize(a,b,!1);this.setPosition()};
initBookMarkTab.prototype.setPosition=function(){void 0!=flipBook&&(this.leftBox.setPosition(-60,flipBook.height),this.rightBox.setPosition(flipBook.width+60,0),this.leftBox.rotate(-90),this.rightBox.rotate(90))};initBookMarkTab.prototype.refresh=function(){this.resort();this.tabArray=[];this.leftTabArr=[];this.rightTabArr=[];this.leftBox.refresh();this.rightBox.refresh();this.initItem()};initBookMarkTab.prototype.resort=function(){void 0!=bmtConfig&&bmtConfig.sort(createComparisonFunction("pageIndex"))};
function createComparisonFunction(a){return function(b,c){var d=b[a],e=c[a];return d<e?-1:d>e?1:0}}initBookMarkTab.prototype.initItem=function(){for(var a=0;a<bmtConfig.length;a++)this.tabArray.push(new bookMarkTab(bmtConfig[a],this.showTipBox,this.hideTipBox));this.isRight?(this.leftBox.tabArray=this.tabArray,this.leftBox.initItem(!0)):(this.rightBox.tabArray=this.tabArray,this.rightBox.initItem(!1));void 0!=flipBook&&this.separated(flipBook.currentPageIndex)};
initBookMarkTab.prototype.showTipBox=function(a){this.tipLabel.setCaption("page "+a);a=(windowHeight-this.tipBoxHeight)/2;this.tipBox.css({display:"block"});this.tipBox.animate({opacity:1,top:a},{duration:300})};initBookMarkTab.prototype.hideTipBox=function(){var a=this,b=(windowHeight-this.tipBoxHeight)/2-200;this.tipBox.css({display:"none"});this.tipBox.animate({opacity:0},300,function(){a.tipBox.css({top:b+"px"})})};
initBookMarkTab.prototype.separated=function(a){this.leftTabArr=[];this.rightTabArr=[];if(this.isRight)for(var b=0;b<this.tabArray.length;b++)this.tabArray[b].config.pageIndex>=a?this.leftTabArr.push(this.tabArray[b]):this.rightTabArr.push(this.tabArray[b]);else for(b=0;b<this.tabArray.length;b++)this.tabArray[b].config.pageIndex>=a?this.rightTabArr.push(this.tabArray[b]):this.leftTabArr.push(this.tabArray[b]);this.leftBox.tabArray=this.leftTabArr;this.rightBox.tabArray=this.rightTabArr;this.leftBox.initItem(!0);
this.rightBox.initItem(!1)};initBookMarkTab.prototype.show=function(){this.leftBox.show();this.rightBox.show()};initBookMarkTab.prototype.hide=function(){this.leftBox.hide();this.rightBox.hide()};function treeNode(a,b){this.config=$.extend({caption:"untitled",page:0,width:280,height:35,backColor:bookConfig.bookmarkBackground,fontColor:bookConfig.bookmarkFontColor,level:0,padding:10},a);var c=this;this.background=$('<div style="position:relative; overflow : hidden;"></div>');this.contentBox=$('<div style="position:absolute;"></div>');this.textField=new label(this.config.caption,this.contentBox);this.expandButton=new button(1,this.contentBox,{iconURL:uiBaseURL+"closed.png"},!1,!0);this.children=
[];this.opened=this.hasChild=!1;this.totalHeight=0;this.showing=!1;this.textField.shortWord(25);this.isDrag=!1;this.expandButton.setVisible(!1);$(b).append(this.background);$(this.background).append(this.contentBox);this.expandButton.setButtonPosition(-10,0);this.textField.setLabelPosition(13,10);var d=this.config.width-2*this.config.padding;$(this.contentBox).css({width:d+"px",height:this.config.height+"px",color:this.config.fontColor,left:12*Math.max(this.config.level,0)+5+"px",cursor:"pointer",
"font-family":"arial,tahoma,sans-serif","font-size":"12px"});$(this.background).css({width:d+"px",height:this.config.height+"px",left:+this.config.padding+"px",top:+this.config.padding+"px","background-color":this.config.backColor,"-moz-border-radius":"5px","-webkit-border-radius":"5px","border-radius":"5px","border-left":"0px solid #CCCCCC","border-right":"0px solid #CCCCCC","border-bottom":"0px solid #CCCCCC","font-family":"arial,tahoma,sans-serif","font-size":"12px"});this.fontColor=bookConfig.bookmarkFontColor;
this.downBackColor=this.config.backColor;this.textShadow="";this.expandButton.onMouseUp(this,this.onExpand);$(this.contentBox).bind(_event._down,function(){isBookmarkDrag||gotoPageFun(c.config.page);var a=colorAdd(c.config.backColor,50);$(c.background).css({"background-color":a});$(c.contentBox).css({color:"#8c97cb"});$(c.contentBox).css({"text-shadow":"0 0 30px #8c97cb, 0 0 70px #8c97cb"})});$(this.background).bind(_event._enter,function(){var a=colorAdd(c.config.backColor,50);$(c.background).css({"background-color":a});
$(c.contentBox).css({color:"#8c97cb"});$(c.contentBox).css({"text-shadow":"0 0 30px #8c97cb, 0 0 70px #8c97cb"})});$(this.background).bind(_event._end,function(){$(c.background).css({"background-color":c.downBackColor});$(c.contentBox).css({color:c.fontColor});$(c.contentBox).css({"text-shadow":c.textShadow})});$(this.background).bind(_event._leave,function(){$(c.background).css({"background-color":c.downBackColor});$(c.contentBox).css({color:c.fontColor});$(c.contentBox).css({"text-shadow":c.textShadow})})}
treeNode.prototype.setBorderTop=function(){$(this.background).css("border-top","0px solid #CCCCCC")};treeNode.prototype.setButtonVisible=function(a){this.expandButton.setVisible(a)};treeNode.prototype.setHasChildren=function(a){(this.hasChild=a)&&$(this.contentBox).css({"font-weight":"bold"})};treeNode.prototype.setVisible=function(a){$(this.background).css({display:a?"block":"none"})};treeNode.prototype.getIsExpand=function(){return this.opened};
treeNode.prototype.setIsExpand=function(a){this.opened=a};treeNode.prototype.getBackground=function(){return this.background};treeNode.prototype.getWidth=function(){return this.config.width};treeNode.prototype.getHeight=function(){return this.config.height};treeNode.prototype.setCaption=function(a){this.config.caption=a};treeNode.prototype.setColor=function(){};
treeNode.prototype.setPosition=function(a,b,c){void 0==c&&(c=["left","top"]);$(this.background).css(c[0],a+"px");$(this.background).css(c[1],b+"px")};treeNode.prototype.onResize=function(a,b){this.config.width=a+13;b&&(this.config.height=b);this.background.css({width:this.config.width-this.config.padding+"px",height:this.config.height+"px"})};treeNode.prototype.getTotalHeight=function(){return this.totalHeight};
treeNode.prototype.expand=function(){if(this.hasChild){this.expandButton.changeIcon(uiBaseURL+"opened.png");for(var a=0;a<this.children.length;a++)this.children[a].setVisible(!0),this.children[a].getIsExpand()?this.children[a].expand():this.children[a].bookMarkEnter();$(this.contentBox).css({color:bookConfig.bookmarkFontColor});this.fontColor=bookConfig.bookmarkFontColor;this.downBackColor=this.config.backColor;this.textShadow=""}else this.expandButton.changeIcon(uiBaseURL+"bookMarkEnter.png")};
treeNode.prototype.bookMarkEnter=function(){this.hasChild||this.expandButton.changeIcon(uiBaseURL+"bookMarkEnter.png")};treeNode.prototype.collapse=function(){if(this.hasChild){this.expandButton.changeIcon(uiBaseURL+"closed.png");for(var a=0;a<this.children.length;a++)this.children[a].setVisible(!1),this.children[a].collapse();$(this.contentBox).css({color:bookConfig.bookmarkFontColor});this.fontColor=bookConfig.bookmarkFontColor;this.downBackColor=this.config.backColor;this.textShadow=""}};
treeNode.prototype.onExpand=function(){this.opened?this.collapse():this.expand();this.opened=!this.opened;$(this.background).css({"background-color":this.config.backColor})};treeNode.prototype.addChildren=function(a){this.children.push(a)};treeNode.prototype.addNode=function(a){this.children.push(new treeNode(a,this.background))};treeNode.prototype.deleteNode=function(){};treeNode.prototype.getPageIndex=function(){return this.config.page};var isBookmarkDrag=!1;
function tableContent(a,b){form.call(this,a,b);this.scrollMask=$('<div style = "position : absolute;"></div>');this.scrollBox=$('<div style = "position : absolute; width : 190px; height : 300px; overflow-y : auto;"></div>');this.scrollMouseDown=!1;this.mouseDownY=-1;this.height=this.width=200;this.showing=!1;this.itemArr=[];$(this.contentBox).append(this.scrollMask);$(this.contentBox).append(this.scrollBox);this.captionBox.setFont("12px","#cccccc","arial");this.captionBox.setCaption("<strong>"+getLanguage("frmToc",
"Table of Content")+"</strong>");this.initScrollEvent();var c=windowWidth/4+this.formConfig.scrollbarWidth,c=Math.max(300,c);this.formBackground.css({opacity:1,"z-index":99,top:"10px",left:-c-20+"px",width:"200px"});this.scrollMask.css({"border-top":"1px solid "+colorAdd(bookConfig.bookmarkBackground,40)});this.captionBox.setFontSize(16)}$.extend(tableContent.prototype,form.prototype);
tableContent.prototype.addContent=function(a,b,c){addProgressBar(this.contentBox,this.width,this.height);for(var d=0;d<a.length;d++){var e=new treeNode(a[d],this.scrollBox);this.itemArr.push(e);!b&&0==d&&e.setBorderTop();b&&(c.addChildren(e),e.setVisible(!1));1<=a[d].children.length?(e.setButtonVisible(!0),e.setHasChildren(!0),this.addContent(a[d].children,!0,e)):(e.setButtonVisible(!0),e.bookMarkEnter())}};
tableContent.prototype.onResize=function(a,b){this.width=100>a?100:a;this.height=100>b?100:b;this.showing||this.formBackground.css({left:-(this.width+this.formConfig.scrollbarWidth+20)+"px"});this.setWidth(a);this.setHeight(b);$(this.scrollMask).css({width:this.width+"px",height:this.height-this.titleBox.height()+"px"});$(this.scrollBox).css({width:this.width+this.formConfig.scrollbarWidth+"px",height:this.height-this.titleBox.height()-15+"px",top:"1px"});for(var c=0;c<this.itemArr.length;c++)this.itemArr[c].onResize(this.width-
30)};tableContent.prototype.showForm=function(){var a=this;this.formBackground.animate({left:10},400,function(){a.showing=!0;if(void 0==a.addContentDown||null==a.addContentDown)a.addContentDown=!1;if(!1==a.addContentDown)try{a.addContent(ols,!1),clearProgressBar(a.contentBox),a.addContentDown=!0}catch(b){$("#btnTableOfContent").css({display:"none"}),tableofcontentButtonEnable=!1}})};
tableContent.prototype.closeForm=function(){var a=this,b=windowWidth/4+this.formConfig.scrollbarWidth,b=Math.max(300,b);this.formBackground.animate({left:-(a.width+a.formConfig.scrollbarWidth+20)},400,function(){a.showing=!1})};tableContent.prototype.getShowStatu=function(){return this.showing};tableContent.prototype.setShowStatu=function(a){this.showing=a};
tableContent.prototype.setPosition=function(a,b,c){void 0==c&&(c=["left","top"]);$(this.formBackground).css(c[0],a+"px");$(this.formBackground).css(c[1],b+"px")};
tableContent.prototype.initScrollEvent=function(){var a=this;$(this.scrollBox).bind(_event._down,function(b){a.scrollMouseDown=!0;isBookmarkDrag=!1;b=isTouch?b.originalEvent.touches:[b];a.mouseDownY=b[0].pageY;3==browserType?event.cancelBubble=!0:event.stopPropagation()});$(this.scrollBox).bind(_event._move,function(b){a.scrollMouseDown&&(b=isTouch?b.originalEvent.touches:[b],Math.abs(a.mouseDownY-b[0].pageY))});$(this.scrollBox).bind(_event._end,function(){a.scrollMouseDown=!1})};function thumbnailCell(a){this.normalBorder="2px solid #ffffff";this.selectBorder="2px solid rgb(255, 128, 64)";this.overBorder="2px solid rgb(0, 128, 255)";this.boxShadow="0 0 5px rgba(40, 0, 0, 1)";this.background=$("<div></div>");this.imgBac=$("<div></div>");this.pageIndex=-1;this.width=90;this.height=80;$(a).append(this.background);$(this.imgBac).append(this.img);$(this.imgBac).css({position:"absolute"});a=getPageWidthHeight(this.width,this.height,zoomPageWidth,zoomPageHeight);this.imgWidth=a.x;
this.imgHeight=a.y;this.textHeight=24;this.textWidth=40;this.pageTextField=$("<div class='numberingText'></div>");this.pageTextField.css({color:"#000000",backgroundColor:"#eee",fontSize:16,opacity:0.9,textAlign:"center",verticalAlign:"middle",borderRadius:4,position:"absolute",width:"auto",height:"auto",lineHeight:"100%",bottom:90,display:"none",padding:5});$(this.imgBac).css({width:this.imgWidth,height:this.imgHeight});$(this.background).css({position:"absolute",width:this.imgWidth,height:this.imgHeight,
cursor:"pointer","font-size":"80%",boxShadow:this.boxShadow,background:"#ffffff"})}thumbnailCell.prototype.getPageIndex=function(){return this.pageIndex};thumbnailCell.prototype.getWidth=function(){return this.imgWidth};thumbnailCell.prototype.getHeight=function(){return this.imgHeight};thumbnailCell.prototype.setPosition=function(a,b,c){void 0==c&&(c=["left","top"]);$(this.background).css(c[0],a+"px");$(this.background).css(c[1],b+"px")};
thumbnailCell.prototype.setImgPosition=function(a){switch(a){case "l":case "c":$(this.imgBac).css({left:"0px",right:"auto"});break;case "r":$(this.imgBac).css({right:"0px",left:"auto"})}};
thumbnailCell.prototype.fillImage=function(a){this.pageIndex=a;this.img=$("<img />");$(this.img).css({width:this.imgWidth,height:this.imgHeight});$(this.img).attr("src",getPageDir(a,"thumb"));$(this.background).append(this.imgBac);this.imgBac.append(this.img);$(this.background).append(this.pageTextField);this.pageTextField.html("<b>"+a+"</b>");this.pageTextField.css({left:(this.imgWidth-this.pageTextField.outerWidth(!0))/2})};thumbnailCell.prototype.clearImage=function(){$(this.imgBac).empty()};
thumbnailCell.prototype.showBorder=function(){this.background.css({border:this.normalBorder})};thumbnailCell.prototype.hideBorder=function(){this.background.css({border:""})};thumbnailCell.prototype.highLight=function(){this.background.css({border:this.selectBorder})};thumbnailCell.prototype.clearHighLight=function(){};thumbnailCell.prototype.getTextField=function(){return this.pageTextField};thumbnailCell.prototype.hideTextField=function(){this.pageTextField.setCSS({display:"none"})};
thumbnailCell.prototype.showTextField=function(a){var b=this;this.background.bind(_event._enter,function(){b.pageTextField.css({display:a})});this.background.bind(_event._down,function(){b.pageTextField.css({display:a})});this.background.bind(_event._end,function(){b.pageTextField.css({display:"none"})});this.background.bind(_event._leave,function(){b.pageTextField.css({display:"none"})})};thumbnailCell.prototype.showCell=function(a){$(this.background).css({display:a?"block":"none"})};
thumbnailCell.prototype.onMouseUp=function(a,b){var c=this;this.background.bind(_event._end,function(){b.call(a,c)})};thumbnailCell.prototype.onMouseOver=function(){var a=this;this.background.css({border:this.normalBorder});this.background.bind(_event._enter,function(){$(this).css({border:a.overBorder})});this.background.bind(_event._leave,function(){$(this).css({border:a.normalBorder})})};
thumbnailCell.prototype.clearMouseOver=function(){this.background.bind(_event._enter,function(){$(this).css({border:""})});this.background.bind(_event._leave,function(){$(this).css({border:""})})};thumbnailCell.prototype.onMouseOverUp=function(){var a=this;this.background.bind(_event._enter,function(){$(this).css({border:a.overBorder})});this.background.bind(_event._leave,function(){$(this).css({border:a.selectBorder})})};var isThumbDrag=!1;
function thumbnailBar(a){this.background=$("<div class='thumbBar'></div>");this.outContentBox=$("<div class='outThumbBG'></div>");this.contentBox=$("<div class='thumbBG'></div>");this.contentBac=$("<div class='thumbBG'></div>");this.scrollBox=$("<div class='dock'></div>");this.mouseDown=this.showing=!1;this.scrollBoxX=this.mouseDownX=-1;this.spacing=16;this.btnShow=!1;this.other=300;this.another=70;this.width=windowWidth-this.other;this.height=150;this.left=this.other/2;this.bottom=0;this.boxShadowWidth=
5;this.mainColor="#888888";this.thumbArray=[];this.lastMoveTime=this.lastMoveX=-1;this.mergeing=this.moveLeft=!1;this.background.css({width:this.width,height:this.height,left:this.left,bottom:-this.height,minWidth:3*this.another});this.contentBox.css({height:"100%"});this.outContentBox.css({height:"100%"});$(a).append(this.background);$(this.background).append(this.contentBac);$(this.background).append(this.outContentBox);this.outContentBox.append(this.contentBox);$(this.contentBox).append(this.scrollBox);
this.addPrevNextBtn(this.background);this.prevOnEvents();this.nextOnEvents();this.initEvent()}
thumbnailBar.prototype.initScroll=function(){var a=this;$(document).ready(function(){function b(){m||(m=!0,window.setTimeout(c,15))}function c(){d();m=!1;l&&(l=!1,b())}function d(){k.children().each(function(){var a=$(this).offset().left+$(this).outerWidth()/2,b=$(this).offset().top+$(this).outerHeight()/2,a=h-a,b=j-b,b=Math.sqrt(a*a+b*b),b=((1-Math.min(1,Math.max(0,b/e)))*g+f)/f;$(this).css({"-webkit-transform":"scale("+b+")","-moz-transform":"scale("+b+")","-ms-transform":"scale("+b+")","-o-transform":"scale("+
b+")"})})}var e=148,f=108,g=120-f,h,j,k=$(a.scrollBox),m=!1,l=!1;$(document).bind("mousemove",function(a){k.is(":visible")&&(h=a.pageX,j=a.pageY,l=!0,b())})})};
thumbnailBar.prototype.onResize=function(){var a=$(this.contentBox).width(),b=$(this.scrollBox).width();if(a>b)$(this.scrollBox).css({left:(a-b)/2+"px"});else{var c=$(this.scrollBox).offset().left;0<c&&(c=0);c<a-b&&(c=a-b);$(this.scrollBox).css({left:c+"px"})}this.background.css({width:windowWidth-this.other,height:this.height,left:this.left});this.prev_nextIsShow();this.outContentBox.css({width:this.background.width()-this.another,left:this.btnShow?this.another/2:0});this.contentBox.css({width:this.outContentBox.width()-
2*this.boxShadowWidth,left:this.btnShow?this.boxShadowWidth:0})};thumbnailBar.prototype.setPosition=function(a,b,c){void 0==c&&(c=["left","top"]);$(this.background).css(c[0],a+"px");$(this.background).css(c[1],b+"px")};
thumbnailBar.prototype.addItem=function(){for(var a=0,b=0;a<=originTotalPageCount;){var c=0==a?new thumbnailItem(this.scrollBox,1):new thumbnailItem(this.scrollBox,a);c.setPosition(b,25,["left","bottom"]);b=b+c.getWidth()+this.spacing;this.thumbArray.push(c);a+=2}$(this.scrollBox).css({width:b-this.spacing});!0==this.mergeing?this.mergeAll():this.fissionAll()};
thumbnailBar.prototype.resetItemPosition=function(){for(var a=0,b=0;b<this.thumbArray.length;b++){var c=this.thumbArray[b];c.setPosition(a,25,["left","bottom"]);a=a+c.getWidth()+this.spacing}this.thumbArray[0].getHeight();$(this.scrollBox).css({width:a-this.spacing});this.prev_nextIsShow();this.outContentBox.css({width:this.btnShow?windowWidth-this.other-this.another:windowWidth-this.other,left:this.btnShow?this.another/2:0});this.contentBox.css({width:this.btnShow?windowWidth-this.other-this.another-
2*this.boxShadowWidth:windowWidth-this.other,left:this.btnShow?this.boxShadowWidth:0})};thumbnailBar.prototype.mergeAll=function(){this.mergeing=!0;if(this.getShowStatu()){if(!this.mergeingDown){for(var a=0;a<this.thumbArray.length;a++)this.thumbArray[a].merge();this.resetItemPosition();this.mergeingDown=!0;this.fissionDown=!1}}else this.mergeingDown=!1};
thumbnailBar.prototype.fissionAll=function(){this.mergeing=!1;if(this.getShowStatu()){if(!this.fissionDown){for(var a=0;a<this.thumbArray.length;a++)this.thumbArray[a].fission();this.resetItemPosition();this.mergeingDown=!1;this.fissionDown=!0}}else this.fissionDown=!1};thumbnailBar.prototype.getShowStatu=function(){return this.showing};thumbnailBar.prototype.setShowStatu=function(a){this.showing=a};thumbnailBar.prototype.getHeight=function(){return this.background.outerHeight(!0)};
thumbnailBar.prototype.showshow=function(){var a=this;addProgressBar(a.background,a.width,a.height);this.background.stop(!1,!1).animate({bottom:this.bottom},{duration:500,easing:"linear",start:function(){},step:function(){},complete:function(){ifOnStageResize()&&onStageResize();if(void 0==a.addItemDown||null==a.addItemDown)a.addItemDown=!1;!1==a.addItemDown&&(a.addItem(),a.setHighLight(1),a.currentCellIndex=1,a.fillNearByImages(0),a.addItemDown=!0);void 0!=a.mergeing&&null!=a.mergeing&&(!0==a.mergeing?
a.mergeAll():a.fissionAll());clearProgressBar(a.background)}});this.showing=!0};thumbnailBar.prototype.hideBox=function(){var a=this;this.background.stop(!1,!1).animate({bottom:-this.height},{duration:500,easing:"linear",start:function(){},step:function(){},complete:function(){ifOnStageResize()&&onStageResize();clearProgressBar(a.background)}});this.showing=!1};
thumbnailBar.prototype.initEvent=function(){var a=this;this.background.bind(_event._down,function(){return!1});$(this.contentBox).bind(_event._down,function(b){a.mouseDown=!0;isThumbDrag=!1;b=isTouch?b.originalEvent.touches:[b];a.mouseDownX=b[0].pageX;a.scrollBoxX=$(a.scrollBox).position().left;return!1});$(this.contentBox).bind(_event._move,function(b){if(a.mouseDown){var b=isTouch?b.originalEvent.touches:[b],c=a.mouseDownX-b[0].pageX;20<Math.abs(c)&&(isThumbDrag=!0);$(a.contentBox).width()>$(a.scrollBox).width()||
(c=a.scrollBoxX-c,0<c&&(c=0),c<$(a.contentBox).width()-$(a.scrollBox).width()&&(c=$(a.contentBox).width()-$(a.scrollBox).width()),$(a.scrollBox).css({left:c+"px"}),a.moveLeft=a.lastMoveX>b[0].pageX?!0:!1,a.lastMoveX=b[0].pageX,a.lastMoveTime=(new Date).getTime())}});$(this.contentBox).bind(_event._end,function(){a.mouseDown=!1;if(100>(new Date).getTime()-a.lastMoveTime&&-1!=a.lastMoveTime){var b=a.moveLeft?-30:30;a.tweener($(a.scrollBox).position().left,b,10)}});$(this.contentBox).bind("mouseleave",
function(){a.mouseDown=!1})};
thumbnailBar.prototype.setHighLight=function(a){var b=this;this.currentCellIndex=a;var c=Math.floor(a/2);if(!(a>originTotalPageCount||void 0==this.thumbArray[c]||null==this.thumbArray[c]))if(this.thumbArray[c].highLight(a),this.clearHighLight(c),$(this.contentBox).width()>$(this.scrollBox).width())$(this.scrollBox).css({left:($(this.contentBox).width()-$(this.scrollBox).width())/2+"px"});else{var a=$(this.scrollBox).offset().left,d=this.scrollBox.width(),e=$(this.contentBox).width(),f=this.thumbArray[c].background.position().left,
c=this.thumbArray[c].getWidth(),g=a+-(f+a-(e-c)/2);0<g?g=0:g<e-d&&(g=e-d);this.scrollBox.animate({left:g},500,function(){b.fillNearByImages(g)})}};thumbnailBar.prototype.clearHighLight=function(a){for(var b=0;b<this.thumbArray.length;b++)if(b!=a){if(void 0==this.thumbArray[b]||null==this.thumbArray[b])break;this.thumbArray[b].clearHighLight()}};
thumbnailBar.prototype.tweener=function(a,b,c){var d=function(a,b){for(var c=b/2,d=(a-a/4)/c,e=Array(b),f=0;f<b;f++)e[f]=f<c?a-(c-f)*d:a+(f-c+1)*d;return e.reverse()}(b,c),e=a,f=0,g=this,h=window.setInterval(function(){e+=d[f];f++;f==c&&(e=a+b*c);0<e&&(e=0);e<$(g.contentBox).width()-$(g.scrollBox).width()&&(e=$(g.contentBox).width()-$(g.scrollBox).width());$(g.scrollBox).css({left:e+"px"});f>=c&&(window.clearInterval(h),g.fillNearByImages(e))},30)};
thumbnailBar.prototype.fillNearByImages=function(a){var b;b=this.thumbArray[0]?this.thumbArray[0].getWidth():1;var c=b+16;b=Math.ceil((this.background.width()+Math.abs(a))/b)+4;a=Math.floor(Math.abs(a)/c)-4;a=Math.max(Math.ceil(a/2),0);this.contentBox.width()>this.scrollBox.width()&&(a=0,b=originTotalPageCount+1);b=Math.min(b,originTotalPageCount+1);if(0<a)for(c=0;c<a;c++)this.thumbArray[c]&&this.thumbArray[c].clearImage();for(c=a;c<Math.ceil(b/2);c++)a=c,this.thumbArray[a]&&this.thumbArray[a].addImage()};
thumbnailBar.prototype.addPrevNextBtn=function(a){this.prev=$("<div>",{"class":"prev-btn",css:{position:"absolute",width:20,height:44,left:0,bottom:42,cursor:"pointer",backgroundColor:"rgba(93, 89, 89, 0.46)"}}).appendTo(a).append($("<img>",{src:uiBaseURL+"prev_page.png",css:{marginLeft:-3,marginTop:9}})).attr("title","Prev page");this.next=$("<div>",{"class":"next-btn",css:{position:"absolute",width:20,height:44,right:0,bottom:42,cursor:"pointer",backgroundColor:"rgba(93, 89, 89, 0.46)"}}).appendTo(a).append($("<img>",
{src:uiBaseURL+"next_page.png",css:{marginLeft:-3,marginTop:9}})).attr("title","Next page");this.prev.hide();this.next.hide()};
thumbnailBar.prototype.prevOnEvents=function(){var a=this;this.prev.bind(_event._enter,function(){0===a.scrollBox.position().left?$(this).css({cursor:"default"}):$(this).css({cursor:"pointer"})});this.prev.bind(_event._click,function(){0!=a.scrollBox.position().left&&a.btnShow&&(-a.scrollBox.position().left>a.contentBox.width()?a.scrollBox.animate({left:a.scrollBox.position().left+a.contentBox.width()},300,function(){a.fillNearByImages(a.scrollBox.position().left)}):a.scrollBox.animate({left:0},300,
function(){a.fillNearByImages(0)}))})};
thumbnailBar.prototype.nextOnEvents=function(){var a=this;this.next.bind(_event._enter,function(){a.scrollBox.position().left===a.contentBox.width()-a.scrollBox.width()?$(this).css({cursor:"default"}):$(this).css({cursor:"pointer"})});this.next.bind(_event._click,function(){a.scrollBox.position().left!=a.contentBox.width()-a.scrollBox.width()&&a.btnShow&&(a.scrollBox.position().left-a.contentBox.width()>a.contentBox.width()-a.scrollBox.width()?a.scrollBox.animate({left:a.scrollBox.position().left-a.contentBox.width()},
300,function(){a.fillNearByImages(a.scrollBox.position().left)}):a.scrollBox.animate({left:a.contentBox.width()-a.scrollBox.width()},300,function(){a.fillNearByImages(a.contentBox.width()-a.scrollBox.width())}))})};thumbnailBar.prototype.prev_nextIsShow=function(){this.background.width()>this.scrollBox.width()?(this.prev.hide(),this.next.hide(),this.btnShow=!1):(this.prev.show(),this.next.show(),this.btnShow=!0)};function thumbnailItem(a,b){this.normalBorder="2px solid #ffffff";this.selectBorder="2px solid rgb(255, 128, 64)";this.overBorder="2px solid rgb(0, 128, 255)";this.boredrWidth=2;this.spacing=16;this.boxShadow="0 0 5px rgba(40, 0, 0, 1)";var c=!0;this.background=$("<div class='linea'></div>");this.itemB=new thumbnailCell(this.background);this.itemA=new thumbnailCell(this.background);this.isSinglePage=!1;this.pageIndex=b;this.fillImage=!1;this.mainColor="#000000";c=b+1;this.textHeight=24;this.textWidth=
64;this.textField=$("<div class='numberingText'></div>");this.background.append(this.textField);this.textField.html("<b>"+b+"-"+c+"</b>");$(a).append(this.background);1!=b&&b!=totalPageCount?(c=!1,this.itemA.setPosition(0,0,["left","bottom"]),this.itemB.setPosition(0,0,["right","bottom"]),this.itemB.onMouseUp(this,this.onItemMouseUp),this.itemA.pageIndex=b,this.itemB.pageIndex=b+1,this.itemA.background.append(this.itemA.pageTextField),this.itemB.background.append(this.itemB.pageTextField),this.itemA.pageTextField.html("<b>"+
b+"</b>"),this.itemB.pageTextField.html("<b>"+(b+1)+"</b>")):(c=!0,this.itemA.setPosition(0,0,["left","bottom"]),this.itemB.showCell(!1),this.textField.css({display:"none"}),this.itemA.background.append(this.itemA.pageTextField),this.itemA.pageIndex=b,this.itemA.pageTextField.html("<b>"+b+"</b>"));this.onMouseOver();this.width=c?this.itemA.getWidth():this.itemA.getWidth()+this.itemB.getWidth();this.height=this.itemA.getHeight();$(this.background).css({position:"absolute"});this.textField.css({color:"#000000",
backgroundColor:"#eee",fontSize:16,opacity:0.9,textAlign:"center",verticalAlign:"middle",borderRadius:4,position:"absolute",width:"auto",height:"auto",lineHeight:"100%","font-size":"80%",bottom:90,display:"none",padding:5});this.itemA.onMouseUp(this,this.onItemMouseUp)}thumbnailItem.prototype.getWidth=function(){return this.background.outerWidth(!0)};thumbnailItem.prototype.getHeight=function(){return this.background.outerHeight(!0)};
thumbnailItem.prototype.addImage=function(){this.fillImage||(this.itemA.fillImage(this.pageIndex),1!=this.pageIndex&&this.pageIndex!=totalPageCount?this.itemB.fillImage(this.pageIndex+1):this.itemA.showTextField("block"),this.fillImage=!0)};thumbnailItem.prototype.clearImage=function(){this.itemA.clearImage(this.pageIndex);1!=this.pageIndex&&this.pageIndex!=totalPageCount?this.itemB.clearImage(this.pageIndex+1):this.itemA.showTextField("block");this.fillImage=!1};
thumbnailItem.prototype.setPosition=function(a,b,c){void 0==c&&(c=["left","top"]);$(this.background).css(c[0],a+"px");$(this.background).css(c[1],b+"px")};thumbnailItem.prototype.onResize=function(){this.isSinglePage?this.background.css({width:this.width+4*this.boredrWidth,height:this.height+2*this.boredrWidth}):this.background.css({width:this.width,height:this.height})};
thumbnailItem.prototype.fission=function(){this.background.css({width:1===this.pageIndex||this.pageIndex===totalPageCount?this.width+2*this.boredrWidth:this.width+4*this.boredrWidth+this.spacing,height:this.height+2*this.boredrWidth});this.setBorder(!0);this.itemA.setImgPosition("c");this.itemB.setImgPosition("c");this.showTextField(!1);this.isSinglePage=!0};
thumbnailItem.prototype.merge=function(){this.background.css({width:this.width,height:this.height});this.setBorder(!1);this.itemA.setImgPosition("l");this.itemB.setImgPosition("r");this.showTextField(!0);this.isSinglePage=!1};thumbnailItem.prototype.setBorder=function(a){a?(this.hideBorder(),this.itemA.showBorder(),this.itemB.showBorder()):(this.showBorder(),this.itemA.hideBorder(),this.itemB.hideBorder())};
thumbnailItem.prototype.showBorder=function(){this.background.css({border:this.normalBorder,boxShadow:this.boxShadow})};thumbnailItem.prototype.hideBorder=function(){this.background.css({border:"",boxShadow:""})};
thumbnailItem.prototype.highLight=function(a){this.isSinglePage?a==this.pageIndex?(this.itemA.highLight(),this.itemA.onMouseOverUp(),this.itemA.showTextField("block")):(this.itemB.highLight(),this.itemB.onMouseOverUp(),this.itemB.showTextField("block")):((1===a||a===totalPageCount)&&this.itemA.showTextField("block"),this.background.css({border:this.selectBorder}),this.onMouseOverUp())};
thumbnailItem.prototype.showTextField=function(a){if(!(1==this.pageIndex||this.pageIndex==totalPageCount)){this.textField.css({left:(this.width-this.textField.outerWidth(!0))/2});var b=this,c=a?"block":"none",a=a?"none":"block";this.background.bind(_event._enter,function(){b.textField.css({display:c})});this.background.bind(_event._down,function(){b.textField.css({display:c})});this.background.bind(_event._end,function(){b.textField.css({display:"none"})});this.background.bind(_event._leave,function(){b.textField.css({display:"none"})});
this.itemA.showTextField(a);this.itemB.showTextField(a)}};thumbnailItem.prototype.onItemMouseUp=function(a){isThumbDrag||(a=a.getPageIndex(),gotoPageFun(a))};thumbnailItem.prototype.onMouseOver=function(){var a=this;this.background.css({border:this.normalBorder});this.background.bind(_event._enter,function(){$(this).css({border:a.overBorder})});this.background.bind(_event._leave,function(){$(this).css({border:a.normalBorder})})};
thumbnailItem.prototype.onMouseOverUp=function(){var a=this;this.background.bind(_event._enter,function(){$(this).css({border:a.overBorder})});this.background.bind(_event._leave,function(){$(this).css({border:a.selectBorder})})};thumbnailItem.prototype.clearMouseOver=function(){this.background.bind(_event._enter,function(){$(this).css({border:""})});this.background.bind(_event._leave,function(){$(this).css({border:""})})};
thumbnailItem.prototype.clearHighLight=function(){this.isSinglePage?(this.itemA.onMouseOver(),this.itemB.onMouseOver(),this.clearMouseOver()):(this.itemA.clearMouseOver(),this.itemB.clearMouseOver(),this.onMouseOver())};function loadToolBar(a,b){this.visible=!1;this.icons=b;this.topBg=$('<div class="fbTopBar" id = "fbTopBar"></div>');this.logoBar=$("<div id='logoBar' class='bottom left' style='position: absolute;left: 0px;right: auto;z-index: 1;'></div>");this.pageBar=$("<div class='bottom left' style='position: absolute;left: 0px;right: auto;z-index: 3;'></div>");this.searchBar=$("<div class='bottom right' style='position: absolute;left: auto;right: 0px;z-index: 2;'></div>");this.toolBG=$("<div class='fbToolBar' id='fbToolBar'></div>");
this.edtPageNumber=$("<div class='numbering' id='tfPageIndex'><input type='text' class='numInnerShadow' id='currentPageIndexTextField' size='13' value='' style='text-align: center'/></div>");this.edtPreSearch=$("<div class='numbering' id='preSearchContent'><input type='text' class='searchInnerShadow' id='preSearch' size='13' value='' style='text-align: left'/></div>");this.visible=!1;a.append(this.topBg);this.topBg.append(this.pageBar);this.topBg.append(this.searchBar);this.topBg.append(this.logoBar);
this.searchBar.append(this.edtPreSearch);this.pageBar.append(this.edtPageNumber);this.edtPageNumber.children("input").css({color:bookConfig.pageNumColor});this.editPageWidth=this.edtPageNumber.width();this.addButton(this.pageBar,[1,2,3,4,5,6,7,8,9,10,12,13,14,15,16,17,18,19,20,21]);this.addButton(this.searchBar,[11]);thumbnail=new thumbnailBar(tmpContainer);rightToLeft&&(this.btnFirst.attr({title:getLanguage("btnLastPage","Last")}),this.btnLast.attr({title:getLanguage("btnFirstPage","First")}),this.btnNext.attr({title:getLanguage("btnPrePage",
"Previous")}),this.btnPrevious.attr({title:getLanguage("btnNextPage","Next")}));getBool("autoPlayAutoStart",!1)&&(this.btnAutoPlay.empty().append(getImage(toolBarIconsURL[8])),this.btnAutoPlay.attr("title",getLanguage("btnStopAutoFlip","Stop auto flip")));this.initEvent()}
loadToolBar.prototype.setButtonPosition=function(){bookType!=BookType.singleSlide_book&&bookType!=BookType.slide_book&&this.show();var a=parseInt(windowWidth)-200;QRbutton.css({top:"0px",left:windowWidth-50+"px"});this.topBg.css({width:a+"px",height:"42px",left:"100px"});parseInt(windowWidth);this.topBg.setGradient(bookConfig.toolbarColor,!1);this.topBg.addBorderShadow(colorDiv(bookConfig.toolbarColor,20),0,1);this.topBg.css({"border-bottom":"1px solid "+colorDiv(bookConfig.toolbarColor,5)});colorAdd(bookConfig.toolbarColor,
120);this.editPageWidth=87;this.edtPageNumber.children("input").css({width:this.editPageWidth+"px"});$(".searchInnerShadow").css({"border-top":"1px solid "+colorDiv(bookConfig.toolbarColor,20),"border-left":"1px solid "+colorDiv(bookConfig.toolbarColor,20)});var b=10,c=0,d=function(b){return b<a-400?!0:!1};d(c+300)&&userConfig.homeButtonVisible?(this.btnHome.css({top:"5px",left:c+"px"}),c+=30,this.btnHome.css({display:"block"}),moreConfig.homeButtonVisible=!1):(this.btnHome.css({display:"none"}),
this.btnMore.css({display:"block"}),moreConfig.homeButtonVisible=!0);d(c+300)&&userConfig.bgSoundButtonVisible?(this.btnSound.css({top:"5px",left:c+"px"}),c+=30,this.btnSound.css({display:"block"}),moreConfig.bgSoundButtonVisible=!1):(this.btnSound.css({display:"none"}),this.btnMore.css({display:"block"}),moreConfig.bgSoundButtonVisible=!0);d(c+300)&&userConfig.printButtonVisible?(this.btnPrint.css({top:"5px",left:c+"px"}),c+=30,this.btnPrint.css({display:"block"}),moreConfig.printButtonVisible=!1):
(this.btnPrint.css({display:"none"}),this.btnMore.css({display:"block"}),moreConfig.printButtonVisible=!0);d(c+300)&&userConfig.downloadButtonVisible?(this.btnDownload.css({top:"5px",left:c+"px"}),c+=30,this.btnDownload.css({display:"block"}),moreConfig.downloadButtonVisible=!1):(this.btnDownload.css({display:"none"}),this.btnMore.css({display:"block"}),moreConfig.downloadButtonVisible=!0);d(c+300)&&thumbButtonEnable?(this.btnThumb.css({top:"5px",left:c+"px"}),c+=30,this.btnThumb.css({display:"block"}),
moreConfig.thumbButtonEnable=!1):(this.btnThumb.css({display:"none"}),this.btnMore.css({display:"block"}),moreConfig.thumbButtonEnable=!0);d(c+300)&&bookmarkButtonEnable?(this.btnBookMark.css({top:"5px",left:c+"px"}),c+=30,this.btnBookMark.css({display:"block"}),moreConfig.bookmarkButtonEnable=!1):(this.btnBookMark.css({display:"none"}),this.btnMore.css({display:"block"}),moreConfig.bookmarkButtonEnable=!0);d(c+300)&&tableofcontentButtonEnable?(this.btnTableOfContent.css({top:"5px",left:c+"px"}),
c+=30,this.btnTableOfContent.css({display:"block"}),moreConfig.tableofcontentButtonEnable=!1):(this.btnTableOfContent.css({display:"none"}),this.btnMore.css({display:"block"}),moreConfig.tableofcontentButtonEnable=!0);d(c+300)&&zoomButtonEnable&&isFlipModel?(this.btnZoom.css({top:"5px",left:c+"px"}),c+=30,this.btnZoom.css({display:"block"}),moreConfig.zoomButtonEnable=!1):(this.btnZoom.css({display:"none"}),this.btnMore.css({display:"block"}),moreConfig.zoomButtonEnable=!0);this.btnFirst.css({left:c+
"px",top:"5px"});c+=30;this.btnPrevious.css({left:c+"px",top:"5px"});c+=36;this.edtPageNumber.css({left:c,top:"6px"});c=c+this.editPageWidth+14;this.btnNext.css({left:c+"px",top:"5px"});c+=30;this.btnLast.css({left:c+"px",top:"5px"});c+=30;this.btnFirst.css({display:"block"});this.btnPrevious.css({display:"block"});this.btnNext.css({display:"block"});this.btnLast.css({display:"block"});this.edtPageNumber.css({display:"block"});moreConfig.flipButtonVisible=!1;d(c+300)&&userConfig.autoPlayButtonVisible?
(this.btnAutoPlay.css({top:"5px",left:c+"px"}),c+=30,this.btnAutoPlay.css({display:"block"}),moreConfig.autoPlayButtonVisible=!1):(this.btnAutoPlay.css({display:"none"}),this.btnMore.css({display:"block"}),moreConfig.autoPlayButtonVisible=!0);var e=0;d(c)&&shareButtonEnable?(this.btnShare.css({top:"5px",left:c+"px"}),e=c,c+=30,this.btnShare.css({display:"block"}),moreConfig.shareButtonEnable=!1):(this.btnShare.css({display:"none"}),this.btnMore.css({display:"block"}),moreConfig.shareButtonEnable=
!0);d(c)&&1<language.length?(this.btnLanguage.css({top:"5px",left:c+"px"}),this.btnLanguage.css({display:"block"}),c+=30,moreConfig.languageButtonVisible=!1):(this.btnLanguage.css({display:"none"}),this.btnMore.css({display:"block"}),moreConfig.languageButtonVisible=!0);d(c)&&userConfig.AnnotationButtonVisible?(this.btnNote.css({top:"5px",left:c+"px"}),c+=30,this.btnNote.css({display:"block"}),moreConfig.AnnotationButtonVisible=!1):(this.btnNote.css({display:"none"}),this.btnMore.css({display:"block"}),
moreConfig.AnnotationButtonVisible=!0);userConfig.fullscreenButtonVisible&&(this.btnFullscreen.css({top:"5px",left:c+"px"}),this.btnFullscreen.css({display:"block"}),c+=30,moreConfig.fullscreenButtonVisible=!1);d(c)&&userConfig.helpButtonVisible?(this.btnHelp.css({top:"5px",left:c+"px"}),c+=30,this.btnHelp.css({display:"block"}),moreConfig.helpButtonVisible=!1):(this.btnHelp.css({display:"none"}),this.btnMore.css({display:"block"}),moreConfig.helpButtonVisible=!0);d(c)&&userConfig.aboutButtonVisible?
(this.btnAbout.css({top:"5px",left:c+"px"}),c+=30,this.btnAbout.css({display:"block"}),moreConfig.aboutButtonVisible=!1):(this.btnAbout.css({display:"none"}),this.btnMore.css({display:"block"}),moreConfig.aboutButtonVisible=!0);var f=0;this.btnMore.css({top:"5px",left:c+"px"});var f=c,c=c+30,g=c-30,b=10;d(c)&&searchButtonEnable?(this.btnSearch.css({top:"5px",right:b+"px"}),b+=this.btnSearch.width()+3,this.edtPreSearch.css({top:"6px",right:b+"px"}),this.btnSearch.css({display:"block"}),this.edtPreSearch.css({display:"block"}),
moreConfig.searchButtonEnable=!1):(this.btnSearch.css({display:"none"}),this.edtPreSearch.css({display:"none"}),this.btnMore.css({display:"block"}),moreConfig.searchButtonEnable=!0);b=(a-g)/2;this.pageBar.css({left:b+"px"});shareBar.setSharePosition(100+e+b-65,50,["left","top"]);moreBar.setMorePosition(100+f+b-65,50,["left","top"]);this.changeButtonColor(bookConfig.iconColor);this.mouseEnterShine(bookConfig.toolbarColor,colorDiv(bookConfig.toolbarColor,30),colorAdd(bookConfig.toolbarColor,105));this.OnMouseOver();
moreBar.onResize(this.btnMore)};
loadToolBar.prototype.changeButtonColor=function(a){this.changeFullscreenIcon(fullScreenApi.isFullScreen());this.changeZoomIcon(2!=bookType);this.changeAutoPlayIcon();this.changeSoundIcon();userConfig.homeButtonVisible&&this.btnHome.changeButtonColor(a);userConfig.downloadButtonVisible&&this.btnDownload.changeButtonColor(a);userConfig.printButtonVisible&&this.btnPrint.changeButtonColor(a);thumbButtonEnable&&this.btnThumb.changeButtonColor(a);bookmarkButtonEnable&&this.btnBookMark.changeButtonColor(a);tableofcontentButtonEnable&&
this.btnTableOfContent.changeButtonColor(a);shareButtonEnable&&this.btnShare.changeButtonColor(a);userConfig.helpButtonVisible&&this.btnHelp.changeButtonColor(a);userConfig.aboutButtonVisible&&this.btnAbout.changeButtonColor(a);1<language.length&&this.btnLanguage.changeButtonColor(a);userConfig.AnnotationButtonVisible&&this.btnNote.changeButtonColor(a);zoomButtonEnable&&isFlipModel&&this.btnZoom.changeButtonColor(a);userConfig.autoPlayButtonVisible&&this.btnAutoPlay.changeButtonColor(a);userConfig.bgSoundButtonVisible&&
this.btnSound.changeButtonColor(a);userConfig.fullscreenButtonVisible&&this.btnFullscreen.changeButtonColor(a);this.btnLast.changeButtonColor(a);this.btnNext.changeButtonColor(a);this.btnPrevious.changeButtonColor(a);this.btnFirst.changeButtonColor(a);searchButtonEnable&&this.btnSearch.changeButtonColor(a);this.btnMore.changeButtonColor(a)};
loadToolBar.prototype.changeZoomIcon=function(a){a?this.btnZoom.empty().append(getImage(toolBarIconsURL[5])).attr("title",getLanguage("btnZoomIn","Zoom in")):this.btnZoom.empty().append(getImage(toolBarIconsURL[6])).attr("title",getLanguage("btnZoomOut","Zoom out"));this.btnZoom.changeButtonColor(bookConfig.iconColor);moreBar.changeZoomIcon(a)};
loadToolBar.prototype.changeFullscreenIcon=function(a){a?this.btnFullscreen.empty().append(getImage(toolBarIconsURL[28])).attr("title",getLanguage("btnFullscreen","Exit fullscreen")):this.btnFullscreen.empty().append(getImage(toolBarIconsURL[27])).attr("title",getLanguage("btnFullscreen","Enter fullscreen"));this.btnFullscreen.changeButtonColor(bookConfig.iconColor);moreBar.changeFullscreenIcon(a)};
loadToolBar.prototype.changeAutoPlayIcon=function(){void 0!=auto_player&&null!=auto_player&&(auto_player.isPlaying()?this.btnAutoPlay.empty().append(getImage(toolBarIconsURL[8])).attr("title",getLanguage("btnStopAutoFlip","Stop auto flip")):this.btnAutoPlay.empty().append(getImage(toolBarIconsURL[7])).attr("title",getLanguage("btnAutoFlip","Auto flip")),this.btnAutoPlay.changeButtonColor(bookConfig.iconColor));moreBar.changeAutoPlayIcon()};
loadToolBar.prototype.changeSoundIcon=function(){void 0!=isPlaying&&(isPlaying?this.btnSound.empty().append(getImage(toolBarIconsURL[15])).attr("title",getLanguage("btnSoundOn","Sound on")):this.btnSound.empty().append(getImage(toolBarIconsURL[16])).attr("title",getLanguage("btnSoundOff","Sound off")),this.btnSound.changeButtonColor(bookConfig.iconColor));moreBar.changeSoundIcon()};
loadToolBar.prototype.mouseEnterShine=function(a,b,c){userConfig.homeButtonVisible&&this.btnHome.mouseEnterGradient(a,b,c);userConfig.printButtonVisible&&this.btnPrint.mouseEnterGradient(a,b,c);userConfig.downloadButtonVisible&&this.btnDownload.mouseEnterGradient(a,b,c);zoomButtonEnable&&isFlipModel&&this.btnZoom.mouseEnterGradient(a,b,c);bookmarkButtonEnable&&this.btnBookMark.mouseEnterGradient(a,b,c);tableofcontentButtonEnable&&this.btnTableOfContent.mouseEnterGradient(a,b,c);shareButtonEnable&&
this.btnShare.mouseEnterGradient(a,b,c);userConfig.autoPlayButtonVisible&&this.btnAutoPlay.mouseEnterGradient(a,b,c);userConfig.bgSoundButtonVisible&&this.btnSound.mouseEnterGradient(a,b,c);userConfig.helpButtonVisible&&this.btnHelp.mouseEnterGradient(a,b,c);userConfig.aboutButtonVisible&&this.btnAbout.mouseEnterGradient(a,b,c);thumbButtonEnable&&this.btnThumb.mouseEnterGradient(a,b,c);1<language.length&&this.btnLanguage.mouseEnterGradient(a,b);userConfig.fullscreenButtonVisible&&this.btnFullscreen.mouseEnterGradient(a,
b);userConfig.AnnotationButtonVisible&&this.btnNote.mouseEnterGradient(a,b);this.btnLast.mouseEnterGradient(a,b,c);this.btnNext.mouseEnterGradient(a,b,c);this.btnPrevious.mouseEnterGradient(a,b,c);this.btnFirst.mouseEnterGradient(a,b,c);searchButtonEnable&&this.btnSearch.mouseEnterGradient(a,b,c);this.btnMore.mouseEnterGradient(a,b,c)};
loadToolBar.prototype.show=function(){var a=this;a.visible=!0;miniStyle.isMini()?this.topBg.animate({top:-50},500,function(){a.visible=!0}):this.topBg.animate({top:0},500,function(){a.visible=!0})};loadToolBar.prototype.getHeight=function(){return this.getTopHeight()+this.getBottomHeight()};loadToolBar.prototype.getTopHeight=function(){return miniStyle.isMini()?10:this.visible?this.topBg.height()+10:10};
loadToolBar.prototype.getBottomHeight=function(){return miniStyle.isMini()?10:thumbButtonEnable&&thumbnail.getShowStatu()?thumbnail.height-20:10};loadToolBar.prototype.getLogoHeight=function(){return this.topBg.height()};loadToolBar.prototype.hide=function(){var a=this;a.visible=!1;this.topBg.animate({top:-50},300,function(){a.visible=!1})};
loadToolBar.prototype.initEvent=function(){this.edtPreSearch.bind("keydown",function(a){13==a.keyCode&&!frmSearch.isSearchShow&&frmSearch.showForm();isMoreShow&&(moreBar.hideMoreBar(),isMoreShow=!1)});this.toolBG.bind(_event._down,function(){isShareShow&&(shareBar.showShareBar(),isShareShow=!1)})};function initMoreButton(a,b,c,d){this.name=b;this.moreButtonString="<div class='moreButton' id='"+b+"'></div>";this.moreButton=$(this.moreButtonString);this.moreImg=$("<div><img src='"+c+"' class='moreImg'/></div>");this.moreLable=new label(d,this.moreButton);this.moreLable.setLabelPosition(35,7);a.append(this.moreButton);$(this.moreButton).append(this.moreImg);$(this.moreButton).append(this.moreLable);$(this.moreLable).css({"vertical-align":"middle"});$(this.moreButton).css({"text-shadow":"1px 1px "+
colorDiv(bookConfig.toolbarColor,40)});$(this.moreButton).css({color:"#ffffff"});$(this.moreButton).mouseEnterGradient(bookConfig.toolbarColor,colorDiv(bookConfig.toolbarColor,30),colorAdd(bookConfig.toolbarColor,105));$(this.moreButton).css({cursor:"pointer"});return this}initMoreButton.prototype.setPosition=function(a,b){$(this.moreButton).css({left:b+"px"});$(this.moreButton).css({top:a+"px"})};initMoreButton.prototype.changeIcon=function(a){this.moreImg.empty().append("<img src='"+a+"' class='moreImg'/>")};
initMoreButton.prototype.src=function(){return this.moreImg.attr("src")};initMoreButton.prototype.bind=function(a,b){$(this.moreButton).bind(a,b)};initMoreButton.prototype.hide=function(){$(this.moreButton).css({display:"none"})};initMoreButton.prototype.show=function(){$(this.moreButton).css({display:"block"})};initMoreButton.prototype.changeButtonColor=function(a){$(this.moreImg).changeButtonColor(a)};initMoreButton.prototype.setCaption=function(a){this.moreLable.setCaption(a)};var isMoreShow=!1,moreConfig={autoPlayButtonVisible:!1,zoomButtonEnable:!1,thumbButtonEnable:!1,shareButtonEnable:!1,searchButtonEnable:!1,bookmarkButtonEnable:!1,tableofcontentButtonEnable:!1,downloadButtonVisible:!1,homeButtonVisible:!1,printButtonVisible:!1,bgSoundButtonVisible:!1,helpButtonVisible:!1,aboutButtonVisible:!1,languageButtonVisible:!1,flipButtonVisible:!1,fullscreenButtonVisible:!1,AnnotationButtonVisible:!1};
function initMoreBar(){var a=this;this.moreBar=$("<div style='display:none;opacity:0;'>");this.moreBar.css("z-index",2002);this.moreBar.css("bottom","38px");this.moreBar.css("right","300px");this.moreBar.css({width:"160px",position:"absolute",background:bookConfig.toolbarColor,"overflow-y":"auto"});this.moreBar.addBorderShadow(bookConfig.toolbarColor,3,3);this.btnLast=new initMoreButton(this.moreBar,"moreBtnLast",toolBarIconsURL[1],getLanguage("btnLastPage","Last"));this.btnNext=new initMoreButton(this.moreBar,
"moreBtnNext",toolBarIconsURL[2],getLanguage("btnNextPage","Next"));this.btnPrevious=new initMoreButton(this.moreBar,"moreBtnPrevious",toolBarIconsURL[3],getLanguage("btnPrePage","Previous"));this.btnFirst=new initMoreButton(this.moreBar,"moreBtnFirst",toolBarIconsURL[4],getLanguage("btnFirstPage","First"));this.btnZoom=new initMoreButton(this.moreBar,"moreBtnZoom",toolBarIconsURL[5],getLanguage("btnZoomIn","Zoom In"));this.btnAutoPlay=new initMoreButton(this.moreBar,"moreBtnAutoPlay",toolBarIconsURL[7],
getLanguage("btnAutoFlip","Auto Flip"));this.btnThumb=new initMoreButton(this.moreBar,"moreBtnThumb",toolBarIconsURL[9],getLanguage("btnThumb","Thumbnails"));this.btnShare=new initMoreButton(this.moreBar,"moreBtnShare",toolBarIconsURL[10],getLanguage("btnSocialShare","Share"));this.btnSearch=new initMoreButton(this.moreBar,"moreBtnSearch",toolBarIconsURL[11],getLanguage("btnSearch","Search"));this.btnBookMark=new initMoreButton(this.moreBar,"moreBtnBookMark",toolBarIconsURL[14],getLanguage("btnBookMark",
"Book Mark"));this.btnTableOfContent=new initMoreButton(this.moreBar,"moreBtnTableOfContent",toolBarIconsURL[32],getLanguage("btnTableOfContent","table of content"));this.btnDownload=new initMoreButton(this.moreBar,"moreBtnDownload",toolBarIconsURL[12],getLanguage("btnDownload","Download"));this.btnHome=new initMoreButton(this.moreBar,"moreBtnHome",toolBarIconsURL[13],getLanguage("btnGoToHome","Home"));this.btnPrint=new initMoreButton(this.moreBar,"moreBtnPrint",toolBarIconsURL[21],getLanguage("btnPrint",
"Print"));this.btnSound=new initMoreButton(this.moreBar,"moreBtnSound",toolBarIconsURL[15],getLanguage("btnSoundOn","soundOn"));this.btnHelp=new initMoreButton(this.moreBar,"moreBtnHelp",toolBarIconsURL[22],getLanguage("btnHelp","Help"));this.btnAbout=new initMoreButton(this.moreBar,"moreBtnAbout",toolBarIconsURL[23],getLanguage("btnAbout","About"));this.btnLanguage=new initMoreButton(this.moreBar,"moreBtnLanguage",toolBarIconsURL[25],getLanguage("btnLanguage","LanguageChange"));this.btnFullscreen=
new initMoreButton(this.moreBar,"moreBtnFullscreen",toolBarIconsURL[27],getLanguage("btnFullscreen","fullscreen"));this.btnNote=new initMoreButton(this.moreBar,"moreBtnNote",toolBarIconsURL[31],getLanguage("btnNote","add note"));$.fn.extend(this,{showMoreBar:function(){a.moreBar.css("display","block");a.moreBar.animate({opacity:1},200,"linear")},hideMoreBar:function(){a.moreBar.animate({opacity:0},200,"linear",function(){a.moreBar.css("display","none")})},setMorePosition:function(b,c,d){void 0==d&&
(d=["right","bottom"]);a.moreBar.css(d[0],b+"px");a.moreBar.css(d[1],c+"px")}});tmpContainer.append(this.moreBar);(!moreConfig.autoPlayButtonVisible||!userConfig.autoPlayButtonVisible)&&this.btnAutoPlay.hide();(!moreConfig.zoomButtonEnable||!zoomButtonEnable||!isFlipModel)&&this.btnZoom.hide();(!moreConfig.thumbButtonEnable||!thumbButtonEnable)&&this.btnThumb.hide();(!moreConfig.shareButtonEnable||!shareButtonEnable)&&this.btnShare.hide();(!moreConfig.searchButtonEnable||!searchButtonEnable)&&this.btnSearch.hide();
(!moreConfig.bookmarkButtonEnable||!bookmarkButtonEnable)&&this.btnBookMark.hide();(!moreConfig.tableofcontentButtonEnable||!tableofcontentButtonEnable)&&this.btnTableOfContent.hide();(!moreConfig.downloadButtonVisible||!userConfig.downloadButtonVisible)&&this.btnDownload.hide();(!moreConfig.homeButtonVisible||!userConfig.homeButtonVisible)&&this.btnHome.hide();(!moreConfig.printButtonVisible||!userConfig.printButtonVisible)&&this.btnPrint.hide();(!moreConfig.bgSoundButtonVisible||!userConfig.bgSoundButtonVisible)&&
this.btnSound.hide();(!moreConfig.helpButtonVisible||!userConfig.helpButtonVisible)&&this.btnHelp.hide();(!moreConfig.aboutButtonVisible||!userConfig.aboutButtonVisible)&&this.btnAbout.hide();(!moreConfig.languageButtonVisible||1>=language.length)&&this.btnLanguage.hide();(!moreConfig.fullscreenButtonVisible||!userConfig.fullscreenButtonVisible)&&this.btnFullscreen.hide();(!moreConfig.AnnotationButtonVisible||!userConfig.AnnotationButtonVisible)&&this.btnNote.hide();moreConfig.flipButtonVisible||
(this.btnLast.hide(),this.btnNext.hide(),this.btnPrevious.hide(),this.btnFirst.hide());this.initEvent()}
initMoreBar.prototype.onResize=function(a,b){isMoreShow=!1;var c=0;shareButtonTop=function(a){return 8+35*a};moreConfig.flipButtonVisible?(this.btnLast.setPosition(shareButtonTop(c),10),c++,this.btnNext.setPosition(shareButtonTop(c),10),c++,this.btnPrevious.setPosition(shareButtonTop(c),10),c++,this.btnFirst.setPosition(shareButtonTop(c),10),c++,this.btnFirst.show(),this.btnPrevious.show(),this.btnNext.show(),this.btnLast.show()):(this.btnFirst.hide(),this.btnPrevious.hide(),this.btnNext.hide(),this.btnLast.hide());
moreConfig.autoPlayButtonVisible&&userConfig.autoPlayButtonVisible?(this.btnAutoPlay.setPosition(shareButtonTop(c),10),this.btnAutoPlay.show(),c++):this.btnAutoPlay.hide();moreConfig.AnnotationButtonVisible&&userConfig.AnnotationButtonVisible?(this.btnNote.setPosition(shareButtonTop(c),10),this.btnNote.show(),c++):this.btnNote.hide();moreConfig.zoomButtonEnable&&zoomButtonEnable&&isFlipModel?(this.btnZoom.setPosition(shareButtonTop(c),10),this.btnZoom.show(),c++):this.btnZoom.hide();moreConfig.thumbButtonEnable&&
thumbButtonEnable?(this.btnThumb.setPosition(shareButtonTop(c),10),this.btnThumb.show(),c++):this.btnThumb.hide();moreConfig.shareButtonEnable&&shareButtonEnable?(this.btnShare.setPosition(shareButtonTop(c),10),this.btnShare.show(),c++):this.btnShare.hide();moreConfig.searchButtonEnable&&searchButtonEnable?(this.btnSearch.setPosition(shareButtonTop(c),10),this.btnSearch.show(),c++):this.btnSearch.hide();moreConfig.bookmarkButtonEnable&&bookmarkButtonEnable?(this.btnBookMark.setPosition(shareButtonTop(c),
10),this.btnBookMark.show(),c++):this.btnBookMark.hide();moreConfig.tableofcontentButtonEnable&&tableofcontentButtonEnable?(this.btnTableOfContent.setPosition(shareButtonTop(c),10),this.btnTableOfContent.show(),c++):this.btnTableOfContent.hide();moreConfig.downloadButtonVisible&&userConfig.downloadButtonVisible?(this.btnDownload.setPosition(shareButtonTop(c),10),this.btnDownload.show(),c++):this.btnDownload.hide();moreConfig.homeButtonVisible&&userConfig.homeButtonVisible?(this.btnHome.setPosition(shareButtonTop(c),
10),this.btnHome.show(),c++):this.btnHome.hide();moreConfig.printButtonVisible&&userConfig.printButtonVisible?(this.btnPrint.setPosition(shareButtonTop(c),10),this.btnPrint.show(),c++):this.btnPrint.hide();moreConfig.bgSoundButtonVisible&&userConfig.bgSoundButtonVisible?(this.btnSound.setPosition(shareButtonTop(c),10),this.btnSound.show(),c++):this.btnSound.hide();moreConfig.helpButtonVisible&&userConfig.helpButtonVisible?(this.btnHelp.setPosition(shareButtonTop(c),10),this.btnHelp.show(),c++):this.btnHelp.hide();
moreConfig.aboutButtonVisible&&userConfig.aboutButtonVisible?(this.btnAbout.setPosition(shareButtonTop(c),10),this.btnAbout.show(),c++):this.btnAbout.hide();moreConfig.languageButtonVisible&&1<language.length?(this.btnLanguage.setPosition(shareButtonTop(c),10),this.btnLanguage.show(),c++):this.btnLanguage.hide();moreConfig.fullscreenButtonVisible&&userConfig.fullscreenButtonVisible?(this.btnFullscreen.setPosition(shareButtonTop(c),10),this.btnFullscreen.show(),c++):this.btnFullscreen.hide();0==c?
(a.css({display:"none"}),null!=b&&b.css({display:"none"}),this.hideMoreBar()):(a.css({display:"block"}),null!=b&&b.css({display:"block"}),this.moreBar.css({height:Math.min(shareButtonTop(c),250)+"px"}));this.changeButtonColor(bookConfig.iconColor);printBody.onResize();helpBody.onResize();aboutBody.onResize();sharePanel.onResize();languagePanel.onResize();annotationPannel.onResize()};
initMoreBar.prototype.changeZoomIcon=function(a){a?(this.btnZoom.changeIcon(toolBarIconsURL[5]),this.btnZoom.setCaption(getLanguage("btnZoomIn","Zoom In"))):(this.btnZoom.changeIcon(toolBarIconsURL[6]),this.btnZoom.setCaption(getLanguage("btnZoomOut","Zoom Out")));this.btnZoom.changeButtonColor(bookConfig.iconColor)};
initMoreBar.prototype.changeFullscreenIcon=function(a){a?(this.btnFullscreen.changeIcon(toolBarIconsURL[28]),this.btnFullscreen.setCaption(getLanguage("btnFullscreen","Exit fullscreen"))):(this.btnFullscreen.changeIcon(toolBarIconsURL[27]),this.btnFullscreen.setCaption(getLanguage("btnFullscreen","Enter fullscreen")));this.btnFullscreen.changeButtonColor(bookConfig.iconColor)};
initMoreBar.prototype.changeAutoPlayIcon=function(){void 0!=auto_player&&null!=auto_player&&(auto_player.isPlaying()?(this.btnAutoPlay.changeIcon(toolBarIconsURL[7]),this.btnAutoPlay.setCaption(getLanguage("btnAutoFlip","Auto Flip"))):(this.btnAutoPlay.changeIcon(toolBarIconsURL[8]),this.btnAutoPlay.setCaption(getLanguage("btnStopAutoFlip","Stop Auto Flip"))),this.btnAutoPlay.changeButtonColor(bookConfig.iconColor))};
initMoreBar.prototype.changeSoundIcon=function(){void 0!=isPlaying&&(isPlaying?(this.btnSound.changeIcon(toolBarIconsURL[16]),this.btnSound.setCaption(getLanguage("btnSoundOff","soundOff"))):(this.btnSound.changeIcon(toolBarIconsURL[15]),this.btnSound.setCaption(getLanguage("btnSoundOn","soundOn"))),this.btnSound.changeButtonColor(bookConfig.iconColor))};initMoreBar.prototype.height=function(){return this.moreBar.height()};
initMoreBar.prototype.initEvent=function(){var a=this;this.btnLast.bind(_event._end,function(){a.lastPage();moreBar.hideMoreBar();isMoreShow=!1});this.btnNext.bind(_event._end,function(){a.nextPage();moreBar.hideMoreBar();isMoreShow=!1});this.btnPrevious.bind(_event._end,function(){a.prePage();moreBar.hideMoreBar();isMoreShow=!1});this.btnFirst.bind(_event._end,function(){a.firstPage();moreBar.hideMoreBar();isMoreShow=!1});this.btnZoom.bind(_event._end,function(){2==bookType?(windowWidth<windowHeight?
(bookType=1,changeShowBook(1),setCurrentIndexTextField($(singlePageBook).data().currentPageIndex),$(singlePageBook).data().gotoPage(zoomBook.currentIndex)):(bookType=0,changeShowBook(0),setCurrentIndexTextField(flipBook.currentPageIndex,!0),flipBook.gotoPage(zoomBook.currentIndex)),thumbnail.clearHighLight(),thumbnail.setHighLight(zoomBook.currentIndex),a.btnZoom.changeIcon(toolBarIconsURL[5]),a.btnZoom.setCaption(getLanguage("btnZoomIn","Zoom In"))):(zoomBook.currentIndex=flipBook.currentPageIndex,
zoomBook.showPage.fillContent(zoomBook.currentIndex),bookType=2,changeShowBook(2),a.btnZoom.changeIcon(toolBarIconsURL[6]),a.btnZoom.setCaption(getLanguage("btnZoomOut","Zoom Out")),setCurrentIndexTextField(zoomBook.currentIndex,!1),thumbnail.clearHighLight(),thumbnail.setHighLight(zoomBook.currentIndex),auto_player.isPlaying()&&(auto_player.stop(),a.btnAutoPlay.changeIcon(toolBarIconsURL[8]),a.btnAutoPlay.setCaption(getLanguage("btnStopAutoFlip","Stop Auto Flip"))));a.btnZoom.changeButtonColor(bookConfig.iconColor);
a.btnAutoPlay.changeButtonColor(bookConfig.iconColor);moreBar.hideMoreBar();isMoreShow=!1});this.btnAutoPlay.bind(_event._end,function(){auto_player.isPlaying()?(auto_player.stop(),a.btnAutoPlay.changeIcon(toolBarIconsURL[7]),a.btnAutoPlay.setCaption(getLanguage("btnAutoFlip","Auto Flip"))):(auto_player.start(),a.btnAutoPlay.changeIcon(toolBarIconsURL[8]),a.btnAutoPlay.setCaption(getLanguage("btnStopAutoFlip","Stop Auto Flip")));a.btnAutoPlay.changeButtonColor(bookConfig.iconColor);moreBar.hideMoreBar();
isMoreShow=!1});this.btnThumb.bind(_event._end,function(){thumbnail.getShowStatu()?thumbnail.hideBox():thumbnail.showshow();moreBar.hideMoreBar();isMoreShow=!1});this.btnShare.bind(_event._end,function(){sharePanel.getShowStatu()?sharePanel.hideBox():sharePanel.showshow();moreBar.hideMoreBar();isMoreShow=!1});this.btnShare.bind(_event._down,function(){return!1});this.btnPrint.bind(_event._end,function(){printBody.getShowStatu()?printBody.hideBox():printBody.showshow();moreBar.hideMoreBar();isMoreShow=
!1});this.btnSearch.bind(_event._end,function(){frmSearch.isSearchShow?frmSearch.closeForm():frmSearch.showForm();moreBar.hideMoreBar();isMoreShow=!1});this.btnTableOfContent.bind(_event._end,function(){frmBookmark.getShowStatu()?frmBookmark.closeForm():frmBookmark.showForm();moreBar.hideMoreBar();isMoreShow=!1});this.btnBookMark.bind(_event._end,function(){bookmark.showHide();moreBar.hideMoreBar();isMoreShow=!1});this.btnDownload.bind(_event._end,function(){""!=userConfig.downloadURL&&(window.location=
userConfig.downloadURL);moreBar.hideMoreBar();isMoreShow=!1});this.btnSound.bind(_event._end,function(){isPlaying?(a.btnSound.changeIcon(toolBarIconsURL[16]),a.btnSound.setCaption(getLanguage("btnSoundOff","soundOff"))):(a.btnSound.changeIcon(toolBarIconsURL[15]),a.btnSound.setCaption(getLanguage("btnSoundOn","soundOn")));a.btnSound.changeButtonColor(bookConfig.iconColor);moreBar.hideMoreBar();isMoreShow=!1});this.btnHome.bind(_event._end,function(){if(void 0!=userConfig.homeURL&&""!=userConfig.homeURL){var a=
userConfig.homeURL;"http"!=a.substr(0,4)&&(a="http://"+a);window.open(a,"_tab")}moreBar.hideMoreBar();isMoreShow=!1});this.btnHelp.bind(_event._end,function(){helpBody.getShowStatu()?helpBody.hideBox():helpBody.showshow();moreBar.hideMoreBar();isMoreShow=!1});this.btnAbout.bind(_event._end,function(){aboutBody.getShowStatu()?aboutBody.hideBox():aboutBody.showshow();moreBar.hideMoreBar();isMoreShow=!1});this.btnLanguage.bind(_event._end,function(){languagePanel.getShowStatu()?languagePanel.hideBox():
languagePanel.showshow();moreBar.hideMoreBar();isMoreShow=!1});this.btnNote.bind(_event._end,function(){annotationPannel.getShowStatu()?annotationPannel.hideBox():annotationPannel.showshow();moreBar.hideMoreBar();isMoreShow=!1});this.btnFullscreen.bind(_event._end,function(){var a=$("body")[0];fullScreenApi.supportsFullScreen?fullScreenApi.isFullScreen()?fullScreenApi.cancelFullScreen():fullScreenApi.requestFullScreen(a):a.webkitSupportsFullscreen&&a.webkitEnterFullscreen(Element.ALLOW_KEYBOARD_INPUT);
return!1});$(document).bind(fullScreenApi.fullScreenEventName,function(){fullScreenApi.isFullScreen()?(a.btnFullscreen.changeIcon(toolBarIconsURL[28]),a.btnFullscreen.setCaption(getLanguage("btnFullscreen","Exit fullscreen"))):(a.btnFullscreen.changeIcon(toolBarIconsURL[27]),a.btnFullscreen.setCaption(getLanguage("btnFullscreen","Enter fullscreen")));a.btnFullscreen.changeButtonColor(bookConfig.iconColor)})};
initMoreBar.prototype.changeButtonColor=function(a){moreConfig.fullscreenButtonVisible&&userConfig.fullscreenButtonVisible&&fullScreenApi.supportsFullScreen&&(fullScreenApi.isFullScreen()?(this.btnFullscreen.changeIcon(toolBarIconsURL[28]),this.btnFullscreen.setCaption(getLanguage("btnFullscreen","Exit fullscreen"))):(this.btnFullscreen.changeIcon(toolBarIconsURL[27]),this.btnFullscreen.setCaption(getLanguage("btnFullscreen","Enter fullscreen"))),this.btnFullscreen.changeButtonColor(bookConfig.iconColor));
moreConfig.flipButtonVisible&&(this.btnLast.changeIcon(toolBarIconsURL[1]),this.btnLast.setCaption(getLanguage("btnLastPage","Last")),this.btnNext.changeIcon(toolBarIconsURL[2]),this.btnNext.setCaption(getLanguage("btnNextPage","Next")),this.btnPrevious.changeIcon(toolBarIconsURL[3]),this.btnPrevious.setCaption(getLanguage("btnPrePage","Previous")),this.btnFirst.changeIcon(toolBarIconsURL[4]),this.btnFirst.setCaption(getLanguage("btnFirstPage","First")));moreConfig.thumbButtonEnable&&thumbButtonEnable&&
(this.btnThumb.changeIcon(toolBarIconsURL[9]),this.btnThumb.setCaption(getLanguage("btnThumb","Thumbnails")));moreConfig.shareButtonEnable&&shareButtonEnable&&(this.btnShare.changeIcon(toolBarIconsURL[10]),this.btnShare.setCaption(getLanguage("btnSocialShare","Share")));moreConfig.searchButtonEnable&&searchButtonEnable&&(this.btnSearch.changeIcon(toolBarIconsURL[11]),this.btnSearch.setCaption(getLanguage("btnSearch","Search")));moreConfig.bookmarkButtonEnable&&bookmarkButtonEnable&&(this.btnBookMark.changeIcon(toolBarIconsURL[14]),
this.btnBookMark.setCaption(getLanguage("btnBookMark","Book Mark")));moreConfig.tableofcontentButtonEnable&&tableofcontentButtonEnable&&(this.btnTableOfContent.changeIcon(toolBarIconsURL[32]),this.btnTableOfContent.setCaption(getLanguage("btnTableOfContent","Table of content")));moreConfig.downloadButtonVisible&&userConfig.downloadButtonVisible&&(this.btnDownload.changeIcon(toolBarIconsURL[12]),this.btnDownload.setCaption(getLanguage("btnDownload","Download")));moreConfig.homeButtonVisible&&userConfig.homeButtonVisible&&
(this.btnHome.changeIcon(toolBarIconsURL[13]),this.btnHome.setCaption(getLanguage("btnGoToHome","Home")));moreConfig.printButtonVisible&&userConfig.printButtonVisible&&(this.btnPrint.changeIcon(toolBarIconsURL[21]),this.btnPrint.setCaption(getLanguage("btnPrint","Print")));moreConfig.helpButtonVisible&&userConfig.helpButtonVisible&&(this.btnHelp.changeIcon(toolBarIconsURL[22]),this.btnHelp.setCaption(getLanguage("btnHelp","Help")));moreConfig.aboutButtonVisible&&userConfig.aboutButtonVisible&&(this.btnAbout.changeIcon(toolBarIconsURL[23]),
this.btnAbout.setCaption(getLanguage("btnAbout","About")));moreConfig.AnnotationButtonVisible&&userConfig.AnnotationButtonVisible&&(this.btnNote.changeIcon(toolBarIconsURL[31]),this.btnNote.setCaption(getLanguage("btnNote","Annotation")));moreConfig.languageButtonVisible&&1<language.length&&(this.btnLanguage.changeIcon(toolBarIconsURL[25]),this.btnLanguage.setCaption(getLanguage("btnLanguage","LanguageChange")));moreConfig.zoomButtonEnable&&zoomButtonEnable&&isFlipModel&&(2==bookType?(this.btnZoom.changeIcon(toolBarIconsURL[6]),
this.btnZoom.setCaption(getLanguage("btnZoomOut","Zoom Out"))):(this.btnZoom.changeIcon(toolBarIconsURL[5]),this.btnZoom.setCaption(getLanguage("btnZoomIn","Zoom In"))),this.btnZoom.changeButtonColor(bookConfig.iconColor));moreConfig.autoPlayButtonVisible&&userConfig.autoPlayButtonVisible&&(void 0!=auto_player&&null!=auto_player&&(auto_player.isPlaying()?(this.btnAutoPlay.changeIcon(toolBarIconsURL[8]),this.btnAutoPlay.setCaption(getLanguage("btnStopAutoFlip","Stop Auto Flip"))):(this.btnAutoPlay.changeIcon(toolBarIconsURL[7]),
this.btnAutoPlay.setCaption(getLanguage("btnAutoFlip","Auto Flip")))),this.btnAutoPlay.changeButtonColor(bookConfig.iconColor));moreConfig.bgSoundButtonVisible&&userConfig.bgSoundButtonVisible&&void 0!=isPlaying&&(isPlaying?(this.btnSound.changeIcon(toolBarIconsURL[15]),this.btnSound.setCaption(getLanguage("btnSoundOn","soundOn"))):(this.btnSound.changeIcon(toolBarIconsURL[16]),this.btnSound.setCaption(getLanguage("btnSoundOff","soundOff"))),this.btnSound.changeButtonColor(bookConfig.iconColor));
moreConfig.homeButtonVisible&&userConfig.homeButtonVisible&&this.btnHome.changeButtonColor(a);moreConfig.downloadButtonVisible&&userConfig.downloadButtonVisible&&this.btnDownload.changeButtonColor(a);moreConfig.printButtonVisible&&userConfig.printButtonVisible&&this.btnPrint.changeButtonColor(a);moreConfig.thumbButtonEnable&&thumbButtonEnable&&this.btnThumb.changeButtonColor(a);moreConfig.zoomButtonEnable&&zoomButtonEnable&&isFlipModel&&this.btnZoom.changeButtonColor(a);moreConfig.bookmarkButtonEnable&&
bookmarkButtonEnable&&this.btnBookMark.changeButtonColor(a);moreConfig.tableofcontentButtonEnable&&tableofcontentButtonEnable&&this.btnTableOfContent.changeButtonColor(a);moreConfig.shareButtonEnable&&shareButtonEnable&&this.btnShare.changeButtonColor(a);moreConfig.autoPlayButtonVisible&&userConfig.autoPlayButtonVisible&&this.btnAutoPlay.changeButtonColor(a);moreConfig.bgSoundButtonVisible&&userConfig.bgSoundButtonVisible&&this.btnSound.changeButtonColor(a);moreConfig.helpButtonVisible&&userConfig.helpButtonVisible&&
this.btnHelp.changeButtonColor(a);moreConfig.aboutButtonVisible&&userConfig.aboutButtonVisible&&this.btnAbout.changeButtonColor(a);moreConfig.fullscreenButtonVisible&&userConfig.fullscreenButtonVisible&&this.btnFullscreen.changeButtonColor(a);moreConfig.AnnotationButtonVisible&&userConfig.AnnotationButtonVisible&&this.btnNote.changeButtonColor(a);moreConfig.languageButtonVisible&&1<language.length&&this.btnLanguage.changeButtonColor(a);moreConfig.flipButtonVisible&&(this.btnLast.changeButtonColor(a),
this.btnNext.changeButtonColor(a),this.btnPrevious.changeButtonColor(a),this.btnFirst.changeButtonColor(a));moreConfig.searchButtonEnable&&searchButtonEnable&&this.btnSearch.changeButtonColor(a)};initMoreBar.prototype.nextPage=function(){rightToLeft?previousPageFun():nextPageFun()};initMoreBar.prototype.prePage=function(){rightToLeft?nextPageFun():previousPageFun()};initMoreBar.prototype.firstPage=function(){rightToLeft?lastPageFun():firstPageFun()};
initMoreBar.prototype.lastPage=function(){rightToLeft?firstPageFun():lastPageFun()};
initMoreBar.prototype.changeLanguage=function(){this.btnLast.setCaption(getLanguage("btnLastPage","Last"));this.btnNext.setCaption(getLanguage("btnNextPage","Next"));this.btnPrevious.setCaption(getLanguage("btnPrePage","Previous"));this.btnFirst.setCaption(getLanguage("btnFirstPage","First"));this.btnZoom.setCaption(2==bookType?getLanguage("btnZoomOut","Zoom Out"):getLanguage("btnZoomIn","Zoom In"));this.btnAutoPlay.setCaption(auto_player.isPlaying()?getLanguage("btnStopAutoFlip","Stop Auto Flip"):
getLanguage("btnAutoFlip","Auto Flip"));this.btnShare.setCaption(getLanguage("btnSocialShare","Share"));this.btnSearch.setCaption(getLanguage("btnSearch","Search"));this.btnBookMark.setCaption(getLanguage("btnBookMark","Book Mark"));this.btnDownload.setCaption(getLanguage("btnDownload","Download"));this.btnHome.setCaption(getLanguage("btnGoToHome","Home"));this.btnPrint.setCaption(getLanguage("btnPrint","Print"));this.btnHelp.setCaption(getLanguage("btnHelp","Help"));this.btnAbout.setCaption(getLanguage("btnAbout",
"About"));this.btnLanguage.setCaption(getLanguage("btnLanguage","languageChange"));this.btnFullscreen.setCaption(getLanguage("btnFullscreen","fullscreen"));this.btnNote.setCaption(getLanguage("btnNote","annotation"));this.btnSound.setCaption(isPlaying?getLanguage("btnSoundOn","soundOn"):getLanguage("btnSoundOff","soundOff"));rightToLeft&&(this.btnFirst.setCaption(getLanguage("btnLastPage","Last")),this.btnLast.setCaption(getLanguage("btnFirstPage","First")),this.btnNext.setCaption(getLanguage("btnPrePage",
"Previous")),this.btnPrevious.setCaption(getLanguage("btnNextPage","Next")))};function link(a,b){var c=$("<div style='position: absolute;'></div>"),d=pageEditor[a-1][b].action;void 0!=d.length&&(d=d[0]);var e=d.url;null!=e&&"www."==e.substr(0,4).toLowerCase()&&(e="http://"+e);var f;try{f=d.triggerEventType}catch(g){f=null}c.bind(_event._down,function(){var g=colorTo0x(pageEditor[a-1][b].downColor);c.css({"background-color":g,opacity:pageEditor[a-1][b].downAlpha});f==PageEditor.TriggerEventType.MouseDown&&(d.actionType==PageEditor.ActionType.GOTO_PAGE?gotoPageFun(d.pageIndex):
d.actionType==PageEditor.ActionType.OPEN_URL&&(sendvisitinfo(3,a),window.open(e,d.linkTarget)));3==browserType?event.cancelBubble=!0:event.stopPropagation()});c.bind("mouseover",function(){var g=colorTo0x(pageEditor[a-1][b].overColor);c.css({"background-color":g,opacity:pageEditor[a-1][b].overAlpha});f==PageEditor.TriggerEventType.MouseOver&&(d.actionType==PageEditor.ActionType.GOTO_PAGE?gotoPageFun(d.pageIndex):d.actionType==PageEditor.ActionType.OPEN_URL&&window.open(e,d.linkTarget))});c.bind(isTouch?
_event._end:"mouseout",function(){var g=colorTo0x(pageEditor[a-1][b].outColor);c.css({"background-color":g,opacity:pageEditor[a-1][b].outAlpha});f==PageEditor.TriggerEventType.MouseOut&&(d.actionType==PageEditor.ActionType.GOTO_PAGE?gotoPageFun(d.pageIndex):d.actionType==PageEditor.ActionType.OPEN_URL&&window.open(e,d.linkTarget))});$.fn.extend(c,{onResize:function(d,e){var f=pageEditor[a-1][b].location;c.css({top:f.y*e+"px",left:f.x*d+"px",width:f.width*d+"px",height:f.height*e+"px"})}});return c}
function initLink(a,b,c,d){this.link=$("<div style='position: absolute;'></div>");this.config=$.extend({width:0.2,height:0.2,x:0.2,y:0.2,action:null},b);this.pw=c;this.ph=d;this.width=this.pw*this.config.width;this.height=this.ph*this.config.height;a.append(this.link);void 0==this.config.downColor?(this.config.downColor=getColor("LinkDownColor","#808080"),this.config.downAlpha=getInt("LinkAlpha",0.6),this.config.overColor=this.config.downColor,this.config.outColor=this.config.downColor,this.config.overAlpha=
this.config.downAlpha/2,this.config.outAlpha=0):(this.config.downColor=colorTo0x(this.config.downColor),this.config.overColor=colorTo0x(this.config.overColor),this.config.outColor=colorTo0x(this.config.outColor));this.link.css({position:"absolute",top:this.config.y*this.ph+"px",left:this.config.x*this.pw+"px",width:this.width+"px",background:"rgba(0,0,0,0)",height:this.height+"px"});this.father=a;this.initEvt()}
initLink.prototype.onResize=function(a,b){this.pw=a;this.ph=b;this.width=this.config.width*a;this.height=this.config.height*b;var c=this.config.y*b,d=this.config.x*a;this.link.css({width:this.width+"px",height:this.height+"px"});this.setPosition(d,c);if(null!=this.form)this.form.onResize(bookContainer.width(),bookContainer.height());if(null!=this.slide)this.slide.onResize(bookContainer.width(),bookContainer.height());if(null!=this.audios)this.audios.onResize(bookContainer.width(),bookContainer.height())};
initLink.prototype.setPosition=function(a,b){this.link.css({left:a+"px",top:b+"px"})};
initLink.prototype.initEvt=function(){var a=this;this.flag=0;this.audios=this.slide=this.form=null;this.linkURL;if(null!=this.config.action){try{void 0!=this.config.action.length&&(this.config.action=this.config.action[0]),this.linkURL=this.config.action.url}catch(b){}var c;null!=this.linkURL&&"www"==this.linkURL.substr(0,3).toLowerCase()&&(this.linkURL="http://"+this.linkURL);try{c=this.config.action.triggerEventType}catch(d){c=null}}this.link.bind(_event._down,function(){a.link.css({"background-color":a.config.downColor,
opacity:a.config.downAlpha,cursor:"pointer"});c==PageEditor.TriggerEventType.MouseDown&&actionEvent.call(a);3==browserType?event.cancelBubble=!0:event.stopPropagation()});this.link.bind("mouseover",function(){a.link.css({"background-color":a.config.overColor,opacity:a.config.overAlpha,cursor:"pointer"});c==PageEditor.TriggerEventType.MouseOver&&actionEvent.call(a)});this.link.bind(isTouch?_event._end:"mouseout",function(){a.link.css({"background-color":a.config.outColor,opacity:a.config.outAlpha,
cursor:"default"});c==PageEditor.TriggerEventType.MouseOut&&actionEvent.call(a)});var e=void 0;null!=this.config.action&&this.config.action.actionType==PageEditor.ActionType.GOTO_PAGE&&(e=this.config.action.pageIndex);if(null!=this.linkURL||void 0!=e)a=this,this.link.hint=null,this.link.bind(_event._enter,function(){var b=a.config.y*a.ph+a.height,c=a.config.x*a.pw,d=function(){var d=a.link.hint.width(),e=a.link.hint.height();c+d>a.pw&&(c=c-(c+d-a.pw));b+e>a.ph&&(b=b-a.height-e)};if(a.link.hint==null){var j=
a.linkURL;e!=void 0&&(j=getLanguage("gotoPage","page:")+e);a.link.hint=new divHint(j,c,b,a.father);d();a.link.hint.moveto(c,b);a.link.hint.setAnimate(true)}d();a.link.hint.moveto(c,b);a.link.hint.show()}),this.link.bind(_event._leave,function(){a.link.hint!=null&&a.link.hint.hide()})};function thickness(a){var b=$("<div></div>"),c;c=a?$("<img src='"+uiBaseURL+"thickness_left.png' style='position:absolute;' />"):$("<img src='"+uiBaseURL+"thickness.png' style='position:absolute;' />");b.append(c);b.hint=null;b.bind(_event._move,function(c){var e;isTouchDevice()?(e=c.originalEvent.touches[0],void 0==e&&(e=c.touches[0])):e=c;$(e.target);c=e.offsetX;void 0==c&&(c=e.pageX-b.offset().left);c=b.pageIndexByPosition(c,a);if(-1!=c){var c=" "+getShownPageNumber(c)+" ",f=e.pageX;e=e.pageY-
30;null==b.hint&&(b.hint=new divHint(c,f,e));b.hint.setText(c);b.hint.show(f,e);b.hint.moveto(f,e)}else null!=b.hint&&b.hint.hide()});b.bind(_event._leave,function(){null!=b.hint&&b.hint.hide()});b.bind(_event._end,function(c){var e;isTouchDevice()?(e=c.originalEvent.touches[0],void 0==e&&(e=c.touches[0])):e=c;$(e.target);c=e.offsetX;void 0==c&&(c=e.pageX-b.offset().left);e=b.pageIndexByPosition(c,a);c=flipBook.currentPageIndex;bookType==BookType.single_book&&(c=$(singlePageBook).data().currentPageIndex);
var f=c+1;bookType==BookType.single_book&&(f=-1);-1!=e&&e!=c&&e!=f&&gotoPageFun(e)});$.fn.extend(b,{visible:!0,onResize:function(a,e){b.css({width:a,height:e});c.css({width:a,height:e})},setThicknessPosition:function(c,e){b.css({left:c,top:e,position:"absolute","z-index":a?8:9})},hideThickness:function(){b.css("display","none")},showThickness:function(){b.css("display","block")},setVisible:function(a){b.css({display:a?"block":"none"});b.visible=a},pageIndexByPosition:function(a,b){var c=this.width(),
g=0.4*c;if(0<a&&a<=g&&!1==b||0<c-a&&c-a<=g&&!0==b){var h=bookConfig.totalPageCount,j=flipBook.currentPageIndex;bookType==BookType.single_book&&(j=$(singlePageBook).data().currentPageIndex);var k=j-1;!0==rightToLeft?(!0==b&&(k=h-j-1),!1==b?(c=Math.floor(k*(1-a/g)),c++):(c=Math.floor(k*(1-(a-(c-g))/g)),c+=j+1)):(!1==b&&(k=h-j-1),!1==b?(c=Math.floor(k*a/g),c+=j+1):(c=Math.floor(k*(a-(c-g))/g),c++));return c}return-1}});return b};Log.debug(navigator.userAgent.toLowerCase());jsLoadingBar.initStatus();
var gradientColorA,gradientColorB,gradientColorAngle,backGroundImgURL,zoomButtonEnable=!0,thumbButtonEnable=!0,shareButtonEnable=!0,searchButtonEnable=!0,bookmarkButtonEnable=!0,tableofcontentButtonEnable=!0,windowWidth=0,windowHeight=0,toolBarColor,buttonColor,originTotalPageCount,totalPageCount,leftShadowWidth=50,rightShadowWidth=50,zoomPageWidth,zoomPageHeight,flipTime=600,isRegister=!1,bookDescription,bookTitle,showFlipButton,normalEventRadius=1E4,singleEventRadius=1E4,stopFlip=!1,flipping=!1,
isTouch=isTouchDevice(),bookContainer,tmpContainer,onBookLoad,zoomBook,slideBook,singleSlideBook,catalogBook,singleCatalogBook,phoneBook,singlePhoneBook,flipBook,toolBar,printBody,helpBody,aboutBody,noteCookie,textRemark,signature,annotationShapes,cursor=!0,highLight,annotationPannel,languagePanel,QRcode,QRbutton,moreBar,pageIndexTextField,topMargin,leftMargin,bottomMargin,rightMargin,resizeBookAfterFlip=!1,frmSearch,frmShare,_rimFlip,flipAudio,backgroundAudio,auto_player,productName,homePage,_tipsBox,
frmBookmark,bookmark,thumbnail,miniStyle,oriPageIndex=1,googleID,hardPageEnable,uiBaseURL,phoneBaseURL,soundBaseURL,browserType,rightToLeft=!1,isFlipPdf=!1,flaudio=0,flagspeak=0,fliphtml5_pages,sliderJS=[],isFlipModel=!0,hadBMT,selectedLanguage,bgSound,backgroundObj,bmtBox,textForPages=[],positionForPages=[],loadSearchFlag=!1,iconArray,toolBarIconsURL,ua=navigator.userAgent.toLowerCase(),device={};
device.name=ua.match(/ipad/)?"ipad":ua.match(/ipod/)?"ipod":ua.match(/iphone/)?"iphone":ua.match(/android/)?"android":ua.match(/mac|win|linux/)?"pc":"other";
var userConfig={leftShadowWidth:30,leftShadowAlpha:1,rightShadowWidth:30,rightShadowAlpha:1,shortcutButtonHeight:370,shortcutButtonWidth:90,autoPlayButtonVisible:"true",downloadButtonVisible:"false",downloadURL:"",bgSoundButtonVisible:"yes",bgSoundAutoStart:"yes",bgSoundURL:"",homeButtonVisible:!0,homeURL:"",printButtonVisible:"yes"},originWindow=Point(0,0),testLog=$("<div width='300px' height='300px' style='position:absolute;left:10px;top:10px;'></div>"),logStr=function(a){testLog[0].innerHTML=a},
singlePageBook,leftRightButton,init=function(){if(compareov()){""==userConfig.bgSoundURL&&(userConfig.bgSoundButtonVisible=!1);pageIndexTextField=$("#currentPageIndexTextField");flipBook=rightToLeft?new rightToLeftNormalBook(bookContainer):new normalBook(bookContainer);zoomBook=new initZoomBook(bookContainer);slideBook=new initSlideBook(bookContainer);singleSlideBook=new initSingleSlideBook(bookContainer);catalogBook=new CatalogBook(bookContainer);singleCatalogBook=new SingleCatalogBook(bookContainer);
phoneBook=new initPhoneBook(bookContainer);singlePhoneBook=new initSinglePhoneBook(bookContainer);printBody=new printBar(tmpContainer);helpBody=new helpBar(tmpContainer);aboutBody=new aboutBar(tmpContainer);sharePanel=new sharePanel(tmpContainer);languagePanel=new languageChange(tmpContainer);annotationPannel=new AnnotationPannel(tmpContainer);initShareBar();initLogoBar();QRcode=new codeBar(tmpContainer);QRbutton=$("<img src='"+bookConfig.QRPath+"'/>");QRbutton.css({width:"50px",height:"50px",top:"0px",
right:"0px",position:"absolute","z-index":"99",opacity:"0.5"});QRbutton.attr("title","Click to scan the QR code.");QRbutton.load(function(){tmpContainer.append(QRbutton)});moreBar=new initMoreBar;backgroundObj=new initBackground(tmpContainer,gradientColorA,gradientColorB,gradientColorAngle,windowWidth,windowHeight,backGroundImgURL);singlePageBook=new SingleBook(bookContainer);showFlipButton&&(leftRightButton=new LeftRightButton(tmpContainer));frmBookmark=new tableContent({caption:getLanguage("frmBookMark",
"Table of Content"),closeIconURL:uiBaseURL+"close.png",mainColor:bookConfig.bookmarkBackground,fontColor:bookConfig.bookmarkFontColor},tmpContainer);bookmark=new BookMark(tmpContainer);frmSearch=new searchForm({caption:getLanguage("frmSearch","Search"),closeIconURL:uiBaseURL+"close.png",mainColor:bookConfig.searchBackground,fontColor:bookConfig.searchFontColor},tmpContainer);_rimFlip=new rimFlip;1!=oriPageIndex&&_rimFlip.removeRimFlip();_tipsBox=new tipsBox("This is the last page",bookContainer);
_tipsBox.setPosition((windowWidth-_tipsBox.getWidth())/2,100);auto_player=new autoFlip;"slide"!=bookConfig.FlipStyle.toLowerCase()&&"catalog"!=bookConfig.FlipStyle.toLowerCase()&&!isBelowIE9()&&(bookType=windowWidth>=windowHeight?BookType.normal_book:BookType.single_book);isPhoneBook()&&(bookType=windowWidth>=windowHeight?BookType.phone_book:BookType.singlePhone_book);changeShowBook(bookType);onStageResize();isTouch?window.onorientationchange=function(){window.setTimeout(function(){onStageResize()},
200)}:$(window).resize(function(){onStageResize()});var a=window.location.hash;""!=a&&3<a.length&&"#p="==a.substr(0,3)?isNaN(a.substr(3,a.length-3))?(flipBook.movetoCenter(30,20,flipBook.currentPageIndex),TurnonAutoFlip()):window.setTimeout(function(){var b=parseInt(a.substr(3,a.length-3));b==1&&flipBook.movetoCenter(30,20,1);gotoPageFun(b);TurnonAutoFlip()},1E3):(flipBook.movetoCenter(30,20,flipBook.currentPageIndex),TurnonAutoFlip());initEvent();setPageIndexTextField();if("iphone"==device.name||
"ipod"==device.name||"#mobile"==window.location.hash)windowWidth>windowHeight?(phoneBook.currentIndex=oriPageIndex,phoneBook.showPage.fillContent(phoneBook.currentIndex),phoneBook.currentIndex=oriPageIndex,phoneBook.showPage.fillContent(phoneBook.currentIndex),bookType=4,changeShowBook(4),setCurrentIndexTextField(phoneBook.currentIndex,!0),thumbnail.clearHighLight(),thumbnail.setHighLight(phoneBook.currentIndex)):(singlePhoneBook.currentIndex=oriPageIndex,singlePhoneBook.showPage.fillContent(singlePhoneBook.currentIndex),
singlePhoneBook.currentIndex=oriPageIndex,singlePhoneBook.showPage.fillContent(singlePhoneBook.currentIndex),bookType=5,changeShowBook(5),setCurrentIndexTextField(singlePhoneBook.currentIndex,!1),thumbnail.clearHighLight(),thumbnail.setHighLight(singlePhoneBook.currentIndex));2==browserType&&(_event._mousewheel="DOMMouseScroll",HTMLElement.prototype.__defineGetter__("innerText",function(){return this.textContent}),HTMLElement.prototype.__defineSetter__("innerText",function(a){this.textContent=a}));
isIE()&&(_event._mousewheel="mousewheel");!0==parseBool(bookConfig.mouseWheelFlip)&&flipBook.flipBook.bind(_event._mousewheel,function(a){if(bookType==BookType.zoom_book)return false;var b=a.originalEvent;Math.max(-1,Math.min(1,b.wheelDelta||-b.detail))<0?rightToLeft?previousPageFun():nextPageFun():rightToLeft?nextPageFun():previousPageFun();stopEvent(a);return false});$(window).bind("keydown",function(a){a=a.keyCode;Log.info("key down[%d]",a);a==KEY_CODE_LEFT&&(bookType==BookType.zoom_book?zoomBook.movePageRight():
rightToLeft?nextPageFun():previousPageFun());a==KEY_CODE_RIGHT&&(bookType==BookType.zoom_book?zoomBook.movePageLeft():rightToLeft?previousPageFun():nextPageFun());if(a==KEY_CODE_HOME||a==KEY_CODE_PAGEUP)rightToLeft?lastPageFun():firstPageFun();if(a==KEY_CODE_END||a==KEY_CODE_PAGEDOWN)rightToLeft?firstPageFun():lastPageFun();a==KEY_CODE_UP&&bookType==BookType.zoom_book&&zoomBook.movePageDown();a==KEY_CODE_DOWN&&bookType==BookType.zoom_book&&zoomBook.movePageUp()});initFlipSound();bookType==BookType.normal_book?
flipBook.openShownSlider():bookType==BookType.single_book&&singlePageBook.openShownSlider();!0==parseBool(bookConfig.haveAdSense)&&addAdSense(bookConfig.adSenseLeft,bookConfig.adSenseTop,bookConfig.adSenseWidth,bookConfig.adSenseHeight,bookConfig.adSenseClientId);try{void 0!=staticAd&&!0==staticAd.haveAd&&flipBook.insertStaticAd()}catch(b){}}else alert("Purchase from www.flipbuilder.com to preview the book.")},TurnonAutoFlip=function(){!0==parseBool(bookConfig.autoFlipOnStart)&&window.setTimeout(function(){auto_player.start();
toolBar.changeButtonColor(bookConfig.iconColor)},1E3)},initFlipSound=function(){flipAudio=$("<audio preload><audio>");flipAudio.attr("src",soundBaseURL+"flipsound.mp3");tmpContainer.append(flipAudio)},isPlaying,initBGSound=function(){if(!(void 0==userConfig.bgSoundURL||""==userConfig.bgSoundURL||!userConfig.bgSoundButtonVisible)){var a=0,b=userConfig.bgSoundButtonVisible,c=this;-1==userConfig.backgroundSoundLoop?sound=$("<audio autoplay loop><audio>"):(sound=$("<audio autoplay><audio>"),sound.bind("ended",
function(){a<userConfig.backgroundSoundLoop-1?sound[0].play():sound[0].pause();a++}));b&&(isPlaying=!0);sound.attr("src",userConfig.bgSoundURL);this.pause=function(){sound[0].pause();isPlaying=false};this.play=function(){sound[0].play();isPlaying=true};tmpContainer.append(sound);$("#btnSound").bind(_event._end,function(){if(b){c.pause();isPlaying=b=false}else{c.play();isPlaying=b=true}});$("#moreBtnSound").bind(_event._end,function(){if(b){c.pause();isPlaying=b=false}else{c.play();isPlaying=b=true}})}};
function createAll(){selectLanguage(bookConfig.language);tmpContainer=$("<div class='bookStage' id= 'tmpContainer'></div>");bookContainer=$("<div class='bookStage' id= 'bookContainer'></div>");$("body").append(tmpContainer);tmpContainer.append(bookContainer);bookContainer.css({"-webkit-transform":"perspective(1000px)","-moz-transform":"perspective(1000px)"});windowWidth=bookContainer.width();windowHeight=bookContainer.height();originWindow=Point(tmpContainer.width(),tmpContainer.height());onBookLoad=
new loadingBook(tmpContainer,bookConfig.loadingBackground);toolBarIconsURL=[uiBaseURL+"BackGround.jpg",uiBaseURL+"Last.png",uiBaseURL+"next.png",uiBaseURL+"prev.png",uiBaseURL+"First.png",uiBaseURL+"ZoomIn.png",uiBaseURL+"ZoomOut.png",uiBaseURL+"autoPlay.png",uiBaseURL+"stopAutoPlay.png",uiBaseURL+"thumbnails.png",uiBaseURL+"sharethis.png",uiBaseURL+"search.png",uiBaseURL+"download.png",uiBaseURL+"home.png",uiBaseURL+"bookmark.png",uiBaseURL+"soundOn.png",uiBaseURL+"soundOff.png",uiBaseURL+"previous_normal.png",
uiBaseURL+"previous_normal_down.png",uiBaseURL+"next_normal.png",uiBaseURL+"next_normal_down.png",uiBaseURL+"print.png",uiBaseURL+"Help.png",uiBaseURL+"about.png",uiBaseURL+"moreBar.png",uiBaseURL+"languageChange.png",uiBaseURL+"thumbnails_down.png",uiBaseURL+"fullscreen.png",uiBaseURL+"exitFullscreen.png",uiBaseURL+"moveByPos.png",uiBaseURL+"moveByDrag.png",uiBaseURL+"annotation.png",uiBaseURL+"tableOfContent.png"];phoneIconsURL=[phoneBaseURL+"autoPlay.png",phoneBaseURL+"stopAutoPlay.png",phoneBaseURL+
"thumbnails.png",phoneBaseURL+"sharethis.png",uiBaseURL+"thumbnails_down.png"];customButtonIcons();var a=function(a){jsLoadingBar.destroy();iconArray=a;onBookLoad.chooseFlipSlide()},b=function(a){jsLoadingBar.destroy();iconArray=a;onBookLoad.chooseFlipSlide()};isPhoneBook()?$(window).loader(phoneIconsURL,b):$(window).loader(toolBarIconsURL,a);if("undefined"!=typeof speakConfig&&"none"!=speakConfig.title){var a=$("<div id='LectureBook' style='position:absolute;right:20px;bottom:40px; width:190px; height:330px;'></div>"),
b=$("<div id='LectureBox' style='position:absolute;z-index:70; width:190px; height:88px;top:0;opacity:0.6;background-image:url(style/icon/lecturetext.png)'></div>"),c=$("<div style='position:absolute;overflow: hidden; height:60px;top:5px;'><div id='LectureText' style='word-break: break-word;color:#fff;padding:5px 10px 5px 10px;text-shadow: 2px 2px 2px #000000;'></div></div>"),d=$("<div id='LecturePre' style='position:absolute; top:95px;left:25px;z-index:100;'></div>");LectureCon=$("<div id='LectureCon' style='position:absolute; display:none;z-index:101; width:105px; height:105px; top:150px;left:40px;background-image:url(style/icon/co_bg.png)'><div style='position:absolute; cursor: pointer;width:23px;height:23px;left:41px; top:15px'><img id='lstop' src='style/icon/Pause.png' title='Pause' /></div><div style='position:absolute; cursor: pointer;width:23px;height:23px;right:15px;top:41px;'><img id='lnext' src='style/icon/Nextpage.png' title='Next Page' /></div><div style='position:absolute; cursor: pointer;width:23px;height:23px;left:15px;top:41px;'><img id='lpre' src='style/icon/Pre.png' title='Previous Page' /></div><div style='position:absolute; cursor: pointer;width:23px;height:23px;left:41px;bottom:15px;'><img id='laudio' src='style/icon/Muteclose.png' title='Mute' /></div></div>");
LectureClose=$("<div id='LectureClose' style='position:absolute; right:60px; top:85px;display:none;z-index:200;cursor:pointer;'><img style='z-index:200;' src='style/icon/Closediv.png' title='Close' /></div>");LectureShow=$("<div id='LectureShow' style='position:absolute; right:0;bottom:35px;display:none;z-index:200;cursor:pointer;'><img  src='style/icon/LectureShow.png' /></div>");bookContainer.append(a);a.append(b);b.append(c);a.append(d);a.append(LectureCon);a.append(LectureClose);bookContainer.append(LectureShow)}}
function customButtonIcons(){""!=bookConfig.HomeButtonIcon&&(toolBarIconsURL[ICON_HOME]=bookConfig.HomeButtonIcon);""!=bookConfig.AnnotationButtonIcon&&(toolBarIconsURL[ICON_ANNOTATION]=bookConfig.AnnotationButtonIcon);""!=bookConfig.ShareButtonIcon&&(toolBarIconsURL[ICON_SHARE]=bookConfig.ShareButtonIcon);""!=bookConfig.ThumbnailButtonIcon&&(toolBarIconsURL[ICON_THUMB]=bookConfig.ThumbnailButtonIcon);""!=bookConfig.ZoomInButtonIcon&&(toolBarIconsURL[ICON_ZOOMIN]=bookConfig.ZoomInButtonIcon);""!=
bookConfig.ZoomOutButtonIcon&&(toolBarIconsURL[ICON_ZOOMOUT]=bookConfig.ZoomOutButtonIcon);""!=bookConfig.FullscreenButtonIcon&&(toolBarIconsURL[ICON_FULLSCREEN]=bookConfig.FullscreenButtonIcon);""!=bookConfig.ExitFullscreenButtonIcon&&(toolBarIconsURL[ICON_EXIT_FULLSCREEN]=bookConfig.ExitFullscreenButtonIcon);""!=bookConfig.BookmarkButtonIcon&&(toolBarIconsURL[ICON_BOOKMARK]=bookConfig.BookmarkButtonIcon);""!=bookConfig.TableOfContentButtonIcon&&(toolBarIconsURL[ICON_TOC]=bookConfig.TableOfContentButtonIcon);
""!=bookConfig.SearchButtonIcon&&(toolBarIconsURL[ICON_SEARCH]=bookConfig.SearchButtonIcon);""!=bookConfig.PrintButtonIcon&&(toolBarIconsURL[ICON_PRINT]=bookConfig.PrintButtonIcon);""!=bookConfig.BackgroundSoundButtonOnIcon&&(toolBarIconsURL[ICON_SOUNDON]=bookConfig.BackgroundSoundButtonOnIcon);""!=bookConfig.BackgroundSoundButtonOffIcon&&(toolBarIconsURL[ICON_SOUNDOFF]=bookConfig.BackgroundSoundButtonOffIcon);""!=bookConfig.HelpButtonIcon&&(toolBarIconsURL[ICON_HELP]=bookConfig.HelpButtonIcon);""!=
bookConfig.AboutButtonIcon&&(toolBarIconsURL[ICON_ABOUT]=bookConfig.AboutButtonIcon);""!=bookConfig.AutoPlayStartButtonIcon&&(toolBarIconsURL[ICON_AUTOPLAY]=bookConfig.AutoPlayStartButtonIcon);""!=bookConfig.AutoPlayStopButtonIcon&&(toolBarIconsURL[ICON_STOPAUTOPLAY]=bookConfig.AutoPlayStopButtonIcon);""!=bookConfig.DownloadButtonIcon&&(toolBarIconsURL[ICON_DOWNLOAD]=bookConfig.DownloadButtonIcon)}
function LectureAudio(a){var b=document.getElementById("LecturePre");b.innerHTML="<img id='LectureSpe' style='width:126px;' src='"+uiBaseURL+"speak.gif' />";var c=document.createElement("audio");c.setAttribute("id","LectureID");c.type="audio/mpeg";c.setAttribute("autoplay","autoplay");0==speakConfig.page[a].type?c.src=speakConfig.page[a].speakmp3:(c.src=speakConfig.page[a].importmp3,$("#LectureBox").css("display","none"));b.appendChild(c)}
function LectureSoll(a){var b=$("#LectureText");$("#LectureBox").css("display","block");b.html(speakConfig.page[a].speaktext);var c=b.height();40<c&&b.animate({marginTop:-c+40+"px"},90*c,function(){b.css("marginTop",0);$("#LectureBox").css("display","none");$("#LectureSpe").attr("src",uiBaseURL+"nospeak.gif");a+1<totalPageCount/2+1&&0==flaudio&&(nextPageFun(),LectureAudio(a+1),LectureSoll(a+1))})}
function initToolBar(){thumbnail=new thumbnailBar(tmpContainer);initLogoBar(toolBar);setPageIndexTextField();$("#btnLast")&&$("#btnLast").asButton();$("#btnFirst")&&$("#btnFirst").asButton();$("#btnRight").asButton();$("#btnLeft").asButton();$("#btnZoom").asButton();$("#btnThumb").asButton();$("#btnShare").asButton();$("#btnSearch").asButton();$("#btnAutoPlay").asButton();$("#btnDownload").asButton();$("#btnSound").asButton();$("#btnHome").asButton();getBool("autoPlayAutoStart",!1)&&($("#autoPlayImg").attr("src",
uiBaseURL+"stopAutoPlay.png"),$("#btnAutoPlay").attr("title","Stop Auto Play"))}
var setToolBarPosition=function(){var a=45;$("#toolBarBack").css({width:windowWidth+"px",height:"42px"});var a=45,b=$("#tfPageIndex").width();$("#btnLast").css({right:"3px"});$("#btnRight").css({right:a+3+"px"});$("#tfPageIndex").css({right:2*a+3+"px",top:"5px"});$("#btnLeft").css({right:2*a+b+3+"px"});$("#btnFirst").css({right:3*a+b+3+"px"});b=4*a+b+3;zoomButtonEnable&&($("#btnZoom").css({right:b+"px"}),b+=a);userConfig.autoPlayButtonVisible&&($("#btnAutoPlay").css({right:b+"px"}),b+=a);userConfig.bgSoundButtonVisible&&
($("#btnSound").css({right:b+"px"}),b+=a);thumbButtonEnable&&($("#btnThumb").css({right:b+"px"}),b+=a);shareButtonEnable&&($("#btnShare").css({right:b+"px"}),b+=a);searchButtonEnable&&($("#btnSearch").css({right:b+"px"}),b+=a);bookmarkButtonEnable&&($("#btnBookmark").css({right:b+"px"}),b+=a);userConfig.downloadButtonVisible&&($("#btnDownload").css({right:b+"px"}),b+=a);userConfig.homeButtonVisible&&$("#btnHome").css({right:b+"px"})},onStageResize=function(){Log.info("onStageResize");resizeBookAfterFlip=
!1;if(bookType==BookType.normal_book&&nBookStatu==normalBookStatu.book_statu_auto_flip||bookType==BookType.single_book&&1==$(singlePageBook).data().bookStatu)resizeBookAfterFlip=!0;else{windowWidth=tmpContainer.width();windowHeight=tmpContainer.height();var a,b,c=windowWidth,d=windowHeight,e=bookConfig.largePageWidth,f=bookConfig.largePageHeight;if("iphone"==device.name||"ipod"==device.name)d=window.innerHeight,c=window.innerWidth,tmpContainer.css({width:c+"px",height:d+"px"}),window.setTimeout(function(){window.scrollTo(0,
1)},30),windowWidth=tmpContainer.width(),windowHeight=tmpContainer.height();var g=Math.max(c-leftMargin-rightMargin,1),h=Math.max(d-topMargin-bottomMargin-toolBar.getHeight(),1);backgroundObj.onResize(c,d);var j=2*e/f;g/h>j?(b=h,a=j*b):(a=g,b=f*a/(2*e));flipBook.onResize(a/2,b);var k=(windowWidth-bookConfig.leftMargin-bookConfig.rightMargin-a)/2+bookConfig.leftMargin,m=k-a/4,j=k+a/4;rightToLeft&&(m=k+a/4,j=k-a/4);a=parseBool(bookConfig.retainBookCenter);!0==a&&(1==flipBook.currentPageIndex&&(k=m),
m=bookConfig.totalPageCount,1==m%2&&m++,flipBook.currentPageIndex==m&&(k=j));flipBook.setCSS({top:(h-b)/2+topMargin+toolBar.getTopHeight()+"px",left:k+"px"});try{var l=window.location.hash;""!=l&&3<l.length&&"#p="==l.substr(0,3)&&!isNaN(l.substr(3,l.length-3))&&parseInt(l.substr(3,l.length-3))==flipBook.currentPageIndex&&flipBook.movetoCenter(0,0,flipBook.currentPageIndex)}catch(n){}flipBook.fillNearPage(flipBook.getCurrentPageIndex());b=getPageWidthHeight(c,d-toolBar.getHeight()-20,e,f);singlePageBook.onResize(b.x,
b.y);e=toolBar.getTopHeight()+10;singlePageBook.setBookPosition((c-b.x)/2,e);e=b=0;zoomBook.width<c&&(b=(c-zoomBook.width)/2);zoomBook.height<d&&(e=(d-zoomBook.height)/2);zoomBook.setPosition(b,e);zoomBook.onResize(c,d);e=b=0;slideBook.width<g&&(b=(g-slideBook.width)/2);slideBook.height<h&&(e=(h-slideBook.height)/2);slideBook.setPosition(b,e);slideBook.onResize(g,h);singleSlideBook.onResize(g,h);catalogBook.width<g&&(b=(g-catalogBook.width)/2);catalogBook.height<h&&(e=(h-catalogBook.height)/2);catalogBook.setPosition(b,
e);catalogBook.onResize(g,h);singleCatalogBook.onResize(g,h);phoneBook.onResize(g,h);singlePhoneBook.onResize(g,h);flipBook.setThicknessPosition();bookType==BookType.normal_book&&c<d&&(bookType=BookType.single_book,changeShowBook(1),singlePageBook.gotoPage(flipBook.currentPageIndex),setCurrentIndexTextField(singlePageBook.currentPageIndex,!1),thumbnail.clearHighLight(),thumbnail.setHighLight(flipBook.currentPageIndex));bookType==BookType.single_book&&c>=d&&(bookType=BookType.normal_book,changeShowBook(0),
flipBook.gotoPage(singlePageBook.currentPageIndex),setCurrentIndexTextField(flipBook.currentPageIndex,!0),thumbnail.clearHighLight(),thumbnail.setHighLight(singlePageBook.currentPageIndex));bookType==BookType.singlePhone_book&&c>=d&&(bookType=BookType.phone_book,changeShowBook(4),phoneBook.gotoPage(singlePhoneBook.currentIndex),setCurrentIndexTextField(phoneBook.currentIndex,!0),thumbnail.clearHighLight(),thumbnail.setHighLight(singlePhoneBook.currentIndex));bookType==BookType.phone_book&&c<d&&(bookType=
BookType.singlePhone_book,changeShowBook(5),singlePhoneBook.gotoPage(phoneBook.currentIndex),setCurrentIndexTextField(singlePhoneBook.currentIndex,!1),thumbnail.clearHighLight(),thumbnail.setHighLight(phoneBook.currentIndex));thumbnail.onResize();QRcode.onResize();QRbutton.css({top:"0px",left:windowWidth-50+"px"});toolBar.setButtonPosition();bookType!=BookType.phone_book&&bookType!=BookType.singlePhone_book&&(printBody.onResize(),helpBody.onResize(),aboutBody.onResize(),sharePanel.onResize(),languagePanel.onResize(),
annotationPannel.onResize(),miniStyle.isMini()&&!fullScreenApi.isFullScreen()?(miniStyle.onResize(),miniStyle.miniLogo.css({display:"block"}),toolBar.hide(),QRbutton.css({display:"none"})):(QRbutton.css({display:"block"}),miniStyle.miniLogo.css({display:"none"}),bookType!=BookType.singleSlide_book&&bookType!=BookType.slide_book&&toolBar.show()));getBool("QRCode",!0)||QRbutton.css({display:"none"});frmSearch&&(frmSearch.resize(240,h),frmSearch.setTop(toolBar.getTopHeight()+10));void 0!=frmBookmark&&
(c=Math.max(300,g/4),frmBookmark.resize(c,h),frmBookmark.setTop(toolBar.getTopHeight()+10));void 0!=_tipsBox&&_tipsBox.setPosition((windowWidth-_tipsBox.getWidth())/2,100);showFlipButton&&leftRightButton.setPosition()}};
function initEvent(){bookContainer.bind(_event._move,function(){return!0==isIpad()?!1:!0});bookContainer.bind(_event._end,function(a){0==bookType&&(a.pageX>$("#flipBook").offset().left+$("#flipBook").outerWidth()?rightToLeft?previousPageFun():nextPageFun():a.pageX<$("#flipBook").offset().left&&(rightToLeft?nextPageFun():previousPageFun()))});bookContainer.bind(_event._down,function(){isShareShow&&(shareBar.hideShareBar(),isShareShow=!1);isMoreShow&&(moreBar.hideMoreBar(),isMoreShow=!1)});"undefined"!=
typeof speakConfig&&"none"!=speakConfig.title&&($("#LecturePre").bind(_event._down,function(){"none"===$("#LectureCon").css("display")?($("#LectureCon").css("display","block"),$("#LectureClose").css("display","block")):($("#LectureCon").css("display","none"),$("#LectureClose").css("display","none"));$("#lnext").asImageButton();$("#lpre").asImageButton()}),$("#lstop").bind(_event._down,function(){var a=document.getElementById("LectureID"),c=document.getElementById("LectureSpe");0==flaudio?(a.pause(),
$("#LectureText").stop(!0),c.src=uiBaseURL+"nospeak.gif",$("#lstop").attr("src",uiBaseURL+"Play.png"),$("#lstop").attr("title","Play"),$("#LectureBox").css("display","none"),flaudio=1):(flaudio=0,LectureSoll(Math.floor(flipBook.getCurrentPageIndex()/2)),a.play(),c.src=uiBaseURL+"speak.gif",$("#lstop").attr("src",uiBaseURL+"Pause.png"),$("#lstop").attr("title","Pause"))}),$("#lnext").bind(_event._down,function(){nextPageFun()}),$("#lnext").bind(_event._move,function(){$("#lnext").attr("src",uiBaseURL+
"Nextpage_down.png")}),$("#lpre").bind(_event._down,function(){previousPageFun()}),$("#lpre").bind(_event._move,function(){$("#lpre").attr("src",uiBaseURL+"Pre_down.png")}),$("#laudio").bind(_event._down,function(){var a=document.getElementById("LectureID");!1==a.muted?(a.muted=!0,$("#laudio").attr("src",uiBaseURL+"Mute.png"),$("#laudio").attr("title","Play"),$("#LectureSpe").attr("src",uiBaseURL+"nospeak.gif")):(a.muted=!1,$("#laudio").attr("src",uiBaseURL+"Muteclose.png"),$("#laudio").attr("title",
"Mute"),$("#LectureSpe").attr("src",uiBaseURL+"speak.gif"))}),$("#LectureClose").bind(_event._down,function(){document.getElementById("LectureID").pause();$("#LectureText").stop(!0);$("#LectureBook").css("display","none");$("#LectureShow").css("display","block");flagspeak=1}),$("#LectureShow").bind(_event._down,function(){$("#LectureBook").css("display","block");$("#LectureShow").css("display","none");$("#LectureBox").css("display","none");$("#LectureSpe").attr("src",uiBaseURL+"nospeak.gif");$("#LectureCon").css("display",
"none");$("#LectureClose").css("display","none");flagspeak=0}));var a=this;$(QRbutton).bind(_event._enter,function(){QRbutton.css({opacity:"1"})});$(QRbutton).bind(_event._leave,function(){QRbutton.css({opacity:"0.5"})});$(QRbutton).bind(_event._down,function(b){b=isTouch?b.originalEvent.touches:[b];a.drapable=true;a.mouseDownPointX=b[0].pageX;a.mouseDownPointY=b[0].pageY;a.codePositionX=$(QRbutton).offset().left;a.codePositionY=$(QRbutton).offset().top;return a.codeMove=false});$(QRbutton).bind(_event._end,
function(){if(a.codeMove==false){QRcode.getShowStatu()?QRcode.hideBox():QRcode.showshow();if(isMoreShow){moreBar.hideMoreBar();isMoreShow=false}}QRbutton.css({opacity:"0.5"});return a.drapable=false});$(QRbutton).bind(_event._move,function(b){b=isTouch?b.originalEvent.touches:[b];if(a.drapable){var c=b[0].pageX-a.mouseDownPointX,b=b[0].pageY-a.mouseDownPointY;$(QRbutton).css({left:a.codePositionX+c+"px",top:a.codePositionY+b+"px"});if(Math.abs(c)>1||Math.abs(b)>1)a.codeMove=true}return false});QRbutton.mouseOverCursor()}
var selectLanguage=function(a){a=a.toLowerCase();0==language.length&&(selectedLanguage=[]);for(var b,c=0;c<language.length;c++){if(language[c].language.toLowerCase()==a){selectedLanguage=language[c];break}"english"==language[c].language.toLowerCase()&&(b=language[c]);c==language.length-1&&(selectedLanguage=b)}},changeLanguage=function(a){selectLanguage(a);toolBar.changeLanguage();moreBar.changeLanguage();frmBookmark.setCaption(getLanguage("frmBookMark","Book Mark"));frmSearch.setCaption(getLanguage("frmSearch",
"Search"))};
jQuery(document).ready(function(){void 0==window.aliasConfig&&(window.aliasConfig={});uiBaseURL=getString("UIBaseURL","");"string"==typeof uiBaseURL&&"/"!=uiBaseURL.substr(uiBaseURL.length-1,1)&&""!=uiBaseURL&&(uiBaseURL+="/");phoneBaseURL=getString("UIBaseURL","");"string"==typeof phoneBaseURL&&"/"!=phoneBaseURL.substr(phoneBaseURL.length-1,1)&&""!=phoneBaseURL&&(phoneBaseURL+="/");checkBookConfig();uiBaseURL+="style/icon/";phoneBaseURL+="style/phoneIcon/";soundBaseURL=uiBaseURL.replace("/icon/","/raw/");
zoomButtonEnable=getBool("ZoomButtonVisible",!0);thumbButtonEnable=getBool("ThumbnailsButtonVisible",!0);shareButtonEnable=getBool("ShareButtonVisible",!0);searchButtonEnable=getBool("SearchButtonVisible",!1);bookmarkButtonEnable=getBool("BookMarkButtonVisible",!1);tableofcontentButtonEnable=getBool("TableOfContentButtonVisible",!1);originTotalPageCount=getInt("totalPageCount",2);totalPageCount=originTotalPageCount+(1==originTotalPageCount%2?1:0);zoomPageWidth=getInt("largePageWidth",640);zoomPageHeight=
getInt("largePageHeight",920);var a=zoomPageWidth/zoomPageHeight,b=zoomPageHeight;zoomPageHeight=Math.min(zoomPageHeight,1440);b!==zoomPageHeight&&(zoomPageWidth=zoomPageHeight*a);gradientColorA=getColor("bgBeginColor","#a93268");gradientColorB=getColor("bgEndColor","#588643");gradientColorAngle=getInt("bgMRotation",0);backGroundImgURL=getString("backGroundImgURL","");bookDescription=getString("bookDescription","This is a jQuery book.");bookTitle=getString("bookTitle","flipBook");showFlipButton=getBool("flipshortcutbutton",
!0);if("iphone"==device.name||"ipod"==device.name)showFlipButton=!1;productName=getString("productName",DeString("cf126d0a3d3fcd1edb6ce3a1c93b865710c11409ce473c9a265b04899d19d48dc3770282f85d"));homePage=getString("homePage",DeString("f4d9301f2c3fba666c340d6c972ffc2d671a27caa6833d28c887fa057e9fa3"));leftMargin=getInt("leftMargin",0);topMargin=getInt("topMargin",0);rightMargin=getInt("rightMargin",0);bottomMargin=getInt("bottomMargin",0);rightToLeft=getBool("RightToLeft",!1);isFlipPdf=getString("isFlipPdf",
!1);try{_gaq[0]=["_setAccount",getString("googleAnalyticsID","")]}catch(c){}oriPageIndex=getInt("OriginPageIndex",1);hardPageEnable=getBool("HardPageEnable",!1);userConfig.leftShadowWidth=getInt("LeftShadowWidth",0);userConfig.leftShadowAlpha=getInt("LeftShadowAlpha",0);userConfig.rightShadowWidth=getInt("RightShadowWidth",0);userConfig.rightShadowAlpha=getInt("RightShadowAlpha",0);userConfig.shortcutButtonHeight=getInt("ShortcutButtonHeight",0);userConfig.shortcutButtonWidth=getInt("ShortcutButtonWidth",
0);userConfig.autoPlayButtonVisible=getBool("AutoPlayButtonVisible",!0);userConfig.downloadButtonVisible=getBool("DownloadButtonVisible",!1);userConfig.downloadURL=getString("DownloadURL","");userConfig.bgSoundButtonVisible=getBool("BackgroundSoundButtonVisible",!0);userConfig.bgSoundAutoStart=getBool("BackgroundSoundAutoStart",!0);userConfig.backgroundSoundLoop=getInt("BackgroundSoundLoop",-1);userConfig.bgSoundURL=getString("BackgroundSoundURL","");userConfig.homeButtonVisible=getBool("HomeButtonVisible",
!1);userConfig.homeURL=getString("HomeURL","");userConfig.printButtonVisible=getBool("PrintButtonVisible",!1);userConfig.printWatermarkFile=getString("printWatermarkFile","");userConfig.helpButtonVisible=getBool("HelpButtonVisible",!1);userConfig.helpContentFileURL=getString("helpContentFileURL","");userConfig.helpWidth=getInt("helpWidth",0);userConfig.helpHeight=getInt("helpHeight",0);userConfig.showHelpContentAtFirst=getBool("showHelpContentAtFirst",!1);userConfig.AnnotationButtonVisible=getBool("AnnotationButtonVisible",
!1);userConfig.aboutButtonVisible=getBool("aboutButtonVisible",!1);userConfig.aboutContactInfoTxt=getString("aboutContactInfoTxt","");userConfig.showDoublePage=getBool("showDoublePage",!0);userConfig.fullscreenButtonVisible=getBool("FullscreenButtonVisible",!0);""==userConfig.bgSoundURL&&(userConfig.bgSoundButtonVisible=!1);if(void 0==window.bookConfig)alert("Miss book config.");else{void 0==window.pageEditor&&(window.pageEditor=void 0);if(void 0==window.ols||void 0==ols||0==ols.length)window.ols=
{},tableofcontentButtonEnable=!1;void 0==window.bmtConfig&&(window.bmtConfig=[]);void 0==window.language&&(window.language=[]);!0==$.browser.webkit&&(browserType=BrowserType.WEBKIT);!0==$.browser.mozilla&&(browserType=BrowserType.MOZ);!0==$.browser.opera&&(browserType=BrowserType.OPERA);!0==$.browser.msie&&(browserType=BrowserType.MS);createAll();isTouch?window.onorientationchange=function(){window.setTimeout(function(){onBookLoad.onResize()},200)}:$(window).resize(function(){onBookLoad.onResize()});
"undefined"!=typeof speakConfig&&"none"!=speakConfig.title&&(LectureAudio(0),LectureSoll(0))}});var ButtonType={last:1,next:2,prev:3,first:4,home:5,zoom:6,autoPlay:7,help:8,thumbnails:9,sharethis:10,search:11,download:12,fullscreen:13,bookmark:14,sound:15,language:16,print:17,about:18,more:19,note:20,tableOfContent:21};
loadToolBar.extend({addButton:function(a,b){for(var c=this,d=0;d<b.length;d++)switch(b[d]){case ButtonType.last:this.btnLast=$("<div title='Last page' id='btnLast' class='button'></div>");this.btnLast.append(getImage(toolBarIconsURL[1])).asButton().attr("title",getLanguage("btnLastPage","Last"));a.append(this.btnLast);this.btnLast.bind(_event._end,function(){c.lastPage();isMoreShow&&(moreBar.hideMoreBar(),isMoreShow=!1)});break;case ButtonType.next:this.btnNext=$("<div title='Next page' id='btnRight' class='button'></div>");
this.btnNext.append(getImage(toolBarIconsURL[2])).asButton().attr("title",getLanguage("btnNextPage","Next"));a.append(this.btnNext);this.btnNext.bind(_event._end,function(){c.nextPage();isMoreShow&&(moreBar.hideMoreBar(),isMoreShow=!1)});break;case ButtonType.prev:this.btnPrevious=$("<div title='Previous page'  id='btnLeft' class='button'></div>");this.btnPrevious.append(getImage(toolBarIconsURL[3])).asButton().attr("title",getLanguage("btnPrePage","Previous"));a.append(this.btnPrevious);this.btnPrevious.bind(_event._end,
function(){c.prePage();isMoreShow&&(moreBar.hideMoreBar(),isMoreShow=!1)});break;case ButtonType.first:this.btnFirst=$("<div title='First page' id='btnFirst' class='button' ></div>");this.btnFirst.append(getImage(toolBarIconsURL[4])).asButton().attr("title",getLanguage("btnFirstPage","First"));a.append(this.btnFirst);this.btnFirst.bind(_event._end,function(){c.firstPage();isMoreShow&&(moreBar.hideMoreBar(),isMoreShow=!1)});break;case ButtonType.home:this.btnHome=$("<div title='Home' id='btnHome' class='button'></div>");
this.btnHome.append(getImage(toolBarIconsURL[13])).asButton().attr("title",getLanguage("btnGoToHome","Home"));userConfig.homeButtonVisible||this.btnHome.css({display:"none"});a.append(this.btnHome);this.btnHome.bind(_event._end,function(){if(void 0!=userConfig.homeURL&&""!=userConfig.homeURL){var a=userConfig.homeURL;"http"!=a.substr(0,4)&&(a="http://"+a);window.open(a,"_tab")}isMoreShow&&(moreBar.hideMoreBar(),isMoreShow=!1)});break;case ButtonType.zoom:this.btnZoom=$("<div title='Zoom in' id='btnZoom' class='button'></div>");
this.btnZoom.append(getImage(toolBarIconsURL[5])).asButton().attr("title",getLanguage("btnZoomIn","Zoom in"));(!zoomButtonEnable||!isFlipModel)&&this.btnZoom.css("display","none");a.append(this.btnZoom);this.btnZoom.bind(_event._end,function(){2==bookType?(windowWidth<windowHeight?(bookType=1,changeShowBook(1),setCurrentIndexTextField(singlePageBook.currentPageIndex),singlePageBook.gotoPage(zoomBook.currentIndex)):(bookType=0,changeShowBook(0),setCurrentIndexTextField(flipBook.currentPageIndex,!0),
flipBook.gotoPage(zoomBook.currentIndex)),thumbnail.clearHighLight(),thumbnail.setHighLight(zoomBook.currentIndex),c.changeZoomIcon(!0)):(zoomBook.currentIndex=flipBook.currentPageIndex,zoomBook.showPage.fillContent(zoomBook.currentIndex),bookType=2,changeShowBook(2),setCurrentIndexTextField(zoomBook.currentIndex,!1),thumbnail.clearHighLight(),thumbnail.setHighLight(zoomBook.currentIndex),auto_player.isPlaying()&&(auto_player.stop(),c.changeAutoPlayIcon()),c.changeZoomIcon(!1));isMoreShow&&(moreBar.hideMoreBar(),
isMoreShow=!1)});break;case ButtonType.autoPlay:this.btnAutoPlay=$("<div title='Auto play' id='btnAutoPlay' class='button' ></div>");this.btnAutoPlay.append(getImage(toolBarIconsURL[7])).asButton().attr("title",getLanguage("btnAutoFlip","Auto flip"));userConfig.autoPlayButtonVisible||this.btnAutoPlay.css("display","none");a.append(this.btnAutoPlay);this.btnAutoPlay.bind(_event._end,function(){auto_player.isPlaying()?auto_player.stop():auto_player.start();c.changeAutoPlayIcon();isMoreShow&&(moreBar.hideMoreBar(),
isMoreShow=!1)});break;case ButtonType.help:this.btnHelp=$("<div title='Help' id='btnHelp' class='button'></div>");this.btnHelp.append(getImage(toolBarIconsURL[22])).asButton().attr("title",getLanguage("btnHelp","Help"));userConfig.helpButtonVisible||this.btnHelp.css({display:"none"});a.append(this.btnHelp);this.btnHelp.bind(_event._end,function(){helpBody.getShowStatu()?helpBody.hideBox():helpBody.showshow();isMoreShow&&(moreBar.hideMoreBar(),isMoreShow=!1)});break;case ButtonType.thumbnails:this.btnThumb=
$("<div title='Thumbnails'  id='btnThumb' class='button'></div>");this.btnThumb.append(getImage(toolBarIconsURL[9])).asButton().attr("title",getLanguage("btnThumb","Thumbnails"));thumbButtonEnable||this.btnThumb.css("display","none");a.append(this.btnThumb);this.btnThumb.bind(_event._end,function(){thumbnail.getShowStatu()?thumbnail.hideBox():thumbnail.showshow();isMoreShow&&(moreBar.hideMoreBar(),isMoreShow=!1)});break;case ButtonType.sharethis:this.btnShare=$("<div title='Share'  id='btnShare' class='button'></div>");
this.btnShare.append(getImage(toolBarIconsURL[10])).asButton().attr("title",getLanguage("btnSocialShare","Share"));shareButtonEnable||this.btnShare.css("display","none");a.append(this.btnShare);this.btnShare.bind(_event._end,function(){sharePanel.getShowStatu()?sharePanel.hideBox():sharePanel.showshow();isMoreShow&&(moreBar.hideMoreBar(),isMoreShow=!1)});this.btnShare.bind(_event._down,function(){isMoreShow&&(moreBar.hideMoreBar(),isMoreShow=!1);return!1});break;case ButtonType.search:this.btnSearch=
$("<div title='Search' id='btnSearch' class='button'></div>");this.btnSearch.append(getImage(toolBarIconsURL[11])).asButton().attr("title",getLanguage("btnSearch","Search"));searchButtonEnable||this.btnSearch.css("display","none");a.append(this.btnSearch);this.btnSearch.bind(_event._end,function(){frmSearch.isSearchShow?frmSearch.closeForm():frmSearch.showForm();isMoreShow&&(moreBar.hideMoreBar(),isMoreShow=!1)});break;case ButtonType.download:this.btnDownload=$("<div title='Download' id='btnDownload' class='button'></div>");
this.btnDownload.append(getImage(toolBarIconsURL[12])).asButton().attr("title",getLanguage("btnDownload","Download"));userConfig.downloadButtonVisible||this.btnDownload.css({display:"none"});a.append(this.btnDownload);this.btnDownload.bind(_event._end,function(){""!=userConfig.downloadURL&&(window.location=userConfig.downloadURL);isMoreShow&&(moreBar.hideMoreBar(),isMoreShow=!1)});break;case ButtonType.fullscreen:this.btnFullscreen=$("<div title='Fullscreen' id='btnfullscreen' class='button'></div>");
this.btnFullscreen.append(getImage(toolBarIconsURL[27])).asButton().attr("title",getLanguage("btnFullscreen","Fullscreen"));userConfig.fullscreenButtonVisible||this.btnFullscreen.css({display:"none"});a.append(this.btnFullscreen);this.btnFullscreen.bind(_event._end,function(){var a=$("body")[0];fullScreenApi.supportsFullScreen?fullScreenApi.isFullScreen()?fullScreenApi.cancelFullScreen():fullScreenApi.requestFullScreen(a):a.webkitSupportsFullscreen&&a.webkitEnterFullscreen(Element.ALLOW_KEYBOARD_INPUT);
return!1});$(document).bind(fullScreenApi.fullScreenEventName,function(){c.changeFullscreenIcon(fullScreenApi.isFullScreen())});break;case ButtonType.bookmark:this.btnBookMark=$("<div title='Bookmark' id='btnBookmark' class='button'></div>");this.btnBookMark.append(getImage(toolBarIconsURL[14])).asButton().attr("title",getLanguage("btnBookMark","Bookmark"));bookmarkButtonEnable||this.btnBookMark.css("display","none");a.append(this.btnBookMark);this.btnBookMark.bind(_event._end,function(){bookmark.showHide();
isMoreShow&&(moreBar.hideMoreBar(),isMoreShow=!1)});break;case ButtonType.tableOfContent:this.btnTableOfContent=$("<div title='TableOfContent' id='btnTableOfContent' class='button'></div>");this.btnTableOfContent.append(getImage(toolBarIconsURL[32])).asButton().attr("title",getLanguage("btnTableOfContent","TableOfContent"));tableofcontentButtonEnable||this.btnTableOfContent.css("display","none");a.append(this.btnTableOfContent);this.btnTableOfContent.bind(_event._end,function(){frmBookmark.getShowStatu()?
frmBookmark.closeForm():frmBookmark.showForm();isMoreShow&&(moreBar.hideMoreBar(),isMoreShow=!1)});break;case ButtonType.sound:this.btnSound=$("<div title='Sound on' id='btnSound' class='button'></div>");this.btnSound.append(getImage(toolBarIconsURL[15])).asButton().attr("title",getLanguage("btnSoundOn","Sound on"));userConfig.bgSoundButtonVisible||this.btnSound.css({display:"none"});a.append(this.btnSound);this.btnSound.bind(_event._end,function(){c.changeSoundIcon();isMoreShow&&(moreBar.hideMoreBar(),
isMoreShow=!1)});break;case ButtonType.language:this.btnLanguage=$("<div title='Language' id='btnLanguage' class='button'></div>");this.btnLanguage.append(getImage(toolBarIconsURL[25])).asButton().attr("title",getLanguage("btnLanguage","Language change"));1>=language.length&&this.btnLanguage.css({display:"none"});a.append(this.btnLanguage);this.btnLanguage.bind(_event._end,function(){languagePanel.getShowStatu()?languagePanel.hideBox():languagePanel.showshow();isMoreShow&&(moreBar.hideMoreBar(),isMoreShow=
!1)});break;case ButtonType.print:this.btnPrint=$("<div title='Print' id='btnPrint' class='button'></div>");this.btnPrint.append(getImage(toolBarIconsURL[21])).asButton().attr("title",getLanguage("btnPrint","Print"));userConfig.printButtonVisible||this.btnPrint.css({display:"none"});a.append(this.btnPrint);this.btnPrint.bind(_event._end,function(){printBody.getShowStatu()?printBody.hideBox():printBody.showshow();isMoreShow&&(moreBar.hideMoreBar(),isMoreShow=!1)});break;case ButtonType.about:this.btnAbout=
$("<div title='About' id='btnAbout' class='button'></div>");this.btnAbout.append(getImage(toolBarIconsURL[23])).asButton().attr("title",getLanguage("btnAbout","About"));userConfig.aboutButtonVisible||this.btnAbout.css({display:"none"});a.append(this.btnAbout);this.btnAbout.bind(_event._end,function(){aboutBody.getShowStatu()?aboutBody.hideBox():aboutBody.showshow();isMoreShow&&(moreBar.hideMoreBar(),isMoreShow=!1)});break;case ButtonType.more:this.btnMore=$("<div title='More' id='btnMore' class='button'></div>");
this.btnMore.append(getImage(toolBarIconsURL[24])).asButton().attr("title",getLanguage("btnMore","More"));a.append(this.btnMore);this.btnMore.bind(_event._end,function(){isMoreShow?moreBar.hideMoreBar():moreBar.showMoreBar();isMoreShow=!isMoreShow;return!1});break;case ButtonType.note:this.btnNote=$("<div title='Note' id='btnNote' class='button'></div>"),this.btnNote.append(getImage(toolBarIconsURL[31])).asButton().attr("title",getLanguage("btnNote","Annotation")),userConfig.AnnotationButtonVisible||
this.btnNote.css({display:"none"}),a.append(this.btnNote),this.btnNote.bind(_event._end,function(){annotationPannel.getShowStatu()?annotationPannel.hideBox():annotationPannel.showshow();isMoreShow&&(moreBar.hideMoreBar(),isMoreShow=!1)})}},lastPage:function(){rightToLeft?firstPageFun():lastPageFun()},nextPage:function(){rightToLeft?previousPageFun():nextPageFun()},prePage:function(){rightToLeft?nextPageFun():previousPageFun()},firstPage:function(){rightToLeft?lastPageFun():firstPageFun()},OnMouseOver:function(){userConfig.homeButtonVisible&&
this.btnHome.mouseOverCursor();userConfig.printButtonVisible&&this.btnPrint.mouseOverCursor();userConfig.downloadButtonVisible&&this.btnDownload.mouseOverCursor();zoomButtonEnable&&isFlipModel&&this.btnZoom.mouseOverCursor();bookmarkButtonEnable&&this.btnBookMark.mouseOverCursor();tableofcontentButtonEnable&&this.btnTableOfContent.mouseOverCursor();shareButtonEnable&&this.btnShare.mouseOverCursor();userConfig.autoPlayButtonVisible&&this.btnAutoPlay.mouseOverCursor();userConfig.bgSoundButtonVisible&&
this.btnSound.mouseOverCursor();userConfig.helpButtonVisible&&this.btnHelp.mouseOverCursor();userConfig.aboutButtonVisible&&this.btnAbout.mouseOverCursor();thumbButtonEnable&&this.btnThumb.mouseOverCursor();userConfig.fullscreenButtonVisible&&this.btnFullscreen.mouseOverCursor();1<language.length&&this.btnLanguage.mouseOverCursor();userConfig.AnnotationButtonVisible&&this.btnNote.mouseOverCursor();this.btnLast.mouseOverCursor();this.btnNext.mouseOverCursor();this.btnPrevious.mouseOverCursor();this.btnFirst.mouseOverCursor();
searchButtonEnable&&this.btnSearch.mouseOverCursor();this.btnMore.mouseOverCursor()},changeLanguage:function(){this.btnLast.attr("title",getLanguage("btnLastPage","Last"));this.btnNext.attr("title",getLanguage("btnNextPage","Next"));this.btnPrevious.attr("title",getLanguage("btnPrePage","Previous"));this.btnFirst.attr("title",getLanguage("btnFirstPage","First"));this.btnZoom.attr("title",2==bookType?getLanguage("btnZoomOut","Zoom out"):getLanguage("btnZoomIn","Zoom in"));this.btnAutoPlay.attr("title",
auto_player.isPlaying()?getLanguage("btnStopAutoFlip","Stop auto flip"):getLanguage("btnAutoFlip","Auto flip"));this.btnThumb.attr("title",getLanguage("btnThumb","Thumbnails"));this.btnShare.attr("title",getLanguage("btnSocialShare","Share"));this.btnSearch.attr("title",getLanguage("btnSearch","Search"));this.btnBookMark.attr("title",getLanguage("btnBookMark","Bookmark"));this.btnTableOfContent.attr("title",getLanguage("btnTableOfContent","table of content"));this.btnDownload.attr("title",getLanguage("btnDownload",
"Download"));this.btnHome.attr("title",getLanguage("btnGoToHome","Home"));this.btnPrint.attr("title",getLanguage("btnPrint","Print"));this.btnNote.attr("title",getLanguage("btnNote","Annotation"));this.btnFullscreen.attr("title",getLanguage("btnFullscreen","Fullscreen"));this.btnHelp.attr("title",getLanguage("btnHelp","Help"));this.btnAbout.attr("title",getLanguage("btnAbout","About"));this.btnLanguage.attr("title",getLanguage("btnLanguage","Language"));this.btnMore.attr("title",getLanguage("btnMore",
"More"));this.btnSound.attr("title",isPlaying?getLanguage("btnSoundOn","Sound on"):getLanguage("btnSoundOff","Sound off"));rightToLeft&&(this.btnFirst.attr({title:getLanguage("btnLastPage","Last")}),this.btnLast.attr({title:getLanguage("btnFirstPage","First")}),this.btnNext.attr({title:getLanguage("btnPrePage","Previous")}),this.btnPrevious.attr({title:getLanguage("btnNextPage","Next")}))}});var isShareShow=!1,initShareBar=function(){shareBar=$("<div class='shareBar' style='display:none;opacity:0;'>");bookContainer.append(shareBar);shareBar.css("z-index",2002);shareBar.css("bottom","38px");shareBar.css("right","300px");shareBar.css({background:bookConfig.formColor,"-webkit-box-shadow":"0 0 10px rgba(40, 40, 40, 0.5)","-moz-box-shadow":"0 0 10px rgba(40, 40, 40, 0.5)","-o-box-shadow":"0 0 10px rgba(40, 40, 40, 0.5)","-ms-box-shadow":"0 0 10px rgba(40, 40, 40, 0.5)","box-shadow":"0 0 10px rgba(40, 40, 40, 0.5)",
"-moz-border-radius":"5px","-webkit-border-radius":"5px","border-radius":"5px"});shareBar.addBorderShadow(bookConfig.formColor,3,3);var a=window.location.href,b=window.document.title,c=window.location.pathname,c=c.substring(0,c.lastIndexOf("/"))+"/"+bookConfig.thumbPath+"1.jpg",d="?&url="+a+"&title="+b+"&description="+bookDescription+"&screenshot="+c,a=initShareButton("email",d),b=initShareButton("facebook",d),c=initShareButton("google",d),e=initShareButton("mySpace",d),f=initShareButton("twitter",
d),g=initShareButton("digg",d),d=initShareButton("more",d);shareBar.append(a);shareButtonTop=function(a){return 8+35*a};a.css({top:shareButtonTop(0)+"px",left:"10px"});shareBar.append(b);b.css({top:shareButtonTop(1)+"px",left:"10px"});shareBar.append(c);c.css({top:shareButtonTop(2)+"px",left:"10px"});shareBar.append(e);e.css({top:shareButtonTop(3)+"px",left:"10px"});shareBar.append(f);f.css({top:shareButtonTop(4)+"px",left:"10px"});shareBar.append(g);g.css({top:shareButtonTop(5)+"px",left:"10px"});
shareBar.append(d);d.css({top:shareButtonTop(6)+"px",left:"10px"});shareBar.css({height:shareButtonTop(7)+"px"});shareBar.show=!1;$.fn.extend(shareBar,{showShareBar:function(){shareBar.css("display","block");shareBar.show=!0;shareBar.animate({opacity:0.9},200,"linear")},hideShareBar:function(){shareBar.show=!1;shareBar.animate({opacity:0},200,"linear",function(){shareBar.css("display","none")})},setSharePosition:function(a,b,c){void 0==c&&(c=["right","bottom"]);shareBar.css(c[0],a+"px");shareBar.css(c[1],
b+"px")},getShowStatus:function(){return shareBar.show}})},initShareButton=function(a,b){var c=$("<div style = 'position: absolute;width:135px;height:33px;color:white;font-family:arial;font-size:12px'></div>"),d,e;switch(a){case "email":e="http://api.addthis.com/oexchange/0.8/forward/email/offer"+b;d=$("<div class='shareButton' ><img src='"+uiBaseURL+"email.png' class='shareImg' />Email</div>");break;case "facebook":e="http://api.addthis.com/oexchange/0.8/forward/facebook/offer"+b;d=$("<div class='shareButton'><img src='"+
uiBaseURL+"facebook.png' class='shareImg' />Facebook</div>");break;case "google":e="http://api.addthis.com/oexchange/0.8/forward/igoogle/offer"+b;d=$("<div class='shareButton'><img src='"+uiBaseURL+"google.png' class='shareImg' />Google+</div>");break;case "mySpace":e="http://api.addthis.com/oexchange/0.8/forward/myspace/offer"+b;d=$("<div class='shareButton'><img src='"+uiBaseURL+"myspace.png' class='shareImg' />MySpace</div>");break;case "netvibes":e="http://api.addthis.com/oexchange/0.8/forward/netvibes/offer"+
b;d=$("<div class='shareButton'><img src='"+uiBaseURL+"netvibes.png' class='shareImg' />netvibes</div>");break;case "twitter":e="http://api.addthis.com/oexchange/0.8/forward/twitter/offer"+b;d=$("<div class='shareButton'><img src='"+uiBaseURL+"twitter.png' class='shareImg' />Twitter</div>");break;case "digg":e="http://api.addthis.com/oexchange/0.8/forward/digg/offer"+b;d=$("<div class='shareButton'><img src='"+uiBaseURL+"digg.png' class='shareImg' />Digg</div>");break;case "more":e="http://api.addthis.com/oexchange/0.8/offer"+
b,d=$("<div class='shareButton'><img src='"+uiBaseURL+"more.png' class='shareImg' />More</div>")}d.css({cursor:"pointer"});d.bind(_event._down,function(){sendvisitinfo(2,getShownPageString());window.open(e,"_blank")});c.append(d);c.mousedown(function(){c.css("background-color","#0000f0")});c.mouseup(function(){c.css("background-color","transparent");shareBar.hideShareBar()});return c},getLogoLink=function(){var a=bookConfig.appLogoLinkURL,b=getString("appLogoOpenWindow","_blank");if("_Self"==b||"Self"==
b||"self"==b)b="_self";void 0==a||""==a?(a="javascript:Void();",b="_self"):"http"!=a.substr(0,4)&&(a="http://"+a);return[a,b]},logoBar,initLogoBar=function(a){logoBar=$("#logoBar");if(void 0!=bookConfig.appLogoIcon||""!=bookConfig.appLogoIcon){var b=$("<img />"),c=0,d=0,e=getLogoLink();b.load(function(){if(isNaN(bookConfig.logoHeight)||""==bookConfig.logoHeight||null==bookConfig.logoHeight||void 0==bookConfig.logoHeight)try{c=a.getLogoHeight()}catch(e){c=toolBar.getLogoHeight()}else c=bookConfig.logoHeight;
var f=b.width()*c/b.height();b.css({width:f+"px",height:c+"px"});try{d=(a.getLogoHeight()-c)/2}catch(j){d=0}logoBar.css({position:"absolute"});logoBar.append(b)});b.attr({src:bookConfig.appLogoIcon});b.css({position:"absolute"})}var f=0,f=isNaN(bookConfig.logoPadding)||""==bookConfig.logoPadding||null==bookConfig.logoPadding||void 0==bookConfig.logoPadding?0:bookConfig.logoPadding,d=0,d=isNaN(bookConfig.logoTop)||""==bookConfig.logoTop||null==bookConfig.logoTop||void 0==bookConfig.logoTop?0:bookConfig.logoTop;
logoBar.css({left:f+"px"});logoBar.css({top:d+"px"});logoBar.bind(_event._down,function(){window.open(e[0],e[1])});logoBar.bind("mouseover",function(){logoBar.css({cursor:"pointer"})})},setPageIndexTextField=function(){if(!(void 0==pageIndexTextField||null==pageIndexTextField)&&!(void 0==pageIndexTextField[0]||null==pageIndexTextField[0])){setCurrentIndexTextField(flipBook.getCurrentPageIndex(),bookType==BookType.normal_book);var a=[8,13,46,48,49,50,51,52,53,54,55,56,57,96,97,98,99,100,101,102,103,
104,105];pageIndexTextField.css({padding:"3px"});pageIndexTextField.bind("keydown",function(b){if(0>a.indexOf(b.keyCode))return!1;13==b.keyCode&&(b=pageIndexTextField.val().replace(/\D/g,""),b=Math.min(Math.max(b,1),totalPageCount),gotoPageFun(b))});pageIndexTextField.bind("blur",function(){var a=flipBook.currentPageIndex;bookType==BookType.single_book&&(a=$(singlePageBook).data().currentPageIndex);bookType==BookType.zoom_book&&(a=zoomBook.currentIndex);bookType==BookType.slide_book&&(a=slideBook.currentIndex);
bookType==BookType.singleSlide_book&&(a=singleSlideBook.currentIndex);bookType==BookType.catalog_book&&(a=catalogBook.currentIndex);bookType==BookType.singleCatalog_book&&(a=singleCatalogBook.currentIndex);bookType==BookType.phone_book&&(a=phoneBook.currentIndex);bookType==BookType.singlePhone_book&&(a=singlePhoneBook.currentIndex);setCurrentIndexTextField(a,bookType==BookType.normal_book)});pageIndexTextField.bind(_event._end,function(){pageIndexTextField.val("")})}},languageChange=function(a){var b=
this;this.background=$("<div class='printBar'></div>");this.contentBox=$("<div class='printBG'></div>");var c=0;this.showing=!1;$(this.background).css({width:windowWidth+"px",height:windowHeight+"px"});$(this.contentBox).css({width:"200px"});$(this.contentBox).css({background:"transparent"});a.append(this.background);a.append(this.contentBox);c=45*language.length+10;this.contentBox.css({height:c+"px"});$(this.contentBox).css({left:(windowWidth-200)/2+"px",top:(windowHeight-c)/2+"px"});a=[];a=[];for(c=
0;c<language.length;c++){var d=$("<div></div>"),e=language[c].language;$(d).css({width:"80px",height:"35px",position:"absolute"});$(d).css({left:"60px",top:45*c+10+"px"});$(d).html(e);d.attr("language",e);a.push(d);$(b.contentBox).append($(a[c]));$(a[c]).css({"font-size":"20px","text-align":"center","line-height":"35px","vertical-align":"middle",color:"#ffffff"});$(a[c]).css({"font-family":"Tahoma","border-radius":"5px",position:"absolute"});$(a[c]).css({cursor:"pointer"});$(a[c]).bind(_event._end,
function(){changeLanguage($(this).attr("language"));b.hideBox()});$(a[c]).bind(_event._enter,function(){$(this).css({background:"#transparent",border:"2px solid #ff8040"})});$(a[c]).bind(_event._end,function(){$(this).css({background:"transparent",border:""})});$(a[c]).bind(_event._leave,function(){$(this).css({background:"transparent",border:""})})}this.initEvent();$(this.background).css({display:"none"});$(this.contentBox).css({display:"none"})};
languageChange.prototype.onResize=function(){var a=45*language.length+10;$(this.background).css({width:windowWidth+"px",height:windowHeight+"px"});$(this.contentBox).css({width:"200px",height:a+"px"});$(this.contentBox).css({left:(windowWidth-200)/2+"px",top:(windowHeight-a)/2+"px"})};languageChange.prototype.hideBox=function(){$(this.background).fadeOut(1E3);$(this.contentBox).fadeOut(1E3);this.showing=!1};
languageChange.prototype.showshow=function(){$(this.background).fadeIn(1E3);$(this.contentBox).fadeIn(1E3);this.showing=!0};languageChange.prototype.getShowStatu=function(){return this.showing};languageChange.prototype.initEvent=function(){var a=this;$(this.background).bind(_event._end,function(){a.hideBox();a.showing=!1})};
var AnnotationPannel=function(a){var b=this;this.width=65;this.itemWidth=37;this.itemHeight=33;this.showButtonHeight=18;this.padding=8;this.buttonCount=6;this.itemBoxWidth=this.width-10;this.itemBoxHeight=this.buttonCount*(this.itemHeight+this.padding)+2*this.padding+this.itemHeight;this.height=this.itemBoxHeight+this.showButtonHeight+10;this.background=$("<div></div>");this.showHideButton=$("<div></div>");this.contentBox=$("<div></div>");a.append(this.background);this.background.append(this.showHideButton);
this.background.append(this.contentBox);this.background.css({width:this.width+"px",height:this.height+"px",left:"100px",top:(windowHeight-this.height)/2+"px","z-index":"10",position:"absolute"});this.contentBox.css({width:this.itemBoxWidth+"px",height:this.itemBoxHeight+"px",left:(this.width-this.itemBoxWidth)/2+"px",top:6+this.showButtonHeight+"px",position:"absolute",background:"#535353","border-top":"1px solid #6a6a6a","border-radius":"0px 0px 2px 2px","-webkit-box-shadow":"0 0 5px rgba(54, 54, 54, 0.95)",
"-moz-box-shadow":"0 0 5px rgba(54, 54, 54, 0.95)","-o-box-shadow":"0 0 5px rgba(54, 54, 54, 0.95)","box-shadow":"0 0 5px rgba(54, 54, 54, 0.95)"});this.showHideButton.css({top:"5px",left:(this.width-this.itemBoxWidth)/2+"px",width:this.itemBoxWidth+"px",height:this.showButtonHeight+"px",position:"absolute","border-radius":"3px 3px 0px 0px","border-bottom":"1px solid #000000",background:"#383838","-webkit-box-shadow":"0 0 5px rgba(54, 54, 54, 0.95)","-moz-box-shadow":"0 0 5px rgba(54, 54, 54, 0.95)",
"-o-box-shadow":"0 0 5px rgba(54, 54, 54, 0.95)","box-shadow":"0 0 5px rgba(54, 54, 54, 0.95)"});a=$("<img/>");a.attr("src",uiBaseURL+"noteclose.png");a.css({position:"absolute",right:"5px",width:10,height:10,top:(this.showButtonHeight-10)/2+"px"});a.asImageButton();a.bind(_event._end,function(){b.hideBox()});this.showHideButton.append(a);this.buttonType=0;this.addItem(this.contentBox);this.addSonItem(this.background);this.changeCursor();CreateNoteRemark.bind(this)();this.initEvent();this.background.css("display",
"none");this.showing=!1};
AnnotationPannel.prototype.addItem=function(a){for(var b=this,c=this.buttonType=0;c<this.buttonCount;c++){var d=$("<div></div>"),e=$("<img/>");$(d).attr("buttonType",c);d.css({width:b.itemWidth+"px",height:b.itemHeight+"px",left:(b.itemBoxWidth-b.itemWidth)/2+"px",top:b.itemWidth/2+b.padding+c*(b.itemHeight+this.padding)+"px",position:"absolute","border-radius":"2px"});e.css({"margin-left":"5px","margin-top":"3px",position:"absolute"});a.append(d);d.append(e);d.bind(_event._over,function(){$(this).removeClass();
$(this).attr("class","item-enter")});d.bind(_event._end,function(){$(this).removeClass();$(this).attr("class","item-enter")});d.bind(_event._leave,function(){b.buttonType!=$(this).attr("buttonType")&&($(this).removeClass(),$(this).attr("class","item-transparent"))});switch(c){case 0:e.attr("src",uiBaseURL+"cursor.png");e.attr("title","cursor");b.cursorButton=d;$(d).bind("click",function(){b.resetButton()});break;case 1:e.attr("src",uiBaseURL+"highligh.png");e.attr("title","add highlight");$(d).bind("click",
function(){annotationShapes.delEvents();signature.hide();textRemark.unbindCreateEvents();textRemark.addHighlightEvent();noteCookie.hide();cursor=!1;1!=b.buttonType&&b.changeCursor();b.buttonType=1;b.selectButton=b.highLightButton;b.shapesPannel.hide()});b.highLightButton=d;break;case 2:e.attr("src",uiBaseURL+"remark.png");e.attr("title","add texts");$(d).bind("click",function(){annotationShapes.delEvents();signature.hide();textRemark.unbindCreateEvents();textRemark.addEvents();noteCookie.hide();cursor=
!1;2!=b.buttonType&&b.changeCursor();b.buttonType=2;b.selectButton=b.textRemarkButton;b.shapesPannel.hide()});b.textRemarkButton=d;break;case 3:e.attr("src",uiBaseURL+"shape.png");e.attr("title","add shapes");$(d).bind("click",function(){void 0!=b.shapeButton&&b.shapeButton.trigger(_event._enter);annotationShapes.delEvents();signature.hide();textRemark.unbindCreateEvents();noteCookie.hide();cursor=!1;3!=b.buttonType&&b.changeCursor();b.buttonType=3;b.selectButton=b.shapeButton;b.shapesPannel.show()});
$(d).bind(_event._over,function(){b.shapesPannel.show()});$(d).bind(_event._leave,function(){3!=b.buttonType&&b.shapesPannel.hide()});b.shapeButton=d;break;case 4:e.attr("src",uiBaseURL+"notesadd.png");e.attr("title","add notes");$(d).bind("click",function(){annotationShapes.delEvents();signature.hide();textRemark.unbindCreateEvents();noteCookie.showHide();cursor=!1;4!=b.buttonType&&b.changeCursor();b.buttonType=4;b.selectButton=b.noteCookieButton;b.shapesPannel.hide()});b.noteCookieButton=d;break;
case 5:e.attr("src",uiBaseURL+"signature.png"),e.attr("title","add signature"),$(d).bind("click",function(){annotationShapes.delEvents();signature.showHide();textRemark.unbindCreateEvents();noteCookie.hide();cursor=!1;5!=b.buttonType&&b.changeCursor();b.buttonType=5;b.selectButton=b.signatureButton;b.shapesPannel.hide()}),b.signatureButton=d}}};
AnnotationPannel.prototype.addSonItem=function(a){var b=parseInt(this.contentBox.css("left"))+parseInt(this.contentBox.css("width")),c=parseInt(this.shapeButton.css("top"))+parseInt(this.contentBox.css("top"))-this.padding/2,d=(parseInt(this.contentBox.css("width"))-this.itemWidth)/2+8;this.shapesPannel=$("<div></div>");this.shapesContentBox=$("<div></div>");this.shapesPannel.css({width:d+180+8,height:49,position:"absolute",left:b-d+"px",top:c+"px"});this.shapesContentBox.css({width:188,height:49,
position:"absolute",left:d+"px",background:"#535353","border-radius":"0px 2px 2px 0px","-webkit-box-shadow":"0 0 5px rgba(54, 54, 54, 0.95)","-moz-box-shadow":"0 0 5px rgba(54, 54, 54, 0.95)","-o-box-shadow":"0 0 5px rgba(54, 54, 54, 0.95)","box-shadow":"0 0 5px rgba(54, 54, 54, 0.95)"});a.append(this.shapesPannel);this.shapesPannel.append(this.shapesContentBox);this.shapesPannel.hide();var e=this;this.shapesPannel.bind(_event._enter,function(){e.shapesPannel.show()});this.shapesPannel.bind(_event._leave,
function(){3!=e.buttonType&&e.shapesPannel.hide()});for(a=0;4>a;a++){var d=$("<div></div>"),f=$("<img/>"),c=8,b=8+45*a;d.css({width:"37px",height:"33px",left:b+"px",top:c+"px",position:"absolute","border-radius":"2px"});f.css({"margin-left":"5px","margin-top":"3px",position:"absolute"});this.shapesContentBox.append(d);d.append(f);switch(a){case 0:f.attr("src",uiBaseURL+"shapes_line.png");f.attr("title","add line");$(d).bind("click",function(){e.clickShape();annotationShapes.addEvents("line");e.shapesPannel.hide()});
break;case 1:f.attr("src",uiBaseURL+"shapes_arrow.png");f.attr("title","add arrow");$(d).bind("click",function(){e.clickShape();annotationShapes.addEvents("arrow");e.shapesPannel.hide()});break;case 2:f.attr("src",uiBaseURL+"shapes_rect.png");f.attr("title","add rect");$(d).bind("click",function(){e.clickShape();annotationShapes.addEvents("rect");e.shapesPannel.hide()});break;case 3:f.attr("src",uiBaseURL+"shapes_ellipse.png"),f.attr("title","add ellipse"),$(d).bind("click",function(){e.clickShape();
annotationShapes.addEvents("ellipse");e.shapesPannel.hide()})}d.bind(_event._over,function(){$(this).removeClass();$(this).attr("class","item-enter")});d.bind(_event._end,function(){$(this).removeClass();$(this).attr("class","item-transparent")});d.bind(_event._leave,function(){$(this).removeClass();$(this).attr("class","item-transparent")})}};AnnotationPannel.prototype.clickShape=function(){void 0!=this.shapeButton&&this.shapeButton.find("img").trigger("click")};
AnnotationPannel.prototype.resetButton=function(){cursor=!0;0!=this.buttonType&&this.changeCursor();this.buttonType=0;this.selectButton=this.cursorButton;this.shapesPannel.hide();void 0!=textRemark&&textRemark.unbindCreateEvents();void 0!=noteCookie&&noteCookie.hide();void 0!=annotationShapes&&annotationShapes.delEvents();void 0!=signature&&signature.hide()};
AnnotationPannel.prototype.changeCursor=function(){void 0==this.selectButton&&(this.selectButton=this.cursorButton);cursor?($(this.selectButton).removeClass(),$(this.selectButton).attr("class","item-transparent"),$(this.cursorButton).removeClass(),$(this.cursorButton).attr("class","item-enter")):($(this.selectButton).removeClass(),$(this.selectButton).attr("class","item-transparent"))};
AnnotationPannel.prototype.onResize=function(){this.background.css({left:"100px",top:(windowHeight-this.height)/2+"px"})};AnnotationPannel.prototype.hideBox=function(){$(this.background).fadeOut(500);this.showing=!1;this.resetButton()};AnnotationPannel.prototype.showshow=function(){$(this.background).fadeIn(500);this.showing=!0};AnnotationPannel.prototype.getShowStatu=function(){return this.showing};AnnotationPannel.prototype.initEvent=function(){$(this.background).dragToMove(this.background)};isPhoneBook()&&(loadToolBar=function(a,b){this.visible=!1;this.icons=b;this.topBG=$("<div class='pbTopBar' id='fbTopBarImg'></div>");this.toolBG=$("<div class='pbToolBar' id='fbToolBar'></div>");this.thumbnailBG=$("<div id='fbThumbnail'></div>");this.logoBar=$("<div id='logoBar' style='position: absolute;z-index: 2;'></div>");this.buttonTopBar=$("<div class='top right' style='width:200px;position: absolute;left: 0px;right: 0px;z-index: 3;'></div>");this.buttonBar=$("<div class='bottom right' style='position: relative;left: auto;right: 0px;z-index: 3;'></div>");
this.btnThumb=$("<div title='Thumbnails'  id='btnThumb' class='bottom left' style='position: absolute;left: 0px;right: auto;z-index: 3;'></div>");this.btnAutoPlay=$("<div title='Auto Play' id='btnAutoPlay' style='position: absolute;' class='numbering' ></div>");this.btnShare=$("<div title='Share'  id='btnShare' style='position: absolute;' class='numbering'></div>");this.btnLinet=$("<div title='linet'  id='btnlinet' class='bottom left' style='position: absolute;left: 0px;right: auto;z-index: 3;'></div>");
this.btnLines=$("<div title='lines'  id='btnlines' class='numbering'></div>");a.append(this.topBG);a.append(this.toolBG);this.topBG.append(this.logoBar);this.topBG.append(this.buttonTopBar);this.toolBG.append(this.buttonBar);this.toolBG.append(this.btnThumb);this.toolBG.append(this.btnLinet);this.toolBG.append(this.thumbnailBG);this.buttonBar.append(this.btnAutoPlay);this.buttonBar.append(this.btnShare);this.buttonBar.append(this.btnLines);$(this.toolBG).css({"-webkit-box-shadow":"0 0 5px rgba(40, 0, 0, 0.5)",
"-moz-box-shadow":"0 0 5px rgba(40, 0, 0, 0.5)","-o-box-shadow":"0 0 5px rgba(40, 0, 0, 0.5)","box-shadow":"0 0 5px rgba(40, 0, 0, 0.5)"});this.toolBG.css({width:windowWidth+"px",height:"155px"});this.thumbnailBG.css({width:windowWidth+"px",height:"130px",top:"25px"});this.toolBG.css("background",bookConfig.toolbarColor);this.btnAutoPlayConfig=$.extend({align:0,caption:getLanguage("btnAutoFlip","Auto Flip"),mainColor:"",iconURL:phoneIconsURL[0]},this.btnAutoPlay);this.btnThumbConfig=$.extend({align:0,
caption:getLanguage("btnThumb","Thumbnails"),mainColor:"",iconURL:phoneIconsURL[2]},this.btnThumb);this.btnShareConfig=$.extend({align:0,caption:getLanguage("btnSocialShare","Share"),mainColor:"",iconURL:phoneIconsURL[3]},this.btnShare);this.buttonAutoPlay=new button(2,this.btnAutoPlay,this.btnAutoPlayConfig,!1,!1);this.buttonThumb=new button(2,this.btnThumb,this.btnThumbConfig,!1,!1);this.buttonShare=new button(2,this.btnShare,this.btnShareConfig,!1,!1);var c=colorDiv(bookConfig.toolbarColor,20),
d=colorAdd(bookConfig.toolbarColor,20);this.btnLinet.css({width:"1px",height:"25px"});this.btnLinet.css({background:c,"border-right":"1px solid "+d});this.btnLines.css({width:"1px",height:"25px"});this.btnLines.css({background:c,"border-right":"1px solid "+d});getBool("autoPlayAutoStart",!1)&&(this.btnAutoPlay.empty().append(getImage(phoneIconsURL[1])),this.btnAutoPlay.attr("title",getLanguage("btnStopAutoFlip","Stop Auto Flip")));thumbnail=new thumbnailBar(this.thumbnailBG);initShareBar();initLogoBar(this);
userConfig.autoPlayButtonVisible||this.btnAutoPlay.css("display","none");thumbButtonEnable||this.btnThumb.css("display","none");shareButtonEnable||this.btnShare.css("display","none");this.initEvent();this.visible=!1},loadToolBar.prototype.setButtonPosition=function(){var a=3;shareBar.setSharePosition(0,25,["right","bottom"]);this.toolBG.css({width:windowWidth+"px",height:"165px",color:"#ffffff"});this.thumbnailBG.css({width:windowWidth+"px",height:"130px",top:"25px"});QRbutton.css({top:"0px",left:windowWidth-
50+"px"});thumbButtonEnable?(this.btnThumb.css({top:"2px",left:"0px"}),this.btnLinet.css({top:"0px",left:this.buttonThumb.getCaptionWidth()+16+3+12+"px"})):(this.btnLinet.hide(),this.btnThumb.hide());a=3;shareButtonEnable?(this.btnShare.css({top:"0px",right:this.buttonShare.getCaptionWidth()+16+12+a+"px"}),shareBar.setSharePosition(a,25+this.getThumbnailHeight()),a=a+this.buttonShare.getCaptionWidth()+16+12+2,this.btnLines.css({top:"0px",right:a+"px"}),a+=3):(this.btnShare.css({display:"none"}),this.btnLines.css({display:"none"}));
this.autoPlayRight=a;userConfig.autoPlayButtonVisible?this.btnAutoPlay.css({top:"0px",right:this.buttonAutoPlay.getCaptionWidth()+16+a+12+"px"}):this.btnAutoPlay.css({display:"none"});this.mouseEnterShine(bookConfig.toolbarColor,colorDiv(bookConfig.toolbarColor,30),colorAdd(bookConfig.toolbarColor,105));sharePanel.onResize();QRcode.onResize()},loadToolBar.prototype.changeButtonColor=function(){},loadToolBar.prototype.changeZoomIcon=function(){},loadToolBar.prototype.changeFullscreenIcon=function(){},
loadToolBar.prototype.changeAutoPlayIcon=function(){},loadToolBar.prototype.changeSoundIcon=function(){},loadToolBar.prototype.mouseEnterShine=function(){userConfig.autoPlayButtonVisible&&this.buttonAutoPlay.mouseEnterLight(colorDiv(bookConfig.toolbarColor,20));thumbButtonEnable&&this.buttonThumb.mouseEnterLight(colorDiv(bookConfig.toolbarColor,20));shareButtonEnable&&this.buttonShare.mouseEnterLight(colorDiv(bookConfig.toolbarColor,20))},loadToolBar.prototype.show=function(){this.visible=!0;this.toolBG.animate({bottom:-140,
opacity:0.95},500,function(){});this.topBG.animate({top:0,opacity:0.95},500,function(){});bookType==BookType.singlePhone_book&&singlePhoneBook.setShow(!1);bookType==BookType.phone_book&&phoneBook.setShow(!1)},loadToolBar.prototype.getHeight=function(){return this.getTopHeight()+this.getBottomHeight()},loadToolBar.prototype.getTopHeight=function(){return!0==this.visible?this.topBG.height():0},loadToolBar.prototype.getBottomHeight=function(){return!0==this.visible?25+this.getThumbnailHeight():0},loadToolBar.prototype.getLogoHeight=
function(){return this.topBG.height()},loadToolBar.prototype.getThumbnailHeight=function(){return thumbnail.getShowStatu()?140:0},loadToolBar.prototype.hide=function(){this.visible=!1;this.toolBG.animate({bottom:-190,opacity:0},300,function(){});this.topBG.animate({top:-50,opacity:0},500,function(){});shareBar.hideShareBar();bookType==BookType.singlePhone_book&&singlePhoneBook.setShow(!0);bookType==BookType.phone_book&&phoneBook.setShow(!0)},loadToolBar.prototype.changeZoomIcon=function(){},loadToolBar.prototype.changeAutoPlayIcon=
function(){void 0!=auto_player&&null!=auto_player&&(auto_player.isPlaying()?this.btnAutoPlay.empty().append(getImage(phoneIconsURL[1])).attr("title",getLanguage("btnStopAutoFlip","Stop Auto Flip")):this.btnAutoPlay.empty().append(getImage(phoneIconsURL[0])).attr("title",getLanguage("btnAutoFlip","Auto Flip")),this.btnAutoPlay.children("img").css({"margin-left":"5px","margin-top":"5px"}),this.btnAutoPlay.changeButtonColor(bookConfig.iconColor))},loadToolBar.prototype.changeSoundIcon=function(){},loadToolBar.prototype.initEvent=
function(){var a=this;this.btnAutoPlay.bind(_event._end,function(){auto_player.isPlaying()?(auto_player.stop(),a.buttonAutoPlay.changeIcon(phoneIconsURL[0]),a.buttonAutoPlay.changeCaption(getLanguage("btnAutoFlip","Auto Flip"))):(auto_player.start(),a.buttonAutoPlay.changeIcon(phoneIconsURL[1]),a.buttonAutoPlay.changeCaption(getLanguage("btnStopAutoFlip","Stop Auto Flip")));a.btnAutoPlay.css({top:"0px",right:a.buttonAutoPlay.getCaptionWidth()+16+a.autoPlayRight+12+"px"})});this.btnThumb.bind(_event._end,
function(){thumbnail.getShowStatu()?(a.buttonThumb.changeIcon(phoneIconsURL[2]),a.buttonThumb.changeCaption(getLanguage("btnThumb","Thumbnails")),thumbnail.hideBox(),a.toolBG.animate({bottom:-140,opacity:0.95},500)):(a.buttonThumb.changeIcon(uiBaseURL+"thumbnails_down.png"),a.buttonThumb.changeCaption(getLanguage("btnThumb","Thumbnails")),thumbnail.showshow(),a.toolBG.animate({bottom:0,opacity:0.95},500),a.changeThumbnail=!0)});this.btnShare.bind(_event._end,function(){shareBar.getShowStatus()?shareBar.hideShareBar():
shareBar.showShareBar()})},loadToolBar.prototype.lastPage=function(){rightToLeft?firstPageFun():lastPageFun()},loadToolBar.prototype.nextPage=function(){rightToLeft?previousPageFun():nextPageFun()},loadToolBar.prototype.prePage=function(){rightToLeft?nextPageFun():previousPageFun()},loadToolBar.prototype.firstPage=function(){rightToLeft?lastPageFun():firstPageFun()},loadToolBar.prototype.changeLanguage=function(){this.buttonAutoPlay.changeCaption(auto_player.isPlaying()?getLanguage("btnStopAutoFlip",
"Stop Auto Flip"):getLanguage("btnAutoFlip","Auto Flip"));this.buttonThumb.changeCaption(getLanguage("btnThumb","Thumbnails"));this.buttonShare.changeCaption(getLanguage("btnSocialShare","Share"))},isThumbDrag=!1,thumbnailBar=function(a){this.background=$("<div class='phoneThumbBar'></div>");this.contentBox=$("<div class='phoneThumbBG'></div>");this.scrollBox=$("<div class='phoneThumbBox'></div>");this.mouseDown=this.showing=!1;this.scrollBoxX=this.mouseDownX=-1;this.width=800;this.height=140;this.mainColor=
bookConfig.thumbnailColor;this.thumbArray=[];this.lastMoveTime=this.lastMoveX=-1;this.mergeing=this.moveLeft=!1;$(this.contentBox).css({background:this.mainColor});this.background.css({height:this.height+"px",bottom:"0px"});this.contentBox.css({height:this.height+"px"});this.scrollBox.css({height:this.height+"px"});$(a).append(this.background);$(this.background).append(this.contentBox);$(this.contentBox).append(this.scrollBox);this.addItem();this.initEvent();this.setHighLight(1);this.currentCellIndex=
1;this.fillNearByImages(0)},thumbnailBar.prototype.onResize=function(){var a=$(this.background).width(),b=$(this.scrollBox).width();if(a>b)$(this.scrollBox).css({left:(a-b)/2+"px"});else{var c=$(this.scrollBox).offset().left;0<c&&(c=0);c<a-b&&(c=a-b);$(this.scrollBox).css({left:c+"px"})}},thumbnailBar.prototype.setPosition=function(a,b,c){void 0==c&&(c=["left","top"]);$(this.background).css(c[0],a+"px");$(this.background).css(c[1],b+"px")},thumbnailBar.prototype.addItem=function(){for(var a=0;a<=
originTotalPageCount;){var b=0==a?new thumbnailItem(this.scrollBox,1):new thumbnailItem(this.scrollBox,a);b.getWidth();b.setPosition(this.thumbArray.length*(b.getWidth()+5)+5,5);this.thumbArray.push(b);a+=2}$(this.scrollBox).css({width:this.thumbArray.length*(b.getWidth()+5)+10+"px"});this.mergeAll()},thumbnailBar.prototype.resetItemPosition=function(){for(var a=0,b=0;b<this.thumbArray.length;b++){var c=this.thumbArray[b];0==b?(c.setPosition(5,5),a=105):(c.setPosition(a,5),a=a+c.getWidth()+5)}$(this.scrollBox).css({width:a+
"px"})},thumbnailBar.prototype.mergeAll=function(){if(!this.mergeing){for(var a=0;a<this.thumbArray.length;a++)this.thumbArray[a].merge();this.resetItemPosition();this.mergeing=!0}},thumbnailBar.prototype.fissionAll=function(){for(var a=0;a<this.thumbArray.length;a++)this.thumbArray[a].fission();this.resetItemPosition();this.mergeing=!1},thumbnailBar.prototype.getShowStatu=function(){return this.showing},thumbnailBar.prototype.setShowStatu=function(a){this.showing=a},thumbnailBar.prototype.showshow=
function(){this.showing=!0},thumbnailBar.prototype.hideBox=function(){this.showing=!1},thumbnailBar.prototype.initEvent=function(){var a=this;this.background.bind(_event._down,function(){return!1});$(this.contentBox).bind(_event._down,function(b){a.mouseDown=!0;isThumbDrag=!1;b=isTouch?b.originalEvent.touches:[b];a.mouseDownX=b[0].pageX;a.scrollBoxX=$(a.scrollBox).offset().left;return!1});$(this.contentBox).bind(_event._move,function(b){if(a.mouseDown){var b=isTouch?b.originalEvent.touches:[b],c=
a.mouseDownX-b[0].pageX;20<Math.abs(c)&&(isThumbDrag=!0);$(a.background).width()>$(a.scrollBox).width()||(c=a.scrollBoxX-c,0<c&&(c=0),c<$(a.background).width()-$(a.scrollBox).width()&&(c=$(a.background).width()-$(a.scrollBox).width()),$(a.scrollBox).css({left:c+"px"}),a.moveLeft=a.lastMoveX>b[0].pageX?!0:!1,a.lastMoveX=b[0].pageX,a.lastMoveTime=(new Date).getTime())}});$(this.contentBox).bind(_event._end,function(){a.mouseDown=!1;if(100>(new Date).getTime()-a.lastMoveTime&&-1!=a.lastMoveTime){var b=
a.moveLeft?-30:30;a.tweener($(a.scrollBox).offset().left,b,10)}});$(this.contentBox).bind("mouseleave",function(){a.mouseDown=!1})},thumbnailBar.prototype.setHighLight=function(a){this.currentCellIndex=a;var b=Math.floor(a/2);if(!(a>originTotalPageCount))if(this.thumbArray[b].highLight(a),this.clearHighLight(b),$(this.background).width()>$(this.scrollBox).width())$(this.scrollBox).css({left:($(this.background).width()-$(this.scrollBox).width())/2+"px"});else{var a=$(this.scrollBox).offset().left,
c=$(this.background).width(),d=(b-1)*(this.thumbArray[b].getWidth()+5)+75,b=this.thumbArray[b].getWidth();this.tweener(a,-(d+a-(c-b)/2)/6,6)}},thumbnailBar.prototype.clearHighLight=function(a){for(var b=0;b<this.thumbArray.length;b++)b!=a&&this.thumbArray[b].clearHighLight()},thumbnailBar.prototype.tweener=function(a,b,c){var d=function(a,b){for(var c=b/2,d=(a-a/4)/c,e=Array(b),f=0;f<b;f++)e[f]=f<c?a-(c-f)*d:a+(f-c+1)*d;return e.reverse()}(b,c),e=a,f=0,g=this,h=window.setInterval(function(){e+=d[f];
f++;f==c&&(e=a+b*c);0<e&&(e=0);e<$(g.background).width()-$(g.scrollBox).width()&&(e=$(g.background).width()-$(g.scrollBox).width());$(g.scrollBox).css({left:e+"px"});f>=c&&(window.clearInterval(h),g.fillNearByImages(e))},30)},thumbnailBar.prototype.fillNearByImages=function(a){var b=Math.ceil((this.background.width()-a)/80)+2;this.background.width()>this.scrollBox.width()?(a=0,b=originTotalPageCount+1):a=0==a?0:Math.ceil(-a/110);a=Math.max(Math.ceil(a/2),0);b=Math.min(b,originTotalPageCount+1);if(0<
a)for(var c=0;c<a;c++)this.thumbArray[c]&&this.thumbArray[c].clearImage();for(c=a;c<Math.ceil(b/2);c++)a=c,this.thumbArray[a]&&this.thumbArray[a].addImage()},thumbnailCell=function(a){this.background=$("<div class='numbering'></div>");this.img=$("<img />");this.imgBac=$("<div></div>");this.pageIndex=-1;this.width=90;this.height=130;this.imgHeight=this.imgWidth=-1;this.mainColor=bookConfig.thumbnailColor;$(a).append(this.background);$(this.background).css({position:"absolute",width:this.width+"px",
height:this.height+"px"});$(this.imgBac).append(this.img);$(this.imgBac).css({position:"absolute"});$(this.img).css({position:"absolute"});this.img.addBorderShadow("#555555",0,2);this.textHeight=21;this.textWidth=35;this.pageTextField=$("<div class='numbering'></div>");this.pageTextField.css({color:"#444444",background:"#cccccc","font-size":"15px"});this.pageTextField.css({"text-align":"center","vertical-align":"middle"});this.pageTextField.css({"border-radius":"5px"});this.pageTextField.css({width:this.textWidth+
"px",height:this.textHeight+"px","line-height":this.textHeight+"px",position:"absolute"});this.pageTextField.css({left:(this.width-this.textWidth)/2+"px",bottom:"0px","border-radius":"5px 5px 0px 0px"});this.pageTextField.css({display:"none"});$(this.background).css({"text-shadow":"1px 1px #ffffff"});$(this.pageTextField).css({"-webkit-box-shadow":"0 0 10px #444444","-moz-box-shadow":"0 0 10px #444444","-o-box-shadow":"0 0 10px #444444","box-shadow":"0 0 10px #444444"})},thumbnailCell.prototype.getPageIndex=
function(){return this.pageIndex},thumbnailCell.prototype.getWidth=function(){return this.width},thumbnailCell.prototype.getHeight=function(){return this.height},thumbnailCell.prototype.setPosition=function(a,b,c){void 0==c&&(c=["left","top"]);$(this.background).css(c[0],a+"px");$(this.background).css(c[1],b+"px")},thumbnailCell.prototype.onResize=function(a,b){$(this.background).css({width:a+"px",height:b+"px"});this.onResizeImage(a,b)},thumbnailCell.prototype.onResizeImage=function(){var a=getPageWidthHeight(this.width,
this.height,zoomPageWidth,zoomPageHeight);this.imgWidth=a.x;this.imgHeight=a.y;$(this.img).css({width:a.x+"px",height:a.y+"px"});$(this.imgBac).css({width:a.x+"px",height:a.y+"px"});$(this.imgBac).css({left:(this.width-a.x)/2+"px",top:(this.height-a.y)/2+"px"})},thumbnailCell.prototype.setImgPosition=function(a){switch(a){case "l":$(this.imgBac).css({left:"0px",right:"auto"});break;case "r":$(this.imgBac).css({right:"0px",left:"auto"});break;case "c":$(this.imgBac).css({left:(this.width-this.imgWidth)/
2+"px",right:"auto"})}},thumbnailCell.prototype.setCaption=function(a){this.pageTextField.setCaption(a)},thumbnailCell.prototype.fillImage=function(a){this.pageIndex=a;this.img=$("<img/>");$(this.img).attr("src",getPageDir(a,"thumb",originTotalPageCount));$(this.background).append(this.imgBac);$(this.imgBac).append(this.img);$(this.background).append(this.pageTextField);this.onResizeImage(this.width,this.height);this.pageTextField.html("<b>"+a+"</b>")},thumbnailCell.prototype.clearImage=function(){$(this.imgBac).empty()},
thumbnailCell.prototype.showBorder=function(){},thumbnailCell.prototype.hideBorder=function(){$(this.background)[0].style.border=""},thumbnailCell.prototype.getTextField=function(){return this.pageTextField},thumbnailCell.prototype.hideTextField=function(){this.pageTextField.css({display:"none"})},thumbnailCell.prototype.showTextField=function(a){this.pageTextField.css({display:a})},thumbnailCell.prototype.showCell=function(a){$(this.background).css({display:a?"block":"none"})},thumbnailCell.prototype.onMouseUp=
function(a,b){var c=this;$(this.background).bind(_event._end,function(){b.call(a,c)});$(this.background).bind(_event._enter,function(){c.background.css({cursor:"pointer"})})},thumbnailCell.prototype.highLight=function(){$(this.background).css({border:"2px solid #ff8040"})},thumbnailCell.prototype.onMouseOver=function(){var a=this;$(this.background).css({border:""});$(this.background).bind(_event._leave,function(){a.background.css({border:""})})},thumbnailCell.prototype.clearMouseOver=function(){var a=
this;$(this.background).bind(_event._enter,function(){a.background.css({border:""})});$(this.background).bind(_event._leave,function(){a.background.css({border:""})})},thumbnailCell.prototype.onMouseOverUp=function(){var a=this;$(this.background).bind(_event._leave,function(){a.background.css({border:"2px solid #ff8040"})})},thumbnailCell.prototype.clearHighLight=function(){$(this.background).css({border:""})},thumbnailItem=function(a,b){this.background=$("<div class='numbering'></div>");this.itemB=
new thumbnailCell(this.background);this.itemA=new thumbnailCell(this.background);this.width=180;this.height=130;this.isMerge=this.isDoublePage=!0;this.pageIndex=b;this.fillImage=!1;this.mainColor=bookConfig.thumbnailColor;var c=b+1;this.textHeight=21;this.textWidth=70;this.textField=$("<div class='numbering'></div>");$(this.background).append(this.textField);this.textField.css({color:"#444444",background:"#cccccc","font-size":"15px"});this.textField.css({"text-align":"center","vertical-align":"middle"});
this.textField.css({"border-radius":"5px"});this.textField.css({width:this.textWidth+"px",height:this.textHeight+"px","line-height":this.textHeight+"px",position:"absolute"});this.textField.css({left:(this.width-this.textWidth)/2+"px",bottom:"0px","border-radius":"5px 5px 0px 0px"});this.textField.html("<b>"+b+"-"+c+"</b>");this.textField.css({display:"none"});$(this.background).css({"text-shadow":"1px 1px #ffffff"});$(this.textField).css({"-webkit-box-shadow":"0 0 10px #444444","-moz-box-shadow":"0 0 10px #444444",
"-o-box-shadow":"0 0 10px #444444","box-shadow":"0 0 10px #444444"});$(a).append(this.background);$(this.background).css({position:"absolute",width:this.width+"px",height:this.height+"px"});1!=b&&b!=totalPageCount?(this.itemA.setPosition(0,0),this.itemB.setPosition(0,0,["right","top"]),this.itemB.onMouseUp(this,this.onItemMouseUp),this.itemA.pageIndex=b,this.itemB.pageIndex=b+1,this.onMouseOver()):(this.itemA.setPosition(0,0),this.itemB.showCell(!1),this.textField.css({display:"none"}),this.setBorder(!1),
this.itemA.pageIndex=b,this.itemA.onMouseOver());this.itemA.onMouseUp(this,this.onItemMouseUp)},thumbnailItem.prototype.getWidth=function(){return this.width},thumbnailItem.prototype.addImage=function(){this.fillImage||(this.itemA.fillImage(this.pageIndex),1!=this.pageIndex&&this.pageIndex!=totalPageCount?this.itemB.fillImage(this.pageIndex+1):this.itemA.showTextField("block"),this.fillImage=!0)},thumbnailItem.prototype.clearImage=function(){this.itemA.clearImage(this.pageIndex);1!=this.pageIndex&&
this.pageIndex!=totalPageCount?this.itemB.clearImage(this.pageIndex+1):this.itemA.showTextField("block");this.fillImage=!1},thumbnailItem.prototype.setPosition=function(a,b,c){void 0==c&&(c=["left","top"]);$(this.background).css(c[0],a+"px");$(this.background).css(c[1],b+"px")},thumbnailItem.prototype.onResize=function(a,b){this.width=a;this.height=b;$(this.background).css({width:a+"px",height:b+"px"})},thumbnailItem.prototype.resetItem=function(){},thumbnailItem.prototype.fission=function(){1==this.pageIndex||
this.pageIndex==totalPageCount||(this.setBorder(!1),this.itemA.setImgPosition("c"),this.itemB.setImgPosition("c"),this.showTextField(!1),this.isMerge=!1)},thumbnailItem.prototype.merge=function(){1==this.pageIndex||this.pageIndex==totalPageCount||(this.setBorder(!0),this.itemA.setImgPosition("r"),this.itemB.setImgPosition("l"),this.showTextField(!0),this.isMerge=!0)},thumbnailItem.prototype.showBorder=function(){},thumbnailItem.prototype.hideBorder=function(){$(this.background)[0].style.border=""},
thumbnailItem.prototype.showTextField=function(a){var b=a?"none":"block";this.textField.css({display:a?"block":"none"});this.itemA.showTextField(b);this.itemB.showTextField(b)},thumbnailItem.prototype.setBorder=function(a){a?(this.itemA.hideBorder(),this.itemB.hideBorder()):($(this.background)[0].style.border="",this.itemA.showBorder(),this.itemB.showBorder())},thumbnailItem.prototype.onItemMouseUp=function(a){isThumbDrag||(a=a.getPageIndex(),gotoPageFun(a))},thumbnailItem.prototype.highLight=function(a){this.isMerge?
1==a||a==totalPageCount?(this.itemA.highLight("#ffffff"),this.itemA.onMouseOverUp(),this.itemA.showTextField("block")):($(this.background).css({border:"2px solid #ff8040"}),this.onMouseOverUp()):a==this.pageIndex?(this.itemA.highLight("#ffffff"),this.itemA.onMouseOverUp(),this.itemA.showTextField("block")):(this.itemB.highLight("#ffffff"),this.itemB.onMouseOverUp(),this.itemB.showTextField("block"))},thumbnailItem.prototype.onMouseOver=function(){var a=this;$(this.background).css({border:""});$(this.background).bind(_event._leave,
function(){a.background.css({border:""})})},thumbnailItem.prototype.onMouseOverUp=function(){var a=this;$(this.background).bind(_event._leave,function(){a.background.css({border:"2px solid #ff8040"})})},thumbnailItem.prototype.clearMouseOver=function(){var a=this;$(this.background).bind(_event._enter,function(){a.background.css({border:""})});$(this.background).bind(_event._leave,function(){a.background.css({border:""})})},thumbnailItem.prototype.clearHighLight=function(){this.isMerge?1==this.pageIndex||
this.pageIndex==totalPageCount?(this.itemA.onMouseOver(),this.itemB.onMouseOver()):(this.onMouseOver(),this.itemA.clearMouseOver(),this.itemB.clearMouseOver()):(this.itemA.onMouseOver(),this.itemB.onMouseOver(),this.clearMouseOver());this.itemA.clearHighLight();this.itemB.clearHighLight()});var hexcase=0,b64pad="",chrsz=8;function compareov(){var a=Date.parse(new Date);return orgt(a)===vldt(a)}function orgt(a){return binl2hex(core_hx(str2binl(a),a.length*chrsz))}function vldt(a){return binl2hex(core_hx(str2binl(a),a.length*chrsz))}
function core_hx(a,b){a[b>>5]|=128<<b%32;a[(b+64>>>9<<4)+14]=b;for(var c=1732584193,d=-271733879,e=-1732584194,f=271733878,g=0;g<a.length;g+=16)var h=c,j=d,k=e,m=f,c=hx_ff(c,d,e,f,a[g+0],7,-680876936),f=hx_ff(f,c,d,e,a[g+1],12,-389564586),e=hx_ff(e,f,c,d,a[g+2],17,606105819),d=hx_ff(d,e,f,c,a[g+3],22,-1044525330),c=hx_ff(c,d,e,f,a[g+4],7,-176418897),f=hx_ff(f,c,d,e,a[g+5],12,1200080426),e=hx_ff(e,f,c,d,a[g+6],17,-1473231341),d=hx_ff(d,e,f,c,a[g+7],22,-45705983),c=hx_ff(c,d,e,f,a[g+8],7,1770035416),
f=hx_ff(f,c,d,e,a[g+9],12,-1958414417),e=hx_ff(e,f,c,d,a[g+10],17,-42063),d=hx_ff(d,e,f,c,a[g+11],22,-1990404162),c=hx_ff(c,d,e,f,a[g+12],7,1804603682),f=hx_ff(f,c,d,e,a[g+13],12,-40341101),e=hx_ff(e,f,c,d,a[g+14],17,-1502002290),d=hx_ff(d,e,f,c,a[g+15],22,1236535329),c=hx_gg(c,d,e,f,a[g+1],5,-165796510),f=hx_gg(f,c,d,e,a[g+6],9,-1069501632),e=hx_gg(e,f,c,d,a[g+11],14,643717713),d=hx_gg(d,e,f,c,a[g+0],20,-373897302),c=hx_gg(c,d,e,f,a[g+5],5,-701558691),f=hx_gg(f,c,d,e,a[g+10],9,38016083),e=hx_gg(e,
f,c,d,a[g+15],14,-660478335),d=hx_gg(d,e,f,c,a[g+4],20,-405537848),c=hx_gg(c,d,e,f,a[g+9],5,568446438),f=hx_gg(f,c,d,e,a[g+14],9,-1019803690),e=hx_gg(e,f,c,d,a[g+3],14,-187363961),d=hx_gg(d,e,f,c,a[g+8],20,1163531501),c=hx_gg(c,d,e,f,a[g+13],5,-1444681467),f=hx_gg(f,c,d,e,a[g+2],9,-51403784),e=hx_gg(e,f,c,d,a[g+7],14,1735328473),d=hx_gg(d,e,f,c,a[g+12],20,-1926607734),c=hx_hh(c,d,e,f,a[g+5],4,-378558),f=hx_hh(f,c,d,e,a[g+8],11,-2022574463),e=hx_hh(e,f,c,d,a[g+11],16,1839030562),d=hx_hh(d,e,f,c,a[g+
14],23,-35309556),c=hx_hh(c,d,e,f,a[g+1],4,-1530992060),f=hx_hh(f,c,d,e,a[g+4],11,1272893353),e=hx_hh(e,f,c,d,a[g+7],16,-155497632),d=hx_hh(d,e,f,c,a[g+10],23,-1094730640),c=hx_hh(c,d,e,f,a[g+13],4,681279174),f=hx_hh(f,c,d,e,a[g+0],11,-358537222),e=hx_hh(e,f,c,d,a[g+3],16,-722521979),d=hx_hh(d,e,f,c,a[g+6],23,76029189),c=hx_hh(c,d,e,f,a[g+9],4,-640364487),f=hx_hh(f,c,d,e,a[g+12],11,-421815835),e=hx_hh(e,f,c,d,a[g+15],16,530742520),d=hx_hh(d,e,f,c,a[g+2],23,-995338651),c=hx_ii(c,d,e,f,a[g+0],6,-198630844),
f=hx_ii(f,c,d,e,a[g+7],10,1126891415),e=hx_ii(e,f,c,d,a[g+14],15,-1416354905),d=hx_ii(d,e,f,c,a[g+5],21,-57434055),c=hx_ii(c,d,e,f,a[g+12],6,1700485571),f=hx_ii(f,c,d,e,a[g+3],10,-1894986606),e=hx_ii(e,f,c,d,a[g+10],15,-1051523),d=hx_ii(d,e,f,c,a[g+1],21,-2054922799),c=hx_ii(c,d,e,f,a[g+8],6,1873313359),f=hx_ii(f,c,d,e,a[g+15],10,-30611744),e=hx_ii(e,f,c,d,a[g+6],15,-1560198380),d=hx_ii(d,e,f,c,a[g+13],21,1309151649),c=hx_ii(c,d,e,f,a[g+4],6,-145523070),f=hx_ii(f,c,d,e,a[g+11],10,-1120210379),e=hx_ii(e,
f,c,d,a[g+2],15,718787259),d=hx_ii(d,e,f,c,a[g+9],21,-343485551),c=safe_add(c,h),d=safe_add(d,j),e=safe_add(e,k),f=safe_add(f,m);return[c,d,e,f]}function hx_cmn(a,b,c,d,e,f){return safe_add(bit_rol(safe_add(safe_add(b,a),safe_add(d,f)),e),c)}function hx_ff(a,b,c,d,e,f,g){return hx_cmn(b&c|~b&d,a,b,e,f,g)}function hx_gg(a,b,c,d,e,f,g){return hx_cmn(b&d|c&~d,a,b,e,f,g)}function hx_hh(a,b,c,d,e,f,g){return hx_cmn(b^c^d,a,b,e,f,g)}function hx_ii(a,b,c,d,e,f,g){return hx_cmn(c^(b|~d),a,b,e,f,g)}
function safe_add(a,b){var c=(a&65535)+(b&65535);return(a>>16)+(b>>16)+(c>>16)<<16|c&65535}function bit_rol(a,b){return a<<b|a>>>32-b}function str2binl(a){for(var b=[],c=(1<<chrsz)-1,d=0;d<a.length*chrsz;d+=chrsz)b[d>>5]|=(a.charCodeAt(d/chrsz)&c)<<d%32;return b}function binl2hex(a){for(var b=hexcase?"0123456789ABCDEF":"0123456789abcdef",c="",d=0;d<4*a.length;d++)c+=b.charAt(a[d>>2]>>8*(d%4)+4&15)+b.charAt(a[d>>2]>>8*(d%4)&15);return c};
